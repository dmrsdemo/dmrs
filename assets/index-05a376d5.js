var cB=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var P0e=cB((_n,An)=>{function hB(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function uB(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var GE={exports:{}},lv={},WE={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $f=Symbol.for("react.element"),dB=Symbol.for("react.portal"),pB=Symbol.for("react.fragment"),fB=Symbol.for("react.strict_mode"),mB=Symbol.for("react.profiler"),gB=Symbol.for("react.provider"),vB=Symbol.for("react.context"),yB=Symbol.for("react.forward_ref"),xB=Symbol.for("react.suspense"),bB=Symbol.for("react.memo"),wB=Symbol.for("react.lazy"),K8=Symbol.iterator;function CB(e){return e===null||typeof e!="object"?null:(e=K8&&e[K8]||e["@@iterator"],typeof e=="function"?e:null)}var qE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},XE=Object.assign,YE={};function sd(e,t,r){this.props=e,this.context=t,this.refs=YE,this.updater=r||qE}sd.prototype.isReactComponent={};sd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};sd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function QE(){}QE.prototype=sd.prototype;function Xx(e,t,r){this.props=e,this.context=t,this.refs=YE,this.updater=r||qE}var Yx=Xx.prototype=new QE;Yx.constructor=Xx;XE(Yx,sd.prototype);Yx.isPureReactComponent=!0;var Z8=Array.isArray,KE=Object.prototype.hasOwnProperty,Qx={current:null},ZE={key:!0,ref:!0,__self:!0,__source:!0};function JE(e,t,r){var i,n={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)KE.call(t,i)&&!ZE.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:$f,type:e,key:s,ref:a,props:n,_owner:Qx.current}}function SB(e,t){return{$$typeof:$f,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Kx(e){return typeof e=="object"&&e!==null&&e.$$typeof===$f}function _B(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var J8=/\/+/g;function p2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_B(""+e.key):t.toString(36)}function l0(e,t,r,i,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case $f:case dB:a=!0}}if(a)return a=e,n=n(a),e=i===""?"."+p2(a,0):i,Z8(n)?(r="",e!=null&&(r=e.replace(J8,"$&/")+"/"),l0(n,t,r,"",function(c){return c})):n!=null&&(Kx(n)&&(n=SB(n,r+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(J8,"$&/")+"/")+e)),t.push(n)),1;if(a=0,i=i===""?".":i+":",Z8(e))for(var o=0;o<e.length;o++){s=e[o];var l=i+p2(s,o);a+=l0(s,t,r,l,n)}else if(l=CB(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=i+p2(s,o++),a+=l0(s,t,r,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function S1(e,t,r){if(e==null)return e;var i=[],n=0;return l0(e,i,"","",function(s){return t.call(r,s,n++)}),i}function AB(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hi={current:null},c0={transition:null},EB={ReactCurrentDispatcher:Hi,ReactCurrentBatchConfig:c0,ReactCurrentOwner:Qx};_t.Children={map:S1,forEach:function(e,t,r){S1(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return S1(e,function(){t++}),t},toArray:function(e){return S1(e,function(t){return t})||[]},only:function(e){if(!Kx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_t.Component=sd;_t.Fragment=pB;_t.Profiler=mB;_t.PureComponent=Xx;_t.StrictMode=fB;_t.Suspense=xB;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EB;_t.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=XE({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Qx.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)KE.call(t,l)&&!ZE.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:$f,type:e.type,key:n,ref:s,props:i,_owner:a}};_t.createContext=function(e){return e={$$typeof:vB,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:gB,_context:e},e.Consumer=e};_t.createElement=JE;_t.createFactory=function(e){var t=JE.bind(null,e);return t.type=e,t};_t.createRef=function(){return{current:null}};_t.forwardRef=function(e){return{$$typeof:yB,render:e}};_t.isValidElement=Kx;_t.lazy=function(e){return{$$typeof:wB,_payload:{_status:-1,_result:e},_init:AB}};_t.memo=function(e,t){return{$$typeof:bB,type:e,compare:t===void 0?null:t}};_t.startTransition=function(e){var t=c0.transition;c0.transition={};try{e()}finally{c0.transition=t}};_t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};_t.useCallback=function(e,t){return Hi.current.useCallback(e,t)};_t.useContext=function(e){return Hi.current.useContext(e)};_t.useDebugValue=function(){};_t.useDeferredValue=function(e){return Hi.current.useDeferredValue(e)};_t.useEffect=function(e,t){return Hi.current.useEffect(e,t)};_t.useId=function(){return Hi.current.useId()};_t.useImperativeHandle=function(e,t,r){return Hi.current.useImperativeHandle(e,t,r)};_t.useInsertionEffect=function(e,t){return Hi.current.useInsertionEffect(e,t)};_t.useLayoutEffect=function(e,t){return Hi.current.useLayoutEffect(e,t)};_t.useMemo=function(e,t){return Hi.current.useMemo(e,t)};_t.useReducer=function(e,t,r){return Hi.current.useReducer(e,t,r)};_t.useRef=function(e){return Hi.current.useRef(e)};_t.useState=function(e){return Hi.current.useState(e)};_t.useSyncExternalStore=function(e,t,r){return Hi.current.useSyncExternalStore(e,t,r)};_t.useTransition=function(){return Hi.current.useTransition()};_t.version="18.2.0";WE.exports=_t;var oe=WE.exports;const Kn=uB(oe),MB=hB({__proto__:null,default:Kn},[oe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TB=oe,LB=Symbol.for("react.element"),PB=Symbol.for("react.fragment"),DB=Object.prototype.hasOwnProperty,IB=TB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OB={key:!0,ref:!0,__self:!0,__source:!0};function $E(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)DB.call(t,i)&&!OB.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:LB,type:e,key:s,ref:a,props:n,_owner:IB.current}}lv.Fragment=PB;lv.jsx=$E;lv.jsxs=$E;GE.exports=lv;var M=GE.exports,Y3={},eM={exports:{}},Dn={},tM={exports:{}},rM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,q){var F=R.length;R.push(q);e:for(;0<F;){var z=F-1>>>1,U=R[z];if(0<n(U,q))R[z]=q,R[F]=U,F=z;else break e}}function r(R){return R.length===0?null:R[0]}function i(R){if(R.length===0)return null;var q=R[0],F=R.pop();if(F!==q){R[0]=F;e:for(var z=0,U=R.length,K=U>>>1;z<K;){var j=2*(z+1)-1,Y=R[j],V=j+1,ie=R[V];if(0>n(Y,F))V<U&&0>n(ie,Y)?(R[z]=ie,R[V]=F,z=V):(R[z]=Y,R[j]=F,z=j);else if(V<U&&0>n(ie,F))R[z]=ie,R[V]=F,z=V;else break e}}return q}function n(R,q){var F=R.sortIndex-q.sortIndex;return F!==0?F:R.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(R){for(var q=r(c);q!==null;){if(q.callback===null)i(c);else if(q.startTime<=R)i(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(c)}}function b(R){if(m=!1,x(R),!f)if(r(l)!==null)f=!0,X(w);else{var q=r(c);q!==null&&H(b,q.startTime-R)}}function w(R,q){f=!1,m&&(m=!1,v(S),S=-1),p=!0;var F=d;try{for(x(q),h=r(l);h!==null&&(!(h.expirationTime>q)||R&&!L());){var z=h.callback;if(typeof z=="function"){h.callback=null,d=h.priorityLevel;var U=z(h.expirationTime<=q);q=e.unstable_now(),typeof U=="function"?h.callback=U:h===r(l)&&i(l),x(q)}else i(l);h=r(l)}if(h!==null)var K=!0;else{var j=r(c);j!==null&&H(b,j.startTime-q),K=!1}return K}finally{h=null,d=F,p=!1}}var C=!1,_=null,S=-1,A=5,E=-1;function L(){return!(e.unstable_now()-E<A)}function P(){if(_!==null){var R=e.unstable_now();E=R;var q=!0;try{q=_(!0,R)}finally{q?D():(C=!1,_=null)}}else C=!1}var D;if(typeof y=="function")D=function(){y(P)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,B=I.port2;I.port1.onmessage=P,D=function(){B.postMessage(null)}}else D=function(){g(P,0)};function X(R){_=R,C||(C=!0,D())}function H(R,q){S=g(function(){R(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,X(w))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(R){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var F=d;d=q;try{return R()}finally{d=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,q){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var F=d;d=R;try{return q()}finally{d=F}},e.unstable_scheduleCallback=function(R,q,F){var z=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?z+F:z):F=z,R){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=F+U,R={id:u++,callback:q,priorityLevel:R,startTime:F,expirationTime:U,sortIndex:-1},F>z?(R.sortIndex=F,t(c,R),r(l)===null&&R===r(c)&&(m?(v(S),S=-1):m=!0,H(b,F-z))):(R.sortIndex=U,t(l,R),f||p||(f=!0,X(w))),R},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(R){var q=d;return function(){var F=d;d=q;try{return R.apply(this,arguments)}finally{d=F}}}})(rM);tM.exports=rM;var RB=tM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iM=oe,Mn=RB;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nM=new Set,df={};function Vc(e,t){Ou(e,t),Ou(e+"Capture",t)}function Ou(e,t){for(df[e]=t,e=0;e<t.length;e++)nM.add(t[e])}var ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Q3=Object.prototype.hasOwnProperty,BB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$8={},eb={};function kB(e){return Q3.call(eb,e)?!0:Q3.call($8,e)?!1:BB.test(e)?eb[e]=!0:($8[e]=!0,!1)}function NB(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function zB(e,t,r,i){if(t===null||typeof t>"u"||NB(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gi(e,t,r,i,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var di={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){di[e]=new Gi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];di[t]=new Gi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){di[e]=new Gi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){di[e]=new Gi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){di[e]=new Gi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){di[e]=new Gi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){di[e]=new Gi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){di[e]=new Gi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){di[e]=new Gi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zx=/[\-:]([a-z])/g;function Jx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zx,Jx);di[t]=new Gi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zx,Jx);di[t]=new Gi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zx,Jx);di[t]=new Gi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){di[e]=new Gi(e,1,!1,e.toLowerCase(),null,!1,!1)});di.xlinkHref=new Gi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){di[e]=new Gi(e,1,!1,e.toLowerCase(),null,!0,!0)});function $x(e,t,r,i){var n=di.hasOwnProperty(t)?di[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(zB(t,r,n,i)&&(r=null),i||n===null?kB(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var mo=iM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_1=Symbol.for("react.element"),zh=Symbol.for("react.portal"),Fh=Symbol.for("react.fragment"),e6=Symbol.for("react.strict_mode"),K3=Symbol.for("react.profiler"),sM=Symbol.for("react.provider"),aM=Symbol.for("react.context"),t6=Symbol.for("react.forward_ref"),Z3=Symbol.for("react.suspense"),J3=Symbol.for("react.suspense_list"),r6=Symbol.for("react.memo"),Bo=Symbol.for("react.lazy"),oM=Symbol.for("react.offscreen"),tb=Symbol.iterator;function Ld(e){return e===null||typeof e!="object"?null:(e=tb&&e[tb]||e["@@iterator"],typeof e=="function"?e:null)}var cr=Object.assign,f2;function bp(e){if(f2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);f2=t&&t[1]||""}return`
`+f2+e}var m2=!1;function g2(e,t){if(!e||m2)return"";m2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=i.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{m2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bp(e):""}function FB(e){switch(e.tag){case 5:return bp(e.type);case 16:return bp("Lazy");case 13:return bp("Suspense");case 19:return bp("SuspenseList");case 0:case 2:case 15:return e=g2(e.type,!1),e;case 11:return e=g2(e.type.render,!1),e;case 1:return e=g2(e.type,!0),e;default:return""}}function $3(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fh:return"Fragment";case zh:return"Portal";case K3:return"Profiler";case e6:return"StrictMode";case Z3:return"Suspense";case J3:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aM:return(e.displayName||"Context")+".Consumer";case sM:return(e._context.displayName||"Context")+".Provider";case t6:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case r6:return t=e.displayName||null,t!==null?t:$3(e.type)||"Memo";case Bo:t=e._payload,e=e._init;try{return $3(e(t))}catch{}}return null}function jB(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $3(t);case 8:return t===e6?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lM(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function UB(e){var t=lM(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function A1(e){e._valueTracker||(e._valueTracker=UB(e))}function cM(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=lM(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function O0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function e4(e,t){var r=t.checked;return cr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rb(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=yl(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hM(e,t){t=t.checked,t!=null&&$x(e,"checked",t,!1)}function t4(e,t){hM(e,t);var r=yl(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?r4(e,t.type,r):t.hasOwnProperty("defaultValue")&&r4(e,t.type,yl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ib(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function r4(e,t,r){(t!=="number"||O0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var wp=Array.isArray;function hu(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+yl(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function i4(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return cr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nb(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(wp(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yl(r)}}function uM(e,t){var r=yl(t.value),i=yl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function sb(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function dM(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function n4(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?dM(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var E1,pM=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(E1=E1||document.createElement("div"),E1.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=E1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Rp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VB=["Webkit","ms","Moz","O"];Object.keys(Rp).forEach(function(e){VB.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rp[t]=Rp[e]})});function fM(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Rp.hasOwnProperty(e)&&Rp[e]?(""+t).trim():t+"px"}function mM(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=fM(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var HB=cr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function s4(e,t){if(t){if(HB[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function a4(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o4=null;function i6(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var l4=null,uu=null,du=null;function ab(e){if(e=r1(e)){if(typeof l4!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=pv(t),l4(e.stateNode,e.type,t))}}function gM(e){uu?du?du.push(e):du=[e]:uu=e}function vM(){if(uu){var e=uu,t=du;if(du=uu=null,ab(e),t)for(e=0;e<t.length;e++)ab(t[e])}}function yM(e,t){return e(t)}function xM(){}var v2=!1;function bM(e,t,r){if(v2)return e(t,r);v2=!0;try{return yM(e,t,r)}finally{v2=!1,(uu!==null||du!==null)&&(xM(),vM())}}function ff(e,t){var r=e.stateNode;if(r===null)return null;var i=pv(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var c4=!1;if(ao)try{var Pd={};Object.defineProperty(Pd,"passive",{get:function(){c4=!0}}),window.addEventListener("test",Pd,Pd),window.removeEventListener("test",Pd,Pd)}catch{c4=!1}function GB(e,t,r,i,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Bp=!1,R0=null,B0=!1,h4=null,WB={onError:function(e){Bp=!0,R0=e}};function qB(e,t,r,i,n,s,a,o,l){Bp=!1,R0=null,GB.apply(WB,arguments)}function XB(e,t,r,i,n,s,a,o,l){if(qB.apply(this,arguments),Bp){if(Bp){var c=R0;Bp=!1,R0=null}else throw Error(Ee(198));B0||(B0=!0,h4=c)}}function Hc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function wM(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ob(e){if(Hc(e)!==e)throw Error(Ee(188))}function YB(e){var t=e.alternate;if(!t){if(t=Hc(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return ob(n),e;if(s===i)return ob(n),t;s=s.sibling}throw Error(Ee(188))}if(r.return!==i.return)r=n,i=s;else{for(var a=!1,o=n.child;o;){if(o===r){a=!0,r=n,i=s;break}if(o===i){a=!0,i=n,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,i=n;break}if(o===i){a=!0,i=s,r=n;break}o=o.sibling}if(!a)throw Error(Ee(189))}}if(r.alternate!==i)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function CM(e){return e=YB(e),e!==null?SM(e):null}function SM(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SM(e);if(t!==null)return t;e=e.sibling}return null}var _M=Mn.unstable_scheduleCallback,lb=Mn.unstable_cancelCallback,QB=Mn.unstable_shouldYield,KB=Mn.unstable_requestPaint,Cr=Mn.unstable_now,ZB=Mn.unstable_getCurrentPriorityLevel,n6=Mn.unstable_ImmediatePriority,AM=Mn.unstable_UserBlockingPriority,k0=Mn.unstable_NormalPriority,JB=Mn.unstable_LowPriority,EM=Mn.unstable_IdlePriority,cv=null,la=null;function $B(e){if(la&&typeof la.onCommitFiberRoot=="function")try{la.onCommitFiberRoot(cv,e,void 0,(e.current.flags&128)===128)}catch{}}var Es=Math.clz32?Math.clz32:rk,ek=Math.log,tk=Math.LN2;function rk(e){return e>>>=0,e===0?32:31-(ek(e)/tk|0)|0}var M1=64,T1=4194304;function Cp(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function N0(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~n;o!==0?i=Cp(o):(s&=a,s!==0&&(i=Cp(s)))}else a=r&~n,a!==0?i=Cp(a):s!==0&&(i=Cp(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-Es(t),n=1<<r,i|=e[r],t&=~n;return i}function ik(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nk(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Es(s),o=1<<a,l=n[a];l===-1?(!(o&r)||o&i)&&(n[a]=ik(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function u4(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function MM(){var e=M1;return M1<<=1,!(M1&4194240)&&(M1=64),e}function y2(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function e1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Es(t),e[t]=r}function sk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Es(r),s=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~s}}function s6(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Es(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var Ut=0;function TM(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var LM,a6,PM,DM,IM,d4=!1,L1=[],tl=null,rl=null,il=null,mf=new Map,gf=new Map,Fo=[],ak="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cb(e,t){switch(e){case"focusin":case"focusout":tl=null;break;case"dragenter":case"dragleave":rl=null;break;case"mouseover":case"mouseout":il=null;break;case"pointerover":case"pointerout":mf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gf.delete(t.pointerId)}}function Dd(e,t,r,i,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},t!==null&&(t=r1(t),t!==null&&a6(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function ok(e,t,r,i,n){switch(t){case"focusin":return tl=Dd(tl,e,t,r,i,n),!0;case"dragenter":return rl=Dd(rl,e,t,r,i,n),!0;case"mouseover":return il=Dd(il,e,t,r,i,n),!0;case"pointerover":var s=n.pointerId;return mf.set(s,Dd(mf.get(s)||null,e,t,r,i,n)),!0;case"gotpointercapture":return s=n.pointerId,gf.set(s,Dd(gf.get(s)||null,e,t,r,i,n)),!0}return!1}function OM(e){var t=cc(e.target);if(t!==null){var r=Hc(t);if(r!==null){if(t=r.tag,t===13){if(t=wM(r),t!==null){e.blockedOn=t,IM(e.priority,function(){PM(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function h0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=p4(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);o4=i,r.target.dispatchEvent(i),o4=null}else return t=r1(r),t!==null&&a6(t),e.blockedOn=r,!1;t.shift()}return!0}function hb(e,t,r){h0(e)&&r.delete(t)}function lk(){d4=!1,tl!==null&&h0(tl)&&(tl=null),rl!==null&&h0(rl)&&(rl=null),il!==null&&h0(il)&&(il=null),mf.forEach(hb),gf.forEach(hb)}function Id(e,t){e.blockedOn===t&&(e.blockedOn=null,d4||(d4=!0,Mn.unstable_scheduleCallback(Mn.unstable_NormalPriority,lk)))}function vf(e){function t(n){return Id(n,e)}if(0<L1.length){Id(L1[0],e);for(var r=1;r<L1.length;r++){var i=L1[r];i.blockedOn===e&&(i.blockedOn=null)}}for(tl!==null&&Id(tl,e),rl!==null&&Id(rl,e),il!==null&&Id(il,e),mf.forEach(t),gf.forEach(t),r=0;r<Fo.length;r++)i=Fo[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Fo.length&&(r=Fo[0],r.blockedOn===null);)OM(r),r.blockedOn===null&&Fo.shift()}var pu=mo.ReactCurrentBatchConfig,z0=!0;function ck(e,t,r,i){var n=Ut,s=pu.transition;pu.transition=null;try{Ut=1,o6(e,t,r,i)}finally{Ut=n,pu.transition=s}}function hk(e,t,r,i){var n=Ut,s=pu.transition;pu.transition=null;try{Ut=4,o6(e,t,r,i)}finally{Ut=n,pu.transition=s}}function o6(e,t,r,i){if(z0){var n=p4(e,t,r,i);if(n===null)T2(e,t,i,F0,r),cb(e,i);else if(ok(n,e,t,r,i))i.stopPropagation();else if(cb(e,i),t&4&&-1<ak.indexOf(e)){for(;n!==null;){var s=r1(n);if(s!==null&&LM(s),s=p4(e,t,r,i),s===null&&T2(e,t,i,F0,r),s===n)break;n=s}n!==null&&i.stopPropagation()}else T2(e,t,i,null,r)}}var F0=null;function p4(e,t,r,i){if(F0=null,e=i6(i),e=cc(e),e!==null)if(t=Hc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=wM(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return F0=e,null}function RM(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZB()){case n6:return 1;case AM:return 4;case k0:case JB:return 16;case EM:return 536870912;default:return 16}default:return 16}}var Go=null,l6=null,u0=null;function BM(){if(u0)return u0;var e,t=l6,r=t.length,i,n="value"in Go?Go.value:Go.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var a=r-e;for(i=1;i<=a&&t[r-i]===n[s-i];i++);return u0=n.slice(e,1<i?1-i:void 0)}function d0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function P1(){return!0}function ub(){return!1}function In(e){function t(r,i,n,s,a){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?P1:ub,this.isPropagationStopped=ub,this}return cr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=P1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=P1)},persist:function(){},isPersistent:P1}),t}var ad={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},c6=In(ad),t1=cr({},ad,{view:0,detail:0}),uk=In(t1),x2,b2,Od,hv=cr({},t1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:h6,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Od&&(Od&&e.type==="mousemove"?(x2=e.screenX-Od.screenX,b2=e.screenY-Od.screenY):b2=x2=0,Od=e),x2)},movementY:function(e){return"movementY"in e?e.movementY:b2}}),db=In(hv),dk=cr({},hv,{dataTransfer:0}),pk=In(dk),fk=cr({},t1,{relatedTarget:0}),w2=In(fk),mk=cr({},ad,{animationName:0,elapsedTime:0,pseudoElement:0}),gk=In(mk),vk=cr({},ad,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yk=In(vk),xk=cr({},ad,{data:0}),pb=In(xk),bk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ck={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ck[e])?!!t[e]:!1}function h6(){return Sk}var _k=cr({},t1,{key:function(e){if(e.key){var t=bk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=d0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?wk[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:h6,charCode:function(e){return e.type==="keypress"?d0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?d0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ak=In(_k),Ek=cr({},hv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fb=In(Ek),Mk=cr({},t1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:h6}),Tk=In(Mk),Lk=cr({},ad,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pk=In(Lk),Dk=cr({},hv,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ik=In(Dk),Ok=[9,13,27,32],u6=ao&&"CompositionEvent"in window,kp=null;ao&&"documentMode"in document&&(kp=document.documentMode);var Rk=ao&&"TextEvent"in window&&!kp,kM=ao&&(!u6||kp&&8<kp&&11>=kp),mb=String.fromCharCode(32),gb=!1;function NM(e,t){switch(e){case"keyup":return Ok.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zM(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jh=!1;function Bk(e,t){switch(e){case"compositionend":return zM(t);case"keypress":return t.which!==32?null:(gb=!0,mb);case"textInput":return e=t.data,e===mb&&gb?null:e;default:return null}}function kk(e,t){if(jh)return e==="compositionend"||!u6&&NM(e,t)?(e=BM(),u0=l6=Go=null,jh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kM&&t.locale!=="ko"?null:t.data;default:return null}}var Nk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Nk[e.type]:t==="textarea"}function FM(e,t,r,i){gM(i),t=j0(t,"onChange"),0<t.length&&(r=new c6("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Np=null,yf=null;function zk(e){KM(e,0)}function uv(e){var t=Hh(e);if(cM(t))return e}function Fk(e,t){if(e==="change")return t}var jM=!1;if(ao){var C2;if(ao){var S2="oninput"in document;if(!S2){var yb=document.createElement("div");yb.setAttribute("oninput","return;"),S2=typeof yb.oninput=="function"}C2=S2}else C2=!1;jM=C2&&(!document.documentMode||9<document.documentMode)}function xb(){Np&&(Np.detachEvent("onpropertychange",UM),yf=Np=null)}function UM(e){if(e.propertyName==="value"&&uv(yf)){var t=[];FM(t,yf,e,i6(e)),bM(zk,t)}}function jk(e,t,r){e==="focusin"?(xb(),Np=t,yf=r,Np.attachEvent("onpropertychange",UM)):e==="focusout"&&xb()}function Uk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return uv(yf)}function Vk(e,t){if(e==="click")return uv(t)}function Hk(e,t){if(e==="input"||e==="change")return uv(t)}function Gk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ls=typeof Object.is=="function"?Object.is:Gk;function xf(e,t){if(Ls(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!Q3.call(t,n)||!Ls(e[n],t[n]))return!1}return!0}function bb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wb(e,t){var r=bb(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=bb(r)}}function VM(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?VM(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function HM(){for(var e=window,t=O0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=O0(e.document)}return t}function d6(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Wk(e){var t=HM(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&VM(r.ownerDocument.documentElement,r)){if(i!==null&&d6(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!e.extend&&s>i&&(n=i,i=s,s=n),n=wb(r,s);var a=wb(r,i);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var qk=ao&&"documentMode"in document&&11>=document.documentMode,Uh=null,f4=null,zp=null,m4=!1;function Cb(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;m4||Uh==null||Uh!==O0(i)||(i=Uh,"selectionStart"in i&&d6(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),zp&&xf(zp,i)||(zp=i,i=j0(f4,"onSelect"),0<i.length&&(t=new c6("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Uh)))}function D1(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Vh={animationend:D1("Animation","AnimationEnd"),animationiteration:D1("Animation","AnimationIteration"),animationstart:D1("Animation","AnimationStart"),transitionend:D1("Transition","TransitionEnd")},_2={},GM={};ao&&(GM=document.createElement("div").style,"AnimationEvent"in window||(delete Vh.animationend.animation,delete Vh.animationiteration.animation,delete Vh.animationstart.animation),"TransitionEvent"in window||delete Vh.transitionend.transition);function dv(e){if(_2[e])return _2[e];if(!Vh[e])return e;var t=Vh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in GM)return _2[e]=t[r];return e}var WM=dv("animationend"),qM=dv("animationiteration"),XM=dv("animationstart"),YM=dv("transitionend"),QM=new Map,Sb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function El(e,t){QM.set(e,t),Vc(t,[e])}for(var A2=0;A2<Sb.length;A2++){var E2=Sb[A2],Xk=E2.toLowerCase(),Yk=E2[0].toUpperCase()+E2.slice(1);El(Xk,"on"+Yk)}El(WM,"onAnimationEnd");El(qM,"onAnimationIteration");El(XM,"onAnimationStart");El("dblclick","onDoubleClick");El("focusin","onFocus");El("focusout","onBlur");El(YM,"onTransitionEnd");Ou("onMouseEnter",["mouseout","mouseover"]);Ou("onMouseLeave",["mouseout","mouseover"]);Ou("onPointerEnter",["pointerout","pointerover"]);Ou("onPointerLeave",["pointerout","pointerover"]);Vc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sp));function _b(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,XB(i,t,void 0,e),e.currentTarget=null}function KM(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;_b(n,o,c),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;_b(n,o,c),s=l}}}if(B0)throw e=h4,B0=!1,h4=null,e}function $t(e,t){var r=t[b4];r===void 0&&(r=t[b4]=new Set);var i=e+"__bubble";r.has(i)||(ZM(t,e,2,!1),r.add(i))}function M2(e,t,r){var i=0;t&&(i|=4),ZM(r,e,i,t)}var I1="_reactListening"+Math.random().toString(36).slice(2);function bf(e){if(!e[I1]){e[I1]=!0,nM.forEach(function(r){r!=="selectionchange"&&(Qk.has(r)||M2(r,!1,e),M2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[I1]||(t[I1]=!0,M2("selectionchange",!1,t))}}function ZM(e,t,r,i){switch(RM(t)){case 1:var n=ck;break;case 4:n=hk;break;default:n=o6}r=n.bind(null,t,r,e),n=void 0,!c4||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function T2(e,t,r,i,n){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=cc(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}bM(function(){var c=s,u=i6(r),h=[];e:{var d=QM.get(e);if(d!==void 0){var p=c6,f=e;switch(e){case"keypress":if(d0(r)===0)break e;case"keydown":case"keyup":p=Ak;break;case"focusin":f="focus",p=w2;break;case"focusout":f="blur",p=w2;break;case"beforeblur":case"afterblur":p=w2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=db;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=pk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Tk;break;case WM:case qM:case XM:p=gk;break;case YM:p=Pk;break;case"scroll":p=uk;break;case"wheel":p=Ik;break;case"copy":case"cut":case"paste":p=yk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=fb}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,x;y!==null;){x=y;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,v!==null&&(b=ff(y,v),b!=null&&m.push(wf(y,b,x)))),g)break;y=y.return}0<m.length&&(d=new p(d,f,null,r,u),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==o4&&(f=r.relatedTarget||r.fromElement)&&(cc(f)||f[oo]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=r.relatedTarget||r.toElement,p=c,f=f?cc(f):null,f!==null&&(g=Hc(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=c),p!==f)){if(m=db,b="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=fb,b="onPointerLeave",v="onPointerEnter",y="pointer"),g=p==null?d:Hh(p),x=f==null?d:Hh(f),d=new m(b,y+"leave",p,r,u),d.target=g,d.relatedTarget=x,b=null,cc(u)===c&&(m=new m(v,y+"enter",f,r,u),m.target=x,m.relatedTarget=g,b=m),g=b,p&&f)t:{for(m=p,v=f,y=0,x=m;x;x=eh(x))y++;for(x=0,b=v;b;b=eh(b))x++;for(;0<y-x;)m=eh(m),y--;for(;0<x-y;)v=eh(v),x--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=eh(m),v=eh(v)}m=null}else m=null;p!==null&&Ab(h,d,p,m,!1),f!==null&&g!==null&&Ab(h,g,f,m,!0)}}e:{if(d=c?Hh(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var w=Fk;else if(vb(d))if(jM)w=Hk;else{w=Uk;var C=jk}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=Vk);if(w&&(w=w(e,c))){FM(h,w,r,u);break e}C&&C(e,d,c),e==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&r4(d,"number",d.value)}switch(C=c?Hh(c):window,e){case"focusin":(vb(C)||C.contentEditable==="true")&&(Uh=C,f4=c,zp=null);break;case"focusout":zp=f4=Uh=null;break;case"mousedown":m4=!0;break;case"contextmenu":case"mouseup":case"dragend":m4=!1,Cb(h,r,u);break;case"selectionchange":if(qk)break;case"keydown":case"keyup":Cb(h,r,u)}var _;if(u6)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else jh?NM(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(kM&&r.locale!=="ko"&&(jh||S!=="onCompositionStart"?S==="onCompositionEnd"&&jh&&(_=BM()):(Go=u,l6="value"in Go?Go.value:Go.textContent,jh=!0)),C=j0(c,S),0<C.length&&(S=new pb(S,e,null,r,u),h.push({event:S,listeners:C}),_?S.data=_:(_=zM(r),_!==null&&(S.data=_)))),(_=Rk?Bk(e,r):kk(e,r))&&(c=j0(c,"onBeforeInput"),0<c.length&&(u=new pb("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=_))}KM(h,t)})}function wf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function j0(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=ff(e,r),s!=null&&i.unshift(wf(e,s,n)),s=ff(e,t),s!=null&&i.push(wf(e,s,n))),e=e.return}return i}function eh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ab(e,t,r,i,n){for(var s=t._reactName,a=[];r!==null&&r!==i;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&c!==null&&(o=c,n?(l=ff(r,s),l!=null&&a.unshift(wf(r,l,o))):n||(l=ff(r,s),l!=null&&a.push(wf(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Kk=/\r\n?/g,Zk=/\u0000|\uFFFD/g;function Eb(e){return(typeof e=="string"?e:""+e).replace(Kk,`
`).replace(Zk,"")}function O1(e,t,r){if(t=Eb(t),Eb(e)!==t&&r)throw Error(Ee(425))}function U0(){}var g4=null,v4=null;function y4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var x4=typeof setTimeout=="function"?setTimeout:void 0,Jk=typeof clearTimeout=="function"?clearTimeout:void 0,Mb=typeof Promise=="function"?Promise:void 0,$k=typeof queueMicrotask=="function"?queueMicrotask:typeof Mb<"u"?function(e){return Mb.resolve(null).then(e).catch(eN)}:x4;function eN(e){setTimeout(function(){throw e})}function L2(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),vf(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);vf(t)}function nl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Tb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var od=Math.random().toString(36).slice(2),ta="__reactFiber$"+od,Cf="__reactProps$"+od,oo="__reactContainer$"+od,b4="__reactEvents$"+od,tN="__reactListeners$"+od,rN="__reactHandles$"+od;function cc(e){var t=e[ta];if(t)return t;for(var r=e.parentNode;r;){if(t=r[oo]||r[ta]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Tb(e);e!==null;){if(r=e[ta])return r;e=Tb(e)}return t}e=r,r=e.parentNode}return null}function r1(e){return e=e[ta]||e[oo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Hh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function pv(e){return e[Cf]||null}var w4=[],Gh=-1;function Ml(e){return{current:e}}function tr(e){0>Gh||(e.current=w4[Gh],w4[Gh]=null,Gh--)}function Jt(e,t){Gh++,w4[Gh]=e.current,e.current=t}var xl={},Ai=Ml(xl),rn=Ml(!1),Lc=xl;function Ru(e,t){var r=e.type.contextTypes;if(!r)return xl;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function nn(e){return e=e.childContextTypes,e!=null}function V0(){tr(rn),tr(Ai)}function Lb(e,t,r){if(Ai.current!==xl)throw Error(Ee(168));Jt(Ai,t),Jt(rn,r)}function JM(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(Ee(108,jB(e)||"Unknown",n));return cr({},r,i)}function H0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xl,Lc=Ai.current,Jt(Ai,e),Jt(rn,rn.current),!0}function Pb(e,t,r){var i=e.stateNode;if(!i)throw Error(Ee(169));r?(e=JM(e,t,Lc),i.__reactInternalMemoizedMergedChildContext=e,tr(rn),tr(Ai),Jt(Ai,e)):tr(rn),Jt(rn,r)}var Va=null,fv=!1,P2=!1;function $M(e){Va===null?Va=[e]:Va.push(e)}function iN(e){fv=!0,$M(e)}function Tl(){if(!P2&&Va!==null){P2=!0;var e=0,t=Ut;try{var r=Va;for(Ut=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}Va=null,fv=!1}catch(n){throw Va!==null&&(Va=Va.slice(e+1)),_M(n6,Tl),n}finally{Ut=t,P2=!1}}return null}var Wh=[],qh=0,G0=null,W0=0,Gn=[],Wn=0,Pc=null,Xa=1,Ya="";function Ql(e,t){Wh[qh++]=W0,Wh[qh++]=G0,G0=e,W0=t}function eT(e,t,r){Gn[Wn++]=Xa,Gn[Wn++]=Ya,Gn[Wn++]=Pc,Pc=e;var i=Xa;e=Ya;var n=32-Es(i)-1;i&=~(1<<n),r+=1;var s=32-Es(t)+n;if(30<s){var a=n-n%5;s=(i&(1<<a)-1).toString(32),i>>=a,n-=a,Xa=1<<32-Es(t)+n|r<<n|i,Ya=s+e}else Xa=1<<s|r<<n|i,Ya=e}function p6(e){e.return!==null&&(Ql(e,1),eT(e,1,0))}function f6(e){for(;e===G0;)G0=Wh[--qh],Wh[qh]=null,W0=Wh[--qh],Wh[qh]=null;for(;e===Pc;)Pc=Gn[--Wn],Gn[Wn]=null,Ya=Gn[--Wn],Gn[Wn]=null,Xa=Gn[--Wn],Gn[Wn]=null}var En=null,bn=null,nr=!1,xs=null;function tT(e,t){var r=Qn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Db(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,En=e,bn=nl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,En=e,bn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Pc!==null?{id:Xa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,En=e,bn=null,!0):!1;default:return!1}}function C4(e){return(e.mode&1)!==0&&(e.flags&128)===0}function S4(e){if(nr){var t=bn;if(t){var r=t;if(!Db(e,t)){if(C4(e))throw Error(Ee(418));t=nl(r.nextSibling);var i=En;t&&Db(e,t)?tT(i,r):(e.flags=e.flags&-4097|2,nr=!1,En=e)}}else{if(C4(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,nr=!1,En=e}}}function Ib(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;En=e}function R1(e){if(e!==En)return!1;if(!nr)return Ib(e),nr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!y4(e.type,e.memoizedProps)),t&&(t=bn)){if(C4(e))throw rT(),Error(Ee(418));for(;t;)tT(e,t),t=nl(t.nextSibling)}if(Ib(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){bn=nl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}bn=null}}else bn=En?nl(e.stateNode.nextSibling):null;return!0}function rT(){for(var e=bn;e;)e=nl(e.nextSibling)}function Bu(){bn=En=null,nr=!1}function m6(e){xs===null?xs=[e]:xs.push(e)}var nN=mo.ReactCurrentBatchConfig;function gs(e,t){if(e&&e.defaultProps){t=cr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var q0=Ml(null),X0=null,Xh=null,g6=null;function v6(){g6=Xh=X0=null}function y6(e){var t=q0.current;tr(q0),e._currentValue=t}function _4(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function fu(e,t){X0=e,g6=Xh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ji=!0),e.firstContext=null)}function ts(e){var t=e._currentValue;if(g6!==e)if(e={context:e,memoizedValue:t,next:null},Xh===null){if(X0===null)throw Error(Ee(308));Xh=e,X0.dependencies={lanes:0,firstContext:e}}else Xh=Xh.next=e;return t}var hc=null;function x6(e){hc===null?hc=[e]:hc.push(e)}function iT(e,t,r,i){var n=t.interleaved;return n===null?(r.next=r,x6(t)):(r.next=n.next,n.next=r),t.interleaved=r,lo(e,i)}function lo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ko=!1;function b6(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nT(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ja(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sl(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Dt&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,lo(e,r)}return n=i.interleaved,n===null?(t.next=t,x6(i)):(t.next=n.next,n.next=t),i.interleaved=t,lo(e,r)}function p0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,s6(e,r)}}function Ob(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Y0(e,t,r,i){var n=e.updateQueue;ko=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=r,m.tag){case 1:if(f=m.payload,typeof f=="function"){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,d=typeof f=="function"?f.call(p,h,d):f,d==null)break e;h=cr({},h,d);break e;case 2:ko=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(1);if(u===null&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);Ic|=a,e.lanes=a,e.memoizedState=h}}function Rb(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(Ee(191,n));n.call(i)}}}var sT=new iM.Component().refs;function A4(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:cr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var mv={isMounted:function(e){return(e=e._reactInternals)?Hc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=ji(),n=ol(e),s=Ja(i,n);s.payload=t,r!=null&&(s.callback=r),t=sl(e,s,n),t!==null&&(Ms(t,e,n,i),p0(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=ji(),n=ol(e),s=Ja(i,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=sl(e,s,n),t!==null&&(Ms(t,e,n,i),p0(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ji(),i=ol(e),n=Ja(r,i);n.tag=2,t!=null&&(n.callback=t),t=sl(e,n,i),t!==null&&(Ms(t,e,i,r),p0(t,e,i))}};function Bb(e,t,r,i,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!xf(r,i)||!xf(n,s):!0}function aT(e,t,r){var i=!1,n=xl,s=t.contextType;return typeof s=="object"&&s!==null?s=ts(s):(n=nn(t)?Lc:Ai.current,i=t.contextTypes,s=(i=i!=null)?Ru(e,n):xl),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=mv,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function kb(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&mv.enqueueReplaceState(t,t.state,null)}function E4(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs=sT,b6(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=ts(s):(s=nn(t)?Lc:Ai.current,n.context=Ru(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(A4(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&mv.enqueueReplaceState(n,n.state,null),Y0(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Rd(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var i=r.stateNode}if(!i)throw Error(Ee(147,e));var n=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;o===sT&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function B1(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Nb(e){var t=e._init;return t(e._payload)}function oT(e){function t(v,y){if(e){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function n(v,y){return v=ll(v,y),v.index=0,v.sibling=null,v}function s(v,y,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,x,b){return y===null||y.tag!==6?(y=N2(x,v.mode,b),y.return=v,y):(y=n(y,x),y.return=v,y)}function l(v,y,x,b){var w=x.type;return w===Fh?u(v,y,x.props.children,b,x.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Bo&&Nb(w)===y.type)?(b=n(y,x.props),b.ref=Rd(v,y,x),b.return=v,b):(b=x0(x.type,x.key,x.props,null,v.mode,b),b.ref=Rd(v,y,x),b.return=v,b)}function c(v,y,x,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=z2(x,v.mode,b),y.return=v,y):(y=n(y,x.children||[]),y.return=v,y)}function u(v,y,x,b,w){return y===null||y.tag!==7?(y=bc(x,v.mode,b,w),y.return=v,y):(y=n(y,x),y.return=v,y)}function h(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=N2(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case _1:return x=x0(y.type,y.key,y.props,null,v.mode,x),x.ref=Rd(v,null,y),x.return=v,x;case zh:return y=z2(y,v.mode,x),y.return=v,y;case Bo:var b=y._init;return h(v,b(y._payload),x)}if(wp(y)||Ld(y))return y=bc(y,v.mode,x,null),y.return=v,y;B1(v,y)}return null}function d(v,y,x,b){var w=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:o(v,y,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case _1:return x.key===w?l(v,y,x,b):null;case zh:return x.key===w?c(v,y,x,b):null;case Bo:return w=x._init,d(v,y,w(x._payload),b)}if(wp(x)||Ld(x))return w!==null?null:u(v,y,x,b,null);B1(v,x)}return null}function p(v,y,x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(x)||null,o(y,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _1:return v=v.get(b.key===null?x:b.key)||null,l(y,v,b,w);case zh:return v=v.get(b.key===null?x:b.key)||null,c(y,v,b,w);case Bo:var C=b._init;return p(v,y,x,C(b._payload),w)}if(wp(b)||Ld(b))return v=v.get(x)||null,u(y,v,b,w,null);B1(y,b)}return null}function f(v,y,x,b){for(var w=null,C=null,_=y,S=y=0,A=null;_!==null&&S<x.length;S++){_.index>S?(A=_,_=null):A=_.sibling;var E=d(v,_,x[S],b);if(E===null){_===null&&(_=A);break}e&&_&&E.alternate===null&&t(v,_),y=s(E,y,S),C===null?w=E:C.sibling=E,C=E,_=A}if(S===x.length)return r(v,_),nr&&Ql(v,S),w;if(_===null){for(;S<x.length;S++)_=h(v,x[S],b),_!==null&&(y=s(_,y,S),C===null?w=_:C.sibling=_,C=_);return nr&&Ql(v,S),w}for(_=i(v,_);S<x.length;S++)A=p(_,v,S,x[S],b),A!==null&&(e&&A.alternate!==null&&_.delete(A.key===null?S:A.key),y=s(A,y,S),C===null?w=A:C.sibling=A,C=A);return e&&_.forEach(function(L){return t(v,L)}),nr&&Ql(v,S),w}function m(v,y,x,b){var w=Ld(x);if(typeof w!="function")throw Error(Ee(150));if(x=w.call(x),x==null)throw Error(Ee(151));for(var C=w=null,_=y,S=y=0,A=null,E=x.next();_!==null&&!E.done;S++,E=x.next()){_.index>S?(A=_,_=null):A=_.sibling;var L=d(v,_,E.value,b);if(L===null){_===null&&(_=A);break}e&&_&&L.alternate===null&&t(v,_),y=s(L,y,S),C===null?w=L:C.sibling=L,C=L,_=A}if(E.done)return r(v,_),nr&&Ql(v,S),w;if(_===null){for(;!E.done;S++,E=x.next())E=h(v,E.value,b),E!==null&&(y=s(E,y,S),C===null?w=E:C.sibling=E,C=E);return nr&&Ql(v,S),w}for(_=i(v,_);!E.done;S++,E=x.next())E=p(_,v,S,E.value,b),E!==null&&(e&&E.alternate!==null&&_.delete(E.key===null?S:E.key),y=s(E,y,S),C===null?w=E:C.sibling=E,C=E);return e&&_.forEach(function(P){return t(v,P)}),nr&&Ql(v,S),w}function g(v,y,x,b){if(typeof x=="object"&&x!==null&&x.type===Fh&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case _1:e:{for(var w=x.key,C=y;C!==null;){if(C.key===w){if(w=x.type,w===Fh){if(C.tag===7){r(v,C.sibling),y=n(C,x.props.children),y.return=v,v=y;break e}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Bo&&Nb(w)===C.type){r(v,C.sibling),y=n(C,x.props),y.ref=Rd(v,C,x),y.return=v,v=y;break e}r(v,C);break}else t(v,C);C=C.sibling}x.type===Fh?(y=bc(x.props.children,v.mode,b,x.key),y.return=v,v=y):(b=x0(x.type,x.key,x.props,null,v.mode,b),b.ref=Rd(v,y,x),b.return=v,v=b)}return a(v);case zh:e:{for(C=x.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(v,y.sibling),y=n(y,x.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=z2(x,v.mode,b),y.return=v,v=y}return a(v);case Bo:return C=x._init,g(v,y,C(x._payload),b)}if(wp(x))return f(v,y,x,b);if(Ld(x))return m(v,y,x,b);B1(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(v,y.sibling),y=n(y,x),y.return=v,v=y):(r(v,y),y=N2(x,v.mode,b),y.return=v,v=y),a(v)):r(v,y)}return g}var ku=oT(!0),lT=oT(!1),i1={},ca=Ml(i1),Sf=Ml(i1),_f=Ml(i1);function uc(e){if(e===i1)throw Error(Ee(174));return e}function w6(e,t){switch(Jt(_f,t),Jt(Sf,e),Jt(ca,i1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:n4(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=n4(t,e)}tr(ca),Jt(ca,t)}function Nu(){tr(ca),tr(Sf),tr(_f)}function cT(e){uc(_f.current);var t=uc(ca.current),r=n4(t,e.type);t!==r&&(Jt(Sf,e),Jt(ca,r))}function C6(e){Sf.current===e&&(tr(ca),tr(Sf))}var sr=Ml(0);function Q0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var D2=[];function S6(){for(var e=0;e<D2.length;e++)D2[e]._workInProgressVersionPrimary=null;D2.length=0}var f0=mo.ReactCurrentDispatcher,I2=mo.ReactCurrentBatchConfig,Dc=0,lr=null,Fr=null,Jr=null,K0=!1,Fp=!1,Af=0,sN=0;function mi(){throw Error(Ee(321))}function _6(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ls(e[r],t[r]))return!1;return!0}function A6(e,t,r,i,n,s){if(Dc=s,lr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,f0.current=e===null||e.memoizedState===null?cN:hN,e=r(i,n),Fp){s=0;do{if(Fp=!1,Af=0,25<=s)throw Error(Ee(301));s+=1,Jr=Fr=null,t.updateQueue=null,f0.current=uN,e=r(i,n)}while(Fp)}if(f0.current=Z0,t=Fr!==null&&Fr.next!==null,Dc=0,Jr=Fr=lr=null,K0=!1,t)throw Error(Ee(300));return e}function E6(){var e=Af!==0;return Af=0,e}function Qs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jr===null?lr.memoizedState=Jr=e:Jr=Jr.next=e,Jr}function rs(){if(Fr===null){var e=lr.alternate;e=e!==null?e.memoizedState:null}else e=Fr.next;var t=Jr===null?lr.memoizedState:Jr.next;if(t!==null)Jr=t,Fr=e;else{if(e===null)throw Error(Ee(310));Fr=e,e={memoizedState:Fr.memoizedState,baseState:Fr.baseState,baseQueue:Fr.baseQueue,queue:Fr.queue,next:null},Jr===null?lr.memoizedState=Jr=e:Jr=Jr.next=e}return Jr}function Ef(e,t){return typeof t=="function"?t(e):t}function O2(e){var t=rs(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var i=Fr,n=i.baseQueue,s=r.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}i.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,i=i.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Dc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=i):l=l.next=h,lr.lanes|=u,Ic|=u}c=c.next}while(c!==null&&c!==s);l===null?a=i:l.next=o,Ls(i,t.memoizedState)||(Ji=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do s=n.lane,lr.lanes|=s,Ic|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function R2(e){var t=rs(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);Ls(s,t.memoizedState)||(Ji=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function hT(){}function uT(e,t){var r=lr,i=rs(),n=t(),s=!Ls(i.memoizedState,n);if(s&&(i.memoizedState=n,Ji=!0),i=i.queue,M6(fT.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||Jr!==null&&Jr.memoizedState.tag&1){if(r.flags|=2048,Mf(9,pT.bind(null,r,i,n,t),void 0,null),ri===null)throw Error(Ee(349));Dc&30||dT(r,t,n)}return n}function dT(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=lr.updateQueue,t===null?(t={lastEffect:null,stores:null},lr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function pT(e,t,r,i){t.value=r,t.getSnapshot=i,mT(t)&&gT(e)}function fT(e,t,r){return r(function(){mT(t)&&gT(e)})}function mT(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ls(e,r)}catch{return!0}}function gT(e){var t=lo(e,1);t!==null&&Ms(t,e,1,-1)}function zb(e){var t=Qs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ef,lastRenderedState:e},t.queue=e,e=e.dispatch=lN.bind(null,lr,e),[t.memoizedState,e]}function Mf(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=lr.updateQueue,t===null?(t={lastEffect:null,stores:null},lr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function vT(){return rs().memoizedState}function m0(e,t,r,i){var n=Qs();lr.flags|=e,n.memoizedState=Mf(1|t,r,void 0,i===void 0?null:i)}function gv(e,t,r,i){var n=rs();i=i===void 0?null:i;var s=void 0;if(Fr!==null){var a=Fr.memoizedState;if(s=a.destroy,i!==null&&_6(i,a.deps)){n.memoizedState=Mf(t,r,s,i);return}}lr.flags|=e,n.memoizedState=Mf(1|t,r,s,i)}function Fb(e,t){return m0(8390656,8,e,t)}function M6(e,t){return gv(2048,8,e,t)}function yT(e,t){return gv(4,2,e,t)}function xT(e,t){return gv(4,4,e,t)}function bT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wT(e,t,r){return r=r!=null?r.concat([e]):null,gv(4,4,bT.bind(null,t,e),r)}function T6(){}function CT(e,t){var r=rs();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&_6(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function ST(e,t){var r=rs();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&_6(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function _T(e,t,r){return Dc&21?(Ls(r,t)||(r=MM(),lr.lanes|=r,Ic|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ji=!0),e.memoizedState=r)}function aN(e,t){var r=Ut;Ut=r!==0&&4>r?r:4,e(!0);var i=I2.transition;I2.transition={};try{e(!1),t()}finally{Ut=r,I2.transition=i}}function AT(){return rs().memoizedState}function oN(e,t,r){var i=ol(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},ET(e))MT(t,r);else if(r=iT(e,t,r,i),r!==null){var n=ji();Ms(r,e,i,n),TT(r,t,i)}}function lN(e,t,r){var i=ol(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(ET(e))MT(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(n.hasEagerState=!0,n.eagerState=o,Ls(o,a)){var l=t.interleaved;l===null?(n.next=n,x6(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}r=iT(e,t,n,i),r!==null&&(n=ji(),Ms(r,e,i,n),TT(r,t,i))}}function ET(e){var t=e.alternate;return e===lr||t!==null&&t===lr}function MT(e,t){Fp=K0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function TT(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,s6(e,r)}}var Z0={readContext:ts,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},cN={readContext:ts,useCallback:function(e,t){return Qs().memoizedState=[e,t===void 0?null:t],e},useContext:ts,useEffect:Fb,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,m0(4194308,4,bT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return m0(4194308,4,e,t)},useInsertionEffect:function(e,t){return m0(4,2,e,t)},useMemo:function(e,t){var r=Qs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=Qs();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=oN.bind(null,lr,e),[i.memoizedState,e]},useRef:function(e){var t=Qs();return e={current:e},t.memoizedState=e},useState:zb,useDebugValue:T6,useDeferredValue:function(e){return Qs().memoizedState=e},useTransition:function(){var e=zb(!1),t=e[0];return e=aN.bind(null,e[1]),Qs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=lr,n=Qs();if(nr){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),ri===null)throw Error(Ee(349));Dc&30||dT(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Fb(fT.bind(null,i,s,e),[e]),i.flags|=2048,Mf(9,pT.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=Qs(),t=ri.identifierPrefix;if(nr){var r=Ya,i=Xa;r=(i&~(1<<32-Es(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=Af++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=sN++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hN={readContext:ts,useCallback:CT,useContext:ts,useEffect:M6,useImperativeHandle:wT,useInsertionEffect:yT,useLayoutEffect:xT,useMemo:ST,useReducer:O2,useRef:vT,useState:function(){return O2(Ef)},useDebugValue:T6,useDeferredValue:function(e){var t=rs();return _T(t,Fr.memoizedState,e)},useTransition:function(){var e=O2(Ef)[0],t=rs().memoizedState;return[e,t]},useMutableSource:hT,useSyncExternalStore:uT,useId:AT,unstable_isNewReconciler:!1},uN={readContext:ts,useCallback:CT,useContext:ts,useEffect:M6,useImperativeHandle:wT,useInsertionEffect:yT,useLayoutEffect:xT,useMemo:ST,useReducer:R2,useRef:vT,useState:function(){return R2(Ef)},useDebugValue:T6,useDeferredValue:function(e){var t=rs();return Fr===null?t.memoizedState=e:_T(t,Fr.memoizedState,e)},useTransition:function(){var e=R2(Ef)[0],t=rs().memoizedState;return[e,t]},useMutableSource:hT,useSyncExternalStore:uT,useId:AT,unstable_isNewReconciler:!1};function zu(e,t){try{var r="",i=t;do r+=FB(i),i=i.return;while(i);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function B2(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function M4(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var dN=typeof WeakMap=="function"?WeakMap:Map;function LT(e,t,r){r=Ja(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){$0||($0=!0,N4=i),M4(e,t)},r}function PT(e,t,r){r=Ja(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){M4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){M4(e,t),typeof i!="function"&&(al===null?al=new Set([this]):al.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function jb(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new dN;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=EN.bind(null,e,t,r),t.then(e,e))}function Ub(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vb(e,t,r,i,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ja(-1,1),t.tag=2,sl(r,t,1))),r.lanes|=1),e)}var pN=mo.ReactCurrentOwner,Ji=!1;function Oi(e,t,r,i){t.child=e===null?lT(t,null,r,i):ku(t,e.child,r,i)}function Hb(e,t,r,i,n){r=r.render;var s=t.ref;return fu(t,n),i=A6(e,t,r,i,s,n),r=E6(),e!==null&&!Ji?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,co(e,t,n)):(nr&&r&&p6(t),t.flags|=1,Oi(e,t,i,n),t.child)}function Gb(e,t,r,i,n){if(e===null){var s=r.type;return typeof s=="function"&&!k6(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,DT(e,t,s,i,n)):(e=x0(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:xf,r(a,i)&&e.ref===t.ref)return co(e,t,n)}return t.flags|=1,e=ll(s,i),e.ref=t.ref,e.return=t,t.child=e}function DT(e,t,r,i,n){if(e!==null){var s=e.memoizedProps;if(xf(s,i)&&e.ref===t.ref)if(Ji=!1,t.pendingProps=i=s,(e.lanes&n)!==0)e.flags&131072&&(Ji=!0);else return t.lanes=e.lanes,co(e,t,n)}return T4(e,t,r,i,n)}function IT(e,t,r){var i=t.pendingProps,n=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Qh,vn),vn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Jt(Qh,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:r,Jt(Qh,vn),vn|=i}else s!==null?(i=s.baseLanes|r,t.memoizedState=null):i=r,Jt(Qh,vn),vn|=i;return Oi(e,t,n,r),t.child}function OT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function T4(e,t,r,i,n){var s=nn(r)?Lc:Ai.current;return s=Ru(t,s),fu(t,n),r=A6(e,t,r,i,s,n),i=E6(),e!==null&&!Ji?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,co(e,t,n)):(nr&&i&&p6(t),t.flags|=1,Oi(e,t,r,n),t.child)}function Wb(e,t,r,i,n){if(nn(r)){var s=!0;H0(t)}else s=!1;if(fu(t,n),t.stateNode===null)g0(e,t),aT(t,r,i),E4(t,r,i,n),i=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=ts(c):(c=nn(r)?Lc:Ai.current,c=Ru(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==c)&&kb(t,a,i,c),ko=!1;var d=t.memoizedState;a.state=d,Y0(t,i,a,n),l=t.memoizedState,o!==i||d!==l||rn.current||ko?(typeof u=="function"&&(A4(t,r,u,i),l=t.memoizedState),(o=ko||Bb(t,r,o,i,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,nT(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:gs(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=ts(l):(l=nn(r)?Lc:Ai.current,l=Ru(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&kb(t,a,i,l),ko=!1,d=t.memoizedState,a.state=d,Y0(t,i,a,n);var f=t.memoizedState;o!==h||d!==f||rn.current||ko?(typeof p=="function"&&(A4(t,r,p,i),f=t.memoizedState),(c=ko||Bb(t,r,c,i,d,f,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,f,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return L4(e,t,r,i,s,n)}function L4(e,t,r,i,n,s){OT(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return n&&Pb(t,r,!1),co(e,t,s);i=t.stateNode,pN.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=ku(t,e.child,null,s),t.child=ku(t,null,o,s)):Oi(e,t,o,s),t.memoizedState=i.state,n&&Pb(t,r,!0),t.child}function RT(e){var t=e.stateNode;t.pendingContext?Lb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lb(e,t.context,!1),w6(e,t.containerInfo)}function qb(e,t,r,i,n){return Bu(),m6(n),t.flags|=256,Oi(e,t,r,i),t.child}var P4={dehydrated:null,treeContext:null,retryLane:0};function D4(e){return{baseLanes:e,cachePool:null,transitions:null}}function BT(e,t,r){var i=t.pendingProps,n=sr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),Jt(sr,n&1),e===null)return S4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=xv(a,i,0,null),e=bc(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=D4(r),t.memoizedState=P4,e):L6(t,a));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return fN(e,t,a,i,o,n,r);if(s){s=i.fallback,a=t.mode,n=e.child,o=n.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=ll(n,l),i.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=ll(o,s):(s=bc(s,a,r,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a=a===null?D4(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=P4,i}return s=e.child,e=s.sibling,i=ll(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function L6(e,t){return t=xv({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function k1(e,t,r,i){return i!==null&&m6(i),ku(t,e.child,null,r),e=L6(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function fN(e,t,r,i,n,s,a){if(r)return t.flags&256?(t.flags&=-257,i=B2(Error(Ee(422))),k1(e,t,a,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=xv({mode:"visible",children:i.children},n,0,null),s=bc(s,n,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&ku(t,e.child,null,a),t.child.memoizedState=D4(a),t.memoizedState=P4,s);if(!(t.mode&1))return k1(e,t,a,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(Ee(419)),i=B2(s,i,void 0),k1(e,t,a,i)}if(o=(a&e.childLanes)!==0,Ji||o){if(i=ri,i!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,lo(e,n),Ms(i,e,n,-1))}return B6(),i=B2(Error(Ee(421))),k1(e,t,a,i)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=MN.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,bn=nl(n.nextSibling),En=t,nr=!0,xs=null,e!==null&&(Gn[Wn++]=Xa,Gn[Wn++]=Ya,Gn[Wn++]=Pc,Xa=e.id,Ya=e.overflow,Pc=t),t=L6(t,i.children),t.flags|=4096,t)}function Xb(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),_4(e.return,t,r)}function k2(e,t,r,i,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n)}function kT(e,t,r){var i=t.pendingProps,n=i.revealOrder,s=i.tail;if(Oi(e,t,i.children,r),i=sr.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xb(e,r,t);else if(e.tag===19)Xb(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Jt(sr,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&Q0(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),k2(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Q0(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}k2(t,!0,r,null,s);break;case"together":k2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function g0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function co(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ic|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=ll(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ll(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function mN(e,t,r){switch(t.tag){case 3:RT(t),Bu();break;case 5:cT(t);break;case 1:nn(t.type)&&H0(t);break;case 4:w6(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;Jt(q0,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Jt(sr,sr.current&1),t.flags|=128,null):r&t.child.childLanes?BT(e,t,r):(Jt(sr,sr.current&1),e=co(e,t,r),e!==null?e.sibling:null);Jt(sr,sr.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return kT(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Jt(sr,sr.current),i)break;return null;case 22:case 23:return t.lanes=0,IT(e,t,r)}return co(e,t,r)}var NT,I4,zT,FT;NT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};I4=function(){};zT=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,uc(ca.current);var s=null;switch(r){case"input":n=e4(e,n),i=e4(e,i),s=[];break;case"select":n=cr({},n,{value:void 0}),i=cr({},i,{value:void 0}),s=[];break;case"textarea":n=i4(e,n),i=i4(e,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=U0)}s4(r,i);var a;r=null;for(c in n)if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(df.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(o=n!=null?n[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(df.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&$t("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};FT=function(e,t,r,i){r!==i&&(t.flags|=4)};function Bd(e,t){if(!nr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function gi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function gN(e,t,r){var i=t.pendingProps;switch(f6(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gi(t),null;case 1:return nn(t.type)&&V0(),gi(t),null;case 3:return i=t.stateNode,Nu(),tr(rn),tr(Ai),S6(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(R1(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xs!==null&&(j4(xs),xs=null))),I4(e,t),gi(t),null;case 5:C6(t);var n=uc(_f.current);if(r=t.type,e!==null&&t.stateNode!=null)zT(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Ee(166));return gi(t),null}if(e=uc(ca.current),R1(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[ta]=t,i[Cf]=s,e=(t.mode&1)!==0,r){case"dialog":$t("cancel",i),$t("close",i);break;case"iframe":case"object":case"embed":$t("load",i);break;case"video":case"audio":for(n=0;n<Sp.length;n++)$t(Sp[n],i);break;case"source":$t("error",i);break;case"img":case"image":case"link":$t("error",i),$t("load",i);break;case"details":$t("toggle",i);break;case"input":rb(i,s),$t("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},$t("invalid",i);break;case"textarea":nb(i,s),$t("invalid",i)}s4(r,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&O1(i.textContent,o,e),n=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&O1(i.textContent,o,e),n=["children",""+o]):df.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&$t("scroll",i)}switch(r){case"input":A1(i),ib(i,s,!0);break;case"textarea":A1(i),sb(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=U0)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=dM(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(r,{is:i.is}):(e=a.createElement(r),r==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,r),e[ta]=t,e[Cf]=i,NT(e,t,!1,!1),t.stateNode=e;e:{switch(a=a4(r,i),r){case"dialog":$t("cancel",e),$t("close",e),n=i;break;case"iframe":case"object":case"embed":$t("load",e),n=i;break;case"video":case"audio":for(n=0;n<Sp.length;n++)$t(Sp[n],e);n=i;break;case"source":$t("error",e),n=i;break;case"img":case"image":case"link":$t("error",e),$t("load",e),n=i;break;case"details":$t("toggle",e),n=i;break;case"input":rb(e,i),n=e4(e,i),$t("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=cr({},i,{value:void 0}),$t("invalid",e);break;case"textarea":nb(e,i),n=i4(e,i),$t("invalid",e);break;default:n=i}s4(r,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?mM(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pM(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&pf(e,l):typeof l=="number"&&pf(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(df.hasOwnProperty(s)?l!=null&&s==="onScroll"&&$t("scroll",e):l!=null&&$x(e,s,l,a))}switch(r){case"input":A1(e),ib(e,i,!1);break;case"textarea":A1(e),sb(e);break;case"option":i.value!=null&&e.setAttribute("value",""+yl(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?hu(e,!!i.multiple,s,!1):i.defaultValue!=null&&hu(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=U0)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return gi(t),null;case 6:if(e&&t.stateNode!=null)FT(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=uc(_f.current),uc(ca.current),R1(t)){if(i=t.stateNode,r=t.memoizedProps,i[ta]=t,(s=i.nodeValue!==r)&&(e=En,e!==null))switch(e.tag){case 3:O1(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&O1(i.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[ta]=t,t.stateNode=i}return gi(t),null;case 13:if(tr(sr),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nr&&bn!==null&&t.mode&1&&!(t.flags&128))rT(),Bu(),t.flags|=98560,s=!1;else if(s=R1(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(Ee(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ee(317));s[ta]=t}else Bu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;gi(t),s=!1}else xs!==null&&(j4(xs),xs=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||sr.current&1?Ur===0&&(Ur=3):B6())),t.updateQueue!==null&&(t.flags|=4),gi(t),null);case 4:return Nu(),I4(e,t),e===null&&bf(t.stateNode.containerInfo),gi(t),null;case 10:return y6(t.type._context),gi(t),null;case 17:return nn(t.type)&&V0(),gi(t),null;case 19:if(tr(sr),s=t.memoizedState,s===null)return gi(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)Bd(s,!1);else{if(Ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Q0(e),a!==null){for(t.flags|=128,Bd(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)s=r,e=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Jt(sr,sr.current&1|2),t.child}e=e.sibling}s.tail!==null&&Cr()>Fu&&(t.flags|=128,i=!0,Bd(s,!1),t.lanes=4194304)}else{if(!i)if(e=Q0(a),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Bd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!nr)return gi(t),null}else 2*Cr()-s.renderingStartTime>Fu&&r!==1073741824&&(t.flags|=128,i=!0,Bd(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Cr(),t.sibling=null,r=sr.current,Jt(sr,i?r&1|2:r&1),t):(gi(t),null);case 22:case 23:return R6(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?vn&1073741824&&(gi(t),t.subtreeFlags&6&&(t.flags|=8192)):gi(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function vN(e,t){switch(f6(t),t.tag){case 1:return nn(t.type)&&V0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Nu(),tr(rn),tr(Ai),S6(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return C6(t),null;case 13:if(tr(sr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));Bu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tr(sr),null;case 4:return Nu(),null;case 10:return y6(t.type._context),null;case 22:case 23:return R6(),null;case 24:return null;default:return null}}var N1=!1,yi=!1,yN=typeof WeakSet=="function"?WeakSet:Set,je=null;function Yh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){dr(e,t,i)}else r.current=null}function O4(e,t,r){try{r()}catch(i){dr(e,t,i)}}var Yb=!1;function xN(e,t){if(g4=z0,e=HM(),d6(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var p;h!==r||n!==0&&h.nodeType!==3||(o=a+n),h!==s||i!==0&&h.nodeType!==3||(l=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===r&&++c===n&&(o=a),d===s&&++u===i&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(v4={focusedElem:e,selectionRange:r},z0=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:gs(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(b){dr(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return f=Yb,Yb=!1,f}function jp(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&O4(t,r,s)}n=n.next}while(n!==i)}}function vv(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function R4(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function jT(e){var t=e.alternate;t!==null&&(e.alternate=null,jT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ta],delete t[Cf],delete t[b4],delete t[tN],delete t[rN])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function UT(e){return e.tag===5||e.tag===3||e.tag===4}function Qb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||UT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function B4(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=U0));else if(i!==4&&(e=e.child,e!==null))for(B4(e,t,r),e=e.sibling;e!==null;)B4(e,t,r),e=e.sibling}function k4(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(k4(e,t,r),e=e.sibling;e!==null;)k4(e,t,r),e=e.sibling}var ci=null,vs=!1;function xo(e,t,r){for(r=r.child;r!==null;)VT(e,t,r),r=r.sibling}function VT(e,t,r){if(la&&typeof la.onCommitFiberUnmount=="function")try{la.onCommitFiberUnmount(cv,r)}catch{}switch(r.tag){case 5:yi||Yh(r,t);case 6:var i=ci,n=vs;ci=null,xo(e,t,r),ci=i,vs=n,ci!==null&&(vs?(e=ci,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ci.removeChild(r.stateNode));break;case 18:ci!==null&&(vs?(e=ci,r=r.stateNode,e.nodeType===8?L2(e.parentNode,r):e.nodeType===1&&L2(e,r),vf(e)):L2(ci,r.stateNode));break;case 4:i=ci,n=vs,ci=r.stateNode.containerInfo,vs=!0,xo(e,t,r),ci=i,vs=n;break;case 0:case 11:case 14:case 15:if(!yi&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&O4(r,t,a),n=n.next}while(n!==i)}xo(e,t,r);break;case 1:if(!yi&&(Yh(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(o){dr(r,t,o)}xo(e,t,r);break;case 21:xo(e,t,r);break;case 22:r.mode&1?(yi=(i=yi)||r.memoizedState!==null,xo(e,t,r),yi=i):xo(e,t,r);break;default:xo(e,t,r)}}function Kb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new yN),t.forEach(function(i){var n=TN.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function os(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:ci=o.stateNode,vs=!1;break e;case 3:ci=o.stateNode.containerInfo,vs=!0;break e;case 4:ci=o.stateNode.containerInfo,vs=!0;break e}o=o.return}if(ci===null)throw Error(Ee(160));VT(s,a,n),ci=null,vs=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){dr(n,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)HT(t,e),t=t.sibling}function HT(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(os(t,e),Rs(e),i&4){try{jp(3,e,e.return),vv(3,e)}catch(m){dr(e,e.return,m)}try{jp(5,e,e.return)}catch(m){dr(e,e.return,m)}}break;case 1:os(t,e),Rs(e),i&512&&r!==null&&Yh(r,r.return);break;case 5:if(os(t,e),Rs(e),i&512&&r!==null&&Yh(r,r.return),e.flags&32){var n=e.stateNode;try{pf(n,"")}catch(m){dr(e,e.return,m)}}if(i&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&hM(n,s),a4(o,a);var c=a4(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?mM(n,h):u==="dangerouslySetInnerHTML"?pM(n,h):u==="children"?pf(n,h):$x(n,u,h,c)}switch(o){case"input":t4(n,s);break;case"textarea":uM(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?hu(n,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?hu(n,!!s.multiple,s.defaultValue,!0):hu(n,!!s.multiple,s.multiple?[]:"",!1))}n[Cf]=s}catch(m){dr(e,e.return,m)}}break;case 6:if(os(t,e),Rs(e),i&4){if(e.stateNode===null)throw Error(Ee(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(m){dr(e,e.return,m)}}break;case 3:if(os(t,e),Rs(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{vf(t.containerInfo)}catch(m){dr(e,e.return,m)}break;case 4:os(t,e),Rs(e);break;case 13:os(t,e),Rs(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(I6=Cr())),i&4&&Kb(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(yi=(c=yi)||u,os(t,e),yi=c):os(t,e),Rs(e),i&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(je=e,u=e.child;u!==null;){for(h=je=u;je!==null;){switch(d=je,p=d.child,d.tag){case 0:case 11:case 14:case 15:jp(4,d,d.return);break;case 1:Yh(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,r=d.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){dr(i,r,m)}}break;case 5:Yh(d,d.return);break;case 22:if(d.memoizedState!==null){Jb(h);continue}}p!==null?(p.return=d,je=p):Jb(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=fM("display",a))}catch(m){dr(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){dr(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:os(t,e),Rs(e),i&4&&Kb(e);break;case 21:break;default:os(t,e),Rs(e)}}function Rs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(UT(r)){var i=r;break e}r=r.return}throw Error(Ee(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(pf(n,""),i.flags&=-33);var s=Qb(e);k4(e,s,n);break;case 3:case 4:var a=i.stateNode.containerInfo,o=Qb(e);B4(e,o,a);break;default:throw Error(Ee(161))}}catch(l){dr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bN(e,t,r){je=e,GT(e)}function GT(e,t,r){for(var i=(e.mode&1)!==0;je!==null;){var n=je,s=n.child;if(n.tag===22&&i){var a=n.memoizedState!==null||N1;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||yi;o=N1;var c=yi;if(N1=a,(yi=l)&&!c)for(je=n;je!==null;)a=je,l=a.child,a.tag===22&&a.memoizedState!==null?$b(n):l!==null?(l.return=a,je=l):$b(n);for(;s!==null;)je=s,GT(s),s=s.sibling;je=n,N1=o,yi=c}Zb(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,je=s):Zb(e)}}function Zb(e){for(;je!==null;){var t=je;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:yi||vv(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!yi)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:gs(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Rb(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Rb(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&vf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}yi||t.flags&512&&R4(t)}catch(d){dr(t,t.return,d)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function Jb(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function $b(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{vv(4,t)}catch(l){dr(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){dr(t,n,l)}}var s=t.return;try{R4(t)}catch(l){dr(t,s,l)}break;case 5:var a=t.return;try{R4(t)}catch(l){dr(t,a,l)}}}catch(l){dr(t,t.return,l)}if(t===e){je=null;break}var o=t.sibling;if(o!==null){o.return=t.return,je=o;break}je=t.return}}var wN=Math.ceil,J0=mo.ReactCurrentDispatcher,P6=mo.ReactCurrentOwner,Zn=mo.ReactCurrentBatchConfig,Dt=0,ri=null,Ir=null,ui=0,vn=0,Qh=Ml(0),Ur=0,Tf=null,Ic=0,yv=0,D6=0,Up=null,Xi=null,I6=0,Fu=1/0,za=null,$0=!1,N4=null,al=null,z1=!1,Wo=null,eg=0,Vp=0,z4=null,v0=-1,y0=0;function ji(){return Dt&6?Cr():v0!==-1?v0:v0=Cr()}function ol(e){return e.mode&1?Dt&2&&ui!==0?ui&-ui:nN.transition!==null?(y0===0&&(y0=MM()),y0):(e=Ut,e!==0||(e=window.event,e=e===void 0?16:RM(e.type)),e):1}function Ms(e,t,r,i){if(50<Vp)throw Vp=0,z4=null,Error(Ee(185));e1(e,r,i),(!(Dt&2)||e!==ri)&&(e===ri&&(!(Dt&2)&&(yv|=r),Ur===4&&jo(e,ui)),sn(e,i),r===1&&Dt===0&&!(t.mode&1)&&(Fu=Cr()+500,fv&&Tl()))}function sn(e,t){var r=e.callbackNode;nk(e,t);var i=N0(e,e===ri?ui:0);if(i===0)r!==null&&lb(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&lb(r),t===1)e.tag===0?iN(ew.bind(null,e)):$M(ew.bind(null,e)),$k(function(){!(Dt&6)&&Tl()}),r=null;else{switch(TM(i)){case 1:r=n6;break;case 4:r=AM;break;case 16:r=k0;break;case 536870912:r=EM;break;default:r=k0}r=JT(r,WT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function WT(e,t){if(v0=-1,y0=0,Dt&6)throw Error(Ee(327));var r=e.callbackNode;if(mu()&&e.callbackNode!==r)return null;var i=N0(e,e===ri?ui:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=tg(e,i);else{t=i;var n=Dt;Dt|=2;var s=XT();(ri!==e||ui!==t)&&(za=null,Fu=Cr()+500,xc(e,t));do try{_N();break}catch(o){qT(e,o)}while(1);v6(),J0.current=s,Dt=n,Ir!==null?t=0:(ri=null,ui=0,t=Ur)}if(t!==0){if(t===2&&(n=u4(e),n!==0&&(i=n,t=F4(e,n))),t===1)throw r=Tf,xc(e,0),jo(e,i),sn(e,Cr()),r;if(t===6)jo(e,i);else{if(n=e.current.alternate,!(i&30)&&!CN(n)&&(t=tg(e,i),t===2&&(s=u4(e),s!==0&&(i=s,t=F4(e,s))),t===1))throw r=Tf,xc(e,0),jo(e,i),sn(e,Cr()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(Ee(345));case 2:Kl(e,Xi,za);break;case 3:if(jo(e,i),(i&130023424)===i&&(t=I6+500-Cr(),10<t)){if(N0(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){ji(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=x4(Kl.bind(null,e,Xi,za),t);break}Kl(e,Xi,za);break;case 4:if(jo(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var a=31-Es(i);s=1<<a,a=t[a],a>n&&(n=a),i&=~s}if(i=n,i=Cr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*wN(i/1960))-i,10<i){e.timeoutHandle=x4(Kl.bind(null,e,Xi,za),i);break}Kl(e,Xi,za);break;case 5:Kl(e,Xi,za);break;default:throw Error(Ee(329))}}}return sn(e,Cr()),e.callbackNode===r?WT.bind(null,e):null}function F4(e,t){var r=Up;return e.current.memoizedState.isDehydrated&&(xc(e,t).flags|=256),e=tg(e,t),e!==2&&(t=Xi,Xi=r,t!==null&&j4(t)),e}function j4(e){Xi===null?Xi=e:Xi.push.apply(Xi,e)}function CN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],s=n.getSnapshot;n=n.value;try{if(!Ls(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function jo(e,t){for(t&=~D6,t&=~yv,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Es(t),i=1<<r;e[r]=-1,t&=~i}}function ew(e){if(Dt&6)throw Error(Ee(327));mu();var t=N0(e,0);if(!(t&1))return sn(e,Cr()),null;var r=tg(e,t);if(e.tag!==0&&r===2){var i=u4(e);i!==0&&(t=i,r=F4(e,i))}if(r===1)throw r=Tf,xc(e,0),jo(e,t),sn(e,Cr()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Kl(e,Xi,za),sn(e,Cr()),null}function O6(e,t){var r=Dt;Dt|=1;try{return e(t)}finally{Dt=r,Dt===0&&(Fu=Cr()+500,fv&&Tl())}}function Oc(e){Wo!==null&&Wo.tag===0&&!(Dt&6)&&mu();var t=Dt;Dt|=1;var r=Zn.transition,i=Ut;try{if(Zn.transition=null,Ut=1,e)return e()}finally{Ut=i,Zn.transition=r,Dt=t,!(Dt&6)&&Tl()}}function R6(){vn=Qh.current,tr(Qh)}function xc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Jk(r)),Ir!==null)for(r=Ir.return;r!==null;){var i=r;switch(f6(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&V0();break;case 3:Nu(),tr(rn),tr(Ai),S6();break;case 5:C6(i);break;case 4:Nu();break;case 13:tr(sr);break;case 19:tr(sr);break;case 10:y6(i.type._context);break;case 22:case 23:R6()}r=r.return}if(ri=e,Ir=e=ll(e.current,null),ui=vn=t,Ur=0,Tf=null,D6=yv=Ic=0,Xi=Up=null,hc!==null){for(t=0;t<hc.length;t++)if(r=hc[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,s=r.pending;if(s!==null){var a=s.next;s.next=n,i.next=a}r.pending=i}hc=null}return e}function qT(e,t){do{var r=Ir;try{if(v6(),f0.current=Z0,K0){for(var i=lr.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}K0=!1}if(Dc=0,Jr=Fr=lr=null,Fp=!1,Af=0,P6.current=null,r===null||r.return===null){Ur=1,Tf=t,Ir=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=ui,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Ub(a);if(p!==null){p.flags&=-257,Vb(p,a,o,s,t),p.mode&1&&jb(s,c,t),t=p,l=c;var f=t.updateQueue;if(f===null){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}else{if(!(t&1)){jb(s,c,t),B6();break e}l=Error(Ee(426))}}else if(nr&&o.mode&1){var g=Ub(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Vb(g,a,o,s,t),m6(zu(l,o));break e}}s=l=zu(l,o),Ur!==4&&(Ur=2),Up===null?Up=[s]:Up.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=LT(s,l,t);Ob(s,v);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(al===null||!al.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=PT(s,o,t);Ob(s,b);break e}}s=s.return}while(s!==null)}QT(r)}catch(w){t=w,Ir===r&&r!==null&&(Ir=r=r.return);continue}break}while(1)}function XT(){var e=J0.current;return J0.current=Z0,e===null?Z0:e}function B6(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),ri===null||!(Ic&268435455)&&!(yv&268435455)||jo(ri,ui)}function tg(e,t){var r=Dt;Dt|=2;var i=XT();(ri!==e||ui!==t)&&(za=null,xc(e,t));do try{SN();break}catch(n){qT(e,n)}while(1);if(v6(),Dt=r,J0.current=i,Ir!==null)throw Error(Ee(261));return ri=null,ui=0,Ur}function SN(){for(;Ir!==null;)YT(Ir)}function _N(){for(;Ir!==null&&!QB();)YT(Ir)}function YT(e){var t=ZT(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?QT(e):Ir=t,P6.current=null}function QT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=vN(r,t),r!==null){r.flags&=32767,Ir=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ur=6,Ir=null;return}}else if(r=gN(r,t,vn),r!==null){Ir=r;return}if(t=t.sibling,t!==null){Ir=t;return}Ir=t=e}while(t!==null);Ur===0&&(Ur=5)}function Kl(e,t,r){var i=Ut,n=Zn.transition;try{Zn.transition=null,Ut=1,AN(e,t,r,i)}finally{Zn.transition=n,Ut=i}return null}function AN(e,t,r,i){do mu();while(Wo!==null);if(Dt&6)throw Error(Ee(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(sk(e,s),e===ri&&(Ir=ri=null,ui=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||z1||(z1=!0,JT(k0,function(){return mu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Zn.transition,Zn.transition=null;var a=Ut;Ut=1;var o=Dt;Dt|=4,P6.current=null,xN(e,r),HT(r,e),Wk(v4),z0=!!g4,v4=g4=null,e.current=r,bN(r),KB(),Dt=o,Ut=a,Zn.transition=s}else e.current=r;if(z1&&(z1=!1,Wo=e,eg=n),s=e.pendingLanes,s===0&&(al=null),$B(r.stateNode),sn(e,Cr()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],i(n.value,{componentStack:n.stack,digest:n.digest});if($0)throw $0=!1,e=N4,N4=null,e;return eg&1&&e.tag!==0&&mu(),s=e.pendingLanes,s&1?e===z4?Vp++:(Vp=0,z4=e):Vp=0,Tl(),null}function mu(){if(Wo!==null){var e=TM(eg),t=Zn.transition,r=Ut;try{if(Zn.transition=null,Ut=16>e?16:e,Wo===null)var i=!1;else{if(e=Wo,Wo=null,eg=0,Dt&6)throw Error(Ee(331));var n=Dt;for(Dt|=4,je=e.current;je!==null;){var s=je,a=s.child;if(je.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(je=c;je!==null;){var u=je;switch(u.tag){case 0:case 11:case 15:jp(8,u,s)}var h=u.child;if(h!==null)h.return=u,je=h;else for(;je!==null;){u=je;var d=u.sibling,p=u.return;if(jT(u),u===c){je=null;break}if(d!==null){d.return=p,je=d;break}je=p}}}var f=s.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}je=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,je=a;else e:for(;je!==null;){if(s=je,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jp(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,je=v;break e}je=s.return}}var y=e.current;for(je=y;je!==null;){a=je;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,je=x;else e:for(a=y;je!==null;){if(o=je,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vv(9,o)}}catch(w){dr(o,o.return,w)}if(o===a){je=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,je=b;break e}je=o.return}}if(Dt=n,Tl(),la&&typeof la.onPostCommitFiberRoot=="function")try{la.onPostCommitFiberRoot(cv,e)}catch{}i=!0}return i}finally{Ut=r,Zn.transition=t}}return!1}function tw(e,t,r){t=zu(r,t),t=LT(e,t,1),e=sl(e,t,1),t=ji(),e!==null&&(e1(e,1,t),sn(e,t))}function dr(e,t,r){if(e.tag===3)tw(e,e,r);else for(;t!==null;){if(t.tag===3){tw(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(al===null||!al.has(i))){e=zu(r,e),e=PT(t,e,1),t=sl(t,e,1),e=ji(),t!==null&&(e1(t,1,e),sn(t,e));break}}t=t.return}}function EN(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=ji(),e.pingedLanes|=e.suspendedLanes&r,ri===e&&(ui&r)===r&&(Ur===4||Ur===3&&(ui&130023424)===ui&&500>Cr()-I6?xc(e,0):D6|=r),sn(e,t)}function KT(e,t){t===0&&(e.mode&1?(t=T1,T1<<=1,!(T1&130023424)&&(T1=4194304)):t=1);var r=ji();e=lo(e,t),e!==null&&(e1(e,t,r),sn(e,r))}function MN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),KT(e,r)}function TN(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Ee(314))}i!==null&&i.delete(t),KT(e,r)}var ZT;ZT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||rn.current)Ji=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ji=!1,mN(e,t,r);Ji=!!(e.flags&131072)}else Ji=!1,nr&&t.flags&1048576&&eT(t,W0,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;g0(e,t),e=t.pendingProps;var n=Ru(t,Ai.current);fu(t,r),n=A6(null,t,i,e,n,r);var s=E6();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,nn(i)?(s=!0,H0(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,b6(t),n.updater=mv,t.stateNode=n,n._reactInternals=t,E4(t,i,e,r),t=L4(null,t,i,!0,s,r)):(t.tag=0,nr&&s&&p6(t),Oi(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(g0(e,t),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=PN(i),e=gs(i,e),n){case 0:t=T4(null,t,i,e,r);break e;case 1:t=Wb(null,t,i,e,r);break e;case 11:t=Hb(null,t,i,e,r);break e;case 14:t=Gb(null,t,i,gs(i.type,e),r);break e}throw Error(Ee(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:gs(i,n),T4(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:gs(i,n),Wb(e,t,i,n,r);case 3:e:{if(RT(t),e===null)throw Error(Ee(387));i=t.pendingProps,s=t.memoizedState,n=s.element,nT(e,t),Y0(t,i,null,r);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=zu(Error(Ee(423)),t),t=qb(e,t,i,r,n);break e}else if(i!==n){n=zu(Error(Ee(424)),t),t=qb(e,t,i,r,n);break e}else for(bn=nl(t.stateNode.containerInfo.firstChild),En=t,nr=!0,xs=null,r=lT(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bu(),i===n){t=co(e,t,r);break e}Oi(e,t,i,r)}t=t.child}return t;case 5:return cT(t),e===null&&S4(t),i=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,y4(i,n)?a=null:s!==null&&y4(i,s)&&(t.flags|=32),OT(e,t),Oi(e,t,a,r),t.child;case 6:return e===null&&S4(t),null;case 13:return BT(e,t,r);case 4:return w6(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=ku(t,null,i,r):Oi(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:gs(i,n),Hb(e,t,i,n,r);case 7:return Oi(e,t,t.pendingProps,r),t.child;case 8:return Oi(e,t,t.pendingProps.children,r),t.child;case 12:return Oi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,Jt(q0,i._currentValue),i._currentValue=a,s!==null)if(Ls(s.value,a)){if(s.children===n.children&&!rn.current){t=co(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ja(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),_4(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ee(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),_4(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Oi(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,fu(t,r),n=ts(n),i=i(n),t.flags|=1,Oi(e,t,i,r),t.child;case 14:return i=t.type,n=gs(i,t.pendingProps),n=gs(i.type,n),Gb(e,t,i,n,r);case 15:return DT(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:gs(i,n),g0(e,t),t.tag=1,nn(i)?(e=!0,H0(t)):e=!1,fu(t,r),aT(t,i,n),E4(t,i,n,r),L4(null,t,i,!0,e,r);case 19:return kT(e,t,r);case 22:return IT(e,t,r)}throw Error(Ee(156,t.tag))};function JT(e,t){return _M(e,t)}function LN(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(e,t,r,i){return new LN(e,t,r,i)}function k6(e){return e=e.prototype,!(!e||!e.isReactComponent)}function PN(e){if(typeof e=="function")return k6(e)?1:0;if(e!=null){if(e=e.$$typeof,e===t6)return 11;if(e===r6)return 14}return 2}function ll(e,t){var r=e.alternate;return r===null?(r=Qn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function x0(e,t,r,i,n,s){var a=2;if(i=e,typeof e=="function")k6(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Fh:return bc(r.children,n,s,t);case e6:a=8,n|=8;break;case K3:return e=Qn(12,r,t,n|2),e.elementType=K3,e.lanes=s,e;case Z3:return e=Qn(13,r,t,n),e.elementType=Z3,e.lanes=s,e;case J3:return e=Qn(19,r,t,n),e.elementType=J3,e.lanes=s,e;case oM:return xv(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case sM:a=10;break e;case aM:a=9;break e;case t6:a=11;break e;case r6:a=14;break e;case Bo:a=16,i=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=Qn(a,r,t,n),t.elementType=e,t.type=i,t.lanes=s,t}function bc(e,t,r,i){return e=Qn(7,e,i,t),e.lanes=r,e}function xv(e,t,r,i){return e=Qn(22,e,i,t),e.elementType=oM,e.lanes=r,e.stateNode={isHidden:!1},e}function N2(e,t,r){return e=Qn(6,e,null,t),e.lanes=r,e}function z2(e,t,r){return t=Qn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function DN(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=y2(0),this.expirationTimes=y2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=y2(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function N6(e,t,r,i,n,s,a,o,l){return e=new DN(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Qn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},b6(s),e}function IN(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zh,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function $T(e){if(!e)return xl;e=e._reactInternals;e:{if(Hc(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(nn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(nn(r))return JM(e,r,t)}return t}function eL(e,t,r,i,n,s,a,o,l){return e=N6(r,i,!0,e,n,s,a,o,l),e.context=$T(null),r=e.current,i=ji(),n=ol(r),s=Ja(i,n),s.callback=t??null,sl(r,s,n),e.current.lanes=n,e1(e,n,i),sn(e,i),e}function bv(e,t,r,i){var n=t.current,s=ji(),a=ol(n);return r=$T(r),t.context===null?t.context=r:t.pendingContext=r,t=Ja(s,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=sl(n,t,a),e!==null&&(Ms(e,n,a,s),p0(e,n,a)),a}function rg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function rw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function z6(e,t){rw(e,t),(e=e.alternate)&&rw(e,t)}function ON(){return null}var tL=typeof reportError=="function"?reportError:function(e){console.error(e)};function F6(e){this._internalRoot=e}wv.prototype.render=F6.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));bv(e,t,null,null)};wv.prototype.unmount=F6.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Oc(function(){bv(null,e,null,null)}),t[oo]=null}};function wv(e){this._internalRoot=e}wv.prototype.unstable_scheduleHydration=function(e){if(e){var t=DM();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Fo.length&&t!==0&&t<Fo[r].priority;r++);Fo.splice(r,0,e),r===0&&OM(e)}};function j6(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function iw(){}function RN(e,t,r,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var c=rg(a);s.call(c)}}var a=eL(t,i,e,0,null,!1,!1,"",iw);return e._reactRootContainer=a,e[oo]=a.current,bf(e.nodeType===8?e.parentNode:e),Oc(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var o=i;i=function(){var c=rg(l);o.call(c)}}var l=N6(e,0,!1,null,null,!1,!1,"",iw);return e._reactRootContainer=l,e[oo]=l.current,bf(e.nodeType===8?e.parentNode:e),Oc(function(){bv(t,l,r,i)}),l}function Sv(e,t,r,i,n){var s=r._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=rg(a);o.call(l)}}bv(t,a,e,n)}else a=RN(r,t,e,n,i);return rg(a)}LM=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Cp(t.pendingLanes);r!==0&&(s6(t,r|1),sn(t,Cr()),!(Dt&6)&&(Fu=Cr()+500,Tl()))}break;case 13:Oc(function(){var i=lo(e,1);if(i!==null){var n=ji();Ms(i,e,1,n)}}),z6(e,1)}};a6=function(e){if(e.tag===13){var t=lo(e,134217728);if(t!==null){var r=ji();Ms(t,e,134217728,r)}z6(e,134217728)}};PM=function(e){if(e.tag===13){var t=ol(e),r=lo(e,t);if(r!==null){var i=ji();Ms(r,e,t,i)}z6(e,t)}};DM=function(){return Ut};IM=function(e,t){var r=Ut;try{return Ut=e,t()}finally{Ut=r}};l4=function(e,t,r){switch(t){case"input":if(t4(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=pv(i);if(!n)throw Error(Ee(90));cM(i),t4(i,n)}}}break;case"textarea":uM(e,r);break;case"select":t=r.value,t!=null&&hu(e,!!r.multiple,t,!1)}};yM=O6;xM=Oc;var BN={usingClientEntryPoint:!1,Events:[r1,Hh,pv,gM,vM,O6]},kd={findFiberByHostInstance:cc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},kN={bundleType:kd.bundleType,version:kd.version,rendererPackageName:kd.rendererPackageName,rendererConfig:kd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=CM(e),e===null?null:e.stateNode},findFiberByHostInstance:kd.findFiberByHostInstance||ON,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var F1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!F1.isDisabled&&F1.supportsFiber)try{cv=F1.inject(kN),la=F1}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BN;Dn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j6(t))throw Error(Ee(200));return IN(e,t,null,r)};Dn.createRoot=function(e,t){if(!j6(e))throw Error(Ee(299));var r=!1,i="",n=tL;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=N6(e,1,!1,null,null,r,!1,i,n),e[oo]=t.current,bf(e.nodeType===8?e.parentNode:e),new F6(t)};Dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=CM(t),e=e===null?null:e.stateNode,e};Dn.flushSync=function(e){return Oc(e)};Dn.hydrate=function(e,t,r){if(!Cv(t))throw Error(Ee(200));return Sv(null,e,t,!0,r)};Dn.hydrateRoot=function(e,t,r){if(!j6(e))throw Error(Ee(405));var i=r!=null&&r.hydratedSources||null,n=!1,s="",a=tL;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=eL(t,null,e,1,r??null,n,!1,s,a),e[oo]=t.current,bf(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new wv(t)};Dn.render=function(e,t,r){if(!Cv(t))throw Error(Ee(200));return Sv(null,e,t,!1,r)};Dn.unmountComponentAtNode=function(e){if(!Cv(e))throw Error(Ee(40));return e._reactRootContainer?(Oc(function(){Sv(null,null,e,!1,function(){e._reactRootContainer=null,e[oo]=null})}),!0):!1};Dn.unstable_batchedUpdates=O6;Dn.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Cv(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return Sv(e,t,r,!1,i)};Dn.version="18.2.0-next-9e3b772b8-20220608";function rL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rL)}catch(e){console.error(e)}}rL(),eM.exports=Dn;var NN=eM.exports,nw=NN;Y3.createRoot=nw.createRoot,Y3.hydrateRoot=nw.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ir(){return ir=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ir.apply(this,arguments)}var Dr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Dr||(Dr={}));const sw="popstate";function zN(e){e===void 0&&(e={});function t(i,n){let{pathname:s,search:a,hash:o}=i.location;return Lf("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(i,n){return typeof n=="string"?n:Rc(n)}return jN(t,r,null,e)}function xt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ju(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function FN(){return Math.random().toString(36).substr(2,8)}function aw(e,t){return{usr:e.state,key:e.key,idx:t}}function Lf(e,t,r,i){return r===void 0&&(r=null),ir({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?go(t):t,{state:r,key:t&&t.key||i||FN()})}function Rc(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function go(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function jN(e,t,r,i){i===void 0&&(i={});let{window:n=document.defaultView,v5Compat:s=!1}=i,a=n.history,o=Dr.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(ir({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=Dr.Pop;let g=u(),v=g==null?null:g-c;c=g,l&&l({action:o,location:m.location,delta:v})}function d(g,v){o=Dr.Push;let y=Lf(m.location,g,v);r&&r(y,g),c=u()+1;let x=aw(y,c),b=m.createHref(y);try{a.pushState(x,"",b)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;n.location.assign(b)}s&&l&&l({action:o,location:m.location,delta:1})}function p(g,v){o=Dr.Replace;let y=Lf(m.location,g,v);r&&r(y,g),c=u();let x=aw(y,c),b=m.createHref(y);a.replaceState(x,"",b),s&&l&&l({action:o,location:m.location,delta:0})}function f(g){let v=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof g=="string"?g:Rc(g);return xt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return e(n,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(sw,h),l=g,()=>{n.removeEventListener(sw,h),l=null}},createHref(g){return t(n,g)},createURL:f,encodeLocation(g){let v=f(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:p,go(g){return a.go(g)}};return m}var br;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(br||(br={}));const UN=new Set(["lazy","caseSensitive","path","id","index","children"]);function VN(e){return e.index===!0}function U4(e,t,r,i){return r===void 0&&(r=[]),i===void 0&&(i={}),e.map((n,s)=>{let a=[...r,s],o=typeof n.id=="string"?n.id:a.join("-");if(xt(n.index!==!0||!n.children,"Cannot specify children on an index route"),xt(!i[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),VN(n)){let l=ir({},n,t(n),{id:o});return i[o]=l,l}else{let l=ir({},n,t(n),{id:o,children:void 0});return i[o]=l,n.children&&(l.children=U4(n.children,t,a,i)),l}})}function Kh(e,t,r){r===void 0&&(r="/");let i=typeof t=="string"?go(t):t,n=ld(i.pathname||"/",r);if(n==null)return null;let s=iL(e);HN(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=JN(s[o],tz(n));return a}function iL(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(xt(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=$a([i,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(xt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),iL(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:KN(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of nL(s.path))n(s,a,l)}),t}function nL(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(i.length===0)return n?[s,""]:[s];let a=nL(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function HN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:ZN(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const GN=/^:\w+$/,WN=3,qN=2,XN=1,YN=10,QN=-2,ow=e=>e==="*";function KN(e,t){let r=e.split("/"),i=r.length;return r.some(ow)&&(i+=QN),t&&(i+=qN),r.filter(n=>!ow(n)).reduce((n,s)=>n+(GN.test(s)?WN:s===""?XN:YN),i)}function ZN(e,t){return e.length===t.length&&e.slice(0,-1).every((i,n)=>i===t[n])?e[e.length-1]-t[t.length-1]:0}function JN(e,t){let{routesMeta:r}=e,i={},n="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=n==="/"?t:t.slice(n.length)||"/",u=$N({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(i,u.params);let h=o.route;s.push({params:i,pathname:$a([n,u.pathname]),pathnameBase:sz($a([n,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(n=$a([n,u.pathnameBase]))}return s}function $N(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=ez(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((c,u,h)=>{if(u==="*"){let d=o[h]||"";a=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[u]=rz(o[h]||"",u),c},{}),pathname:s,pathnameBase:a,pattern:e}}function ez(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ju(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(i.push(o),"/([^\\/]+)"));return e.endsWith("*")?(i.push("*"),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function tz(e){try{return decodeURI(e)}catch(t){return ju(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function rz(e,t){try{return decodeURIComponent(e)}catch(r){return ju(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function ld(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function iz(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:n=""}=typeof e=="string"?go(e):e;return{pathname:r?r.startsWith("/")?r:nz(r,t):t,search:az(i),hash:oz(n)}}function nz(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function F2(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _v(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function U6(e,t,r,i){i===void 0&&(i=!1);let n;typeof e=="string"?n=go(e):(n=ir({},e),xt(!n.pathname||!n.pathname.includes("?"),F2("?","pathname","search",n)),xt(!n.pathname||!n.pathname.includes("#"),F2("#","pathname","hash",n)),xt(!n.search||!n.search.includes("#"),F2("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(i||a==null)o=r;else{let h=t.length-1;if(a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}o=h>=0?t[h]:"/"}let l=iz(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const $a=e=>e.join("/").replace(/\/\/+/g,"/"),sz=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),az=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,oz=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class V6{constructor(t,r,i,n){n===void 0&&(n=!1),this.status=t,this.statusText=r||"",this.internal=n,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}}function sL(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const aL=["post","put","patch","delete"],lz=new Set(aL),cz=["get",...aL],hz=new Set(cz),uz=new Set([301,302,303,307,308]),dz=new Set([307,308]),j2={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},pz={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Nd={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},oL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fz=e=>({hasErrorBoundary:!!e.hasErrorBoundary});function mz(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",i=!r;xt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let n;if(e.mapRouteProperties)n=e.mapRouteProperties;else if(e.detectErrorBoundary){let Q=e.detectErrorBoundary;n=J=>({hasErrorBoundary:Q(J)})}else n=fz;let s={},a=U4(e.routes,n,void 0,s),o,l=e.basename||"/",c=ir({v7_normalizeFormMethod:!1,v7_prependBasename:!1},e.future),u=null,h=new Set,d=null,p=null,f=null,m=e.hydrationData!=null,g=Kh(a,e.history.location,l),v=null;if(g==null){let Q=Un(404,{pathname:e.history.location.pathname}),{matches:J,route:de}=mw(a);g=J,v={[de.id]:Q}}let y=!g.some(Q=>Q.route.lazy)&&(!g.some(Q=>Q.route.loader)||e.hydrationData!=null),x,b={historyAction:e.history.action,location:e.history.location,matches:g,initialized:y,navigation:j2,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||v,fetchers:new Map,blockers:new Map},w=Dr.Pop,C=!1,_,S=!1,A=!1,E=[],L=[],P=new Map,D=0,I=-1,B=new Map,X=new Set,H=new Map,R=new Map,q=new Map,F=!1;function z(){return u=e.history.listen(Q=>{let{action:J,location:de,delta:Me}=Q;if(F){F=!1;return}ju(q.size===0||Me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let He=Te({currentLocation:b.location,nextLocation:de,historyAction:J});if(He&&Me!=null){F=!0,e.history.go(Me*-1),xe(He,{state:"blocked",location:de,proceed(){xe(He,{state:"proceeding",proceed:void 0,reset:void 0,location:de}),e.history.go(Me)},reset(){let G=new Map(b.blockers);G.set(He,Nd),j({blockers:G})}});return}return $(J,de)}),b.initialized||$(Dr.Pop,b.location),x}function U(){u&&u(),h.clear(),_&&_.abort(),b.fetchers.forEach((Q,J)=>_e(J)),b.blockers.forEach((Q,J)=>we(J))}function K(Q){return h.add(Q),()=>h.delete(Q)}function j(Q){b=ir({},b,Q),h.forEach(J=>J(b))}function Y(Q,J){var de,Me;let He=b.actionData!=null&&b.navigation.formMethod!=null&&ys(b.navigation.formMethod)&&b.navigation.state==="loading"&&((de=Q.state)==null?void 0:de._isRedirect)!==!0,G;J.actionData?Object.keys(J.actionData).length>0?G=J.actionData:G=null:He?G=b.actionData:G=null;let te=J.loaderData?fw(b.loaderData,J.loaderData,J.matches||[],J.errors):b.loaderData,se=b.blockers;se.size>0&&(se=new Map(se),se.forEach((De,et)=>se.set(et,Nd)));let me=C===!0||b.navigation.formMethod!=null&&ys(b.navigation.formMethod)&&((Me=Q.state)==null?void 0:Me._isRedirect)!==!0;o&&(a=o,o=void 0),S||w===Dr.Pop||(w===Dr.Push?e.history.push(Q,Q.state):w===Dr.Replace&&e.history.replace(Q,Q.state)),j(ir({},J,{actionData:G,loaderData:te,historyAction:w,location:Q,initialized:!0,navigation:j2,revalidation:"idle",restoreScrollPosition:Xe(Q,J.matches||b.matches),preventScrollReset:me,blockers:se})),w=Dr.Pop,C=!1,S=!1,A=!1,E=[],L=[]}async function V(Q,J){if(typeof Q=="number"){e.history.go(Q);return}let de=V4(b.location,b.matches,l,c.v7_prependBasename,Q,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:Me,submission:He,error:G}=lw(c.v7_normalizeFormMethod,!1,de,J),te=b.location,se=Lf(b.location,Me,J&&J.state);se=ir({},se,e.history.encodeLocation(se));let me=J&&J.replace!=null?J.replace:void 0,De=Dr.Push;me===!0?De=Dr.Replace:me===!1||He!=null&&ys(He.formMethod)&&He.formAction===b.location.pathname+b.location.search&&(De=Dr.Replace);let et=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,lt=Te({currentLocation:te,nextLocation:se,historyAction:De});if(lt){xe(lt,{state:"blocked",location:se,proceed(){xe(lt,{state:"proceeding",proceed:void 0,reset:void 0,location:se}),V(Q,J)},reset(){let Ct=new Map(b.blockers);Ct.set(lt,Nd),j({blockers:Ct})}});return}return await $(De,se,{submission:He,pendingError:G,preventScrollReset:et,replace:J&&J.replace})}function ie(){if(Oe(),j({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){$(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}$(w||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation})}}async function $(Q,J,de){_&&_.abort(),_=null,w=Q,S=(de&&de.startUninterruptedRevalidation)===!0,Ve(b.location,b.matches),C=(de&&de.preventScrollReset)===!0;let Me=o||a,He=de&&de.overrideNavigation,G=Kh(Me,J,l);if(!G){let Ct=Un(404,{pathname:J.pathname}),{matches:Qt,route:It}=mw(Me);Ge(),Y(J,{matches:Qt,loaderData:{},errors:{[It.id]:Ct}});return}if(b.initialized&&!A&&bz(b.location,J)&&!(de&&de.submission&&ys(de.submission.formMethod))){Y(J,{matches:G});return}_=new AbortController;let te=Fd(e.history,J,_.signal,de&&de.submission),se,me;if(de&&de.pendingError)me={[Zh(G).route.id]:de.pendingError};else if(de&&de.submission&&ys(de.submission.formMethod)){let Ct=await ee(te,J,de.submission,G,{replace:de.replace});if(Ct.shortCircuited)return;se=Ct.pendingActionData,me=Ct.pendingActionError,He=j1(J,de.submission),te=new Request(te.url,{signal:te.signal})}let{shortCircuited:De,loaderData:et,errors:lt}=await ne(te,J,G,He,de&&de.submission,de&&de.fetcherSubmission,de&&de.replace,se,me);De||(_=null,Y(J,ir({matches:G},se?{actionData:se}:{},{loaderData:et,errors:lt})))}async function ee(Q,J,de,Me,He){He===void 0&&(He={}),Oe();let G=Az(J,de);j({navigation:G});let te,se=G4(Me,J);if(!se.route.action&&!se.route.lazy)te={type:br.error,error:Un(405,{method:Q.method,pathname:J.pathname,routeId:se.route.id})};else if(te=await zd("action",Q,se,Me,s,n,l),Q.signal.aborted)return{shortCircuited:!0};if(gu(te)){let me;return He&&He.replace!=null?me=He.replace:me=te.location===b.location.pathname+b.location.search,await Se(b,te,{submission:de,replace:me}),{shortCircuited:!0}}if(Hp(te)){let me=Zh(Me,se.route.id);return(He&&He.replace)!==!0&&(w=Dr.Push),{pendingActionData:{},pendingActionError:{[me.route.id]:te.error}}}if(dc(te))throw Un(400,{type:"defer-action"});return{pendingActionData:{[se.route.id]:te.data}}}async function ne(Q,J,de,Me,He,G,te,se,me){let De=Me||j1(J,He),et=He||G||yw(De),lt=o||a,[Ct,Qt]=cw(e.history,b,de,et,J,A,E,L,H,X,lt,l,se,me);if(Ge(Z=>!(de&&de.some(fe=>fe.route.id===Z))||Ct&&Ct.some(fe=>fe.route.id===Z)),I=++D,Ct.length===0&&Qt.length===0){let Z=N();return Y(J,ir({matches:de,loaderData:{},errors:me||null},se?{actionData:se}:{},Z?{fetchers:new Map(b.fetchers)}:{})),{shortCircuited:!0}}if(!S){Qt.forEach(fe=>{let Fe=b.fetchers.get(fe.key),ct=jd(void 0,Fe?Fe.data:void 0);b.fetchers.set(fe.key,ct)});let Z=se||b.actionData;j(ir({navigation:De},Z?Object.keys(Z).length===0?{actionData:null}:{actionData:Z}:{},Qt.length>0?{fetchers:new Map(b.fetchers)}:{}))}Qt.forEach(Z=>{P.has(Z.key)&&Ue(Z.key),Z.controller&&P.set(Z.key,Z.controller)});let It=()=>Qt.forEach(Z=>Ue(Z.key));_&&_.signal.addEventListener("abort",It);let{results:si,loaderResults:Xr,fetcherResults:Jc}=await Ne(b.matches,de,Ct,Qt,Q);if(Q.signal.aborted)return{shortCircuited:!0};_&&_.signal.removeEventListener("abort",It),Qt.forEach(Z=>P.delete(Z.key));let ss=gw(si);if(ss){if(ss.idx>=Ct.length){let Z=Qt[ss.idx-Ct.length].key;X.add(Z)}return await Se(b,ss.result,{replace:te}),{shortCircuited:!0}}let{loaderData:as,errors:$c}=pw(b,de,Ct,Xr,me,Qt,Jc,R);R.forEach((Z,fe)=>{Z.subscribe(Fe=>{(Fe||Z.done)&&R.delete(fe)})});let k=N(),le=O(I),ge=k||le||Qt.length>0;return ir({loaderData:as,errors:$c},ge?{fetchers:new Map(b.fetchers)}:{})}function ce(Q){return b.fetchers.get(Q)||pz}function ue(Q,J,de,Me){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");P.has(Q)&&Ue(Q);let He=o||a,G=V4(b.location,b.matches,l,c.v7_prependBasename,de,J,Me==null?void 0:Me.relative),te=Kh(He,G,l);if(!te){Ae(Q,J,Un(404,{pathname:G}));return}let{path:se,submission:me,error:De}=lw(c.v7_normalizeFormMethod,!0,G,Me);if(De){Ae(Q,J,De);return}let et=G4(te,se);if(C=(Me&&Me.preventScrollReset)===!0,me&&ys(me.formMethod)){ye(Q,J,se,et,te,me);return}H.set(Q,{routeId:J,path:se}),Re(Q,J,se,et,te,me)}async function ye(Q,J,de,Me,He,G){if(Oe(),H.delete(Q),!Me.route.action&&!Me.route.lazy){let Qe=Un(405,{method:G.formMethod,pathname:de,routeId:J});Ae(Q,J,Qe);return}let te=b.fetchers.get(Q),se=Ez(G,te);b.fetchers.set(Q,se),j({fetchers:new Map(b.fetchers)});let me=new AbortController,De=Fd(e.history,de,me.signal,G);P.set(Q,me);let et=D,lt=await zd("action",De,Me,He,s,n,l);if(De.signal.aborted){P.get(Q)===me&&P.delete(Q);return}if(gu(lt))if(P.delete(Q),I>et){let Qe=Ih(void 0);b.fetchers.set(Q,Qe),j({fetchers:new Map(b.fetchers)});return}else{X.add(Q);let Qe=jd(G);return b.fetchers.set(Q,Qe),j({fetchers:new Map(b.fetchers)}),Se(b,lt,{submission:G,isFetchActionRedirect:!0})}if(Hp(lt)){Ae(Q,J,lt.error);return}if(dc(lt))throw Un(400,{type:"defer-action"});let Ct=b.navigation.location||b.location,Qt=Fd(e.history,Ct,me.signal),It=o||a,si=b.navigation.state!=="idle"?Kh(It,b.navigation.location,l):b.matches;xt(si,"Didn't find any matches after fetcher action");let Xr=++D;B.set(Q,Xr);let Jc=jd(G,lt.data);b.fetchers.set(Q,Jc);let[ss,as]=cw(e.history,b,si,G,Ct,A,E,L,H,X,It,l,{[Me.route.id]:lt.data},void 0);as.filter(Qe=>Qe.key!==Q).forEach(Qe=>{let vt=Qe.key,Bt=b.fetchers.get(vt),Tt=jd(void 0,Bt?Bt.data:void 0);b.fetchers.set(vt,Tt),P.has(vt)&&Ue(vt),Qe.controller&&P.set(vt,Qe.controller)}),j({fetchers:new Map(b.fetchers)});let $c=()=>as.forEach(Qe=>Ue(Qe.key));me.signal.addEventListener("abort",$c);let{results:k,loaderResults:le,fetcherResults:ge}=await Ne(b.matches,si,ss,as,Qt);if(me.signal.aborted)return;me.signal.removeEventListener("abort",$c),B.delete(Q),P.delete(Q),as.forEach(Qe=>P.delete(Qe.key));let Z=gw(k);if(Z){if(Z.idx>=ss.length){let Qe=as[Z.idx-ss.length].key;X.add(Qe)}return Se(b,Z.result)}let{loaderData:fe,errors:Fe}=pw(b,b.matches,ss,le,void 0,as,ge,R);if(b.fetchers.has(Q)){let Qe=Ih(lt.data);b.fetchers.set(Q,Qe)}let ct=O(Xr);b.navigation.state==="loading"&&Xr>I?(xt(w,"Expected pending action"),_&&_.abort(),Y(b.navigation.location,{matches:si,loaderData:fe,errors:Fe,fetchers:new Map(b.fetchers)})):(j(ir({errors:Fe,loaderData:fw(b.loaderData,fe,si,Fe)},ct||as.length>0?{fetchers:new Map(b.fetchers)}:{})),A=!1)}async function Re(Q,J,de,Me,He,G){let te=b.fetchers.get(Q),se=jd(G,te?te.data:void 0);b.fetchers.set(Q,se),j({fetchers:new Map(b.fetchers)});let me=new AbortController,De=Fd(e.history,de,me.signal);P.set(Q,me);let et=D,lt=await zd("loader",De,Me,He,s,n,l);if(dc(lt)&&(lt=await hL(lt,De.signal,!0)||lt),P.get(Q)===me&&P.delete(Q),De.signal.aborted)return;if(gu(lt))if(I>et){let Qt=Ih(void 0);b.fetchers.set(Q,Qt),j({fetchers:new Map(b.fetchers)});return}else{X.add(Q),await Se(b,lt);return}if(Hp(lt)){let Qt=Zh(b.matches,J);b.fetchers.delete(Q),j({fetchers:new Map(b.fetchers),errors:{[Qt.route.id]:lt.error}});return}xt(!dc(lt),"Unhandled fetcher deferred data");let Ct=Ih(lt.data);b.fetchers.set(Q,Ct),j({fetchers:new Map(b.fetchers)})}async function Se(Q,J,de){let{submission:Me,replace:He,isFetchActionRedirect:G}=de===void 0?{}:de;J.revalidate&&(A=!0);let te=Lf(Q.location,J.location,ir({_isRedirect:!0},G?{_isFetchActionRedirect:!0}:{}));if(xt(te,"Expected a location on the redirect navigation"),r){let De=!1;if(J.reloadDocument)De=!0;else if(oL.test(J.location)){const et=e.history.createURL(J.location);De=et.origin!==t.location.origin||ld(et.pathname,l)==null}if(De){He?t.location.replace(J.location):t.location.assign(J.location);return}}_=null;let se=He===!0?Dr.Replace:Dr.Push,me=Me||yw(Q.navigation);if(dz.has(J.status)&&me&&ys(me.formMethod))await $(se,te,{submission:ir({},me,{formAction:J.location}),preventScrollReset:C});else if(G)await $(se,te,{overrideNavigation:j1(te),fetcherSubmission:me,preventScrollReset:C});else{let De=j1(te,me);await $(se,te,{overrideNavigation:De,preventScrollReset:C})}}async function Ne(Q,J,de,Me,He){let G=await Promise.all([...de.map(me=>zd("loader",He,me,J,s,n,l)),...Me.map(me=>me.matches&&me.match&&me.controller?zd("loader",Fd(e.history,me.path,me.controller.signal),me.match,me.matches,s,n,l):{type:br.error,error:Un(404,{pathname:me.path})})]),te=G.slice(0,de.length),se=G.slice(de.length);return await Promise.all([vw(Q,de,te,te.map(()=>He.signal),!1,b.loaderData),vw(Q,Me.map(me=>me.match),se,Me.map(me=>me.controller?me.controller.signal:null),!0)]),{results:G,loaderResults:te,fetcherResults:se}}function Oe(){A=!0,E.push(...Ge()),H.forEach((Q,J)=>{P.has(J)&&(L.push(J),Ue(J))})}function Ae(Q,J,de){let Me=Zh(b.matches,J);_e(Q),j({errors:{[Me.route.id]:de},fetchers:new Map(b.fetchers)})}function _e(Q){let J=b.fetchers.get(Q);P.has(Q)&&!(J&&J.state==="loading"&&B.has(Q))&&Ue(Q),H.delete(Q),B.delete(Q),X.delete(Q),b.fetchers.delete(Q)}function Ue(Q){let J=P.get(Q);xt(J,"Expected fetch controller: "+Q),J.abort(),P.delete(Q)}function qe(Q){for(let J of Q){let de=ce(J),Me=Ih(de.data);b.fetchers.set(J,Me)}}function N(){let Q=[],J=!1;for(let de of X){let Me=b.fetchers.get(de);xt(Me,"Expected fetcher: "+de),Me.state==="loading"&&(X.delete(de),Q.push(de),J=!0)}return qe(Q),J}function O(Q){let J=[];for(let[de,Me]of B)if(Me<Q){let He=b.fetchers.get(de);xt(He,"Expected fetcher: "+de),He.state==="loading"&&(Ue(de),B.delete(de),J.push(de))}return qe(J),J.length>0}function ae(Q,J){let de=b.blockers.get(Q)||Nd;return q.get(Q)!==J&&q.set(Q,J),de}function we(Q){b.blockers.delete(Q),q.delete(Q)}function xe(Q,J){let de=b.blockers.get(Q)||Nd;xt(de.state==="unblocked"&&J.state==="blocked"||de.state==="blocked"&&J.state==="blocked"||de.state==="blocked"&&J.state==="proceeding"||de.state==="blocked"&&J.state==="unblocked"||de.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+de.state+" -> "+J.state);let Me=new Map(b.blockers);Me.set(Q,J),j({blockers:Me})}function Te(Q){let{currentLocation:J,nextLocation:de,historyAction:Me}=Q;if(q.size===0)return;q.size>1&&ju(!1,"A router only supports one blocker at a time");let He=Array.from(q.entries()),[G,te]=He[He.length-1],se=b.blockers.get(G);if(!(se&&se.state==="proceeding")&&te({currentLocation:J,nextLocation:de,historyAction:Me}))return G}function Ge(Q){let J=[];return R.forEach((de,Me)=>{(!Q||Q(Me))&&(de.cancel(),J.push(Me),R.delete(Me))}),J}function Ie(Q,J,de){if(d=Q,f=J,p=de||null,!m&&b.navigation===j2){m=!0;let Me=Xe(b.location,b.matches);Me!=null&&j({restoreScrollPosition:Me})}return()=>{d=null,f=null,p=null}}function pe(Q,J){return p&&p(Q,J.map(Me=>_z(Me,b.loaderData)))||Q.key}function Ve(Q,J){if(d&&f){let de=pe(Q,J);d[de]=f()}}function Xe(Q,J){if(d){let de=pe(Q,J),Me=d[de];if(typeof Me=="number")return Me}return null}function Ye(Q){s={},o=U4(Q,n,void 0,s)}return x={get basename(){return l},get state(){return b},get routes(){return a},initialize:z,subscribe:K,enableScrollRestoration:Ie,navigate:V,fetch:ue,revalidate:ie,createHref:Q=>e.history.createHref(Q),encodeLocation:Q=>e.history.encodeLocation(Q),getFetcher:ce,deleteFetcher:_e,dispose:U,getBlocker:ae,deleteBlocker:we,_internalFetchControllers:P,_internalActiveDeferreds:R,_internalSetRoutes:Ye},x}function gz(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function V4(e,t,r,i,n,s,a){let o,l;if(s!=null&&a!=="path"){o=[];for(let u of t)if(o.push(u),u.route.id===s){l=u;break}}else o=t,l=t[t.length-1];let c=U6(n||".",_v(o).map(u=>u.pathnameBase),ld(e.pathname,r)||e.pathname,a==="path");return n==null&&(c.search=e.search,c.hash=e.hash),(n==null||n===""||n===".")&&l&&l.route.index&&!H6(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),i&&r!=="/"&&(c.pathname=c.pathname==="/"?r:$a([r,c.pathname])),Rc(c)}function lw(e,t,r,i){if(!i||!gz(i))return{path:r};if(i.formMethod&&!Sz(i.formMethod))return{path:r,error:Un(405,{method:i.formMethod})};let n=()=>({path:r,error:Un(400,{type:"invalid-body"})}),s=i.formMethod||"get",a=e?s.toUpperCase():s.toLowerCase(),o=cL(r);if(i.body!==void 0){if(i.formEncType==="text/plain"){if(!ys(a))return n();let d=typeof i.body=="string"?i.body:i.body instanceof FormData||i.body instanceof URLSearchParams?Array.from(i.body.entries()).reduce((p,f)=>{let[m,g]=f;return""+p+m+"="+g+`
`},""):String(i.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:i.formEncType,formData:void 0,json:void 0,text:d}}}else if(i.formEncType==="application/json"){if(!ys(a))return n();try{let d=typeof i.body=="string"?JSON.parse(i.body):i.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:i.formEncType,formData:void 0,json:d,text:void 0}}}catch{return n()}}}xt(typeof FormData=="function","FormData is not available in this environment");let l,c;if(i.formData)l=H4(i.formData),c=i.formData;else if(i.body instanceof FormData)l=H4(i.body),c=i.body;else if(i.body instanceof URLSearchParams)l=i.body,c=dw(l);else if(i.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(i.body),c=dw(l)}catch{return n()}let u={formMethod:a,formAction:o,formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(ys(u.formMethod))return{path:r,submission:u};let h=go(r);return t&&h.search&&H6(h.search)&&l.append("index",""),h.search="?"+l,{path:Rc(h),submission:u}}function vz(e,t){let r=e;if(t){let i=e.findIndex(n=>n.route.id===t);i>=0&&(r=e.slice(0,i))}return r}function cw(e,t,r,i,n,s,a,o,l,c,u,h,d,p){let f=p?Object.values(p)[0]:d?Object.values(d)[0]:void 0,m=e.createURL(t.location),g=e.createURL(n),v=p?Object.keys(p)[0]:void 0,x=vz(r,v).filter((w,C)=>{if(w.route.lazy)return!0;if(w.route.loader==null)return!1;if(yz(t.loaderData,t.matches[C],w)||a.some(A=>A===w.route.id))return!0;let _=t.matches[C],S=w;return hw(w,ir({currentUrl:m,currentParams:_.params,nextUrl:g,nextParams:S.params},i,{actionResult:f,defaultShouldRevalidate:s||m.pathname+m.search===g.pathname+g.search||m.search!==g.search||lL(_,S)}))}),b=[];return l.forEach((w,C)=>{if(!r.some(L=>L.route.id===w.routeId))return;let _=Kh(u,w.path,h);if(!_){b.push({key:C,routeId:w.routeId,path:w.path,matches:null,match:null,controller:null});return}let S=t.fetchers.get(C),A=G4(_,w.path),E=!1;c.has(C)?E=!1:o.includes(C)?E=!0:S&&S.state!=="idle"&&S.data===void 0?E=s:E=hw(A,ir({currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:g,nextParams:r[r.length-1].params},i,{actionResult:f,defaultShouldRevalidate:s})),E&&b.push({key:C,routeId:w.routeId,path:w.path,matches:_,match:A,controller:new AbortController})}),[x,b]}function yz(e,t,r){let i=!t||r.route.id!==t.route.id,n=e[r.route.id]===void 0;return i||n}function lL(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function hw(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function uw(e,t,r){if(!e.lazy)return;let i=await e.lazy();if(!e.lazy)return;let n=r[e.id];xt(n,"No route found in manifest");let s={};for(let a in i){let l=n[a]!==void 0&&a!=="hasErrorBoundary";ju(!l,'Route "'+n.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!UN.has(a)&&(s[a]=i[a])}Object.assign(n,s),Object.assign(n,ir({},t(n),{lazy:void 0}))}async function zd(e,t,r,i,n,s,a,o){o===void 0&&(o={});let l,c,u,h=f=>{let m,g=new Promise((v,y)=>m=y);return u=()=>m(),t.signal.addEventListener("abort",u),Promise.race([f({request:t,params:r.params,context:o.requestContext}),g])};try{let f=r.route[e];if(r.route.lazy)if(f)c=(await Promise.all([h(f),uw(r.route,s,n)]))[0];else if(await uw(r.route,s,n),f=r.route[e],f)c=await h(f);else if(e==="action"){let m=new URL(t.url),g=m.pathname+m.search;throw Un(405,{method:t.method,pathname:g,routeId:r.route.id})}else return{type:br.data,data:void 0};else if(f)c=await h(f);else{let m=new URL(t.url),g=m.pathname+m.search;throw Un(404,{pathname:g})}xt(c!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(f){l=br.error,c=f}finally{u&&t.signal.removeEventListener("abort",u)}if(Cz(c)){let f=c.status;if(uz.has(f)){let v=c.headers.get("Location");if(xt(v,"Redirects returned/thrown from loaders/actions must have a Location header"),!oL.test(v))v=V4(new URL(t.url),i.slice(0,i.indexOf(r)+1),a,!0,v);else if(!o.isStaticRequest){let y=new URL(t.url),x=v.startsWith("//")?new URL(y.protocol+v):new URL(v),b=ld(x.pathname,a)!=null;x.origin===y.origin&&b&&(v=x.pathname+x.search+x.hash)}if(o.isStaticRequest)throw c.headers.set("Location",v),c;return{type:br.redirect,status:f,location:v,revalidate:c.headers.get("X-Remix-Revalidate")!==null,reloadDocument:c.headers.get("X-Remix-Reload-Document")!==null}}if(o.isRouteRequest)throw{type:l===br.error?br.error:br.data,response:c};let m,g=c.headers.get("Content-Type");return g&&/\bapplication\/json\b/.test(g)?m=await c.json():m=await c.text(),l===br.error?{type:l,error:new V6(f,c.statusText,m),headers:c.headers}:{type:br.data,data:m,statusCode:c.status,headers:c.headers}}if(l===br.error)return{type:l,error:c};if(wz(c)){var d,p;return{type:br.deferred,deferredData:c,statusCode:(d=c.init)==null?void 0:d.status,headers:((p=c.init)==null?void 0:p.headers)&&new Headers(c.init.headers)}}return{type:br.data,data:c}}function Fd(e,t,r,i){let n=e.createURL(cL(t)).toString(),s={signal:r};if(i&&ys(i.formMethod)){let{formMethod:a,formEncType:o}=i;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(i.json)):o==="text/plain"?s.body=i.text:o==="application/x-www-form-urlencoded"&&i.formData?s.body=H4(i.formData):s.body=i.formData}return new Request(n,s)}function H4(e){let t=new URLSearchParams;for(let[r,i]of e.entries())t.append(r,typeof i=="string"?i:i.name);return t}function dw(e){let t=new FormData;for(let[r,i]of e.entries())t.append(r,i);return t}function xz(e,t,r,i,n){let s={},a=null,o,l=!1,c={};return r.forEach((u,h)=>{let d=t[h].route.id;if(xt(!gu(u),"Cannot handle redirect results in processLoaderData"),Hp(u)){let p=Zh(e,d),f=u.error;i&&(f=Object.values(i)[0],i=void 0),a=a||{},a[p.route.id]==null&&(a[p.route.id]=f),s[d]=void 0,l||(l=!0,o=sL(u.error)?u.error.status:500),u.headers&&(c[d]=u.headers)}else dc(u)?(n.set(d,u.deferredData),s[d]=u.deferredData.data):s[d]=u.data,u.statusCode!=null&&u.statusCode!==200&&!l&&(o=u.statusCode),u.headers&&(c[d]=u.headers)}),i&&(a=i,s[Object.keys(i)[0]]=void 0),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:c}}function pw(e,t,r,i,n,s,a,o){let{loaderData:l,errors:c}=xz(t,r,i,n,o);for(let u=0;u<s.length;u++){let{key:h,match:d,controller:p}=s[u];xt(a!==void 0&&a[u]!==void 0,"Did not find corresponding fetcher result");let f=a[u];if(!(p&&p.signal.aborted))if(Hp(f)){let m=Zh(e.matches,d==null?void 0:d.route.id);c&&c[m.route.id]||(c=ir({},c,{[m.route.id]:f.error})),e.fetchers.delete(h)}else if(gu(f))xt(!1,"Unhandled fetcher revalidation redirect");else if(dc(f))xt(!1,"Unhandled fetcher deferred data");else{let m=Ih(f.data);e.fetchers.set(h,m)}}return{loaderData:l,errors:c}}function fw(e,t,r,i){let n=ir({},t);for(let s of r){let a=s.route.id;if(t.hasOwnProperty(a)?t[a]!==void 0&&(n[a]=t[a]):e[a]!==void 0&&s.route.loader&&(n[a]=e[a]),i&&i.hasOwnProperty(a))break}return n}function Zh(e,t){return(t?e.slice(0,e.findIndex(i=>i.route.id===t)+1):[...e]).reverse().find(i=>i.route.hasErrorBoundary===!0)||e[0]}function mw(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Un(e,t){let{pathname:r,routeId:i,method:n,type:s}=t===void 0?{}:t,a="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(a="Bad Request",n&&r&&i?o="You made a "+n+' request to "'+r+'" but '+('did not provide a `loader` for route "'+i+'", ')+"so there is no way to handle the request.":s==="defer-action"?o="defer() is not supported in actions":s==="invalid-body"&&(o="Unable to encode submission body")):e===403?(a="Forbidden",o='Route "'+i+'" does not match URL "'+r+'"'):e===404?(a="Not Found",o='No route matches URL "'+r+'"'):e===405&&(a="Method Not Allowed",n&&r&&i?o="You made a "+n.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+i+'", ')+"so there is no way to handle the request.":n&&(o='Invalid request method "'+n.toUpperCase()+'"')),new V6(e||500,a,new Error(o),!0)}function gw(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(gu(r))return{result:r,idx:t}}}function cL(e){let t=typeof e=="string"?go(e):e;return Rc(ir({},t,{hash:""}))}function bz(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function dc(e){return e.type===br.deferred}function Hp(e){return e.type===br.error}function gu(e){return(e&&e.type)===br.redirect}function wz(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function Cz(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Sz(e){return hz.has(e.toLowerCase())}function ys(e){return lz.has(e.toLowerCase())}async function vw(e,t,r,i,n,s){for(let a=0;a<r.length;a++){let o=r[a],l=t[a];if(!l)continue;let c=e.find(h=>h.route.id===l.route.id),u=c!=null&&!lL(c,l)&&(s&&s[l.route.id])!==void 0;if(dc(o)&&(n||u)){let h=i[a];xt(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await hL(o,h,n).then(d=>{d&&(r[a]=d||r[a])})}}}async function hL(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:br.data,data:e.deferredData.unwrappedData}}catch(n){return{type:br.error,error:n}}return{type:br.data,data:e.deferredData.data}}}function H6(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function _z(e,t){let{route:r,pathname:i,params:n}=e;return{id:r.id,pathname:i,params:n,data:t[r.id],handle:r.handle}}function G4(e,t){let r=typeof t=="string"?go(t).search:t.search;if(e[e.length-1].route.index&&H6(r||""))return e[e.length-1];let i=_v(e);return i[i.length-1]}function yw(e){let{formMethod:t,formAction:r,formEncType:i,text:n,formData:s,json:a}=e;if(!(!t||!r||!i)){if(n!=null)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:void 0,text:n};if(s!=null)return{formMethod:t,formAction:r,formEncType:i,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:a,text:void 0}}}function j1(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Az(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function jd(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t," _hasFetcherDoneAnything ":!0}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t," _hasFetcherDoneAnything ":!0}}function Ez(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0," _hasFetcherDoneAnything ":!0}}function Ih(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e," _hasFetcherDoneAnything ":!0}}/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ig(){return ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ig.apply(this,arguments)}const Av=oe.createContext(null),G6=oe.createContext(null),Gc=oe.createContext(null),Ev=oe.createContext(null),Ll=oe.createContext({outlet:null,matches:[],isDataRoute:!1}),uL=oe.createContext(null);function Mz(e,t){let{relative:r}=t===void 0?{}:t;n1()||xt(!1);let{basename:i,navigator:n}=oe.useContext(Gc),{hash:s,pathname:a,search:o}=W6(e,{relative:r}),l=a;return i!=="/"&&(l=a==="/"?i:$a([i,a])),n.createHref({pathname:l,search:o,hash:s})}function n1(){return oe.useContext(Ev)!=null}function Pl(){return n1()||xt(!1),oe.useContext(Ev).location}function dL(e){oe.useContext(Gc).static||oe.useLayoutEffect(e)}function Tz(){let{isDataRoute:e}=oe.useContext(Ll);return e?Vz():Lz()}function Lz(){n1()||xt(!1);let e=oe.useContext(Av),{basename:t,navigator:r}=oe.useContext(Gc),{matches:i}=oe.useContext(Ll),{pathname:n}=Pl(),s=JSON.stringify(_v(i).map(l=>l.pathnameBase)),a=oe.useRef(!1);return dL(()=>{a.current=!0}),oe.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=U6(l,JSON.parse(s),n,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:$a([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,n,e])}const Pz=oe.createContext(null);function Dz(e){let t=oe.useContext(Ll).outlet;return t&&oe.createElement(Pz.Provider,{value:e},t)}function W6(e,t){let{relative:r}=t===void 0?{}:t,{matches:i}=oe.useContext(Ll),{pathname:n}=Pl(),s=JSON.stringify(_v(i).map(a=>a.pathnameBase));return oe.useMemo(()=>U6(e,JSON.parse(s),n,r==="path"),[e,s,n,r])}function Iz(e,t,r){n1()||xt(!1);let{navigator:i}=oe.useContext(Gc),{matches:n}=oe.useContext(Ll),s=n[n.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=Pl(),c;if(t){var u;let m=typeof t=="string"?go(t):t;o==="/"||(u=m.pathname)!=null&&u.startsWith(o)||xt(!1),c=m}else c=l;let h=c.pathname||"/",d=o==="/"?h:h.slice(o.length)||"/",p=Kh(e,{pathname:d}),f=Nz(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:$a([o,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:$a([o,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),n,r);return t&&f?oe.createElement(Ev.Provider,{value:{location:ig({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Dr.Pop}},f):f}function Oz(){let e=Uz(),t=sL(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return oe.createElement(oe.Fragment,null,oe.createElement("h2",null,"Unexpected Application Error!"),oe.createElement("h3",{style:{fontStyle:"italic"}},t),r?oe.createElement("pre",{style:n},r):null,s)}const Rz=oe.createElement(Oz,null);class Bz extends oe.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?oe.createElement(Ll.Provider,{value:this.props.routeContext},oe.createElement(uL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kz(e){let{routeContext:t,match:r,children:i}=e,n=oe.useContext(Av);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),oe.createElement(Ll.Provider,{value:t},i)}function Nz(e,t,r){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var n;if((n=r)!=null&&n.errors)e=r.matches;else return null}let s=e,a=(i=r)==null?void 0:i.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||xt(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let u=l.route.id?a==null?void 0:a[l.route.id]:null,h=null;r&&(h=l.route.errorElement||Rz);let d=t.concat(s.slice(0,c+1)),p=()=>{let f;return u?f=h:l.route.Component?f=oe.createElement(l.route.Component,null):l.route.element?f=l.route.element:f=o,oe.createElement(kz,{match:l,routeContext:{outlet:o,matches:d,isDataRoute:r!=null},children:f})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?oe.createElement(Bz,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var pL=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(pL||{}),ng=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ng||{});function zz(e){let t=oe.useContext(Av);return t||xt(!1),t}function Fz(e){let t=oe.useContext(G6);return t||xt(!1),t}function jz(e){let t=oe.useContext(Ll);return t||xt(!1),t}function fL(e){let t=jz(),r=t.matches[t.matches.length-1];return r.route.id||xt(!1),r.route.id}function Uz(){var e;let t=oe.useContext(uL),r=Fz(ng.UseRouteError),i=fL(ng.UseRouteError);return t||((e=r.errors)==null?void 0:e[i])}function Vz(){let{router:e}=zz(pL.UseNavigateStable),t=fL(ng.UseNavigateStable),r=oe.useRef(!1);return dL(()=>{r.current=!0}),oe.useCallback(function(n,s){s===void 0&&(s={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,ig({fromRouteId:t},s)))},[e,t])}const Hz="startTransition",xw=MB[Hz];function Gz(e){let{fallbackElement:t,router:r,future:i}=e,[n,s]=oe.useState(r.state),{v7_startTransition:a}=i||{},o=oe.useCallback(h=>{a&&xw?xw(()=>s(h)):s(h)},[s,a]);oe.useLayoutEffect(()=>r.subscribe(o),[r,o]);let l=oe.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:h=>r.navigate(h),push:(h,d,p)=>r.navigate(h,{state:d,preventScrollReset:p==null?void 0:p.preventScrollReset}),replace:(h,d,p)=>r.navigate(h,{replace:!0,state:d,preventScrollReset:p==null?void 0:p.preventScrollReset})}),[r]),c=r.basename||"/",u=oe.useMemo(()=>({router:r,navigator:l,static:!1,basename:c}),[r,l,c]);return oe.createElement(oe.Fragment,null,oe.createElement(Av.Provider,{value:u},oe.createElement(G6.Provider,{value:n},oe.createElement(Xz,{basename:c,location:n.location,navigationType:n.historyAction,navigator:l},n.initialized?oe.createElement(Wz,{routes:r.routes,state:n}):t))),null)}function Wz(e){let{routes:t,state:r}=e;return Iz(t,void 0,r)}function qz(e){return Dz(e.context)}function Xs(e){xt(!1)}function Xz(e){let{basename:t="/",children:r=null,location:i,navigationType:n=Dr.Pop,navigator:s,static:a=!1}=e;n1()&&xt(!1);let o=t.replace(/^\/*/,"/"),l=oe.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof i=="string"&&(i=go(i));let{pathname:c="/",search:u="",hash:h="",state:d=null,key:p="default"}=i,f=oe.useMemo(()=>{let m=ld(c,o);return m==null?null:{location:{pathname:m,search:u,hash:h,state:d,key:p},navigationType:n}},[o,c,u,h,d,p,n]);return f==null?null:oe.createElement(Gc.Provider,{value:l},oe.createElement(Ev.Provider,{children:r,value:f}))}new Promise(()=>{});function W4(e,t){t===void 0&&(t=[]);let r=[];return oe.Children.forEach(e,(i,n)=>{if(!oe.isValidElement(i))return;let s=[...t,n];if(i.type===oe.Fragment){r.push.apply(r,W4(i.props.children,s));return}i.type!==Xs&&xt(!1),!i.props.index||!i.props.children||xt(!1);let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=W4(i.props.children,s)),r.push(a)}),r}function Yz(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:oe.createElement(e.Component),Component:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:oe.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Uu.apply(this,arguments)}function mL(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function Qz(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Kz(e,t){return e.button===0&&(!t||t==="_self")&&!Qz(e)}const Zz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],Jz=["aria-current","caseSensitive","className","end","style","to","children"];function $z(e,t){return mz({basename:t==null?void 0:t.basename,future:Uu({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:zN({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||eF(),routes:e,mapRouteProperties:Yz}).initialize()}function eF(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=Uu({},t,{errors:tF(t.errors)})),t}function tF(e){if(!e)return null;let t=Object.entries(e),r={};for(let[i,n]of t)if(n&&n.__type==="RouteErrorResponse")r[i]=new V6(n.status,n.statusText,n.data,n.internal===!0);else if(n&&n.__type==="Error"){if(n.__subType){let s=window[n.__subType];if(typeof s=="function")try{let a=new s(n.message);a.stack="",r[i]=a}catch{}}if(r[i]==null){let s=new Error(n.message);s.stack="",r[i]=s}}else r[i]=n;return r}const rF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wr=oe.forwardRef(function(t,r){let{onClick:i,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u}=t,h=mL(t,Zz),{basename:d}=oe.useContext(Gc),p,f=!1;if(typeof c=="string"&&iF.test(c)&&(p=c,rF))try{let y=new URL(window.location.href),x=c.startsWith("//")?new URL(y.protocol+c):new URL(c),b=ld(x.pathname,d);x.origin===y.origin&&b!=null?c=b+x.search+x.hash:f=!0}catch{}let m=Mz(c,{relative:n}),g=nF(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n});function v(y){i&&i(y),y.defaultPrevented||g(y)}return oe.createElement("a",Uu({},h,{href:p||m,onClick:f||s?i:v,ref:r,target:l}))}),xi=oe.forwardRef(function(t,r){let{"aria-current":i="page",caseSensitive:n=!1,className:s="",end:a=!1,style:o,to:l,children:c}=t,u=mL(t,Jz),h=W6(l,{relative:u.relative}),d=Pl(),p=oe.useContext(G6),{navigator:f}=oe.useContext(Gc),m=f.encodeLocation?f.encodeLocation(h).pathname:h.pathname,g=d.pathname,v=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(g=g.toLowerCase(),v=v?v.toLowerCase():null,m=m.toLowerCase());let y=g===m||!a&&g.startsWith(m)&&g.charAt(m.length)==="/",x=v!=null&&(v===m||!a&&v.startsWith(m)&&v.charAt(m.length)==="/"),b=y?i:void 0,w;typeof s=="function"?w=s({isActive:y,isPending:x}):w=[s,y?"active":null,x?"pending":null].filter(Boolean).join(" ");let C=typeof o=="function"?o({isActive:y,isPending:x}):o;return oe.createElement(wr,Uu({},u,{"aria-current":b,className:w,ref:r,style:C,to:l}),typeof c=="function"?c({isActive:y,isPending:x}):c)});var bw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(bw||(bw={}));var ww;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ww||(ww={}));function nF(e,t){let{target:r,replace:i,state:n,preventScrollReset:s,relative:a}=t===void 0?{}:t,o=Tz(),l=Pl(),c=W6(e,{relative:a});return oe.useCallback(u=>{if(Kz(u,r)){u.preventDefault();let h=i!==void 0?i:Rc(l)===Rc(c);o(e,{replace:h,state:n,preventScrollReset:s,relative:a})}},[l,o,c,i,n,r,e,s,a])}const wc=({variant:e="default",size:t="sm",backgroundColor:r="primary-300",borderColor:i="primary-300",textColor:n="white",children:s,...a})=>{const{className:o}=a,l={variant:{default:"bg-primary-300 text-background-dark ring-1 ring-primary-300",outline:"bg-transparent text-primary-300 ring-1 ring-primary-300 hover:bg-primary-300/10",underline:""},size:{xs:"text-xs py-[0.4375rem] px-[.875rem]",sm:"text-sm py-[0.5rem] px-[1rem]",md:"text-md py-[0.6875rem] px-[1.375rem]",lg:"text-lg py-[1.1875rem] px-[2.375rem]",xl:"text-xl py-[1.594rem] px-[3.188rem]"},default:"rounded-lg cursor-pointer transition-all hover:brightness-110 active:brightness-90"};return M.jsx("button",{className:`${l.variant[e]} ${l.size[t]} ${l.default} ${o||""}`,children:s})},sF=()=>{const e=oe.useRef(null),t=oe.useRef(null),[r,i]=oe.useState(!1);return oe.useEffect(()=>{window.innerWidth>640?i(!1):i(!0);const n=()=>{window.innerWidth>640?i(!1):i(!0)};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),oe.useEffect(()=>{const n=()=>{const s=document.querySelector(".navTrigger"),a=e.current,o=t.current;if(!a&&!o)return;const l=a.getBoundingClientRect(),c=s.getBoundingClientRect();if(l.bottom>=Math.floor(c.top)){if(a.classList.add("bg-background-dark"),!o)return;o.classList.add("max-w-[50rem]"),o.classList.remove("hidden")}else{if(a.classList.remove("bg-background-dark"),!o)return;o.classList.remove("max-w-[50rem]"),o.classList.add("hidden")}};window.addEventListener("scroll",()=>{n()}),n()},[]),r?M.jsx(oF,{nav:e}):M.jsx(aF,{nav:e,cta:t})},aF=({nav:e,cta:t})=>M.jsxs("div",{ref:e,className:"fixed top-0 left-0 z-50 flex items-center justify-between w-full h-16 px-10 text-xs text-white laptop:px-28",children:[M.jsx("img",{src:"./images/logo-1.png",className:"h-3/4",alt:""}),M.jsxs("div",{className:"flex items-center gap-8",children:[M.jsx(xi,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"/dmrs/",children:"Home"}),M.jsx(xi,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"australia",children:"DMRS Australia"}),M.jsx(xi,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"thailand",children:"DMRS Thailand"}),M.jsx(xi,{className:({isActive:r})=>r?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"vpn",children:"DMRS VPN"}),M.jsx(xi,{ref:t,to:"./contact",className:"hidden overflow-hidden transition-all duration-1000 max-w-0 whitespace-nowrap",children:M.jsx(wc,{size:"xs",className:"m-1",children:"Get Started"})})]})]}),oF=({nav:e})=>{const[t,r]=oe.useState(!1);return M.jsxs("div",{ref:e,className:"fixed top-0 left-0 z-50 flex w-full h-16 px-6 text-sm text-white bg-background-dark",children:[M.jsxs("div",{className:"z-50 flex items-center justify-between w-full",children:[M.jsx("img",{src:"./images/logo-1.png",className:"h-3/4",alt:""}),M.jsxs("div",{className:"flex gap-2",children:[M.jsx(xi,{to:"./contact",className:"whitespace-nowrap",children:M.jsx(wc,{size:"xs",className:"m-1",children:"Get Started"})}),M.jsx("button",{className:"text-lg",onClick:()=>{r(!t)},children:"="})]})]}),M.jsx("div",{className:`absolute top-0 left-0 z-40 pt-16 bg-background-dark text-white w-full transition-[height] ease-out duration-200 overflow-hidden ${t?"h-[100vh]":"h-0"}`,children:M.jsxs("div",{className:"flex flex-col items-center justify-center w-full gap-5 text-md",children:[M.jsx(xi,{onClick:()=>{r(!1)},className:({isActive:i})=>i?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"/dmrs/",children:"Home"}),M.jsx(xi,{onClick:()=>{r(!1)},className:({isActive:i})=>i?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"australia",children:"DMRS Australia"}),M.jsx(xi,{onClick:()=>{r(!1)},className:({isActive:i})=>i?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"thailand",children:"DMRS Thailand"}),M.jsx(xi,{onClick:()=>{r(!1)},className:({isActive:i})=>i?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"vpn",children:"DMRS VPN"})]})})]})},qo=({id:e="",name:t="",label:r="",value:i="",placeholder:n="",className:s="",onInput:a,number:o=""})=>M.jsxs("div",{className:"flex flex-col gap-1 border-t border-secondary-800/20 pt-7 pb-3",children:[M.jsxs("div",{children:[M.jsx("span",{className:"text-secondary-800/60 w-full",children:o}),M.jsx("label",{className:"text-sm relative pl-5",htmlFor:e,children:r})]}),M.jsx("input",{type:"text",id:e,name:t,value:i,placeholder:n,onInput:a,className:`py-2 ml-10 text-sm text-background-dark bg-transparent focus:outline-none placeholder:text-xs focus:bg-transparent ${s}`})]}),lF=()=>{const e=Pl(),[t,r]=oe.useState({name:"",email:"",message:""}),i=e.pathname,n=a=>{a.preventDefault()},s=a=>{const o=a.target.name;r(l=>({...l,[o]:a.target.value}))};return M.jsxs("div",{className:"flex flex-col-reverse text-white min-h-[calc(100vh-3.9rem)] bg-background-dark p-5 py-10 gap-10 z-[40] overflow-hidden laptop:flex-row",children:[M.jsxs("div",{className:"flex flex-col flex-1 gap-8",children:[M.jsx("div",{className:"items-center hidden w-1/2 laptop:flex",children:M.jsx("img",{src:"./images/logo-1.png",alt:""})}),M.jsxs("div",{className:"flex flex-col h-full gap-2",children:[M.jsx("p",{className:"text-xs text-accent-400 laptop:text-sm",children:"Navigation"}),M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"/dmrs-fe/",children:"Home"}),M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"thailand",children:"DMRS Thailand"}),M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"australia",children:"DMRS Australia"}),M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300 text-sm laptop:text-base":"text-white transition-all duration-500 hover:text-primary-300 active:brightness-90 text-sm laptop:text-base hover:bg-white/20 w-full hover:px-3",to:"vpn",children:"DMRS VPN"})]}),M.jsxs("div",{className:"flex items-end justify-between mt-10 text-xs whitespace-nowrap",children:[M.jsxs("div",{className:"flex flex-col gap-1",children:[M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"policy",children:"Privacy Policy"}),M.jsx("p",{className:"hidden",children:"|"}),M.jsx(xi,{className:({isActive:a})=>a?"text-primary-300":"text-white transition-all hover:text-primary-300 active:brightness-90",to:"terms",children:"Terms & Conditions"})]}),M.jsx("p",{children:"c 2021 Yourintell.com"})]})]}),i!="/dmrs-fe/contact"?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"min-w-[1px] w-[1px] bg-white min-h-full"}),M.jsxs("div",{className:"flex flex-col flex-1 gap-8",children:[M.jsx("div",{className:"flex items-center justify-center w-1/2 laptop:hidden",children:M.jsx("img",{src:"./images/logo-1.png",alt:""})}),M.jsxs("h2",{className:"text-xl tablet:text-3xl text-left text-white",children:["CONTACT ",M.jsx("span",{className:"text-accent-500",children:"US"})]}),M.jsxs("form",{action:"#",className:"flex flex-col gap-8 text-xs mobile:text-sm",onSubmit:n,children:[M.jsx(qo,{className:"text-background-light",label:"Name",name:"name",placeholder:"Enter your name",onInput:s,value:t.name,number:"01"}),M.jsx(qo,{className:"text-background-light",label:"Email Address",name:"email",placeholder:"Enter your email address",onInput:s,value:t.email,number:"02"}),M.jsx(qo,{className:"text-background-light",label:"What services are you looking for?",name:"services",placeholder:"Data Collection, Online Investigations, Business Intelligence",onInput:s,value:t.services,number:"03"}),M.jsx(qo,{className:"text-background-light",label:"Message",name:"message",placeholder:"Leave us a message!",onInput:s,value:t.message,number:"04"}),M.jsx(wc,{size:"sm",variant:"outline",children:M.jsx("a",{href:"mailto:test@gmail.com",children:"Send us a message!"})})]})]})]}):M.jsx(M.Fragment,{})]})},cF=({children:e})=>{const t=Pl();return oe.useEffect(()=>{window.scrollTo(0,0)},[t]),M.jsx(M.Fragment,{children:e})};function hF(){return M.jsx(cF,{children:M.jsxs("div",{className:"flex flex-col min-h-screen font-red-hat",children:[M.jsx(sF,{}),M.jsx(qz,{}),M.jsx(lF,{})]})})}const Mv=({children:e})=>M.jsxs("div",{className:"relative flex w-full min-h-screen pt-16 overflow-hidden bg-background-dark",children:[M.jsx("div",{className:"absolute top-[-150%] left-[-60%] opacity-20 z-10 bg-gradient-radial from-primary-500 via-background-dark to-background-dark h-[300%] aspect-square rounded-full"}),M.jsx("div",{className:"absolute bottom-[-150%] right-[-60%] opacity-10 z-10 bg-gradient-radial from-accent-400 via-background-dark to-background-dark h-[300%] aspect-square rounded-full"}),M.jsx(M.Fragment,{children:e})]}),U2=({children:e})=>M.jsx("div",{className:"h-fit laptop:h-[calc(100vh-4rem)]",children:e}),uF=()=>{var o;const e=oe.useRef(null),t=oe.useRef(null),r=["Intelligent Intelligence","Meaningful Investigations","Thoughtful Research"],[i,n]=oe.useState(0),s=oe.useRef(null);oe.useEffect(()=>{var l;return e.current.style.maxHeight=`${(l=t.current)==null?void 0:l.getBoundingClientRect().height}px`,a(),s.current=setTimeout(()=>{n(c=>c===r.length-1?0:c+1)},2500),()=>{}},[i]);function a(){s.current&&clearTimeout(s.current)}return M.jsx("div",{ref:e,className:"flex flex-col overflow-hidden transition-all max-h-[2.353rem] w-full laptop:w-fit",children:M.jsx("div",{className:"whitespace-nowrap flex transition-all duration-1000 ease-in-out flex-col items-start z-10",style:{transform:`translateY(${-i*`${((o=t.current)==null?void 0:o.getBoundingClientRect().height)/16}`}rem)`},children:r.map((l,c)=>M.jsx("p",{ref:t,className:"text-xs mobile:text-md",children:l},c))})})};var gL={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Cw=Kn.createContext&&Kn.createContext(gL),cl=globalThis&&globalThis.__assign||function(){return cl=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},cl.apply(this,arguments)},dF=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function vL(e){return e&&e.map(function(t,r){return Kn.createElement(t.tag,cl({key:r},t.attr),vL(t.child))})}function Dl(e){return function(t){return Kn.createElement(pF,cl({attr:cl({},e.attr)},t),vL(e.child))}}function pF(e){var t=function(r){var i=e.attr,n=e.size,s=e.title,a=dF(e,["attr","size","title"]),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Kn.createElement("svg",cl({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:cl(cl({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Kn.createElement("title",null,s),e.children)};return Cw!==void 0?Kn.createElement(Cw.Consumer,null,function(r){return t(r)}):t(gL)}function yL(e){return Dl({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 16.71875 9.59375 L 15.28125 11 L 19.28125 15 L 9 15 L 9 17 L 19.28125 17 L 15.28125 21 L 16.71875 22.40625 L 23.125 16 Z"}}]})(e)}const xL=oe.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Tv=oe.createContext({}),q6=oe.createContext(null),Lv=typeof document<"u",fF=Lv?oe.useLayoutEffect:oe.useEffect,bL=oe.createContext({strict:!1});function mF(e,t,r,i){const{visualElement:n}=oe.useContext(Tv),s=oe.useContext(bL),a=oe.useContext(q6),o=oe.useContext(xL).reducedMotion,l=oe.useRef();i=i||s.renderer,!l.current&&i&&(l.current=i(e,{visualState:t,parent:n,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;oe.useInsertionEffect(()=>{c&&c.update(r,a)});const u=oe.useRef(!!window.HandoffAppearAnimations);return fF(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),oe.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,u.current=!1)}),c}function Jh(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function gF(e,t,r){return oe.useCallback(i=>{i&&e.mount&&e.mount(i),t&&(i?t.mount(i):t.unmount()),r&&(typeof r=="function"?r(i):Jh(r)&&(r.current=i))},[t])}function Pf(e){return typeof e=="string"||Array.isArray(e)}function Pv(e){return typeof e=="object"&&typeof e.start=="function"}const X6=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Y6=["initial",...X6];function Dv(e){return Pv(e.animate)||Y6.some(t=>Pf(e[t]))}function wL(e){return!!(Dv(e)||e.variants)}function vF(e,t){if(Dv(e)){const{initial:r,animate:i}=e;return{initial:r===!1||Pf(r)?r:void 0,animate:Pf(i)?i:void 0}}return e.inherit!==!1?t:{}}function yF(e){const{initial:t,animate:r}=vF(e,oe.useContext(Tv));return oe.useMemo(()=>({initial:t,animate:r}),[Sw(t),Sw(r)])}function Sw(e){return Array.isArray(e)?e.join(" "):e}const _w={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Df={};for(const e in _w)Df[e]={isEnabled:t=>_w[e].some(r=>!!t[r])};function xF(e){for(const t in e)Df[t]={...Df[t],...e[t]}}const CL=oe.createContext({}),SL=oe.createContext({}),bF=Symbol.for("motionComponentSymbol");function wF({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:i,Component:n}){e&&xF(e);function s(o,l){let c;const u={...oe.useContext(xL),...o,layoutId:CF(o)},{isStatic:h}=u,d=yF(o),p=i(o,h);if(!h&&Lv){d.visualElement=mF(n,p,u,t);const f=oe.useContext(SL),m=oe.useContext(bL).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,m,e,f))}return oe.createElement(Tv.Provider,{value:d},c&&d.visualElement?oe.createElement(c,{visualElement:d.visualElement,...u}):null,r(n,o,gF(p,d.visualElement,l),p,h,d.visualElement))}const a=oe.forwardRef(s);return a[bF]=n,a}function CF({layoutId:e}){const t=oe.useContext(CL).id;return t&&e!==void 0?t+"-"+e:e}function SF(e){function t(i,n={}){return wF(e(i,n))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(i,n)=>(r.has(n)||r.set(n,t(n)),r.get(n))})}const _F=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Q6(e){return typeof e!="string"||e.includes("-")?!1:!!(_F.indexOf(e)>-1||/[A-Z]/.test(e))}const sg={};function AF(e){Object.assign(sg,e)}const s1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wc=new Set(s1);function _L(e,{layout:t,layoutId:r}){return Wc.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!sg[e]||e==="opacity")}const ln=e=>!!(e&&e.getVelocity),EF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},MF=s1.length;function TF(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},i,n){let s="";for(let a=0;a<MF;a++){const o=s1[a];if(e[o]!==void 0){const l=EF[o]||o;s+=`${l}(${e[o]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),n?s=n(e,i?"":s):r&&i&&(s="none"),s}const AL=e=>t=>typeof t=="string"&&t.startsWith(e),EL=AL("--"),q4=AL("var(--"),LF=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,PF=(e,t)=>t&&typeof e=="number"?t.transform(e):e,bl=(e,t,r)=>Math.min(Math.max(r,e),t),qc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Gp={...qc,transform:e=>bl(0,1,e)},U1={...qc,default:1},Wp=e=>Math.round(e*1e5)/1e5,Iv=/(-)?([\d]*\.?[\d])+/g,ML=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,DF=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function a1(e){return typeof e=="string"}const o1=e=>({test:t=>a1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ro=o1("deg"),ha=o1("%"),ot=o1("px"),IF=o1("vh"),OF=o1("vw"),Aw={...ha,parse:e=>ha.parse(e)/100,transform:e=>ha.transform(e*100)},Ew={...qc,transform:Math.round},TL={borderWidth:ot,borderTopWidth:ot,borderRightWidth:ot,borderBottomWidth:ot,borderLeftWidth:ot,borderRadius:ot,radius:ot,borderTopLeftRadius:ot,borderTopRightRadius:ot,borderBottomRightRadius:ot,borderBottomLeftRadius:ot,width:ot,maxWidth:ot,height:ot,maxHeight:ot,size:ot,top:ot,right:ot,bottom:ot,left:ot,padding:ot,paddingTop:ot,paddingRight:ot,paddingBottom:ot,paddingLeft:ot,margin:ot,marginTop:ot,marginRight:ot,marginBottom:ot,marginLeft:ot,rotate:Ro,rotateX:Ro,rotateY:Ro,rotateZ:Ro,scale:U1,scaleX:U1,scaleY:U1,scaleZ:U1,skew:Ro,skewX:Ro,skewY:Ro,distance:ot,translateX:ot,translateY:ot,translateZ:ot,x:ot,y:ot,z:ot,perspective:ot,transformPerspective:ot,opacity:Gp,originX:Aw,originY:Aw,originZ:ot,zIndex:Ew,fillOpacity:Gp,strokeOpacity:Gp,numOctaves:Ew};function K6(e,t,r,i){const{style:n,vars:s,transform:a,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const h in t){const d=t[h];if(EL(h)){s[h]=d;continue}const p=TL[h],f=PF(d,p);if(Wc.has(h)){if(l=!0,a[h]=f,!u)continue;d!==(p.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,o[h]=f):n[h]=f}if(t.transform||(l||i?n.transform=TF(e.transform,r,u,i):n.transform&&(n.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:p=0}=o;n.transformOrigin=`${h} ${d} ${p}`}}const Z6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function LL(e,t,r){for(const i in t)!ln(t[i])&&!_L(i,r)&&(e[i]=t[i])}function RF({transformTemplate:e},t,r){return oe.useMemo(()=>{const i=Z6();return K6(i,t,{enableHardwareAcceleration:!r},e),Object.assign({},i.vars,i.style)},[t])}function BF(e,t,r){const i=e.style||{},n={};return LL(n,i,e),Object.assign(n,RF(e,t,r)),e.transformValues?e.transformValues(n):n}function kF(e,t,r){const i={},n=BF(e,t,r);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=n,i}const NF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function ag(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||NF.has(e)}let PL=e=>!ag(e);function zF(e){e&&(PL=t=>t.startsWith("on")?!ag(t):e(t))}try{zF(require("@emotion/is-prop-valid").default)}catch{}function FF(e,t,r){const i={};for(const n in e)n==="values"&&typeof e.values=="object"||(PL(n)||r===!0&&ag(n)||!t&&!ag(n)||e.draggable&&n.startsWith("onDrag"))&&(i[n]=e[n]);return i}function Mw(e,t,r){return typeof e=="string"?e:ot.transform(t+r*e)}function jF(e,t,r){const i=Mw(t,e.x,e.width),n=Mw(r,e.y,e.height);return`${i} ${n}`}const UF={offset:"stroke-dashoffset",array:"stroke-dasharray"},VF={offset:"strokeDashoffset",array:"strokeDasharray"};function HF(e,t,r=1,i=0,n=!0){e.pathLength=1;const s=n?UF:VF;e[s.offset]=ot.transform(-i);const a=ot.transform(t),o=ot.transform(r);e[s.array]=`${a} ${o}`}function J6(e,{attrX:t,attrY:r,attrScale:i,originX:n,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},u,h,d){if(K6(e,c,u,d),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:f,dimensions:m}=e;p.transform&&(m&&(f.transform=p.transform),delete p.transform),m&&(n!==void 0||s!==void 0||f.transform)&&(f.transformOrigin=jF(m,n!==void 0?n:.5,s!==void 0?s:.5)),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),i!==void 0&&(p.scale=i),a!==void 0&&HF(p,a,o,l,!1)}const DL=()=>({...Z6(),attrs:{}}),$6=e=>typeof e=="string"&&e.toLowerCase()==="svg";function GF(e,t,r,i){const n=oe.useMemo(()=>{const s=DL();return J6(s,t,{enableHardwareAcceleration:!1},$6(i),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};LL(s,e.style,e),n.style={...s,...n.style}}return n}function WF(e=!1){return(r,i,n,{latestValues:s},a)=>{const l=(Q6(r)?GF:kF)(i,s,a,r),u={...FF(i,typeof r=="string",e),...l,ref:n},{children:h}=i,d=oe.useMemo(()=>ln(h)?h.get():h,[h]);return oe.createElement(r,{...u,children:d})}}const e7=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function IL(e,{style:t,vars:r},i,n){Object.assign(e.style,t,n&&n.getProjectionStyles(i));for(const s in r)e.style.setProperty(s,r[s])}const OL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function RL(e,t,r,i){IL(e,t,void 0,i);for(const n in t.attrs)e.setAttribute(OL.has(n)?n:e7(n),t.attrs[n])}function t7(e,t){const{style:r}=e,i={};for(const n in r)(ln(r[n])||t.style&&ln(t.style[n])||_L(n,e))&&(i[n]=r[n]);return i}function BL(e,t){const r=t7(e,t);for(const i in e)if(ln(e[i])||ln(t[i])){const n=s1.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[n]=e[i]}return r}function r7(e,t,r,i={},n={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,n)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,n)),t}function qF(e){const t=oe.useRef(null);return t.current===null&&(t.current=e()),t.current}const og=e=>Array.isArray(e),XF=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),YF=e=>og(e)?e[e.length-1]||0:e;function b0(e){const t=ln(e)?e.get():e;return XF(t)?t.toValue():t}function QF({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},i,n,s){const a={latestValues:KF(i,n,s,e),renderState:t()};return r&&(a.mount=o=>r(i,o,a)),a}const kL=e=>(t,r)=>{const i=oe.useContext(Tv),n=oe.useContext(q6),s=()=>QF(e,t,i,n);return r?s():qF(s)};function KF(e,t,r,i){const n={},s=i(e,{});for(const d in s)n[d]=b0(s[d]);let{initial:a,animate:o}=e;const l=Dv(e),c=wL(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||a===!1;const h=u?o:a;return h&&typeof h!="boolean"&&!Pv(h)&&(Array.isArray(h)?h:[h]).forEach(p=>{const f=r7(e,p);if(!f)return;const{transitionEnd:m,transition:g,...v}=f;for(const y in v){let x=v[y];if(Array.isArray(x)){const b=u?x.length-1:0;x=x[b]}x!==null&&(n[y]=x)}for(const y in m)n[y]=m[y]}),n}const fr=e=>e;class Tw{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function ZF(e){let t=new Tw,r=new Tw,i=0,n=!1,s=!1;const a=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const h=u&&n,d=h?t:r;return c&&a.add(l),d.add(l)&&h&&n&&(i=t.order.length),l},cancel:l=>{r.remove(l),a.delete(l)},process:l=>{if(n){s=!0;return}if(n=!0,[t,r]=[r,t],r.clear(),i=t.order.length,i)for(let c=0;c<i;c++){const u=t.order[c];u(l),a.has(u)&&(o.schedule(u),e())}n=!1,s&&(s=!1,o.process(l))}};return o}const V1=["prepare","read","update","preRender","render","postRender"],JF=40;function $F(e,t){let r=!1,i=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=V1.reduce((h,d)=>(h[d]=ZF(()=>r=!0),h),{}),a=h=>s[h].process(n),o=()=>{const h=performance.now();r=!1,n.delta=i?1e3/60:Math.max(Math.min(h-n.timestamp,JF),1),n.timestamp=h,n.isProcessing=!0,V1.forEach(a),n.isProcessing=!1,r&&t&&(i=!1,e(o))},l=()=>{r=!0,i=!0,n.isProcessing||e(o)};return{schedule:V1.reduce((h,d)=>{const p=s[d];return h[d]=(f,m=!1,g=!1)=>(r||l(),p.schedule(f,m,g)),h},{}),cancel:h=>V1.forEach(d=>s[d].cancel(h)),state:n,steps:s}}const{schedule:rr,cancel:ho,state:Zr,steps:V2}=$F(typeof requestAnimationFrame<"u"?requestAnimationFrame:fr,!0),ej={useVisualState:kL({scrapeMotionValuesFromProps:BL,createRenderState:DL,onMount:(e,t,{renderState:r,latestValues:i})=>{rr.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),rr.render(()=>{J6(r,i,{enableHardwareAcceleration:!1},$6(t.tagName),e.transformTemplate),RL(t,r)})}})},tj={useVisualState:kL({scrapeMotionValuesFromProps:t7,createRenderState:Z6})};function rj(e,{forwardMotionProps:t=!1},r,i){return{...Q6(e)?ej:tj,preloadedFeatures:r,useRender:WF(t),createVisualElement:i,Component:e}}function Qa(e,t,r,i={passive:!0}){return e.addEventListener(t,r,i),()=>e.removeEventListener(t,r)}const NL=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Ov(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const ij=e=>t=>NL(t)&&e(t,Ov(t));function eo(e,t,r,i){return Qa(e,t,ij(r),i)}const nj=(e,t)=>r=>t(e(r)),hl=(...e)=>e.reduce(nj);function zL(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const Lw=zL("dragHorizontal"),Pw=zL("dragVertical");function FL(e){let t=!1;if(e==="y")t=Pw();else if(e==="x")t=Lw();else{const r=Lw(),i=Pw();r&&i?t=()=>{r(),i()}:(r&&r(),i&&i())}return t}function jL(){const e=FL(!0);return e?(e(),!1):!0}class Il{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Dw(e,t){const r="pointer"+(t?"enter":"leave"),i="onHover"+(t?"Start":"End"),n=(s,a)=>{if(s.type==="touch"||jL())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[i]&&rr.update(()=>o[i](s,a))};return eo(e.current,r,n,{passive:!e.getProps()[i]})}class sj extends Il{mount(){this.unmount=hl(Dw(this.node,!0),Dw(this.node,!1))}unmount(){}}class aj extends Il{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hl(Qa(this.node.current,"focus",()=>this.onFocus()),Qa(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const UL=(e,t)=>t?e===t?!0:UL(e,t.parentElement):!1;function H2(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,Ov(r))}class oj extends Il{constructor(){super(...arguments),this.removeStartListeners=fr,this.removeEndListeners=fr,this.removeAccessibleListeners=fr,this.startPointerPress=(t,r)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=eo(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u}=this.node.getProps();rr.update(()=>{UL(this.node.current,o.target)?c&&c(o,l):u&&u(o,l)})},{passive:!(i.onTap||i.onPointerUp)}),a=eo(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=hl(s,a),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const a=o=>{o.key!=="Enter"||!this.checkPressEnd()||H2("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&rr.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=Qa(this.node.current,"keyup",a),H2("down",(o,l)=>{this.startPress(o,l)})},r=Qa(this.node.current,"keydown",t),i=()=>{this.isPressing&&H2("cancel",(s,a)=>this.cancelPress(s,a))},n=Qa(this.node.current,"blur",i);this.removeAccessibleListeners=hl(r,n)}}startPress(t,r){this.isPressing=!0;const{onTapStart:i,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&rr.update(()=>i(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!jL()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&rr.update(()=>i(t,r))}mount(){const t=this.node.getProps(),r=eo(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),i=Qa(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=hl(r,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const X4=new WeakMap,G2=new WeakMap,lj=e=>{const t=X4.get(e.target);t&&t(e)},cj=e=>{e.forEach(lj)};function hj({root:e,...t}){const r=e||document;G2.has(r)||G2.set(r,{});const i=G2.get(r),n=JSON.stringify(t);return i[n]||(i[n]=new IntersectionObserver(cj,{root:e,...t})),i[n]}function uj(e,t,r){const i=hj(t);return X4.set(e,r),i.observe(e),()=>{X4.delete(e),i.unobserve(e)}}const dj={some:0,all:1};class pj extends Il{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:i,amount:n="some",once:s}=t,a={root:r?r.current:void 0,rootMargin:i,threshold:typeof n=="number"?n:dj[n]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return uj(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(fj(t,r))&&this.startObserver()}unmount(){}}function fj({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const mj={inView:{Feature:pj},tap:{Feature:oj},focus:{Feature:aj},hover:{Feature:sj}};function VL(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}function gj(e){const t={};return e.values.forEach((r,i)=>t[i]=r.get()),t}function vj(e){const t={};return e.values.forEach((r,i)=>t[i]=r.getVelocity()),t}function Rv(e,t,r){const i=e.getProps();return r7(i,t,r!==void 0?r:i.custom,gj(e),vj(e))}const yj="framerAppearId",xj="data-"+e7(yj);let bj=fr,i7=fr;const ul=e=>e*1e3,to=e=>e/1e3,wj={current:!1},HL=e=>Array.isArray(e)&&typeof e[0]=="number";function GL(e){return!!(!e||typeof e=="string"&&WL[e]||HL(e)||Array.isArray(e)&&e.every(GL))}const _p=([e,t,r,i])=>`cubic-bezier(${e}, ${t}, ${r}, ${i})`,WL={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_p([0,.65,.55,1]),circOut:_p([.55,0,1,.45]),backIn:_p([.31,.01,.66,-.59]),backOut:_p([.33,1.53,.69,.99])};function qL(e){if(e)return HL(e)?_p(e):Array.isArray(e)?e.map(qL):WL[e]}function Cj(e,t,r,{delay:i=0,duration:n,repeat:s=0,repeatType:a="loop",ease:o,times:l}={}){const c={[t]:r};l&&(c.offset=l);const u=qL(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:i,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}function Sj(e,{repeat:t,repeatType:r="loop"}){const i=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[i]}const XL=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,_j=1e-7,Aj=12;function Ej(e,t,r,i,n){let s,a,o=0;do a=t+(r-t)/2,s=XL(a,i,n)-e,s>0?r=a:t=a;while(Math.abs(s)>_j&&++o<Aj);return a}function l1(e,t,r,i){if(e===t&&r===i)return fr;const n=s=>Ej(s,0,1,e,r);return s=>s===0||s===1?s:XL(n(s),t,i)}const Mj=l1(.42,0,1,1),Tj=l1(0,0,.58,1),n7=l1(.42,0,.58,1),Lj=e=>Array.isArray(e)&&typeof e[0]!="number",YL=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,QL=e=>t=>1-e(1-t),KL=e=>1-Math.sin(Math.acos(e)),s7=QL(KL),Pj=YL(s7),ZL=l1(.33,1.53,.69,.99),a7=QL(ZL),Dj=YL(a7),Ij=e=>(e*=2)<1?.5*a7(e):.5*(2-Math.pow(2,-10*(e-1))),Oj={linear:fr,easeIn:Mj,easeInOut:n7,easeOut:Tj,circIn:KL,circInOut:Pj,circOut:s7,backIn:a7,backInOut:Dj,backOut:ZL,anticipate:Ij},Iw=e=>{if(Array.isArray(e)){i7(e.length===4);const[t,r,i,n]=e;return l1(t,r,i,n)}else if(typeof e=="string")return Oj[e];return e},o7=(e,t)=>r=>!!(a1(r)&&DF.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),JL=(e,t,r)=>i=>{if(!a1(i))return i;const[n,s,a,o]=i.match(Iv);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Rj=e=>bl(0,255,e),W2={...qc,transform:e=>Math.round(Rj(e))},pc={test:o7("rgb","red"),parse:JL("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:i=1})=>"rgba("+W2.transform(e)+", "+W2.transform(t)+", "+W2.transform(r)+", "+Wp(Gp.transform(i))+")"};function Bj(e){let t="",r="",i="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),i=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),i=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,i+=i,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}const Y4={test:o7("#"),parse:Bj,transform:pc.transform},$h={test:o7("hsl","hue"),parse:JL("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:i=1})=>"hsla("+Math.round(e)+", "+ha.transform(Wp(t))+", "+ha.transform(Wp(r))+", "+Wp(Gp.transform(i))+")"},Ii={test:e=>pc.test(e)||Y4.test(e)||$h.test(e),parse:e=>pc.test(e)?pc.parse(e):$h.test(e)?$h.parse(e):Y4.parse(e),transform:e=>a1(e)?e:e.hasOwnProperty("red")?pc.transform(e):$h.transform(e)},ar=(e,t,r)=>-r*e+r*t+e;function q2(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function kj({hue:e,saturation:t,lightness:r,alpha:i}){e/=360,t/=100,r/=100;let n=0,s=0,a=0;if(!t)n=s=a=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;n=q2(l,o,e+1/3),s=q2(l,o,e),a=q2(l,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:i}}const X2=(e,t,r)=>{const i=e*e;return Math.sqrt(Math.max(0,r*(t*t-i)+i))},Nj=[Y4,pc,$h],zj=e=>Nj.find(t=>t.test(e));function Ow(e){const t=zj(e);let r=t.parse(e);return t===$h&&(r=kj(r)),r}const $L=(e,t)=>{const r=Ow(e),i=Ow(t),n={...r};return s=>(n.red=X2(r.red,i.red,s),n.green=X2(r.green,i.green,s),n.blue=X2(r.blue,i.blue,s),n.alpha=ar(r.alpha,i.alpha,s),pc.transform(n))};function Fj(e){var t,r;return isNaN(e)&&a1(e)&&(((t=e.match(Iv))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(ML))===null||r===void 0?void 0:r.length)||0)>0}const eP={regex:LF,countKey:"Vars",token:"${v}",parse:fr},tP={regex:ML,countKey:"Colors",token:"${c}",parse:Ii.parse},rP={regex:Iv,countKey:"Numbers",token:"${n}",parse:qc.parse};function Y2(e,{regex:t,countKey:r,token:i,parse:n}){const s=e.tokenised.match(t);s&&(e["num"+r]=s.length,e.tokenised=e.tokenised.replace(t,i),e.values.push(...s.map(n)))}function lg(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&Y2(r,eP),Y2(r,tP),Y2(r,rP),r}function iP(e){return lg(e).values}function nP(e){const{values:t,numColors:r,numVars:i,tokenised:n}=lg(e),s=t.length;return a=>{let o=n;for(let l=0;l<s;l++)l<i?o=o.replace(eP.token,a[l]):l<i+r?o=o.replace(tP.token,Ii.transform(a[l])):o=o.replace(rP.token,Wp(a[l]));return o}}const jj=e=>typeof e=="number"?0:e;function Uj(e){const t=iP(e);return nP(e)(t.map(jj))}const wl={test:Fj,parse:iP,createTransformer:nP,getAnimatableNone:Uj},sP=(e,t)=>r=>`${r>0?t:e}`;function aP(e,t){return typeof e=="number"?r=>ar(e,t,r):Ii.test(e)?$L(e,t):e.startsWith("var(")?sP(e,t):lP(e,t)}const oP=(e,t)=>{const r=[...e],i=r.length,n=e.map((s,a)=>aP(s,t[a]));return s=>{for(let a=0;a<i;a++)r[a]=n[a](s);return r}},Vj=(e,t)=>{const r={...e,...t},i={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(i[n]=aP(e[n],t[n]));return n=>{for(const s in i)r[s]=i[s](n);return r}},lP=(e,t)=>{const r=wl.createTransformer(t),i=lg(e),n=lg(t);return i.numVars===n.numVars&&i.numColors===n.numColors&&i.numNumbers>=n.numNumbers?hl(oP(i.values,n.values),r):sP(e,t)},If=(e,t,r)=>{const i=t-e;return i===0?1:(r-e)/i},Rw=(e,t)=>r=>ar(e,t,r);function Hj(e){return typeof e=="number"?Rw:typeof e=="string"?Ii.test(e)?$L:lP:Array.isArray(e)?oP:typeof e=="object"?Vj:Rw}function Gj(e,t,r){const i=[],n=r||Hj(e[0]),s=e.length-1;for(let a=0;a<s;a++){let o=n(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||fr:t;o=hl(l,o)}i.push(o)}return i}function cP(e,t,{clamp:r=!0,ease:i,mixer:n}={}){const s=e.length;if(i7(s===t.length),s===1)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Gj(t,i,n),o=a.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const h=If(e[u],e[u+1],c);return a[u](h)};return r?c=>l(bl(e[0],e[s-1],c)):l}function Wj(e,t){const r=e[e.length-1];for(let i=1;i<=t;i++){const n=If(0,t,i);e.push(ar(r,1,n))}}function qj(e){const t=[0];return Wj(t,e.length-1),t}function Xj(e,t){return e.map(r=>r*t)}function Yj(e,t){return e.map(()=>t||n7).splice(0,e.length-1)}function cg({duration:e=300,keyframes:t,times:r,ease:i="easeInOut"}){const n=Lj(i)?i.map(Iw):Iw(i),s={done:!1,value:t[0]},a=Xj(r&&r.length===t.length?r:qj(t),e),o=cP(a,t,{ease:Array.isArray(n)?n:Yj(t,n)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}function hP(e,t){return t?e*(1e3/t):0}const Qj=5;function uP(e,t,r){const i=Math.max(t-Qj,0);return hP(r-e(i),t-i)}const Q2=.001,Kj=.01,Bw=10,Zj=.05,Jj=1;function $j({duration:e=800,bounce:t=.25,velocity:r=0,mass:i=1}){let n,s;bj(e<=ul(Bw));let a=1-t;a=bl(Zj,Jj,a),e=bl(Kj,Bw,to(e)),a<1?(n=c=>{const u=c*a,h=u*e,d=u-r,p=Q4(c,a),f=Math.exp(-h);return Q2-d/p*f},s=c=>{const h=c*a*e,d=h*r+r,p=Math.pow(a,2)*Math.pow(c,2)*e,f=Math.exp(-h),m=Q4(Math.pow(c,2),a);return(-n(c)+Q2>0?-1:1)*((d-p)*f)/m}):(n=c=>{const u=Math.exp(-c*e),h=(c-r)*e+1;return-Q2+u*h},s=c=>{const u=Math.exp(-c*e),h=(r-c)*(e*e);return u*h});const o=5/e,l=tU(n,s,o);if(e=ul(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:a*2*Math.sqrt(i*c),duration:e}}}const eU=12;function tU(e,t,r){let i=r;for(let n=1;n<eU;n++)i=i-e(i)/t(i);return i}function Q4(e,t){return e*Math.sqrt(1-t*t)}const rU=["duration","bounce"],iU=["stiffness","damping","mass"];function kw(e,t){return t.some(r=>e[r]!==void 0)}function nU(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!kw(e,iU)&&kw(e,rU)){const r=$j(e);t={...t,...r,velocity:0,mass:1},t.isResolvedFromDuration=!0}return t}function dP({keyframes:e,restDelta:t,restSpeed:r,...i}){const n=e[0],s=e[e.length-1],a={done:!1,value:n},{stiffness:o,damping:l,mass:c,velocity:u,duration:h,isResolvedFromDuration:d}=nU(i),p=u?-to(u):0,f=l/(2*Math.sqrt(o*c)),m=s-n,g=to(Math.sqrt(o/c)),v=Math.abs(m)<5;r||(r=v?.01:2),t||(t=v?.005:.5);let y;if(f<1){const x=Q4(g,f);y=b=>{const w=Math.exp(-f*g*b);return s-w*((p+f*g*m)/x*Math.sin(x*b)+m*Math.cos(x*b))}}else if(f===1)y=x=>s-Math.exp(-g*x)*(m+(p+g*m)*x);else{const x=g*Math.sqrt(f*f-1);y=b=>{const w=Math.exp(-f*g*b),C=Math.min(x*b,300);return s-w*((p+f*g*m)*Math.sinh(C)+x*m*Math.cosh(C))/x}}return{calculatedDuration:d&&h||null,next:x=>{const b=y(x);if(d)a.done=x>=h;else{let w=p;x!==0&&(f<1?w=uP(y,x,b):w=0);const C=Math.abs(w)<=r,_=Math.abs(s-b)<=t;a.done=C&&_}return a.value=a.done?s:b,a}}}function Nw({keyframes:e,velocity:t=0,power:r=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const h=e[0],d={done:!1,value:h},p=S=>o!==void 0&&S<o||l!==void 0&&S>l,f=S=>o===void 0?l:l===void 0||Math.abs(o-S)<Math.abs(l-S)?o:l;let m=r*t;const g=h+m,v=a===void 0?g:a(g);v!==g&&(m=v-h);const y=S=>-m*Math.exp(-S/i),x=S=>v+y(S),b=S=>{const A=y(S),E=x(S);d.done=Math.abs(A)<=c,d.value=d.done?v:E};let w,C;const _=S=>{p(d.value)&&(w=S,C=dP({keyframes:[d.value,f(d.value)],velocity:uP(x,S,d.value),damping:n,stiffness:s,restDelta:c,restSpeed:u}))};return _(0),{calculatedDuration:null,next:S=>{let A=!1;return!C&&w===void 0&&(A=!0,b(S),_(S)),w!==void 0&&S>w?C.next(S-w):(!A&&b(S),d)}}}const sU=e=>{const t=({timestamp:r})=>e(r);return{start:()=>rr.update(t,!0),stop:()=>ho(t),now:()=>Zr.isProcessing?Zr.timestamp:performance.now()}},zw=2e4;function Fw(e){let t=0;const r=50;let i=e.next(t);for(;!i.done&&t<zw;)t+=r,i=e.next(t);return t>=zw?1/0:t}const aU={decay:Nw,inertia:Nw,tween:cg,keyframes:cg,spring:dP};function hg({autoplay:e=!0,delay:t=0,driver:r=sU,keyframes:i,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:h,...d}){let p=1,f=!1,m,g;const v=()=>{g=new Promise(z=>{m=z})};v();let y;const x=aU[n]||cg;let b;x!==cg&&typeof i[0]!="number"&&(b=cP([0,100],i,{clamp:!1}),i=[0,100]);const w=x({...d,keyframes:i});let C;o==="mirror"&&(C=x({...d,keyframes:[...i].reverse(),velocity:-(d.velocity||0)}));let _="idle",S=null,A=null,E=null;w.calculatedDuration===null&&s&&(w.calculatedDuration=Fw(w));const{calculatedDuration:L}=w;let P=1/0,D=1/0;L!==null&&(P=L+a,D=P*(s+1)-a);let I=0;const B=z=>{if(A===null)return;p>0&&(A=Math.min(A,z)),p<0&&(A=Math.min(z-D/p,A)),S!==null?I=S:I=Math.round(z-A)*p;const U=I-t*(p>=0?1:-1),K=p>=0?U<0:U>D;I=Math.max(U,0),_==="finished"&&S===null&&(I=D);let j=I,Y=w;if(s){const ee=I/P;let ne=Math.floor(ee),ce=ee%1;!ce&&ee>=1&&(ce=1),ce===1&&ne--,ne=Math.min(ne,s+1);const ue=!!(ne%2);ue&&(o==="reverse"?(ce=1-ce,a&&(ce-=a/P)):o==="mirror"&&(Y=C));let ye=bl(0,1,ce);I>D&&(ye=o==="reverse"&&ue?1:0),j=ye*P}const V=K?{done:!1,value:i[0]}:Y.next(j);b&&(V.value=b(V.value));let{done:ie}=V;!K&&L!==null&&(ie=p>=0?I>=D:I<=0);const $=S===null&&(_==="finished"||_==="running"&&ie);return h&&h(V.value),$&&R(),V},X=()=>{y&&y.stop(),y=void 0},H=()=>{_="idle",X(),m(),v(),A=E=null},R=()=>{_="finished",u&&u(),X(),m()},q=()=>{if(f)return;y||(y=r(B));const z=y.now();l&&l(),S!==null?A=z-S:(!A||_==="finished")&&(A=z),_==="finished"&&v(),E=A,S=null,_="running",y.start()};e&&q();const F={then(z,U){return g.then(z,U)},get time(){return to(I)},set time(z){z=ul(z),I=z,S!==null||!y||p===0?S=z:A=y.now()-z/p},get duration(){const z=w.calculatedDuration===null?Fw(w):w.calculatedDuration;return to(z)},get speed(){return p},set speed(z){z===p||!y||(p=z,F.time=to(I))},get state(){return _},play:q,pause:()=>{_="paused",S=I},stop:()=>{f=!0,_!=="idle"&&(_="idle",c&&c(),H())},cancel:()=>{E!==null&&B(E),H()},complete:()=>{_="finished"},sample:z=>(A=0,B(z))};return F}function oU(e){let t;return()=>(t===void 0&&(t=e()),t)}const lU=oU(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),cU=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),H1=10,hU=2e4,uU=(e,t)=>t.type==="spring"||e==="backgroundColor"||!GL(t.ease);function dU(e,t,{onUpdate:r,onComplete:i,...n}){if(!(lU()&&cU.has(t)&&!n.repeatDelay&&n.repeatType!=="mirror"&&n.damping!==0&&n.type!=="inertia"))return!1;let a=!1,o,l;const c=()=>{l=new Promise(y=>{o=y})};c();let{keyframes:u,duration:h=300,ease:d,times:p}=n;if(uU(t,n)){const y=hg({...n,repeat:0,delay:0});let x={done:!1,value:u[0]};const b=[];let w=0;for(;!x.done&&w<hU;)x=y.sample(w),b.push(x.value),w+=H1;p=void 0,u=b,h=w-H1,d="linear"}const f=Cj(e.owner.current,t,u,{...n,duration:h,ease:d,times:p});n.syncStart&&(f.startTime=Zr.isProcessing?Zr.timestamp:document.timeline?document.timeline.currentTime:performance.now());const m=()=>f.cancel(),g=()=>{rr.update(m),o(),c()};return f.onfinish=()=>{e.set(Sj(u,n)),i&&i(),g()},{then(y,x){return l.then(y,x)},attachTimeline(y){return f.timeline=y,f.onfinish=null,fr},get time(){return to(f.currentTime||0)},set time(y){f.currentTime=ul(y)},get speed(){return f.playbackRate},set speed(y){f.playbackRate=y},get duration(){return to(h)},play:()=>{a||(f.play(),ho(m))},pause:()=>f.pause(),stop:()=>{if(a=!0,f.playState==="idle")return;const{currentTime:y}=f;if(y){const x=hg({...n,autoplay:!1});e.setWithVelocity(x.sample(y-H1).value,x.sample(y).value,H1)}g()},complete:()=>f.finish(),cancel:g}}function pU({keyframes:e,delay:t,onUpdate:r,onComplete:i}){const n=()=>(r&&r(e[e.length-1]),i&&i(),{time:0,speed:1,duration:0,play:fr,pause:fr,stop:fr,then:s=>(s(),Promise.resolve()),cancel:fr,complete:fr});return t?hg({keyframes:[0,1],duration:0,delay:t,onComplete:n}):n()}const fU={type:"spring",stiffness:500,damping:25,restSpeed:10},mU=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),gU={type:"keyframes",duration:.8},vU={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},yU=(e,{keyframes:t})=>t.length>2?gU:Wc.has(e)?e.startsWith("scale")?mU(t[1]):fU:vU,K4=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(wl.test(t)||t==="0")&&!t.startsWith("url(")),xU=new Set(["brightness","contrast","saturate","opacity"]);function bU(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=r.match(Iv)||[];if(!i)return e;const n=r.replace(i,"");let s=xU.has(t)?1:0;return i!==r&&(s*=100),t+"("+s+n+")"}const wU=/([a-z-]*)\(.*?\)/g,Z4={...wl,getAnimatableNone:e=>{const t=e.match(wU);return t?t.map(bU).join(" "):e}},CU={...TL,color:Ii,backgroundColor:Ii,outlineColor:Ii,fill:Ii,stroke:Ii,borderColor:Ii,borderTopColor:Ii,borderRightColor:Ii,borderBottomColor:Ii,borderLeftColor:Ii,filter:Z4,WebkitFilter:Z4},l7=e=>CU[e];function pP(e,t){let r=l7(e);return r!==Z4&&(r=wl),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const fP=e=>/^0[^.\s]+$/.test(e);function SU(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||fP(e)}function _U(e,t,r,i){const n=K4(t,r);let s;Array.isArray(r)?s=[...r]:s=[null,r];const a=i.from!==void 0?i.from:e.get();let o;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?a:s[c-1]),SU(s[c])&&l.push(c),typeof s[c]=="string"&&s[c]!=="none"&&s[c]!=="0"&&(o=s[c]);if(n&&l.length&&o)for(let c=0;c<l.length;c++){const u=l[c];s[u]=pP(t,o)}return s}function AU({when:e,delay:t,delayChildren:r,staggerChildren:i,staggerDirection:n,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function mP(e,t){return e[t]||e.default||e}const c7=(e,t,r,i={})=>n=>{const s=mP(i,e)||{},a=s.delay||i.delay||0;let{elapsed:o=0}=i;o=o-ul(a);const l=_U(t,e,r,s),c=l[0],u=l[l.length-1],h=K4(e,c),d=K4(e,u);let p={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-o,onUpdate:f=>{t.set(f),s.onUpdate&&s.onUpdate(f)},onComplete:()=>{n(),s.onComplete&&s.onComplete()}};if(AU(s)||(p={...p,...yU(e,p)}),p.duration&&(p.duration=ul(p.duration)),p.repeatDelay&&(p.repeatDelay=ul(p.repeatDelay)),!h||!d||wj.current||s.type===!1)return pU(p);if(t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const f=dU(t,e,p);if(f)return f}return hg(p)};function ug(e){return!!(ln(e)&&e.add)}const gP=e=>/^\-?\d*\.?\d+$/.test(e);function h7(e,t){e.indexOf(t)===-1&&e.push(t)}function u7(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class d7{constructor(){this.subscriptions=[]}add(t){return h7(this.subscriptions,t),()=>u7(this.subscriptions,t)}notify(t,r,i){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,i);else for(let s=0;s<n;s++){const a=this.subscriptions[s];a&&a(t,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const EU=e=>!isNaN(parseFloat(e));class MU{constructor(t,r={}){this.version="10.16.4",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,n=!0)=>{this.prev=this.current,this.current=i;const{delta:s,timestamp:a}=Zr;this.lastUpdated!==a&&(this.timeDelta=s,this.lastUpdated=a,rr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>rr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=EU(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new d7);const i=this.events[t].add(r);return t==="change"?()=>{i(),rr.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,i){this.set(r),this.prev=t,this.timeDelta=i}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?hP(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Vu(e,t){return new MU(e,t)}const vP=e=>t=>t.test(e),TU={test:e=>e==="auto",parse:e=>e},yP=[qc,ot,ha,Ro,OF,IF,TU],Ud=e=>yP.find(vP(e)),LU=[...yP,Ii,wl],PU=e=>LU.find(vP(e));function DU(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Vu(r))}function IU(e,t){const r=Rv(e,t);let{transitionEnd:i={},transition:n={},...s}=r?e.makeTargetAnimatable(r,!1):{};s={...s,...i};for(const a in s){const o=YF(s[a]);DU(e,a,o)}}function OU(e,t,r){var i,n;const s=Object.keys(t).filter(o=>!e.hasValue(o)),a=s.length;if(a)for(let o=0;o<a;o++){const l=s[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(n=(i=r[l])!==null&&i!==void 0?i:e.readValue(l))!==null&&n!==void 0?n:t[l]),u!=null&&(typeof u=="string"&&(gP(u)||fP(u))?u=parseFloat(u):!PU(u)&&wl.test(c)&&(u=pP(l,c)),e.addValue(l,Vu(u,{owner:e})),r[l]===void 0&&(r[l]=u),u!==null&&e.setBaseTarget(l,u))}}function RU(e,t){return t?(t[e]||t.default||t).from:void 0}function BU(e,t,r){const i={};for(const n in e){const s=RU(n,t);if(s!==void 0)i[n]=s;else{const a=r.getValue(n);a&&(i[n]=a.get())}}return i}function kU({protectedKeys:e,needsAnimating:t},r){const i=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,i}function xP(e,t,{delay:r=0,transitionOverride:i,type:n}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");i&&(s=i);const c=[],u=n&&e.animationState&&e.animationState.getState()[n];for(const h in o){const d=e.getValue(h),p=o[h];if(!d||p===void 0||u&&kU(u,h))continue;const f={delay:r,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const g=e.getProps()[xj];g&&(f.elapsed=window.HandoffAppearAnimations(g,h,d,rr),f.syncStart=!0)}d.start(c7(h,d,p,e.shouldReduceMotion&&Wc.has(h)?{type:!1}:f));const m=d.animation;ug(l)&&(l.add(h),m.then(()=>l.remove(h))),c.push(m)}return a&&Promise.all(c).then(()=>{a&&IU(e,a)}),c}function J4(e,t,r={}){const i=Rv(e,t,r.custom);let{transition:n=e.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(n=r.transitionOverride);const s=i?()=>Promise.all(xP(e,i,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:h}=n;return NU(e,t,c+l,u,h,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[l,c]=o==="beforeChildren"?[s,a]:[a,s];return l().then(()=>c())}else return Promise.all([s(),a(r.delay)])}function NU(e,t,r=0,i=0,n=1,s){const a=[],o=(e.variantChildren.size-1)*i,l=n===1?(c=0)=>c*i:(c=0)=>o-c*i;return Array.from(e.variantChildren).sort(zU).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(J4(c,t,{...s,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function zU(e,t){return e.sortNodePosition(t)}function FU(e,t,r={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const n=t.map(s=>J4(e,s,r));i=Promise.all(n)}else if(typeof t=="string")i=J4(e,t,r);else{const n=typeof t=="function"?Rv(e,t,r.custom):t;i=Promise.all(xP(e,n,r))}return i.then(()=>e.notify("AnimationComplete",t))}const jU=[...X6].reverse(),UU=X6.length;function VU(e){return t=>Promise.all(t.map(({animation:r,options:i})=>FU(e,r,i)))}function HU(e){let t=VU(e);const r=WU();let i=!0;const n=(l,c)=>{const u=Rv(e,c);if(u){const{transition:h,transitionEnd:d,...p}=u;l={...l,...p,...d}}return l};function s(l){t=l(e)}function a(l,c){const u=e.getProps(),h=e.getVariantContext(!0)||{},d=[],p=new Set;let f={},m=1/0;for(let v=0;v<UU;v++){const y=jU[v],x=r[y],b=u[y]!==void 0?u[y]:h[y],w=Pf(b),C=y===c?x.isActive:null;C===!1&&(m=v);let _=b===h[y]&&b!==u[y]&&w;if(_&&i&&e.manuallyAnimateOnMount&&(_=!1),x.protectedKeys={...f},!x.isActive&&C===null||!b&&!x.prevProp||Pv(b)||typeof b=="boolean")continue;const S=GU(x.prevProp,b);let A=S||y===c&&x.isActive&&!_&&w||v>m&&w;const E=Array.isArray(b)?b:[b];let L=E.reduce(n,{});C===!1&&(L={});const{prevResolvedValues:P={}}=x,D={...P,...L},I=B=>{A=!0,p.delete(B),x.needsAnimating[B]=!0};for(const B in D){const X=L[B],H=P[B];f.hasOwnProperty(B)||(X!==H?og(X)&&og(H)?!VL(X,H)||S?I(B):x.protectedKeys[B]=!0:X!==void 0?I(B):p.add(B):X!==void 0&&p.has(B)?I(B):x.protectedKeys[B]=!0)}x.prevProp=b,x.prevResolvedValues=L,x.isActive&&(f={...f,...L}),i&&e.blockInitialAnimation&&(A=!1),A&&!_&&d.push(...E.map(B=>({animation:B,options:{type:y,...l}})))}if(p.size){const v={};p.forEach(y=>{const x=e.getBaseTarget(y);x!==void 0&&(v[y]=x)}),d.push({animation:v})}let g=!!d.length;return i&&u.initial===!1&&!e.manuallyAnimateOnMount&&(g=!1),i=!1,g?t(d):Promise.resolve()}function o(l,c,u){var h;if(r[l].isActive===c)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(p=>{var f;return(f=p.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),r[l].isActive=c;const d=a(u,l);for(const p in r)r[p].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>r}}function GU(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!VL(t,e):!1}function Fl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function WU(){return{animate:Fl(!0),whileInView:Fl(),whileHover:Fl(),whileTap:Fl(),whileDrag:Fl(),whileFocus:Fl(),exit:Fl()}}class qU extends Il{constructor(t){super(t),t.animationState||(t.animationState=HU(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),Pv(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let XU=0;class YU extends Il{constructor(){super(...arguments),this.id=XU++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:i}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t,{custom:i??this.node.getProps().custom});r&&!t&&s.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const QU={animation:{Feature:qU},exit:{Feature:YU}},jw=(e,t)=>Math.abs(e-t);function KU(e,t){const r=jw(e.x,t.x),i=jw(e.y,t.y);return Math.sqrt(r**2+i**2)}class bP{constructor(t,r,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=Z2(this.lastMoveEventInfo,this.history),u=this.startEvent!==null,h=KU(c.offset,{x:0,y:0})>=3;if(!u&&!h)return;const{point:d}=c,{timestamp:p}=Zr;this.history.push({...d,timestamp:p});const{onStart:f,onMove:m}=this.handlers;u||(f&&f(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,c)},this.handlePointerMove=(c,u)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=K2(u,this.transformPagePoint),rr.update(this.updatePoint,!0)},this.handlePointerUp=(c,u)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:h,onSessionEnd:d}=this.handlers,p=Z2(c.type==="pointercancel"?this.lastMoveEventInfo:K2(u,this.transformPagePoint),this.history);this.startEvent&&h&&h(c,p),d&&d(c,p)},!NL(t))return;this.handlers=r,this.transformPagePoint=i;const n=Ov(t),s=K2(n,this.transformPagePoint),{point:a}=s,{timestamp:o}=Zr;this.history=[{...a,timestamp:o}];const{onSessionStart:l}=r;l&&l(t,Z2(s,this.history)),this.removeListeners=hl(eo(window,"pointermove",this.handlePointerMove),eo(window,"pointerup",this.handlePointerUp),eo(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ho(this.updatePoint)}}function K2(e,t){return t?{point:t(e.point)}:e}function Uw(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Z2({point:e},t){return{point:e,delta:Uw(e,wP(t)),offset:Uw(e,ZU(t)),velocity:JU(t,.1)}}function ZU(e){return e[0]}function wP(e){return e[e.length-1]}function JU(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,i=null;const n=wP(e);for(;r>=0&&(i=e[r],!(n.timestamp-i.timestamp>ul(t)));)r--;if(!i)return{x:0,y:0};const s=to(n.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const a={x:(n.x-i.x)/s,y:(n.y-i.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Tn(e){return e.max-e.min}function $4(e,t=0,r=.01){return Math.abs(e-t)<=r}function Vw(e,t,r,i=.5){e.origin=i,e.originPoint=ar(t.min,t.max,e.origin),e.scale=Tn(r)/Tn(t),($4(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ar(r.min,r.max,e.origin)-e.originPoint,($4(e.translate)||isNaN(e.translate))&&(e.translate=0)}function qp(e,t,r,i){Vw(e.x,t.x,r.x,i?i.originX:void 0),Vw(e.y,t.y,r.y,i?i.originY:void 0)}function Hw(e,t,r){e.min=r.min+t.min,e.max=e.min+Tn(t)}function $U(e,t,r){Hw(e.x,t.x,r.x),Hw(e.y,t.y,r.y)}function Gw(e,t,r){e.min=t.min-r.min,e.max=e.min+Tn(t)}function Xp(e,t,r){Gw(e.x,t.x,r.x),Gw(e.y,t.y,r.y)}function eV(e,{min:t,max:r},i){return t!==void 0&&e<t?e=i?ar(t,e,i.min):Math.max(e,t):r!==void 0&&e>r&&(e=i?ar(r,e,i.max):Math.min(e,r)),e}function Ww(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function tV(e,{top:t,left:r,bottom:i,right:n}){return{x:Ww(e.x,r,n),y:Ww(e.y,t,i)}}function qw(e,t){let r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,i]=[i,r]),{min:r,max:i}}function rV(e,t){return{x:qw(e.x,t.x),y:qw(e.y,t.y)}}function iV(e,t){let r=.5;const i=Tn(e),n=Tn(t);return n>i?r=If(t.min,t.max-i,e.min):i>n&&(r=If(e.min,e.max-n,t.min)),bl(0,1,r)}function nV(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const e5=.35;function sV(e=e5){return e===!1?e=0:e===!0&&(e=e5),{x:Xw(e,"left","right"),y:Xw(e,"top","bottom")}}function Xw(e,t,r){return{min:Yw(e,t),max:Yw(e,r)}}function Yw(e,t){return typeof e=="number"?e:e[t]||0}const Qw=()=>({translate:0,scale:1,origin:0,originPoint:0}),eu=()=>({x:Qw(),y:Qw()}),Kw=()=>({min:0,max:0}),Pr=()=>({x:Kw(),y:Kw()});function Ks(e){return[e("x"),e("y")]}function CP({top:e,left:t,right:r,bottom:i}){return{x:{min:t,max:r},y:{min:e,max:i}}}function aV({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function oV(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}function J2(e){return e===void 0||e===1}function t5({scale:e,scaleX:t,scaleY:r}){return!J2(e)||!J2(t)||!J2(r)}function Zl(e){return t5(e)||SP(e)||e.z||e.rotate||e.rotateX||e.rotateY}function SP(e){return Zw(e.x)||Zw(e.y)}function Zw(e){return e&&e!=="0%"}function dg(e,t,r){const i=e-r,n=t*i;return r+n}function Jw(e,t,r,i,n){return n!==void 0&&(e=dg(e,n,i)),dg(e,r,i)+t}function r5(e,t=0,r=1,i,n){e.min=Jw(e.min,t,r,i,n),e.max=Jw(e.max,t,r,i,n)}function _P(e,{x:t,y:r}){r5(e.x,t.translate,t.scale,t.originPoint),r5(e.y,r.translate,r.scale,r.originPoint)}function lV(e,t,r,i=!1){const n=r.length;if(!n)return;t.x=t.y=1;let s,a;for(let o=0;o<n;o++){s=r[o],a=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&tu(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,_P(e,a)),i&&Zl(s.latestValues)&&tu(e,s.latestValues))}t.x=$w(t.x),t.y=$w(t.y)}function $w(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function No(e,t){e.min=e.min+t,e.max=e.max+t}function e9(e,t,[r,i,n]){const s=t[n]!==void 0?t[n]:.5,a=ar(e.min,e.max,s);r5(e,t[r],t[i],a,t.scale)}const cV=["x","scaleX","originX"],hV=["y","scaleY","originY"];function tu(e,t){e9(e.x,t,cV),e9(e.y,t,hV)}function AP(e,t){return CP(oV(e.getBoundingClientRect(),t))}function uV(e,t,r){const i=AP(e,r),{scroll:n}=t;return n&&(No(i.x,n.offset.x),No(i.y,n.offset.y)),i}const dV=new WeakMap;class pV{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pr(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const n=l=>{this.stopAnimation(),r&&this.snapToCursor(Ov(l,"page").point)},s=(l,c)=>{const{drag:u,dragPropagation:h,onDragStart:d}=this.getProps();if(u&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=FL(u),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ks(f=>{let m=this.getAxisMotionValue(f).get()||0;if(ha.test(m)){const{projection:g}=this.visualElement;if(g&&g.layout){const v=g.layout.layoutBox[f];v&&(m=Tn(v)*(parseFloat(m)/100))}}this.originPoint[f]=m}),d&&rr.update(()=>d(l,c),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},a=(l,c)=>{const{dragPropagation:u,dragDirectionLock:h,onDirectionLock:d,onDrag:p}=this.getProps();if(!u&&!this.openGlobalLock)return;const{offset:f}=c;if(h&&this.currentDirection===null){this.currentDirection=fV(f),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,f),this.updateAxis("y",c.point,f),this.visualElement.render(),p&&p(l,c)},o=(l,c)=>this.stop(l,c);this.panSession=new bP(t,{onSessionStart:n,onStart:s,onMove:a,onSessionEnd:o},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,r){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:n}=r;this.startAnimation(n);const{onDragEnd:s}=this.getProps();s&&rr.update(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,i){const{drag:n}=this.getProps();if(!i||!G1(t,n,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(a=eV(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),{layout:i}=this.visualElement.projection||{},n=this.constraints;t&&Jh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=tV(i.layoutBox,t):this.constraints=!1,this.elastic=sV(r),n!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ks(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=nV(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Jh(t))return!1;const i=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const s=uV(i,n.root,this.visualElement.getTransformPagePoint());let a=rV(n.layout.layoutBox,s);if(r){const o=r(aV(a));this.hasMutatedConstraints=!!o,o&&(a=CP(o))}return a}startAnimation(t){const{drag:r,dragMomentum:i,dragElastic:n,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ks(u=>{if(!G1(u,r,this.currentDirection))return;let h=l&&l[u]||{};a&&(h={min:0,max:0});const d=n?200:1e6,p=n?40:1e7,f={type:"inertia",velocity:i?t[u]:0,bounceStiffness:d,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,f)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const i=this.getAxisMotionValue(t);return i.start(c7(t,i,0,r))}stopAnimation(){Ks(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),i=this.visualElement.getProps(),n=i[r];return n||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Ks(r=>{const{drag:i}=this.getProps();if(!G1(r,i,this.currentDirection))return;const{projection:n}=this.visualElement,s=this.getAxisMotionValue(r);if(n&&n.layout){const{min:a,max:o}=n.layout.layoutBox[r];s.set(t[r]-ar(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:i}=this.visualElement;if(!Jh(r)||!i||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Ks(a=>{const o=this.getAxisMotionValue(a);if(o){const l=o.get();n[a]=iV({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Ks(a=>{if(!G1(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(ar(l,c,n[a]))})}addListeners(){if(!this.visualElement.current)return;dV.set(this.visualElement,this);const t=this.visualElement.current,r=eo(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Jh(l)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,s=n.addEventListener("measure",i);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),i();const a=Qa(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ks(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),r(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:i=!1,dragPropagation:n=!1,dragConstraints:s=!1,dragElastic:a=e5,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:i,dragPropagation:n,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function G1(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function fV(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class mV extends Il{constructor(t){super(t),this.removeGroupControls=fr,this.removeListeners=fr,this.controls=new pV(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fr}unmount(){this.removeGroupControls(),this.removeListeners()}}const t9=e=>(t,r)=>{e&&rr.update(()=>e(t,r))};class gV extends Il{constructor(){super(...arguments),this.removePointerDownListener=fr}onPointerDown(t){this.session=new bP(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:i,onPanEnd:n}=this.node.getProps();return{onSessionStart:t9(t),onStart:t9(r),onMove:i,onEnd:(s,a)=>{delete this.session,n&&rr.update(()=>n(s,a))}}}mount(){this.removePointerDownListener=eo(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function vV(){const e=oe.useContext(q6);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,n=oe.useId();return oe.useEffect(()=>i(n),[]),!t&&r?[!1,()=>r&&r(n)]:[!0]}const w0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function r9(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Vd={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ot.test(e))e=parseFloat(e);else return e;const r=r9(e,t.target.x),i=r9(e,t.target.y);return`${r}% ${i}%`}},yV={correct:(e,{treeScale:t,projectionDelta:r})=>{const i=e,n=wl.parse(e);if(n.length>5)return i;const s=wl.createTransformer(e),a=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;n[0+a]/=o,n[1+a]/=l;const c=ar(o,l,.5);return typeof n[2+a]=="number"&&(n[2+a]/=c),typeof n[3+a]=="number"&&(n[3+a]/=c),s(n)}};class xV extends Kn.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i,layoutId:n}=this.props,{projection:s}=t;AF(bV),s&&(r.group&&r.group.add(s),i&&i.register&&n&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),w0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:i,drag:n,isPresent:s}=this.props,a=i.projection;return a&&(a.isPresent=s,n||t.layoutDependency!==r||r===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||rr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),i&&i.deregister&&i.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function EP(e){const[t,r]=vV(),i=oe.useContext(CL);return Kn.createElement(xV,{...e,layoutGroup:i,switchLayoutGroup:oe.useContext(SL),isPresent:t,safeToRemove:r})}const bV={borderRadius:{...Vd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Vd,borderTopRightRadius:Vd,borderBottomLeftRadius:Vd,borderBottomRightRadius:Vd,boxShadow:yV},MP=["TopLeft","TopRight","BottomLeft","BottomRight"],wV=MP.length,i9=e=>typeof e=="string"?parseFloat(e):e,n9=e=>typeof e=="number"||ot.test(e);function CV(e,t,r,i,n,s){n?(e.opacity=ar(0,r.opacity!==void 0?r.opacity:1,SV(i)),e.opacityExit=ar(t.opacity!==void 0?t.opacity:1,0,_V(i))):s&&(e.opacity=ar(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,i));for(let a=0;a<wV;a++){const o=`border${MP[a]}Radius`;let l=s9(t,o),c=s9(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||n9(l)===n9(c)?(e[o]=Math.max(ar(i9(l),i9(c),i),0),(ha.test(c)||ha.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=ar(t.rotate||0,r.rotate||0,i))}function s9(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const SV=TP(0,.5,s7),_V=TP(.5,.95,fr);function TP(e,t,r){return i=>i<e?0:i>t?1:r(If(e,t,i))}function a9(e,t){e.min=t.min,e.max=t.max}function On(e,t){a9(e.x,t.x),a9(e.y,t.y)}function o9(e,t,r,i,n){return e-=t,e=dg(e,1/r,i),n!==void 0&&(e=dg(e,1/n,i)),e}function AV(e,t=0,r=1,i=.5,n,s=e,a=e){if(ha.test(t)&&(t=parseFloat(t),t=ar(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=ar(s.min,s.max,i);e===s&&(o-=t),e.min=o9(e.min,t,r,o,n),e.max=o9(e.max,t,r,o,n)}function l9(e,t,[r,i,n],s,a){AV(e,t[r],t[i],t[n],t.scale,s,a)}const EV=["x","scaleX","originX"],MV=["y","scaleY","originY"];function c9(e,t,r,i){l9(e.x,t,EV,r?r.x:void 0,i?i.x:void 0),l9(e.y,t,MV,r?r.y:void 0,i?i.y:void 0)}function h9(e){return e.translate===0&&e.scale===1}function LP(e){return h9(e.x)&&h9(e.y)}function TV(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function PP(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function u9(e){return Tn(e.x)/Tn(e.y)}class LV{constructor(){this.members=[]}add(t){h7(this.members,t),t.scheduleRender()}remove(t){if(u7(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let i;for(let n=r;n>=0;n--){const s=this.members[n];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,r){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,r&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:i}=t;r.onExitComplete&&r.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function d9(e,t,r){let i="";const n=e.x.translate/t.x,s=e.y.translate/t.y;if((n||s)&&(i=`translate3d(${n}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:l,rotateX:c,rotateY:u}=r;l&&(i+=`rotate(${l}deg) `),c&&(i+=`rotateX(${c}deg) `),u&&(i+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,o=e.y.scale*t.y;return(a!==1||o!==1)&&(i+=`scale(${a}, ${o})`),i||"none"}const PV=(e,t)=>e.depth-t.depth;class DV{constructor(){this.children=[],this.isDirty=!1}add(t){h7(this.children,t),this.isDirty=!0}remove(t){u7(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(PV),this.isDirty=!1,this.children.forEach(t)}}function IV(e,t){const r=performance.now(),i=({timestamp:n})=>{const s=n-r;s>=t&&(ho(i),e(s-t))};return rr.read(i,!0),()=>ho(i)}function OV(e){window.MotionDebug&&window.MotionDebug.record(e)}function RV(e){return e instanceof SVGElement&&e.tagName!=="svg"}function BV(e,t,r){const i=ln(e)?e:Vu(e);return i.start(c7("",i,t,r)),i.animation}const p9=["","X","Y","Z"],f9=1e3;let kV=0;const Jl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function DP({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:i,resetTransform:n}){return class{constructor(a={},o=t==null?void 0:t()){this.id=kV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Jl.totalNodes=Jl.resolvedTargetDeltas=Jl.recalculatedProjection=0,this.nodes.forEach(FV),this.nodes.forEach(GV),this.nodes.forEach(WV),this.nodes.forEach(jV),OV(Jl)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new DV)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new d7),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=RV(a),this.instance=a;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let h;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=IV(d,250),w0.hasAnimatedSinceResize&&(w0.hasAnimatedSinceResize=!1,this.nodes.forEach(g9))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:p,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||KV,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=u.getProps(),y=!this.targetLayout||!PP(this.targetLayout,f)||p,x=!d&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,x);const b={...mP(m,"layout"),onPlay:g,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else d||g9(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ho(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qV),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(m9);return}this.isUpdating||this.nodes.forEach(VV),this.isUpdating=!1,this.nodes.forEach(HV),this.nodes.forEach(NV),this.nodes.forEach(zV),this.clearAllSnapshots();const o=performance.now();Zr.delta=bl(0,1e3/60,o-Zr.timestamp),Zr.timestamp=o,Zr.isProcessing=!0,V2.update.process(Zr),V2.preRender.process(Zr),V2.render.process(Zr),Zr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(UV),this.sharedNodes.forEach(XV)}scheduleUpdateProjection(){rr.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){rr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Pr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!n)return;const a=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!LP(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&(o||Zl(this.latestValues)||u)&&(n(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),ZV(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return Pr();const o=a.measureViewportBox(),{scroll:l}=this.root;return l&&(No(o.x,l.offset.x),No(o.y,l.offset.y)),o}removeElementScroll(a){const o=Pr();On(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;if(c!==this.root&&u&&h.layoutScroll){if(u.isRoot){On(o,a);const{scroll:d}=this.root;d&&(No(o.x,-d.offset.x),No(o.y,-d.offset.y))}No(o.x,u.offset.x),No(o.y,u.offset.y)}}return o}applyTransform(a,o=!1){const l=Pr();On(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&tu(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Zl(u.latestValues)&&tu(l,u.latestValues)}return Zl(this.latestValues)&&tu(l,this.latestValues),l}removeTransform(a){const o=Pr();On(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Zl(c.latestValues))continue;t5(c.latestValues)&&c.updateSnapshot();const u=Pr(),h=c.measurePageBox();On(u,h),c9(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Zl(this.latestValues)&&c9(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Zr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Zr.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pr(),this.relativeTargetOrigin=Pr(),Xp(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),On(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Pr(),this.targetWithTransforms=Pr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),$U(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):On(this.target,this.layout.layoutBox),_P(this.target,this.targetDelta)):On(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pr(),this.relativeTargetOrigin=Pr(),Xp(this.relativeTargetOrigin,this.target,p.target),On(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Jl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||t5(this.parent.latestValues)||SP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Zr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;On(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,p=this.treeScale.y;lV(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:f}=o;if(!f){this.projectionTransform&&(this.projectionDelta=eu(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=eu(),this.projectionDeltaWithTransform=eu());const m=this.projectionTransform;qp(this.projectionDelta,this.layoutCorrected,f,this.latestValues),this.projectionTransform=d9(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==d||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f)),Jl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=eu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=Pr(),p=l?l.source:void 0,f=this.layout?this.layout.source:void 0,m=p!==f,g=this.getStack(),v=!g||g.members.length<=1,y=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(QV));this.animationProgress=0;let x;this.mixTargetDelta=b=>{const w=b/1e3;v9(h.x,a.x,w),v9(h.y,a.y,w),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Xp(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),YV(this.relativeTarget,this.relativeTargetOrigin,d,w),x&&TV(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=Pr()),On(x,this.relativeTarget)),m&&(this.animationValues=u,CV(u,c,this.latestValues,w,y,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ho(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=rr.update(()=>{w0.hasAnimatedSinceResize=!0,this.currentAnimation=BV(0,f9,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(f9),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&IP(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Pr();const h=Tn(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=Tn(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}On(o,l),tu(o,u),qp(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new LV),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<p9.length;u++){const h="rotate"+p9[u];l[h]&&(c[h]=l[h],a.setStaticValue(h,0))}a.render();for(const u in c)a.setStaticValue(u,c[u]);a.scheduleRender()}getProjectionStyles(a={}){var o,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=b0(a.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=b0(a.pointerEvents)||""),this.hasProjected&&!Zl(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=d9(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:p,y:f}=this.projectionDelta;c.transformOrigin=`${p.origin*100}% ${f.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(o=d.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in sg){if(d[m]===void 0)continue;const{correct:g,applyTo:v}=sg[m],y=c.transform==="none"?d[m]:g(d[m],h);if(v){const x=v.length;for(let b=0;b<x;b++)c[v[b]]=y}else c[m]=y}return this.options.layoutId&&(c.pointerEvents=h===this?b0(a.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(m9),this.root.sharedNodes.clear()}}}function NV(e){e.updateLayout()}function zV(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:n}=e.layout,{animationType:s}=e.options,a=r.source!==e.layout.source;s==="size"?Ks(h=>{const d=a?r.measuredBox[h]:r.layoutBox[h],p=Tn(d);d.min=i[h].min,d.max=d.min+p}):IP(s,r.layoutBox,i)&&Ks(h=>{const d=a?r.measuredBox[h]:r.layoutBox[h],p=Tn(i[h]);d.max=d.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+p)});const o=eu();qp(o,i,r.layoutBox);const l=eu();a?qp(l,e.applyTransform(n,!0),r.measuredBox):qp(l,i,r.layoutBox);const c=!LP(o);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:p}=h;if(d&&p){const f=Pr();Xp(f,r.layoutBox,d.layoutBox);const m=Pr();Xp(m,i,p.layoutBox),PP(f,m)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=f,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:r,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function FV(e){Jl.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function jV(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function UV(e){e.clearSnapshot()}function m9(e){e.clearMeasurements()}function VV(e){e.isLayoutDirty=!1}function HV(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function g9(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function GV(e){e.resolveTargetDelta()}function WV(e){e.calcProjection()}function qV(e){e.resetRotation()}function XV(e){e.removeLeadSnapshot()}function v9(e,t,r){e.translate=ar(t.translate,0,r),e.scale=ar(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function y9(e,t,r,i){e.min=ar(t.min,r.min,i),e.max=ar(t.max,r.max,i)}function YV(e,t,r,i){y9(e.x,t.x,r.x,i),y9(e.y,t.y,r.y,i)}function QV(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const KV={duration:.45,ease:[.4,0,.1,1]},x9=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),b9=x9("applewebkit/")&&!x9("chrome/")?Math.round:fr;function w9(e){e.min=b9(e.min),e.max=b9(e.max)}function ZV(e){w9(e.x),w9(e.y)}function IP(e,t,r){return e==="position"||e==="preserve-aspect"&&!$4(u9(t),u9(r),.2)}const JV=DP({attachResizeListener:(e,t)=>Qa(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),$2={current:void 0},OP=DP({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!$2.current){const e=new JV({});e.mount(window),e.setOptions({layoutScroll:!0}),$2.current=e}return $2.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),$V={pan:{Feature:gV},drag:{Feature:mV,ProjectionNode:OP,MeasureLayout:EP}},eH=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function tH(e){const t=eH.exec(e);if(!t)return[,];const[,r,i]=t;return[r,i]}function i5(e,t,r=1){const[i,n]=tH(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const a=s.trim();return gP(a)?parseFloat(a):a}else return q4(n)?i5(n,t,r+1):n}function rH(e,{...t},r){const i=e.current;if(!(i instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(n=>{const s=n.get();if(!q4(s))return;const a=i5(s,i);a&&n.set(a)});for(const n in t){const s=t[n];if(!q4(s))continue;const a=i5(s,i);a&&(t[n]=a,r||(r={}),r[n]===void 0&&(r[n]=s))}return{target:t,transitionEnd:r}}const iH=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),RP=e=>iH.has(e),nH=e=>Object.keys(e).some(RP),C9=e=>e===qc||e===ot,S9=(e,t)=>parseFloat(e.split(", ")[t]),_9=(e,t)=>(r,{transform:i})=>{if(i==="none"||!i)return 0;const n=i.match(/^matrix3d\((.+)\)$/);if(n)return S9(n[1],t);{const s=i.match(/^matrix\((.+)\)$/);return s?S9(s[1],e):0}},sH=new Set(["x","y","z"]),aH=s1.filter(e=>!sH.has(e));function oH(e){const t=[];return aH.forEach(r=>{const i=e.getValue(r);i!==void 0&&(t.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Hu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:_9(4,13),y:_9(5,14)};Hu.translateX=Hu.x;Hu.translateY=Hu.y;const lH=(e,t,r)=>{const i=t.measureViewportBox(),n=t.current,s=getComputedStyle(n),{display:a}=s,o={};a==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(c=>{o[c]=Hu[c](i,s)}),t.render();const l=t.measureViewportBox();return r.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=Hu[c](l,s)}),e},cH=(e,t,r={},i={})=>{t={...t},i={...i};const n=Object.keys(t).filter(RP);let s=[],a=!1;const o=[];if(n.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=r[l],h=Ud(u);const d=t[l];let p;if(og(d)){const f=d.length,m=d[0]===null?1:0;u=d[m],h=Ud(u);for(let g=m;g<f&&d[g]!==null;g++)p?i7(Ud(d[g])===p):p=Ud(d[g])}else p=Ud(d);if(h!==p)if(C9(h)&&C9(p)){const f=c.get();typeof f=="string"&&c.set(parseFloat(f)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===ot&&(t[l]=d.map(parseFloat))}else h!=null&&h.transform&&(p!=null&&p.transform)&&(u===0||d===0)?u===0?c.set(p.transform(u)):t[l]=h.transform(d):(a||(s=oH(e),a=!0),o.push(l),i[l]=i[l]!==void 0?i[l]:t[l],c.jump(d))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=lH(t,e,o);return s.length&&s.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),Lv&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:i}}else return{target:t,transitionEnd:i}};function hH(e,t,r,i){return nH(t)?cH(e,t,r,i):{target:t,transitionEnd:i}}const uH=(e,t,r,i)=>{const n=rH(e,t,i);return t=n.target,i=n.transitionEnd,hH(e,t,r,i)},n5={current:null},BP={current:!1};function dH(){if(BP.current=!0,!!Lv)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>n5.current=e.matches;e.addListener(t),t()}else n5.current=!1}function pH(e,t,r){const{willChange:i}=t;for(const n in t){const s=t[n],a=r[n];if(ln(s))e.addValue(n,s),ug(i)&&i.add(n);else if(ln(a))e.addValue(n,Vu(s,{owner:e})),ug(i)&&i.remove(n);else if(a!==s)if(e.hasValue(n)){const o=e.getValue(n);!o.hasAnimated&&o.set(s)}else{const o=e.getStaticValue(n);e.addValue(n,Vu(o!==void 0?o:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const A9=new WeakMap,kP=Object.keys(Df),fH=kP.length,E9=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],mH=Y6.length;class gH{constructor({parent:t,props:r,presenceContext:i,reducedMotionConfig:n,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>rr.render(this.render,!1,!0);const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=r,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=a,this.isControllingVariants=Dv(r),this.isVariantNode=wL(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(r,{});for(const h in u){const d=u[h];o[h]!==void 0&&ln(d)&&(d.set(o[h],!1),ug(c)&&c.add(h))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,A9.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),BP.current||dH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:n5.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){A9.delete(this.current),this.projection&&this.projection.unmount(),ho(this.notifyUpdate),ho(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const i=Wc.has(t),n=r.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&rr.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{n(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},i,n,s){let a,o;for(let l=0;l<fH;l++){const c=kP[l],{isEnabled:u,Feature:h,ProjectionNode:d,MeasureLayout:p}=Df[c];d&&(a=d),u(r)&&(!this.features[c]&&h&&(this.features[c]=new h(this)),p&&(o=p))}if(!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:h,layoutScroll:d,layoutRoot:p}=r;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||h&&Jh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:p})}return o}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<E9.length;i++){const n=E9[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const s=t["on"+n];s&&(this.propEventSubscriptions[n]=this.on(n,s))}this.prevMotionValues=pH(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const r={};for(let i=0;i<mH;i++){const n=Y6[i],s=this.props[n];(Pf(s)||s===!1)&&(r[n]=s)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&r!==void 0&&(i=Vu(r,{owner:this}),this.addValue(t,i)),i}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:i}=this.props,n=typeof i=="string"||typeof i=="object"?(r=r7(this.props,i))===null||r===void 0?void 0:r[t]:void 0;if(i&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!ln(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new d7),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class NP extends gH{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:i}){delete r[t],delete i[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...i},{transformValues:n},s){let a=BU(i,t||{},this);if(n&&(r&&(r=n(r)),i&&(i=n(i)),a&&(a=n(a))),s){OU(this,i,a);const o=uH(this,i,a,r);r=o.transitionEnd,i=o.target}return{transition:t,transitionEnd:r,...i}}}function vH(e){return window.getComputedStyle(e)}class yH extends NP{readValueFromInstance(t,r){if(Wc.has(r)){const i=l7(r);return i&&i.default||0}else{const i=vH(t),n=(EL(r)?i.getPropertyValue(r):i[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:r}){return AP(t,r)}build(t,r,i,n){K6(t,r,i,n.transformTemplate)}scrapeMotionValuesFromProps(t,r){return t7(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ln(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,i,n){IL(t,r,i,n)}}class xH extends NP{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Wc.has(r)){const i=l7(r);return i&&i.default||0}return r=OL.has(r)?r:e7(r),t.getAttribute(r)}measureInstanceViewportBox(){return Pr()}scrapeMotionValuesFromProps(t,r){return BL(t,r)}build(t,r,i,n){J6(t,r,i,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,i,n){RL(t,r,i,n)}mount(t){this.isSVGTag=$6(t.tagName),super.mount(t)}}const bH=(e,t)=>Q6(e)?new xH(t,{enableHardwareAcceleration:!1}):new yH(t,{enableHardwareAcceleration:!0}),wH={layout:{ProjectionNode:OP,MeasureLayout:EP}},CH={...QU,...mj,...$V,...wH},We=SF((e,t)=>rj(e,t,CH,bH)),SH={initial:{opacity:0,x:-20},inview:{opacity:1,x:0}},_H=({children:e,content:t,parentHover:r,active:i,handleSelectActive:n,className:s=null,index:a})=>M.jsxs(We.div,{variants:SH,onClick:()=>n(t),className:`hover:pl-7 hover:grayscale-0 hover:opacity-100 hover:text-primary-300 hover:bg-black/5 text-background-dark gap-2 flex flex-col px-4 py-4 cursor-pointer transition-all duration-500 ${i?"pl-7 border-accent-400 text-accent-400":r?"grayscale text-background-dark opacity-50":"grayscale-0 text-background-dark opacity-100 border-black/20 "}`,children:[M.jsxs("div",{className:"flex items-center justify-between w-full",children:[M.jsx("h2",{className:`transition-[font-size] ${i?"text-sm desktop:text-base text-accent-400 font-medium pr-4 hd:text-md":"desktop:text-base hd:text-md"}`,children:t.name}),M.jsx(yL,{size:32,className:`transition-[transform] duration-700 ease-in-out ${i?"rotate-[90deg] text-accent-400":"rotate-0"}`})]}),M.jsx("div",{className:`overflow-hidden text-xs desktop:text-sm hd:text-base duration-1000 text-background-dark transition-[max-height] ease-in-out ${i?"max-h-[50rem]":"max-h-0"}`,children:t.content})]}),AH={initial:{transition:{staggerChildren:.07,delayChildren:.02}},inview:{transition:{staggerChildren:.1,ease:"easeOut"}}},EH=()=>{const e=[{name:"Cyber Monitoring",content:"Cyber product monitoring by trained intelligence analysts"},{name:"Global Investigations",content:"Worldwide Intellectual Property investigations"},{name:"Undercover Operations",content:"Undercover operations worldwide"},{name:"Business Intelligence Background",content:"Business Intelligence background checks"},{name:"Research",content:"Thoughtful Online Research"},{name:"Risk Assessment",content:"Risk Management assessments"},{name:"Anonymous Hosting",content:"Anonymous domain name registration and hosting services"},{name:"VPN Access",content:"Anonymous VPN internet access for our clients and the industry"},{name:"Security Assessments",content:"Enhancing protective measures systematically."}],[t,r]=oe.useState(!1),[i,n]=oe.useState(e[0]),s=a=>{if(a.name===i.name)return;const o=e.findIndex(l=>l.name==a.name);n(e[o])};return M.jsx("div",{className:"z-10 flex-1",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:M.jsx(We.div,{variants:AH,initial:"initial",whileInView:"inview",className:"flex flex-col",children:e.map((a,o)=>M.jsx(_H,{index:o,content:a,parentHover:t,active:a.name==(i==null?void 0:i.name),handleSelectActive:s},o))})})},zP=({cellCount:e=0,cellClass:t})=>new Array(e).fill(null).map((i,n)=>M.jsx("div",{className:t},n)),Bv=()=>{function e(i){i.classList.contains("active")||!i||(i.classList.add("fill"),setTimeout(()=>{i.classList.remove("fill")},Math.random()*2*5e3))}const t=new Array(28),r=oe.useRef([]);return oe.useEffect(()=>{const i=setInterval(()=>{const n=r.current[Math.floor(Math.random()*25)];e(n)},5e3);return()=>clearInterval(i)},[]),M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"absolute w-full h-full bg-gradient-radial from-background-dark/20 to-background-dark z-[2]"}),M.jsx("div",{className:"absolute top-0 left-0 grid w-full h-full grid-cols-7 z-[1] ",children:t.fill(null).map((i,n)=>M.jsx("div",{ref:s=>r.current[n]=s,className:"block border border-background-light/5"},n))})]})},ey=({children:e,...t})=>{const{imageUrl:r,title:i,titleSpan:n,spanColor:s,description:a,linkTitle:o,linkTo:l}=t;return M.jsx(M.Fragment,{children:M.jsxs("div",{className:"relative flex flex-col justify-center h-full",children:[r&&M.jsx(We.img,{initial:{opacity:0,x:105},whileInView:{opacity:1,x:0},transition:{duration:1},viewport:{once:!0,margin:"-20px"},src:r,alt:"",className:"absolute top-[-25%] right-[-25%] h-full brightness-90 tablet:right-0 tablet:h-[15rem] laptop:top-[0%] laptop:right-[100%] laptop:h-3/4"}),M.jsx(We.div,{initial:{opacity:0,x:-75},whileInView:{opacity:1,x:0},transition:{duration:.5},viewport:{once:!0,margin:"-20px"},className:"z-10 flex flex-col justify-center h-full gap-5",children:e})]})})},MH="modulepreload",TH=function(e){return"/dmrs/"+e},M9={},c1=function(t,r,i){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=TH(s),s in M9)return;M9[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!i)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===s&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":MH,a||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),a)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var LH=Object.create,p7=Object.defineProperty,PH=Object.getOwnPropertyDescriptor,DH=Object.getOwnPropertyNames,IH=Object.getPrototypeOf,OH=Object.prototype.hasOwnProperty,cd=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),RH=(e,t)=>{for(var r in t)p7(e,r,{get:t[r],enumerable:!0})},BH=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of DH(t))!OH.call(e,n)&&n!==r&&p7(e,n,{get:()=>t[n],enumerable:!(i=PH(t,n))||i.enumerable});return e},hd=(e,t,r)=>(r=e!=null?LH(IH(e)):{},BH(t||!e||!e.__esModule?p7(r,"default",{value:e,enumerable:!0}):r,e)),kH=cd((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var s=new r;return s.importState(n),s},r;function r(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var c=i();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<n.length;u++)s-=c(n[u]),s<0&&(s+=1),a-=c(n[u]),a<0&&(a+=1),o-=c(n[u]),o<0&&(o+=1);c=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=n,h.exportState=function(){return[s,a,o,l]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),FP=cd((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,u,h,d,p,f,m,g,v,y,x,b=i[0].length,w=i.length;if(w<b)throw new TypeError("Invalid matrix: m < n");for(var C=[],_=[],S=[],A=n==="f"?w:b,E=v=f=0;E<w;E++)_[E]=new Array(A).fill(0);for(E=0;E<b;E++)S[E]=new Array(b).fill(0);var L,P=new Array(b).fill(0);for(E=0;E<w;E++)for(l=0;l<b;l++)_[E][l]=i[E][l];for(E=0;E<b;E++){for(C[E]=f,g=0,u=E+1,l=E;l<w;l++)g+=Math.pow(_[l][E],2);if(g<o)f=0;else for(m=(p=_[E][E])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,_[E][E]=p-f,l=u;l<b;l++){for(g=0,c=E;c<w;c++)g+=_[c][E]*_[c][l];for(p=g/m,c=E;c<w;c++)_[c][l]=_[c][l]+p*_[c][E]}for(P[E]=f,g=0,l=u;l<b;l++)g+=Math.pow(_[E][l],2);if(g<o)f=0;else{for(m=(p=_[E][E+1])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,_[E][E+1]=p-f,l=u;l<b;l++)C[l]=_[E][l]/m;for(l=u;l<w;l++){for(g=0,c=u;c<b;c++)g+=_[l][c]*_[E][c];for(c=u;c<b;c++)_[l][c]=_[l][c]+g*C[c]}}v<(y=Math.abs(P[E])+Math.abs(C[E]))&&(v=y)}if(s)for(E=b-1;0<=E;E--){if(f!==0){for(m=_[E][E+1]*f,l=u;l<b;l++)S[l][E]=_[E][l]/m;for(l=u;l<b;l++){for(g=0,c=u;c<b;c++)g+=_[E][c]*S[c][l];for(c=u;c<b;c++)S[c][l]=S[c][l]+g*S[c][E]}}for(l=u;l<b;l++)S[E][l]=0,S[l][E]=0;S[E][E]=1,f=C[E],u=E}if(n){if(n==="f")for(E=b;E<w;E++){for(l=b;l<w;l++)_[E][l]=0;_[E][E]=1}for(E=b-1;0<=E;E--){for(u=E+1,f=P[E],l=u;l<A;l++)_[E][l]=0;if(f!==0){for(m=_[E][E]*f,l=u;l<A;l++){for(g=0,c=u;c<w;c++)g+=_[c][E]*_[c][l];for(p=g/m,c=E;c<w;c++)_[c][l]=_[c][l]+p*_[c][E]}for(l=E;l<w;l++)_[l][E]=_[l][E]/f}else for(l=E;l<w;l++)_[l][E]=0;_[E][E]=_[E][E]+1}}for(a*=v,c=b-1;0<=c;c--)for(var D=0;D<50;D++){for(L=!1,u=c;0<=u;u--){if(Math.abs(C[u])<=a){L=!0;break}if(Math.abs(P[u-1])<=a)break}if(!L){for(d=0,h=u-(g=1),E=u;E<c+1&&(p=g*C[E],C[E]=d*C[E],!(Math.abs(p)<=a));E++)if(f=P[E],P[E]=Math.sqrt(p*p+f*f),d=f/(m=P[E]),g=-p/m,n)for(l=0;l<w;l++)y=_[l][h],x=_[l][E],_[l][h]=y*d+x*g,_[l][E]=-y*g+x*d}if(x=P[c],u===c){if(x<0&&(P[c]=-x,s))for(l=0;l<b;l++)S[l][c]=-S[l][c];break}for(v=P[u],p=(((y=P[c-1])-x)*(y+x)+((f=C[c-1])-(m=C[c]))*(f+m))/(2*m*y),f=Math.sqrt(p*p+1),p=((v-x)*(v+x)+m*(y/(p<0?p-f:p+f)-m))/v,E=u+(g=d=1);E<c+1;E++){if(f=C[E],y=P[E],m=g*f,f*=d,x=Math.sqrt(p*p+m*m),p=v*(d=p/(C[E-1]=x))+f*(g=m/x),f=-v*g+f*d,m=y*g,y*=d,s)for(l=0;l<b;l++)v=S[l][E-1],x=S[l][E],S[l][E-1]=v*d+x*g,S[l][E]=-v*g+x*d;if(x=Math.sqrt(p*p+m*m),p=(d=p/(P[E-1]=x))*f+(g=m/x)*y,v=-g*f+d*y,n)for(l=0;l<w;l++)y=_[l][E-1],x=_[l][E],_[l][E-1]=y*d+x*g,_[l][E]=-y*g+x*d}C[u]=0,C[c]=p,P[c]=v}for(E=0;E<b;E++)P[E]<a&&(P[E]=0);return{u:_,q:P,v:S}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),NH=cd((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,s){if(n===void 0&&(n=[]),s===void 0&&(s=i),this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var s=this,a=s.data,o=s.compare,l=a[n];n>0;){var c=n-1>>1,u=a[c];if(o(l,u)>=0)break;a[n]=u,n=c}a[n]=l},r.prototype._down=function(n){for(var s=this,a=s.data,o=s.compare,l=this.length>>1,c=a[n];n<l;){var u=(n<<1)+1,h=a[u],d=u+1;if(d<this.length&&o(a[d],h)<0&&(u=d,h=a[d]),o(h,c)>=0)break;a[n]=h,n=u}a[n]=c};function i(n,s){return n<s?-1:n>s?1:0}return r})}),zH=cd((e,t)=>{var r=NH();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,u,h){u=u||1;for(var d,p,f,m,g=0;g<c[0].length;g++){var v=c[0][g];(!g||v[0]<d)&&(d=v[0]),(!g||v[1]<p)&&(p=v[1]),(!g||v[0]>f)&&(f=v[0]),(!g||v[1]>m)&&(m=v[1])}var y=f-d,x=m-p,b=Math.min(y,x),w=b/2;if(b===0){var C=[d,p];return C.distance=0,C}for(var _=new r(void 0,n),S=d;S<f;S+=b)for(var A=p;A<m;A+=b)_.push(new s(S+w,A+w,w,c));var E=o(c),L=new s(d+y/2,p+x/2,0,c);L.d>E.d&&(E=L);for(var P=_.length;_.length;){var D=_.pop();D.d>E.d&&(E=D,h&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,P)),!(D.max-E.d<=u)&&(w=D.h/2,_.push(new s(D.x-w,D.y-w,w,c)),_.push(new s(D.x+w,D.y-w,w,c)),_.push(new s(D.x-w,D.y+w,w,c)),_.push(new s(D.x+w,D.y+w,w,c)),P+=4)}h&&(console.log("num probes: "+P),console.log("best distance: "+E.d));var I=[E.x,E.y];return I.distance=E.d,I}function n(c,u){return u.max-c.max}function s(c,u,h,d){this.x=c,this.y=u,this.h=h,this.d=a(c,u,d),this.max=this.d+this.h*Math.SQRT2}function a(c,u,h){for(var d=!1,p=1/0,f=0;f<h.length;f++)for(var m=h[f],g=0,v=m.length,y=v-1;g<v;y=g++){var x=m[g],b=m[y];x[1]>u!=b[1]>u&&c<(b[0]-x[0])*(u-x[1])/(b[1]-x[1])+x[0]&&(d=!d),p=Math.min(p,l(c,u,x,b))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function o(c){for(var u=0,h=0,d=0,p=c[0],f=0,m=p.length,g=m-1;f<m;g=f++){var v=p[f],y=p[g],x=v[0]*y[1]-y[0]*v[1];h+=(v[0]+y[0])*x,d+=(v[1]+y[1])*x,u+=x*3}return u===0?new s(p[0][0],p[0][1],0,c):new s(h/u,d/u,0,c)}function l(c,u,h,d){var p=h[0],f=h[1],m=d[0]-p,g=d[1]-f;if(m!==0||g!==0){var v=((c-p)*m+(u-f)*g)/(m*m+g*g);v>1?(p=d[0],f=d[1]):v>0&&(p+=m*v,f+=g*v)}return m=c-p,g=u-f,m*m+g*g}}),FH=cd(e=>{(function(){var t=function(){this.init()};t.prototype={init:function(){var h=this||r;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||r;if(h=parseFloat(h),d.ctx||u(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,r.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.volume=g._volume*h)}return d}return d._volume},mute:function(h){var d=this||r;d.ctx||u(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,r.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.muted=h?!0:g._muted)}return d},stop:function(){for(var h=this||r,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||r,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,u()),h},codecs:function(h){return(this||r)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||r;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||r,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var p=d.canPlayType("audio/mpeg;").replace(/^no$/,""),f=h._navigator?h._navigator.userAgent:"",m=f.match(/OPR\/([0-6].)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,v=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,y=f.match(/Version\/(.*?) /),x=v&&y&&parseInt(y[1],10)<15;return h._codecs={mp3:!!(!g&&(p||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||r;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(p){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,h._releaseHtml5Audio(f)}catch{h.noAudio=!0;break}for(var m=0;m<h._howls.length;m++)if(!h._howls[m]._webAudio)for(var g=h._howls[m]._getSoundIds(),v=0;v<g.length;v++){var y=h._howls[m]._soundById(g[v]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}h._autoResume();var x=h.ctx.createBufferSource();x.buffer=h._scratchBuffer,x.connect(h.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),x.onended=function(){x.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var b=0;b<h._howls.length;b++)h._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||r;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||r;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!r.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var p=0;p<h._howls[d]._sounds.length;p++)if(!h._howls[d]._sounds[p]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var f=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(f,f)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!r.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var r=new t,i=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};i.prototype={init:function(h){var d=this;return r.ctx||u(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=r.usingWebAudio&&!d._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(r.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var p=0;p<h._src.length;p++){var f,m;if(h._format&&h._format[p])f=h._format[p];else{if(m=h._src[p],typeof m!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&r.codecs(f)){d=h._src[p];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new n(h),h._webAudio&&a(h),h},play:function(h,d){var p=this,f=null;if(typeof h=="number")f=h,h=null;else{if(typeof h=="string"&&p._state==="loaded"&&!p._sprite[h])return null;if(typeof h>"u"&&(h="__default",!p._playLock)){for(var m=0,g=0;g<p._sounds.length;g++)p._sounds[g]._paused&&!p._sounds[g]._ended&&(m++,f=p._sounds[g]._id);m===1?h=null:f=null}}var v=f?p._soundById(f):p._inactiveSound();if(!v)return null;if(f&&!h&&(h=v._sprite||"__default"),p._state!=="loaded"){v._sprite=h,v._ended=!1;var y=v._id;return p._queue.push({event:"play",action:function(){p.play(y)}}),y}if(f&&!v._paused)return d||p._loadQueue("play"),v._id;p._webAudio&&r._autoResume();var x=Math.max(0,v._seek>0?v._seek:p._sprite[h][0]/1e3),b=Math.max(0,(p._sprite[h][0]+p._sprite[h][1])/1e3-x),w=b*1e3/Math.abs(v._rate),C=p._sprite[h][0]/1e3,_=(p._sprite[h][0]+p._sprite[h][1])/1e3;v._sprite=h,v._ended=!1;var S=function(){v._paused=!1,v._seek=x,v._start=C,v._stop=_,v._loop=!!(v._loop||p._sprite[h][2])};if(x>=_){p._ended(v);return}var A=v._node;if(p._webAudio){var E=function(){p._playLock=!1,S(),p._refreshBuffer(v);var I=v._muted||p._muted?0:v._volume;A.gain.setValueAtTime(I,r.ctx.currentTime),v._playStart=r.ctx.currentTime,typeof A.bufferSource.start>"u"?v._loop?A.bufferSource.noteGrainOn(0,x,86400):A.bufferSource.noteGrainOn(0,x,b):v._loop?A.bufferSource.start(0,x,86400):A.bufferSource.start(0,x,b),w!==1/0&&(p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),w)),d||setTimeout(function(){p._emit("play",v._id),p._loadQueue()},0)};r.state==="running"&&r.ctx.state!=="interrupted"?E():(p._playLock=!0,p.once("resume",E),p._clearTimer(v._id))}else{var L=function(){A.currentTime=x,A.muted=v._muted||p._muted||r._muted||A.muted,A.volume=v._volume*r.volume(),A.playbackRate=v._rate;try{var I=A.play();if(I&&typeof Promise<"u"&&(I instanceof Promise||typeof I.then=="function")?(p._playLock=!0,S(),I.then(function(){p._playLock=!1,A._unlocked=!0,d?p._loadQueue():p._emit("play",v._id)}).catch(function(){p._playLock=!1,p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):d||(p._playLock=!1,S(),p._emit("play",v._id)),A.playbackRate=v._rate,A.paused){p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||v._loop?p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),w):(p._endTimers[v._id]=function(){p._ended(v),A.removeEventListener("ended",p._endTimers[v._id],!1)},A.addEventListener("ended",p._endTimers[v._id],!1))}catch(B){p._emit("playerror",v._id,B)}};A.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(A.src=p._src,A.load());var P=window&&window.ejecta||!A.readyState&&r._navigator.isCocoonJS;if(A.readyState>=3||P)L();else{p._playLock=!0,p._state="loading";var D=function(){p._state="loaded",L(),A.removeEventListener(r._canPlayEvent,D,!1)};A.addEventListener(r._canPlayEvent,D,!1),p._clearTimer(v._id)}}return v._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var p=d._getSoundIds(h),f=0;f<p.length;f++){d._clearTimer(p[f]);var m=d._soundById(p[f]);if(m&&!m._paused&&(m._seek=d.seek(p[f]),m._rateSeek=0,m._paused=!0,d._stopFade(p[f]),m._node))if(d._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||d._emit("pause",m?m._id:null)}return d},stop:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(h)}}),p;for(var f=p._getSoundIds(h),m=0;m<f.length;m++){p._clearTimer(f[m]);var g=p._soundById(f[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,p._stopFade(f[m]),g._node&&(p._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),p._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&p._clearSound(g._node))),d||p._emit("stop",g._id))}return p},mute:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(h,d)}}),p;if(typeof d>"u")if(typeof h=="boolean")p._muted=h;else return p._muted;for(var f=p._getSoundIds(d),m=0;m<f.length;m++){var g=p._soundById(f[m]);g&&(g._muted=h,g._interval&&p._stopFade(g._id),p._webAudio&&g._node?g._node.gain.setValueAtTime(h?0:g._volume,r.ctx.currentTime):g._node&&(g._node.muted=r._muted?!0:h),p._emit("mute",g._id))}return p},volume:function(){var h=this,d=arguments,p,f;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length>=2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var v;if(typeof p<"u"&&p>=0&&p<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof f>"u"&&(h._volume=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)v=h._soundById(f[y]),v&&(v._volume=p,d[2]||h._stopFade(f[y]),h._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(p,r.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=p*r.volume()),h._emit("volume",v._id))}else return v=f?h._soundById(f):h._sounds[0],v?v._volume:0;return h},fade:function(h,d,p,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(h,d,p,f)}}),m;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),p=parseFloat(p),m.volume(h,f);for(var g=m._getSoundIds(f),v=0;v<g.length;v++){var y=m._soundById(g[v]);if(y){if(f||m._stopFade(g[v]),m._webAudio&&!y._muted){var x=r.ctx.currentTime,b=x+p/1e3;y._volume=h,y._node.gain.setValueAtTime(h,x),y._node.gain.linearRampToValueAtTime(d,b)}m._startFadeInterval(y,h,d,p,g[v],typeof f>"u")}}return m},_startFadeInterval:function(h,d,p,f,m,g){var v=this,y=d,x=p-d,b=Math.abs(x/.01),w=Math.max(4,b>0?f/b:f),C=Date.now();h._fadeTo=p,h._interval=setInterval(function(){var _=(Date.now()-C)/f;C=Date.now(),y+=x*_,y=Math.round(y*100)/100,x<0?y=Math.max(p,y):y=Math.min(p,y),v._webAudio?h._volume=y:v.volume(y,h._id,!0),g&&(v._volume=y),(p<d&&y<=p||p>d&&y>=p)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,v.volume(p,h._id),v._emit("fade",h._id))},w)},_stopFade:function(h){var d=this,p=d._soundById(h);return p&&p._interval&&(d._webAudio&&p._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(p._interval),p._interval=null,d.volume(p._fadeTo,h),p._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,p,f,m;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")p=d[0],h._loop=p;else return m=h._soundById(parseInt(d[0],10)),m?m._loop:!1;else d.length===2&&(p=d[0],f=parseInt(d[1],10));for(var g=h._getSoundIds(f),v=0;v<g.length;v++)m=h._soundById(g[v]),m&&(m._loop=p,h._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=p,p&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,h.playing(g[v])&&(h.pause(g[v],!0),h.play(g[v],!0)))));return h},rate:function(){var h=this,d=arguments,p,f;if(d.length===0)f=h._sounds[0]._id;else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var v;if(typeof p=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof f>"u"&&(h._rate=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)if(v=h._soundById(f[y]),v){h.playing(f[y])&&(v._rateSeek=h.seek(f[y]),v._playStart=h._webAudio?r.ctx.currentTime:v._playStart),v._rate=p,h._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(p,r.ctx.currentTime):v._node&&(v._node.playbackRate=p);var x=h.seek(f[y]),b=(h._sprite[v._sprite][0]+h._sprite[v._sprite][1])/1e3-x,w=b*1e3/Math.abs(v._rate);(h._endTimers[f[y]]||!v._paused)&&(h._clearTimer(f[y]),h._endTimers[f[y]]=setTimeout(h._ended.bind(h,v),w)),h._emit("rate",v._id)}}else return v=h._soundById(f),v?v._rate:h._rate;return h},seek:function(){var h=this,d=arguments,p,f;if(d.length===0)h._sounds.length&&(f=h._sounds[0]._id);else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):h._sounds.length&&(f=h._sounds[0]._id,p=parseFloat(d[0]))}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));if(typeof f>"u")return 0;if(typeof p=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var v=h._soundById(f);if(v)if(typeof p=="number"&&p>=0){var y=h.playing(f);y&&h.pause(f,!0),v._seek=p,v._ended=!1,h._clearTimer(f),!h._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=p);var x=function(){y&&h.play(f,!0),h._emit("seek",f)};if(y&&!h._webAudio){var b=function(){h._playLock?setTimeout(b,0):x()};setTimeout(b,0)}else x()}else if(h._webAudio){var w=h.playing(f)?r.ctx.currentTime-v._playStart:0,C=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(C+w*Math.abs(v._rate))}else return v._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var p=d._soundById(h);return p?!p._paused:!1}for(var f=0;f<d._sounds.length;f++)if(!d._sounds[f]._paused)return!0;return!1},duration:function(h){var d=this,p=d._duration,f=d._soundById(h);return f&&(p=d._sprite[f._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,p=0;p<d.length;p++)d[p]._paused||h.stop(d[p]._id),h._webAudio||(h._clearSound(d[p]._node),d[p]._node.removeEventListener("error",d[p]._errorFn,!1),d[p]._node.removeEventListener(r._canPlayEvent,d[p]._loadFn,!1),d[p]._node.removeEventListener("ended",d[p]._endFn,!1),r._releaseHtml5Audio(d[p]._node)),delete d[p]._node,h._clearTimer(d[p]._id);var f=r._howls.indexOf(h);f>=0&&r._howls.splice(f,1);var m=!0;for(p=0;p<r._howls.length;p++)if(r._howls[p]._src===h._src||h._src.indexOf(r._howls[p]._src)>=0){m=!1;break}return s&&m&&delete s[h._src],r.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,p,f){var m=this,g=m["_on"+h];return typeof d=="function"&&g.push(f?{id:p,fn:d,once:f}:{id:p,fn:d}),m},off:function(h,d,p){var f=this,m=f["_on"+h],g=0;if(typeof d=="number"&&(p=d,d=null),d||p)for(g=0;g<m.length;g++){var v=p===m[g].id;if(d===m[g].fn&&v||!d&&v){m.splice(g,1);break}}else if(h)f["_on"+h]=[];else{var y=Object.keys(f);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(f[y[g]])&&(f[y[g]]=[])}return f},once:function(h,d,p){var f=this;return f.on(h,d,p,1),f},_emit:function(h,d,p){for(var f=this,m=f["_on"+h],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===d||h==="load")&&(setTimeout((function(v){v.call(this,d,p)}).bind(f,m[g].fn),0),m[g].once&&f.off(h,m[g].fn,m[g].id));return f._loadQueue(h),f},_loadQueue:function(h){var d=this;if(d._queue.length>0){var p=d._queue[0];p.event===h&&(d._queue.shift(),d._loadQueue()),h||p.action()}return d},_ended:function(h){var d=this,p=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var f=!!(h._loop||d._sprite[p][2]);if(d._emit("end",h._id),!d._webAudio&&f&&d.stop(h._id,!0).play(h._id),d._webAudio&&f){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=r.ctx.currentTime;var m=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),m)}return d._webAudio&&!f&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),r._autoSuspend()),!d._webAudio&&!f&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var p=d._soundById(h);p&&p._node&&p._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,p=0;p<d._sounds.length;p++)if(h===d._sounds[p]._id)return d._sounds[p];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new n(h)},_drain:function(){var h=this,d=h._pool,p=0,f=0;if(!(h._sounds.length<d)){for(f=0;f<h._sounds.length;f++)h._sounds[f]._ended&&p++;for(f=h._sounds.length-1;f>=0;f--){if(p<=d)return;h._sounds[f]._ended&&(h._webAudio&&h._sounds[f]._node&&h._sounds[f]._node.disconnect(0),h._sounds.splice(f,1),p--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var p=[],f=0;f<d._sounds.length;f++)p.push(d._sounds[f]._id);return p}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=r.ctx.createBufferSource(),h._node.bufferSource.buffer=s[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,r.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,p=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),p))try{h.bufferSource.buffer=r._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(h){this._parent=h,this.init()};n.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++r._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,p=r._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),h._node.gain.setValueAtTime(p,r.ctx.currentTime),h._node.paused=!0,h._node.connect(r.masterGain)):r.noAudio||(h._node=r._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(r._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=p*r.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++r._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(r._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var s={},a=function(h){var d=h._src;if(s[d]){h._duration=s[d].duration,c(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var p=atob(d.split(",")[1]),f=new Uint8Array(p.length),m=0;m<p.length;++m)f[m]=p.charCodeAt(m);l(f.buffer,h)}else{var g=new XMLHttpRequest;g.open(h._xhr.method,d,!0),g.withCredentials=h._xhr.withCredentials,g.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(v){g.setRequestHeader(v,h._xhr.headers[v])}),g.onload=function(){var v=(g.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,h)},g.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete s[d],h.load())},o(g)}},o=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var p=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&d._sounds.length>0?(s[d._src]=m,c(d,m)):p()};typeof Promise<"u"&&r.ctx.decodeAudioData.length===1?r.ctx.decodeAudioData(h).then(f).catch(p):r.ctx.decodeAudioData(h,f,p)},c=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},u=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),d=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=d?parseInt(d[1],10):null;if(h&&p&&p<9){var f=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!f&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:r,Howl:i}}),typeof e<"u"&&(e.Howler=r,e.Howl=i),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=r,global.Howl=i,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=r,window.Howl=i,window.Sound=n)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var n=i._howls.length-1;n>=0;n--)i._howls[n].stereo(r);return i},HowlerGlobal.prototype.pos=function(r,i,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,n=typeof n!="number"?s._pos[2]:n,typeof r=="number")s._pos=[r,i,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(r,i,n,s,a,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,n=typeof n!="number"?c[2]:n,s=typeof s!="number"?c[3]:s,a=typeof a!="number"?c[4]:a,o=typeof o!="number"?c[5]:o,typeof r=="number")l._orientation=[r,i,n,s,a,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(r,i,n,s,a,o);else return c;return l},Howl.prototype.init=function(r){return function(i){var n=this;return n._orientation=i.orientation||[1,0,0],n._stereo=i.stereo||null,n._pos=i.pos||null,n._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},n._onstereo=i.onstereo?[{fn:i.onstereo}]:[],n._onpos=i.onpos?[{fn:i.onpos}]:[],n._onorientation=i.onorientation?[{fn:i.onorientation}]:[],r.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(r,i){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(r,i)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof r=="number")n._stereo=r,n._pos=[r,0,0];else return n._stereo;for(var a=n._getSoundIds(i),o=0;o<a.length;o++){var l=n._soundById(a[o]);if(l)if(typeof r=="number")l._stereo=r,l._pos=[r,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(r,0,0):l._panner.pan.setValueAtTime(r,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(r,i,n,s)}}),a;if(i=typeof i!="number"?0:i,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof r=="number")a._pos=[r,i,n];else return a._pos;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._pos=[r,i,n],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setPosition(r,i,n)),a._emit("pos",c._id);else return c._pos}return a},Howl.prototype.orientation=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(r,i,n,s)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,n=typeof n!="number"?a._orientation[2]:n,typeof s>"u")if(typeof r=="number")a._orientation=[r,i,n];else return a._orientation;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._orientation=[r,i,n],c._node&&(c._panner||(c._pos||(c._pos=a._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setOrientation(r,i,n)),a._emit("orientation",c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var r=this,i=arguments,n,s,a;if(!r._webAudio)return r;if(i.length===0)return r._pannerAttr;if(i.length===1)if(typeof i[0]=="object")n=i[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),r._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:r._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:r._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:r._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:r._panningModel});else return a=r._soundById(parseInt(i[0],10)),a?a._pannerAttr:r._pannerAttr;else i.length===2&&(n=i[0],s=parseInt(i[1],10));for(var o=r._getSoundIds(s),l=0;l<o.length;l++)if(a=r._soundById(o[l]),a){var c=a._pannerAttr;c={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:c.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:c.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:c.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:c.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:c.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:c.panningModel};var u=a._panner;u?(u.coneInnerAngle=c.coneInnerAngle,u.coneOuterAngle=c.coneOuterAngle,u.coneOuterGain=c.coneOuterGain,u.distanceModel=c.distanceModel,u.maxDistance=c.maxDistance,u.refDistance=c.refDistance,u.rolloffFactor=c.rolloffFactor,u.panningModel=c.panningModel):(a._pos||(a._pos=r._pos||[0,0,-.5]),t(a,"spatial"))}return r},Sound.prototype.init=function(r){return function(){var i=this,n=i._parent;i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,r.call(this),i._stereo?n.stereo(i._stereo):i._pos&&n.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(r){return function(){var i=this,n=i._parent;return i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,i._stereo?n.stereo(i._stereo):i._pos?n.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,n._refreshBuffer(i)),r.call(this)}}(Sound.prototype.reset);var t=function(r,i){i=i||"spatial",i==="spatial"?(r._panner=Howler.ctx.createPanner(),r._panner.coneInnerAngle=r._pannerAttr.coneInnerAngle,r._panner.coneOuterAngle=r._pannerAttr.coneOuterAngle,r._panner.coneOuterGain=r._pannerAttr.coneOuterGain,r._panner.distanceModel=r._pannerAttr.distanceModel,r._panner.maxDistance=r._pannerAttr.maxDistance,r._panner.refDistance=r._pannerAttr.refDistance,r._panner.rolloffFactor=r._pannerAttr.rolloffFactor,r._panner.panningModel=r._pannerAttr.panningModel,typeof r._panner.positionX<"u"?(r._panner.positionX.setValueAtTime(r._pos[0],Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(r._pos[1],Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(r._pos[2],Howler.ctx.currentTime)):r._panner.setPosition(r._pos[0],r._pos[1],r._pos[2]),typeof r._panner.orientationX<"u"?(r._panner.orientationX.setValueAtTime(r._orientation[0],Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(r._orientation[1],Howler.ctx.currentTime),r._panner.orientationZ.setValueAtTime(r._orientation[2],Howler.ctx.currentTime)):r._panner.setOrientation(r._orientation[0],r._orientation[1],r._orientation[2])):(r._panner=Howler.ctx.createStereoPanner(),r._panner.pan.setValueAtTime(r._stereo,Howler.ctx.currentTime)),r._panner.connect(r._node),r._paused||r._parent.pause(r._id,!0).play(r._id,!0)}}()}),jH=cd((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),s=i.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),ud="149",Rn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},UH=0,T9=1,VH=2,f7=1,HH=2,Ap=3,Ps=0,ei=1,wn=2,Rr=0,vu=1,L9=2,P9=3,D9=4,GH=5,Oh=100,WH=101,qH=102,I9=103,O9=104,XH=200,YH=201,QH=202,KH=203,jP=204,UP=205,ZH=206,JH=207,$H=208,eG=209,tG=210,rG=0,iG=1,nG=2,s5=3,sG=4,aG=5,oG=6,lG=7,VP=0,cG=1,hG=2,ro=0,uG=1,dG=2,pG=3,fG=4,mG=5,HP=300,Bc=301,kc=302,a5=303,o5=304,h1=306,Ka=1e3,Sr=1001,l5=1002,Xt=1003,R9=1004,ty=1005,yt=1006,gG=1007,Gu=1008,Ei=1009,vG=1010,yG=1011,GP=1012,xG=1013,Xo=1014,Cn=1015,Wu=1016,bG=1017,wG=1018,Cc=1020,CG=1021,Xn=1023,SG=1024,_G=1025,Sc=1026,Nc=1027,AG=1028,EG=1029,WP=1030,MG=1031,TG=1033,ry=33776,iy=33777,ny=33778,sy=33779,B9=35840,k9=35841,N9=35842,z9=35843,LG=36196,F9=37492,j9=37496,U9=37808,V9=37809,H9=37810,G9=37811,W9=37812,q9=37813,X9=37814,Y9=37815,Q9=37816,K9=37817,Z9=37818,J9=37819,$9=37820,eC=37821,ay=36492,PG=36283,tC=36284,rC=36285,iC=36286,qP=2200,XP=2201,m7=2202,pg=2300,fg=2301,oy=2302,ru=2400,iu=2401,mg=2402,g7=2500,DG=2501,pa=3e3,dt=3001,vo=3200,YP=3201,IG=0,OG=1,Zs="srgb",gg="srgb-linear",ly=7680,RG=519,c5=35044,nC="300 es",h5=1035,pi=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},vi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],sC=1234567,Yp=Math.PI/180,Of=180/Math.PI;function Jn(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(vi[e&255]+vi[e>>8&255]+vi[e>>16&255]+vi[e>>24&255]+"-"+vi[t&255]+vi[t>>8&255]+"-"+vi[t>>16&15|64]+vi[t>>24&255]+"-"+vi[r&63|128]+vi[r>>8&255]+"-"+vi[r>>16&255]+vi[r>>24&255]+vi[i&255]+vi[i>>8&255]+vi[i>>16&255]+vi[i>>24&255]).toLowerCase()}function jr(e,t,r){return Math.max(t,Math.min(r,e))}function v7(e,t){return(e%t+t)%t}function BG(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function kG(e,t,r){return e!==t?(r-e)/(t-e):0}function Qp(e,t,r){return(1-r)*e+r*t}function NG(e,t,r,i){return Qp(e,t,1-Math.exp(-r*i))}function zG(e,t=1){return t-Math.abs(v7(e,t*2)-t)}function FG(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function jG(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function UG(e,t){return e+Math.floor(Math.random()*(t-e+1))}function VG(e,t){return e+Math.random()*(t-e)}function HG(e){return e*(.5-Math.random())}function GG(e){e!==void 0&&(sC=e);let t=sC+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function WG(e){return e*Yp}function qG(e){return e*Of}function u5(e){return(e&e-1)===0&&e!==0}function QP(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function vg(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function XG(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+i)/2),u=a((t+i)/2),h=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(n){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Za(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function qt(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var gt=Object.freeze({__proto__:null,DEG2RAD:Yp,RAD2DEG:Of,ceilPowerOfTwo:QP,clamp:jr,damp:NG,degToRad:WG,denormalize:Za,euclideanModulo:v7,floorPowerOfTwo:vg,generateUUID:Jn,inverseLerp:kG,isPowerOfTwo:u5,lerp:Qp,mapLinear:BG,normalize:qt,pingpong:zG,radToDeg:qG,randFloat:VG,randFloatSpread:HG,randInt:UG,seededRandom:GG,setQuaternionFromProperEuler:XG,smootherstep:jG,smoothstep:FG}),W=class{constructor(e=0,t=0){W.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},ti=class{constructor(){ti.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=n,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],p=r[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],x=i[7],b=i[2],w=i[5],C=i[8];return n[0]=s*f+a*v+o*b,n[3]=s*m+a*y+o*w,n[6]=s*g+a*x+o*C,n[1]=l*f+c*v+u*b,n[4]=l*m+c*y+u*w,n[7]=l*g+c*x+u*C,n[2]=h*f+d*v+p*b,n[5]=h*m+d*y+p*w,n[8]=h*g+d*x+p*C,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*n*c+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*n,d=l*n-s*o,p=t*u+r*h+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(i*l-c*r)*f,e[2]=(a*r-i*s)*f,e[3]=h*f,e[4]=(c*t-i*o)*f,e[5]=(i*n-a*t)*f,e[6]=d*f,e[7]=(r*o-l*t)*f,e[8]=(s*t-r*n)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(cy.makeScale(e,t)),this}rotate(e){return this.premultiply(cy.makeRotation(-e)),this}translate(e,t){return this.premultiply(cy.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},cy=new ti;function KP(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var YG={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function W1(e,t){return new YG[e](t)}function yg(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function _c(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function C0(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var hy={[Zs]:{[gg]:_c},[gg]:{[Zs]:C0}},Mi={legacyMode:!0,get workingColorSpace(){return gg},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(hy[t]&&hy[t][r]!==void 0){let i=hy[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},ZP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Br={r:0,g:0,b:0},ls={h:0,s:0,l:0},q1={h:0,s:0,l:0};function uy(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function X1(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var $e=class{constructor(t,r,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,r===void 0&&i===void 0?this.set(t):this.setRGB(t,r,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,r=Zs){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Mi.toWorkingColorSpace(this,r),this}setRGB(t,r,i,n=Mi.workingColorSpace){return this.r=t,this.g=r,this.b=i,Mi.toWorkingColorSpace(this,n),this}setHSL(t,r,i,n=Mi.workingColorSpace){if(t=v7(t,1),r=jr(r,0,1),i=jr(i,0,1),r===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+r):i+r-i*r,a=2*i-s;this.r=uy(a,s,t+1/3),this.g=uy(a,s,t),this.b=uy(a,s,t-1/3)}return Mi.toWorkingColorSpace(this,n),this}setStyle(t,r=Zs){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s,a=n[1],o=n[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Mi.toWorkingColorSpace(this,r),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Mi.toWorkingColorSpace(this,r),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,u,r)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){let s=n[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Mi.toWorkingColorSpace(this,r),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Mi.toWorkingColorSpace(this,r),this}return t&&t.length>0?this.setColorName(t,r):this}setColorName(t,r=Zs){let i=ZP[t.toLowerCase()];return i!==void 0?this.setHex(i,r):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=_c(t.r),this.g=_c(t.g),this.b=_c(t.b),this}copyLinearToSRGB(t){return this.r=C0(t.r),this.g=C0(t.g),this.b=C0(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Zs){return Mi.fromWorkingColorSpace(X1(this,Br),t),jr(Br.r*255,0,255)<<16^jr(Br.g*255,0,255)<<8^jr(Br.b*255,0,255)<<0}getHexString(t=Zs){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,r=Mi.workingColorSpace){Mi.fromWorkingColorSpace(X1(this,Br),r);let i=Br.r,n=Br.g,s=Br.b,a=Math.max(i,n,s),o=Math.min(i,n,s),l,c,u=(o+a)/2;if(o===a)l=0,c=0;else{let h=a-o;switch(c=u<=.5?h/(a+o):h/(2-a-o),a){case i:l=(n-s)/h+(n<s?6:0);break;case n:l=(s-i)/h+2;break;case s:l=(i-n)/h+4;break}l/=6}return t.h=l,t.s=c,t.l=u,t}getRGB(t,r=Mi.workingColorSpace){return Mi.fromWorkingColorSpace(X1(this,Br),r),t.r=Br.r,t.g=Br.g,t.b=Br.b,t}getStyle(t=Zs){return Mi.fromWorkingColorSpace(X1(this,Br),t),t!==Zs?`color(${t} ${Br.r} ${Br.g} ${Br.b})`:`rgb(${Br.r*255|0},${Br.g*255|0},${Br.b*255|0})`}offsetHSL(t,r,i){return this.getHSL(ls),ls.h+=t,ls.s+=r,ls.l+=i,this.setHSL(ls.h,ls.s,ls.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this}lerpColors(t,r,i){return this.r=t.r+(r.r-t.r)*i,this.g=t.g+(r.g-t.g)*i,this.b=t.b+(r.b-t.b)*i,this}lerpHSL(t,r){this.getHSL(ls),t.getHSL(q1);let i=Qp(ls.h,q1.h,r),n=Qp(ls.s,q1.s,r),s=Qp(ls.l,q1.l,r);return this.setHSL(i,n,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};$e.NAMES=ZP;var th,JP=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{th===void 0&&(th=yg("canvas")),th.width=e.width,th.height=e.height;let r=th.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=th}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=yg("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=_c(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(_c(t[r]/255)*255):t[r]=_c(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},$P=class{constructor(e=null){this.isSource=!0,this.uuid=Jn(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(dy(i[s].image)):n.push(dy(i[s]))}else n=dy(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function dy(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?JP.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var QG=0,Vr=class extends pi{constructor(e=Vr.DEFAULT_IMAGE,t=Vr.DEFAULT_MAPPING,r=Sr,i=Sr,n=yt,s=Gu,a=Xn,o=Ei,l=Vr.DEFAULT_ANISOTROPY,c=pa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:QG++}),this.uuid=Jn(),this.name="",this.source=new $P(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new W(0,0),this.repeat=new W(1,1),this.center=new W(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ti,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==HP)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ka:e.x=e.x-Math.floor(e.x);break;case Sr:e.x=e.x<0?0:1;break;case l5:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ka:e.y=e.y-Math.floor(e.y);break;case Sr:e.y=e.y<0?0:1;break;case l5:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Vr.DEFAULT_IMAGE=null;Vr.DEFAULT_MAPPING=HP;Vr.DEFAULT_ANISOTROPY=1;var pt=class{constructor(e=0,t=0,r=0,i=1){pt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let g=(a+1)/2,v=(u+1)/2,y=(f+1)/2,x=(o+c)/4,b=(l+d)/4,w=(h+p)/4;return g>v&&g>y?g<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(g),i=x/r,n=b/r):v>y?v<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(v),r=x/i,n=w/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=b/n,i=w/n),this.set(r,i,n,t),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(c-o)/m,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},jt=class extends pi{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new pt(0,0,e,t),this.scissorTest=!1,this.viewport=new pt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Vr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:yt,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new $P(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},eD=class extends Vr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Xt,this.minFilter=Xt,this.wrapR=Sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},KG=class extends Vr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Xt,this.minFilter=Xt,this.wrapR=Sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ZG=class extends jt{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<r;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},mt=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3],h=n[s+0],d=n[s+1],p=n[s+2],f=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=f;return}if(u!==f||o!==h||l!==d||c!==p){let m=1-a,g=o*h+l*d+c*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let b=Math.sqrt(y),w=Math.atan2(b,g*v);m=Math.sin(m*w)/b,a=Math.sin(a*w)/b}let x=a*v;if(o=o*m+h*x,l=l*m+d*x,c=c*m+p*x,u=u*m+f*x,m===1-a){let b=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=b,l*=b,c*=b,u*=b}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],c=r[i+3],u=n[s],h=n[s+1],d=n[s+2],p=n[s+3];return e[t]=a*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-o*u,e[t+3]=c*p-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(i/2),u=a(n/2),h=o(r/2),d=o(i/2),p=o(n/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=r+a+u;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-o)*d,this._y=(n-l)*d,this._z=(s-i)*d}else if(r>a&&r>u){let d=2*Math.sqrt(1+r-a-u);this._w=(c-o)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(n+l)/d}else if(a>u){let d=2*Math.sqrt(1+a-r-u);this._w=(n-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(o+c)/d}else{let d=2*Math.sqrt(1+u-r-a);this._w=(s-i)/d,this._x=(n+l)/d,this._y=(o+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(jr(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+i*l-n*o,this._y=i*c+s*o+n*a-r*l,this._z=n*c+s*l+r*o-i*a,this._w=s*c-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=i*u+this._y*h,this._z=n*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},T=class{constructor(e=0,t=0,r=0){T.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(aC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(aC.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*r,c=o*r+a*t-n*i,u=o*i+n*r-s*t,h=-n*t-s*r-a*i;return this.x=l*o+h*-n+c*-a-u*-s,this.y=c*o+h*-s+u*-n-l*-a,this.z=u*o+h*-a+l*-s-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return py.copy(this).projectOnVector(e),this.sub(py)}reflect(e){return this.sub(py.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(jr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},py=new T,aC=new mt,Er=class{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let c=e[o],u=e[o+1],h=e[o+2];c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let c=e.getX(o),u=e.getY(o),h=e.getZ(o);c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=jl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let s=0,a=n.count;s<a;s++)jl.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(jl)}else r.boundingBox===null&&r.computeBoundingBox(),fy.copy(r.boundingBox),fy.applyMatrix4(e.matrixWorld),this.union(fy);let i=e.children;for(let n=0,s=i.length;n<s;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,jl),jl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Hd),Y1.subVectors(this.max,Hd),rh.subVectors(e.a,Hd),ih.subVectors(e.b,Hd),nh.subVectors(e.c,Hd),bo.subVectors(ih,rh),wo.subVectors(nh,ih),Ul.subVectors(rh,nh);let t=[0,-bo.z,bo.y,0,-wo.z,wo.y,0,-Ul.z,Ul.y,bo.z,0,-bo.x,wo.z,0,-wo.x,Ul.z,0,-Ul.x,-bo.y,bo.x,0,-wo.y,wo.x,0,-Ul.y,Ul.x,0];return!my(t,rh,ih,nh,Y1)||(t=[1,0,0,0,1,0,0,0,1],!my(t,rh,ih,nh,Y1))?!1:(Q1.crossVectors(bo,wo),t=[Q1.x,Q1.y,Q1.z],my(t,rh,ih,nh,Y1))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return jl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(jl).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Sa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Sa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Sa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Sa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Sa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Sa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Sa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Sa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Sa),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Sa=[new T,new T,new T,new T,new T,new T,new T,new T],jl=new T,fy=new Er,rh=new T,ih=new T,nh=new T,bo=new T,wo=new T,Ul=new T,Hd=new T,Y1=new T,Q1=new T,Vl=new T;function my(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){Vl.fromArray(e,s);let o=n.x*Math.abs(Vl.x)+n.y*Math.abs(Vl.y)+n.z*Math.abs(Vl.z),l=t.dot(Vl),c=r.dot(Vl),u=i.dot(Vl);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}var JG=new Er,Gd=new T,gy=new T,Ln=class{constructor(e=new T,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):JG.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Gd.subVectors(e,this.center);let t=Gd.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Gd,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(gy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Gd.copy(e.center).add(gy)),this.expandByPoint(Gd.copy(e.center).sub(gy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},_a=new T,vy=new T,K1=new T,Co=new T,yy=new T,Z1=new T,xy=new T,dd=class{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_a)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=_a.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(_a.copy(this.direction).multiplyScalar(t).add(this.origin),_a.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){vy.copy(e).add(t).multiplyScalar(.5),K1.copy(t).sub(e).normalize(),Co.copy(this.origin).sub(vy);let n=e.distanceTo(t)*.5,s=-this.direction.dot(K1),a=Co.dot(this.direction),o=-Co.dot(K1),l=Co.lengthSq(),c=Math.abs(1-s*s),u,h,d,p;if(c>0)if(u=s*o-a,h=s*a-o,p=n*c,u>=0)if(h>=-p)if(h<=p){let f=1/c;u*=f,h*=f,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-s*n+a)),h=u>0?-n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-n,-o),n),d=h*(h+2*o)+l):(u=Math.max(0,-(s*n+a)),h=u>0?n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l);else h=s>0?-n:n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(K1).multiplyScalar(h).add(vy),d}intersectSphere(e,t){_a.subVectors(e.center,this.origin);let r=_a.dot(this.direction),i=_a.dot(_a)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(n=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(n=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||n>i||((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,_a)!==null}intersectTriangle(e,t,r,i,n){yy.subVectors(t,e),Z1.subVectors(r,e),xy.crossVectors(yy,Z1);let s=this.direction.dot(xy),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Co.subVectors(this.origin,e);let o=a*this.direction.dot(Z1.crossVectors(Co,Z1));if(o<0)return null;let l=a*this.direction.dot(yy.cross(Co));if(l<0||o+l>s)return null;let c=-a*Co.dot(xy);return c<0?null:this.at(c/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ce=class{constructor(){Ce.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=i,g[1]=n,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ce().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/sh.setFromMatrixColumn(e,0).length(),n=1/sh.setFromMatrixColumn(e,1).length(),s=1/sh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),a=Math.sin(r),o=Math.cos(i),l=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if(e.order==="XYZ"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-a*o,t[2]=f-h*l,t[6]=p+d*l,t[10]=s*o}else if(e.order==="YXZ"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h+f*a,t[4]=p*a-d,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=d*a-p,t[6]=f+h*a,t[10]=s*o}else if(e.order==="ZXY"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h-f*a,t[4]=-s*u,t[8]=p+d*a,t[1]=d+p*a,t[5]=s*c,t[9]=f-h*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if(e.order==="ZYX"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=p*l-d,t[8]=h*l+f,t[1]=o*u,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=a*o,t[10]=s*o}else if(e.order==="YZX"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=f-h*u,t[8]=p*u+d,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=d*u+p,t[10]=h-f*u}else if(e.order==="XZY"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=h*u+f,t[5]=s*c,t[9]=d*u-p,t[2]=p*u-d,t[6]=a*c,t[10]=f*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose($G,e,eW)}lookAt(e,t,r){let i=this.elements;return fn.subVectors(e,t),fn.lengthSq()===0&&(fn.z=1),fn.normalize(),So.crossVectors(r,fn),So.lengthSq()===0&&(Math.abs(r.z)===1?fn.x+=1e-4:fn.z+=1e-4,fn.normalize(),So.crossVectors(r,fn)),So.normalize(),J1.crossVectors(fn,So),i[0]=So.x,i[4]=J1.x,i[8]=fn.x,i[1]=So.y,i[5]=J1.y,i[9]=fn.y,i[2]=So.z,i[6]=J1.z,i[10]=fn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[4],o=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],b=r[15],w=i[0],C=i[4],_=i[8],S=i[12],A=i[1],E=i[5],L=i[9],P=i[13],D=i[2],I=i[6],B=i[10],X=i[14],H=i[3],R=i[7],q=i[11],F=i[15];return n[0]=s*w+a*A+o*D+l*H,n[4]=s*C+a*E+o*I+l*R,n[8]=s*_+a*L+o*B+l*q,n[12]=s*S+a*P+o*X+l*F,n[1]=c*w+u*A+h*D+d*H,n[5]=c*C+u*E+h*I+d*R,n[9]=c*_+u*L+h*B+d*q,n[13]=c*S+u*P+h*X+d*F,n[2]=p*w+f*A+m*D+g*H,n[6]=p*C+f*E+m*I+g*R,n[10]=p*_+f*L+m*B+g*q,n[14]=p*S+f*P+m*X+g*F,n[3]=v*w+y*A+x*D+b*H,n[7]=v*C+y*E+x*I+b*R,n[11]=v*_+y*L+x*B+b*q,n[15]=v*S+y*P+x*X+b*F,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14],p=e[3],f=e[7],m=e[11],g=e[15];return p*(+n*o*u-i*l*u-n*a*h+r*l*h+i*a*d-r*o*d)+f*(+t*o*d-t*l*h+n*s*h-i*s*d+i*l*c-n*o*c)+m*(+t*l*u-t*a*d-n*s*u+r*s*d+n*a*c-r*l*c)+g*(-i*a*c-t*o*u+t*a*h+i*s*u-r*s*h+r*o*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*o*d-a*m*d-u*o*g+a*h*g,y=p*h*l-c*m*l-p*o*d+s*m*d+c*o*g-s*h*g,x=c*f*l-p*u*l+p*a*d-s*f*d-c*a*g+s*u*g,b=p*u*o-c*f*o-p*a*h+s*f*h+c*a*m-s*u*m,w=t*v+r*y+i*x+n*b;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let C=1/w;return e[0]=v*C,e[1]=(f*h*n-u*m*n-f*i*d+r*m*d+u*i*g-r*h*g)*C,e[2]=(a*m*n-f*o*n+f*i*l-r*m*l-a*i*g+r*o*g)*C,e[3]=(u*o*n-a*h*n-u*i*l+r*h*l+a*i*d-r*o*d)*C,e[4]=y*C,e[5]=(c*m*n-p*h*n+p*i*d-t*m*d-c*i*g+t*h*g)*C,e[6]=(p*o*n-s*m*n-p*i*l+t*m*l+s*i*g-t*o*g)*C,e[7]=(s*h*n-c*o*n+c*i*l-t*h*l-s*i*d+t*o*d)*C,e[8]=x*C,e[9]=(p*u*n-c*f*n-p*r*d+t*f*d+c*r*g-t*u*g)*C,e[10]=(s*f*n-p*a*n+p*r*l-t*f*l-s*r*g+t*a*g)*C,e[11]=(c*a*n-s*u*n-c*r*l+t*u*l+s*r*d-t*a*d)*C,e[12]=b*C,e[13]=(c*f*i-p*u*i+p*r*h-t*f*h-c*r*m+t*u*m)*C,e[14]=(p*a*i-s*f*i-p*r*o+t*f*o+s*r*m-t*a*m)*C,e[15]=(s*u*i-c*a*i+c*r*o-t*u*o-s*r*h+t*a*h)*C,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,a=e.y,o=e.z,l=n*s,c=n*a;return this.set(l*s+r,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+r,c*o-i*s,0,l*o-i*a,c*o+i*s,n*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,s=t._y,a=t._z,o=t._w,l=n+n,c=s+s,u=a+a,h=n*l,d=n*c,p=n*u,f=s*c,m=s*u,g=a*u,v=o*l,y=o*c,x=o*u,b=r.x,w=r.y,C=r.z;return i[0]=(1-(f+g))*b,i[1]=(d+x)*b,i[2]=(p-y)*b,i[3]=0,i[4]=(d-x)*w,i[5]=(1-(h+g))*w,i[6]=(m+v)*w,i[7]=0,i[8]=(p+y)*C,i[9]=(m-v)*C,i[10]=(1-(h+f))*C,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=sh.set(i[0],i[1],i[2]).length(),s=sh.set(i[4],i[5],i[6]).length(),a=sh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],cs.copy(this);let o=1/n,l=1/s,c=1/a;return cs.elements[0]*=o,cs.elements[1]*=o,cs.elements[2]*=o,cs.elements[4]*=l,cs.elements[5]*=l,cs.elements[6]*=l,cs.elements[8]*=c,cs.elements[9]*=c,cs.elements[10]*=c,t.setFromRotationMatrix(cs),r.x=n,r.y=s,r.z=a,this}makePerspective(e,t,r,i,n,s){let a=this.elements,o=2*n/(t-e),l=2*n/(r-i),c=(t+e)/(t-e),u=(r+i)/(r-i),h=-(s+n)/(s-n),d=-2*s*n/(s-n);return a[0]=o,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,n,s){let a=this.elements,o=1/(t-e),l=1/(r-i),c=1/(s-n),u=(t+e)*o,h=(r+i)*l,d=(s+n)*c;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},sh=new T,cs=new Ce,$G=new T(0,0,0),eW=new T(1,1,1),So=new T,J1=new T,fn=new T,oC=new Ce,lC=new mt,$r=class{constructor(e=0,t=0,r=0,i=$r.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(jr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-jr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(jr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-jr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(jr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-jr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return oC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(oC,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return lC.setFromEuler(this),this.setFromQuaternion(lC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};$r.DEFAULT_ORDER="XYZ";var y7=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},tW=0,cC=new T,ah=new mt,Aa=new Ce,$1=new T,Wd=new T,rW=new T,iW=new mt,hC=new T(1,0,0),uC=new T(0,1,0),dC=new T(0,0,1),nW={type:"added"},pC={type:"removed"},Vt=class extends pi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tW++}),this.uuid=Jn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vt.DEFAULT_UP.clone();let e=new T,t=new $r,r=new mt,i=new T(1,1,1);function n(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ce},normalMatrix:{value:new ti}}),this.matrix=new Ce,this.matrixWorld=new Ce,this.matrixAutoUpdate=Vt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Vt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new y7,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ah.setFromAxisAngle(e,t),this.quaternion.multiply(ah),this}rotateOnWorldAxis(e,t){return ah.setFromAxisAngle(e,t),this.quaternion.premultiply(ah),this}rotateX(e){return this.rotateOnAxis(hC,e)}rotateY(e){return this.rotateOnAxis(uC,e)}rotateZ(e){return this.rotateOnAxis(dC,e)}translateOnAxis(e,t){return cC.copy(e).applyQuaternion(this.quaternion),this.position.add(cC.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(hC,e)}translateY(e){return this.translateOnAxis(uC,e)}translateZ(e){return this.translateOnAxis(dC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Aa.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?$1.copy(e):$1.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),Wd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Aa.lookAt(Wd,$1,this.up):Aa.lookAt($1,Wd,this.up),this.quaternion.setFromRotationMatrix(Aa),i&&(Aa.extractRotation(i.matrixWorld),ah.setFromRotationMatrix(Aa),this.quaternion.premultiply(ah.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(nW)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(pC)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(pC)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Aa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Aa.multiply(e.parent.matrixWorld)),e.applyMatrix4(Aa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wd,e,rW),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wd,iW,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,s=i.length;n<s;n++){let a=i[n];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,c=o.length;l<c;l++){let u=o[l];n(e.shapes,u)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));i.material=a}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];i.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),c=s(e.images),u=s(e.shapes),h=s(e.skeletons),d=s(e.animations),p=s(e.nodes);a.length>0&&(r.geometries=a),o.length>0&&(r.materials=o),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),u.length>0&&(r.shapes=u),h.length>0&&(r.skeletons=h),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function s(a){let o=[];for(let l in a){let c=a[l];delete c.metadata,o.push(c)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Vt.DEFAULT_UP=new T(0,1,0);Vt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Vt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var hs=new T,Ea=new T,by=new T,Ma=new T,oh=new T,lh=new T,fC=new T,wy=new T,Cy=new T,Sy=new T,wi=class{constructor(e=new T,t=new T,r=new T){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),hs.subVectors(e,t),i.cross(hs);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){hs.subVectors(i,t),Ea.subVectors(r,t),by.subVectors(e,t);let s=hs.dot(hs),a=hs.dot(Ea),o=hs.dot(by),l=Ea.dot(Ea),c=Ea.dot(by),u=s*l-a*a;if(u===0)return n.set(-2,-1,-1);let h=1/u,d=(l*o-a*c)*h,p=(s*c-a*o)*h;return n.set(1-d-p,p,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ma),Ma.x>=0&&Ma.y>=0&&Ma.x+Ma.y<=1}static getUV(e,t,r,i,n,s,a,o){return this.getBarycoord(e,t,r,i,Ma),o.set(0,0),o.addScaledVector(n,Ma.x),o.addScaledVector(s,Ma.y),o.addScaledVector(a,Ma.z),o}static isFrontFacing(e,t,r,i){return hs.subVectors(r,t),Ea.subVectors(e,t),hs.cross(Ea).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return hs.subVectors(this.c,this.b),Ea.subVectors(this.a,this.b),hs.cross(Ea).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return wi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return wi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return wi.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return wi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return wi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,s,a;oh.subVectors(i,r),lh.subVectors(n,r),wy.subVectors(e,r);let o=oh.dot(wy),l=lh.dot(wy);if(o<=0&&l<=0)return t.copy(r);Cy.subVectors(e,i);let c=oh.dot(Cy),u=lh.dot(Cy);if(c>=0&&u<=c)return t.copy(i);let h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(r).addScaledVector(oh,s);Sy.subVectors(e,n);let d=oh.dot(Sy),p=lh.dot(Sy);if(p>=0&&d<=p)return t.copy(n);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(r).addScaledVector(lh,a);let m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return fC.subVectors(n,i),a=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(fC,a);let g=1/(m+f+h);return s=f*g,a=h*g,t.copy(r).addScaledVector(oh,s).addScaledVector(lh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},sW=0,u1=class extends pi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:sW++}),this.uuid=Jn(),this.name="",this.type="Material",this.blending=vu,this.side=Ps,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=jP,this.blendDst=UP,this.blendEquation=Oh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=s5,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=RG,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ly,this.stencilZFail=ly,this.stencilZPass=ly,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==vu&&(r.blending=this.blending),this.side!==Ps&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},d1=class extends u1{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new $e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=VP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Tr=new T,em=new W,st=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=c5,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)em.fromBufferAttribute(this,t),em.applyMatrix3(e),this.setXY(t,em.x,em.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyMatrix3(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyMatrix4(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyNormalMatrix(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.transformDirection(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Za(t,this.array)),t}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Za(t,this.array)),t}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Za(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Za(t,this.array)),t}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array),n=qt(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==c5&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},tD=class extends st{constructor(e,t,r){super(new Uint16Array(e),t,r)}},yu=class extends st{constructor(e,t,r){super(new Uint32Array(e),t,r)}},ze=class extends st{constructor(e,t,r){super(new Float32Array(e),t,r)}},aW=0,Bn=new Ce,_y=new Vt,ch=new T,mn=new Er,qd=new Er,Yr=new T,nt=class extends pi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:aW++}),this.uuid=Jn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(KP(e)?yu:tD)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new ti().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Bn.makeRotationFromQuaternion(e),this.applyMatrix4(Bn),this}rotateX(e){return Bn.makeRotationX(e),this.applyMatrix4(Bn),this}rotateY(e){return Bn.makeRotationY(e),this.applyMatrix4(Bn),this}rotateZ(e){return Bn.makeRotationZ(e),this.applyMatrix4(Bn),this}translate(e,t,r){return Bn.makeTranslation(e,t,r),this.applyMatrix4(Bn),this}scale(e,t,r){return Bn.makeScale(e,t,r),this.applyMatrix4(Bn),this}lookAt(e){return _y.lookAt(e),_y.updateMatrix(),this.applyMatrix4(_y.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ch).negate(),this.translate(ch.x,ch.y,ch.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new ze(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Er);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];mn.setFromBufferAttribute(n),this.morphTargetsRelative?(Yr.addVectors(this.boundingBox.min,mn.min),this.boundingBox.expandByPoint(Yr),Yr.addVectors(this.boundingBox.max,mn.max),this.boundingBox.expandByPoint(Yr)):(this.boundingBox.expandByPoint(mn.min),this.boundingBox.expandByPoint(mn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ln);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new T,1/0);return}if(e){let r=this.boundingSphere.center;if(mn.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){let a=t[n];qd.setFromBufferAttribute(a),this.morphTargetsRelative?(Yr.addVectors(mn.min,qd.min),mn.expandByPoint(Yr),Yr.addVectors(mn.max,qd.max),mn.expandByPoint(Yr)):(mn.expandByPoint(qd.min),mn.expandByPoint(qd.max))}mn.getCenter(r);let i=0;for(let n=0,s=e.count;n<s;n++)Yr.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(Yr));if(t)for(let n=0,s=t.length;n<s;n++){let a=t[n],o=this.morphTargetsRelative;for(let l=0,c=a.count;l<c;l++)Yr.fromBufferAttribute(a,l),o&&(ch.fromBufferAttribute(e,l),Yr.add(ch)),i=Math.max(i,r.distanceToSquared(Yr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,s=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new st(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let A=0;A<a;A++)l[A]=new T,c[A]=new T;let u=new T,h=new T,d=new T,p=new W,f=new W,m=new W,g=new T,v=new T;function y(A,E,L){u.fromArray(i,A*3),h.fromArray(i,E*3),d.fromArray(i,L*3),p.fromArray(s,A*2),f.fromArray(s,E*2),m.fromArray(s,L*2),h.sub(u),d.sub(u),f.sub(p),m.sub(p);let P=1/(f.x*m.y-m.x*f.y);!isFinite(P)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(P),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(P),l[A].add(g),l[E].add(g),l[L].add(g),c[A].add(v),c[E].add(v),c[L].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:r.length}]);for(let A=0,E=x.length;A<E;++A){let L=x[A],P=L.start,D=L.count;for(let I=P,B=P+D;I<B;I+=3)y(r[I+0],r[I+1],r[I+2])}let b=new T,w=new T,C=new T,_=new T;function S(A){C.fromArray(n,A*3),_.copy(C);let E=l[A];b.copy(E),b.sub(C.multiplyScalar(C.dot(E))).normalize(),w.crossVectors(_,E);let L=w.dot(c[A])<0?-1:1;o[A*4]=b.x,o[A*4+1]=b.y,o[A*4+2]=b.z,o[A*4+3]=L}for(let A=0,E=x.length;A<E;++A){let L=x[A],P=L.start,D=L.count;for(let I=P,B=P+D;I<B;I+=3)S(r[I+0]),S(r[I+1]),S(r[I+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new st(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,d=r.count;h<d;h++)r.setXYZ(h,0,0,0);let i=new T,n=new T,s=new T,a=new T,o=new T,l=new T,c=new T,u=new T;if(e)for(let h=0,d=e.count;h<d;h+=3){let p=e.getX(h+0),f=e.getX(h+1),m=e.getX(h+2);i.fromBufferAttribute(t,p),n.fromBufferAttribute(t,f),s.fromBufferAttribute(t,m),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),a.fromBufferAttribute(r,p),o.fromBufferAttribute(r,f),l.fromBufferAttribute(r,m),a.add(c),o.add(c),l.add(c),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(f,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z)}else for(let h=0,d=t.count;h<d;h+=3)i.fromBufferAttribute(t,h+0),n.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),r.setXYZ(h+0,c.x,c.y,c.z),r.setXYZ(h+1,c.x,c.y,c.z),r.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Yr.fromBufferAttribute(e,t),Yr.normalize(),e.setXYZ(t,Yr.x,Yr.y,Yr.z)}toNonIndexed(){function e(a,o){let l=a.array,c=a.itemSize,u=a.normalized,h=new l.constructor(o.length*c),d=0,p=0;for(let f=0,m=o.length;f<m;f++){a.isInterleavedBufferAttribute?d=o[f]*a.data.stride+a.offset:d=o[f]*c;for(let g=0;g<c;g++)h[p++]=l[d++]}return new st(h,c,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new nt,r=this.index.array,i=this.attributes;for(let a in i){let o=i[a],l=e(o,r);t.setAttribute(a,l)}let n=this.morphAttributes;for(let a in n){let o=[],l=n[a];for(let c=0,u=l.length;c<u;c++){let h=l[c],d=e(h,r);o.push(d)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let o in r){let l=r[o];e.data.attributes[o]=l.toJSON(e.data)}let i={},n=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],c=[];for(let u=0,h=l.length;u<h;u++){let d=l[u];c.push(d.toJSON(e.data))}c.length>0&&(i[o]=c,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let c=i[l];this.setAttribute(l,c.clone(t))}let n=e.morphAttributes;for(let l in n){let c=[],u=n[l];for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let u=s[l];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},mC=new Ce,hh=new dd,Ay=new Ln,Xd=new T,Yd=new T,Qd=new T,Ey=new T,tm=new T,rm=new W,im=new W,nm=new W,My=new T,sm=new T,$i=class extends Vt{constructor(e=new nt,t=new d1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(n&&a){tm.set(0,0,0);for(let o=0,l=n.length;o<l;o++){let c=a[o],u=n[o];c!==0&&(Ey.fromBufferAttribute(u,e),s?tm.addScaledVector(Ey,c):tm.addScaledVector(Ey.sub(t),c))}t.add(tm)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),Ay.copy(r.boundingSphere),Ay.applyMatrix4(n),e.ray.intersectsSphere(Ay)===!1)||(mC.copy(n).invert(),hh.copy(e.ray).applyMatrix4(mC),r.boundingBox!==null&&hh.intersectsBox(r.boundingBox)===!1))return;let s,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(a!==null)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(a.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,x=v;y<x;y+=3){let b=a.getX(y),w=a.getX(y+1),C=a.getX(y+2);s=am(this,m,e,hh,l,c,b,w,C),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(a.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=a.getX(f),v=a.getX(f+1),y=a.getX(f+2);s=am(this,i,e,hh,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(o.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,x=v;y<x;y+=3){let b=y,w=y+1,C=y+2;s=am(this,m,e,hh,l,c,b,w,C),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=f,v=f+1,y=f+2;s=am(this,i,e,hh,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}}};function oW(e,t,r,i,n,s,a,o){let l;if(t.side===ei?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side===Ps,o),l===null)return null;sm.copy(o),sm.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(sm);return c<r.near||c>r.far?null:{distance:c,point:sm.clone(),object:e}}function am(e,t,r,i,n,s,a,o,l){e.getVertexPosition(a,Xd),e.getVertexPosition(o,Yd),e.getVertexPosition(l,Qd);let c=oW(e,t,r,i,Xd,Yd,Qd,My);if(c){n&&(rm.fromBufferAttribute(n,a),im.fromBufferAttribute(n,o),nm.fromBufferAttribute(n,l),c.uv=wi.getUV(My,Xd,Yd,Qd,rm,im,nm,new W)),s&&(rm.fromBufferAttribute(s,a),im.fromBufferAttribute(s,o),nm.fromBufferAttribute(s,l),c.uv2=wi.getUV(My,Xd,Yd,Qd,rm,im,nm,new W));let u={a,b:o,c:l,normal:new T,materialIndex:0};wi.getNormal(Xd,Yd,Qd,u.normal),c.face=u}return c}var fa=class extends nt{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],c=[],u=[],h=0,d=0;p("z","y","x",-1,-1,r,t,e,s,n,0),p("z","y","x",1,-1,r,t,-e,s,n,1),p("x","z","y",1,1,e,r,t,i,s,2),p("x","z","y",1,-1,e,r,-t,i,s,3),p("x","y","z",1,-1,e,t,r,i,n,4),p("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new ze(l,3)),this.setAttribute("normal",new ze(c,3)),this.setAttribute("uv",new ze(u,2));function p(f,m,g,v,y,x,b,w,C,_,S){let A=x/C,E=b/_,L=x/2,P=b/2,D=w/2,I=C+1,B=_+1,X=0,H=0,R=new T;for(let q=0;q<B;q++){let F=q*E-P;for(let z=0;z<I;z++){let U=z*A-L;R[f]=U*v,R[m]=F*y,R[g]=D,l.push(R.x,R.y,R.z),R[f]=0,R[m]=0,R[g]=w>0?1:-1,c.push(R.x,R.y,R.z),u.push(z/C),u.push(1-q/_),X+=1}}for(let q=0;q<_;q++)for(let F=0;F<C;F++){let z=h+F+I*q,U=h+F+I*(q+1),K=h+(F+1)+I*(q+1),j=h+(F+1)+I*q;o.push(z,U,j),o.push(U,K,j),H+=6}a.addGroup(d,H,S),d+=H,h+=X}}static fromJSON(e){return new fa(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function qu(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Di(e){let t={};for(let r=0;r<e.length;r++){let i=qu(e[r]);for(let n in i)t[n]=i[n]}return t}function lW(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function rD(e){return e.getRenderTarget()===null&&e.outputEncoding===dt?Zs:gg}var pd={clone:qu,merge:Di},cW=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hW=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Yt=class extends u1{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=cW,this.fragmentShader=hW,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=qu(e.uniforms),this.uniformsGroups=lW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},fd=class extends Vt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ce,this.projectionMatrix=new Ce,this.projectionMatrixInverse=new Ce}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},bi=class extends fd{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Of*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Yp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Of*2*Math.atan(Math.tan(Yp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Yp*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},uh=-90,dh=1,uW=class extends Vt{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new bi(uh,dh,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new bi(uh,dh,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new bi(uh,dh,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new bi(uh,dh,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new bi(uh,dh,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new bi(uh,dh,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=ro,e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}},x7=class extends Vr{constructor(e,t,r,i,n,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Bc,super(e,t,r,i,n,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},dW=class extends jt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new x7(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:yt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new fa(5,5,5),n=new Yt({name:"CubemapFromEquirect",uniforms:qu(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:ei,blending:Rr});n.uniforms.tEquirect.value=t;let s=new $i(i,n),a=t.minFilter;return t.minFilter===Gu&&(t.minFilter=yt),new uW(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},Ty=new T,pW=new T,fW=new ti,xn=class{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=Ty.subVectors(r,t).cross(pW.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(Ty),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||fW.getNormalMatrix(e),i=this.coplanarPoint(Ty).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},ph=new Ln,om=new T,b7=class{constructor(e=new xn,t=new xn,r=new xn,i=new xn,n=new xn,s=new xn){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-i,u-o,f-h,y-m).normalize(),t[1].setComponents(a+i,u+o,f+h,y+m).normalize(),t[2].setComponents(a+n,u+l,f+d,y+g).normalize(),t[3].setComponents(a-n,u-l,f-d,y-g).normalize(),t[4].setComponents(a-s,u-c,f-p,y-v).normalize(),t[5].setComponents(a+s,u+c,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),ph.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ph)}intersectsSprite(e){return ph.center.set(0,0,0),ph.radius=.7071067811865476,ph.applyMatrix4(e.matrixWorld),this.intersectsSphere(ph)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(om.x=i.normal.x>0?e.max.x:e.min.x,om.y=i.normal.y>0?e.max.y:e.min.y,om.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(om)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function iD(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function mW(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,u){let h=c.array,d=c.usage,p=e.createBuffer();e.bindBuffer(u,p),e.bufferData(u,h,d),c.onUploadCallback();let f;if(h instanceof Float32Array)f=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(h instanceof Int16Array)f=5122;else if(h instanceof Uint32Array)f=5125;else if(h instanceof Int32Array)f=5124;else if(h instanceof Int8Array)f=5120;else if(h instanceof Uint8Array)f=5121;else if(h instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){let d=u.array,p=u.updateRange;e.bindBuffer(h,c),p.count===-1?e.bufferSubData(h,0,d):(r?e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);h===void 0?i.set(c,n(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:a,remove:o,update:l}}var kv=class extends nt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,c=o+1,u=e/a,h=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){let v=g*h-s;for(let y=0;y<l;y++){let x=y*u-n;p.push(x,-v,0),f.push(0,0,1),m.push(y/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let v=0;v<a;v++){let y=v+l*g,x=v+l*(g+1),b=v+1+l*(g+1),w=v+1+l*g;d.push(y,x,w),d.push(x,b,w)}this.setIndex(d),this.setAttribute("position",new ze(p,3)),this.setAttribute("normal",new ze(f,3)),this.setAttribute("uv",new ze(m,2))}static fromJSON(e){return new kv(e.width,e.height,e.widthSegments,e.heightSegments)}},gW=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,vW=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,yW=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,xW=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,bW=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,wW=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,CW="vec3 transformed = vec3( position );",SW=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,_W=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,AW=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,EW=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,MW=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,TW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,LW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,PW=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,DW=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,IW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,OW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,RW=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,BW=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,kW=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,NW=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,zW=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,FW=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,jW=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,UW=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,VW="gl_FragColor = linearToOutputTexel( gl_FragColor );",HW=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,GW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,WW=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,qW=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,XW=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,YW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,QW=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,KW=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ZW=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,JW=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,$W=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,eq=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,tq=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,rq=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,iq=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,nq=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,sq=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,aq=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,oq=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lq=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,cq=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hq=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,uq=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,dq=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,pq=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,fq=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,mq=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,gq=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vq=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,yq=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,xq=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,bq=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wq=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Cq=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Sq=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,_q=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Aq=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Eq=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Mq=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Tq=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Lq=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Pq=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Dq=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Iq=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Oq=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Rq=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Bq=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,kq=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Nq=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,zq=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Fq=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,jq=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Uq=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Vq=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Hq=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Gq=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Wq=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,qq=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xq=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Yq=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Qq=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Kq=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Zq=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Jq=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,$q=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,eX=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,tX=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,rX=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,iX=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,nX=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,sX=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,aX=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,oX=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,lX=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,cX=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,hX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,dX=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,pX=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,fX=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,mX=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,gX=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,vX=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,yX=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xX=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,bX=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,wX=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,CX=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,SX=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,_X=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,AX=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,EX=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,MX=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,TX=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,LX=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PX=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DX=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IX=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,OX=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RX=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,BX=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,kX=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NX=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zX=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,FX=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jX=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UX=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VX=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,HX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,GX=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WX=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,qX=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,XX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ft={alphamap_fragment:gW,alphamap_pars_fragment:vW,alphatest_fragment:yW,alphatest_pars_fragment:xW,aomap_fragment:bW,aomap_pars_fragment:wW,begin_vertex:CW,beginnormal_vertex:SW,bsdfs:_W,iridescence_fragment:AW,bumpmap_pars_fragment:EW,clipping_planes_fragment:MW,clipping_planes_pars_fragment:TW,clipping_planes_pars_vertex:LW,clipping_planes_vertex:PW,color_fragment:DW,color_pars_fragment:IW,color_pars_vertex:OW,color_vertex:RW,common:BW,cube_uv_reflection_fragment:kW,defaultnormal_vertex:NW,displacementmap_pars_vertex:zW,displacementmap_vertex:FW,emissivemap_fragment:jW,emissivemap_pars_fragment:UW,encodings_fragment:VW,encodings_pars_fragment:HW,envmap_fragment:GW,envmap_common_pars_fragment:WW,envmap_pars_fragment:qW,envmap_pars_vertex:XW,envmap_physical_pars_fragment:sq,envmap_vertex:YW,fog_vertex:QW,fog_pars_vertex:KW,fog_fragment:ZW,fog_pars_fragment:JW,gradientmap_pars_fragment:$W,lightmap_fragment:eq,lightmap_pars_fragment:tq,lights_lambert_fragment:rq,lights_lambert_pars_fragment:iq,lights_pars_begin:nq,lights_toon_fragment:aq,lights_toon_pars_fragment:oq,lights_phong_fragment:lq,lights_phong_pars_fragment:cq,lights_physical_fragment:hq,lights_physical_pars_fragment:uq,lights_fragment_begin:dq,lights_fragment_maps:pq,lights_fragment_end:fq,logdepthbuf_fragment:mq,logdepthbuf_pars_fragment:gq,logdepthbuf_pars_vertex:vq,logdepthbuf_vertex:yq,map_fragment:xq,map_pars_fragment:bq,map_particle_fragment:wq,map_particle_pars_fragment:Cq,metalnessmap_fragment:Sq,metalnessmap_pars_fragment:_q,morphcolor_vertex:Aq,morphnormal_vertex:Eq,morphtarget_pars_vertex:Mq,morphtarget_vertex:Tq,normal_fragment_begin:Lq,normal_fragment_maps:Pq,normal_pars_fragment:Dq,normal_pars_vertex:Iq,normal_vertex:Oq,normalmap_pars_fragment:Rq,clearcoat_normal_fragment_begin:Bq,clearcoat_normal_fragment_maps:kq,clearcoat_pars_fragment:Nq,iridescence_pars_fragment:zq,output_fragment:Fq,packing:jq,premultiplied_alpha_fragment:Uq,project_vertex:Vq,dithering_fragment:Hq,dithering_pars_fragment:Gq,roughnessmap_fragment:Wq,roughnessmap_pars_fragment:qq,shadowmap_pars_fragment:Xq,shadowmap_pars_vertex:Yq,shadowmap_vertex:Qq,shadowmask_pars_fragment:Kq,skinbase_vertex:Zq,skinning_pars_vertex:Jq,skinning_vertex:$q,skinnormal_vertex:eX,specularmap_fragment:tX,specularmap_pars_fragment:rX,tonemapping_fragment:iX,tonemapping_pars_fragment:nX,transmission_fragment:sX,transmission_pars_fragment:aX,uv_pars_fragment:oX,uv_pars_vertex:lX,uv_vertex:cX,uv2_pars_fragment:hX,uv2_pars_vertex:uX,uv2_vertex:dX,worldpos_vertex:pX,background_vert:fX,background_frag:mX,backgroundCube_vert:gX,backgroundCube_frag:vX,cube_vert:yX,cube_frag:xX,depth_vert:bX,depth_frag:wX,distanceRGBA_vert:CX,distanceRGBA_frag:SX,equirect_vert:_X,equirect_frag:AX,linedashed_vert:EX,linedashed_frag:MX,meshbasic_vert:TX,meshbasic_frag:LX,meshlambert_vert:PX,meshlambert_frag:DX,meshmatcap_vert:IX,meshmatcap_frag:OX,meshnormal_vert:RX,meshnormal_frag:BX,meshphong_vert:kX,meshphong_frag:NX,meshphysical_vert:zX,meshphysical_frag:FX,meshtoon_vert:jX,meshtoon_frag:UX,points_vert:VX,points_frag:HX,shadow_vert:GX,shadow_frag:WX,sprite_vert:qX,sprite_frag:XX},Le={common:{diffuse:{value:new $e(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ti},uv2Transform:{value:new ti},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new W(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new $e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new $e(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ti}},sprite:{diffuse:{value:new $e(16777215)},opacity:{value:1},center:{value:new W(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ti}}},Js={basic:{uniforms:Di([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.fog]),vertexShader:ft.meshbasic_vert,fragmentShader:ft.meshbasic_frag},lambert:{uniforms:Di([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new $e(0)}}]),vertexShader:ft.meshlambert_vert,fragmentShader:ft.meshlambert_frag},phong:{uniforms:Di([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new $e(0)},specular:{value:new $e(1118481)},shininess:{value:30}}]),vertexShader:ft.meshphong_vert,fragmentShader:ft.meshphong_frag},standard:{uniforms:Di([Le.common,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.roughnessmap,Le.metalnessmap,Le.fog,Le.lights,{emissive:{value:new $e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ft.meshphysical_vert,fragmentShader:ft.meshphysical_frag},toon:{uniforms:Di([Le.common,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.gradientmap,Le.fog,Le.lights,{emissive:{value:new $e(0)}}]),vertexShader:ft.meshtoon_vert,fragmentShader:ft.meshtoon_frag},matcap:{uniforms:Di([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,{matcap:{value:null}}]),vertexShader:ft.meshmatcap_vert,fragmentShader:ft.meshmatcap_frag},points:{uniforms:Di([Le.points,Le.fog]),vertexShader:ft.points_vert,fragmentShader:ft.points_frag},dashed:{uniforms:Di([Le.common,Le.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ft.linedashed_vert,fragmentShader:ft.linedashed_frag},depth:{uniforms:Di([Le.common,Le.displacementmap]),vertexShader:ft.depth_vert,fragmentShader:ft.depth_frag},normal:{uniforms:Di([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,{opacity:{value:1}}]),vertexShader:ft.meshnormal_vert,fragmentShader:ft.meshnormal_frag},sprite:{uniforms:Di([Le.sprite,Le.fog]),vertexShader:ft.sprite_vert,fragmentShader:ft.sprite_frag},background:{uniforms:{uvTransform:{value:new ti},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ft.background_vert,fragmentShader:ft.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ft.backgroundCube_vert,fragmentShader:ft.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ft.cube_vert,fragmentShader:ft.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ft.equirect_vert,fragmentShader:ft.equirect_frag},distanceRGBA:{uniforms:Di([Le.common,Le.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ft.distanceRGBA_vert,fragmentShader:ft.distanceRGBA_frag},shadow:{uniforms:Di([Le.lights,Le.fog,{color:{value:new $e(0)},opacity:{value:1}}]),vertexShader:ft.shadow_vert,fragmentShader:ft.shadow_frag}};Js.physical={uniforms:Di([Js.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new W(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new $e(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new W},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new $e(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new $e(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ft.meshphysical_vert,fragmentShader:ft.meshphysical_frag};var lm={r:0,b:0,g:0};function YX(e,t,r,i,n,s,a){let o=new $e(0),l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(g,v){let y=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?r:t).get(x));let b=e.xr,w=b.getSession&&b.getSession();w&&w.environmentBlendMode==="additive"&&(x=null),x===null?m(o,l):x&&x.isColor&&(m(x,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===h1)?(u===void 0&&(u=new $i(new fa(1,1,1),new Yt({name:"BackgroundCubeMaterial",uniforms:qu(Js.backgroundCube.uniforms),vertexShader:Js.backgroundCube.vertexShader,fragmentShader:Js.backgroundCube.fragmentShader,side:ei,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(C,_,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=x.encoding!==dt,(h!==x||d!==x.version||p!==e.toneMapping)&&(u.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new $i(new kv(2,2),new Yt({name:"BackgroundMaterial",uniforms:qu(Js.background.uniforms),vertexShader:Js.background.vertexShader,fragmentShader:Js.background.fragmentShader,side:Ps,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==dt,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||d!==x.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(lm,rD(e)),i.buffers.color.setClear(lm.r,lm.g,lm.b,v,a)}return{getClearColor:function(){return o},setClearColor:function(g,v=1){o.set(g),l=v,m(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(o,l)},render:f}}function QX(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=g(null),c=l,u=!1;function h(I,B,X,H,R){let q=!1;if(a){let F=m(H,X,B);c!==F&&(c=F,p(c.object)),q=v(I,H,X,R),q&&y(I,H,X,R)}else{let F=B.wireframe===!0;(c.geometry!==H.id||c.program!==X.id||c.wireframe!==F)&&(c.geometry=H.id,c.program=X.id,c.wireframe=F,q=!0)}R!==null&&r.update(R,34963),(q||u)&&(u=!1,S(I,B,X,H),R!==null&&e.bindBuffer(34963,r.get(R).buffer))}function d(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function p(I){return i.isWebGL2?e.bindVertexArray(I):s.bindVertexArrayOES(I)}function f(I){return i.isWebGL2?e.deleteVertexArray(I):s.deleteVertexArrayOES(I)}function m(I,B,X){let H=X.wireframe===!0,R=o[I.id];R===void 0&&(R={},o[I.id]=R);let q=R[B.id];q===void 0&&(q={},R[B.id]=q);let F=q[H];return F===void 0&&(F=g(d()),q[H]=F),F}function g(I){let B=[],X=[],H=[];for(let R=0;R<n;R++)B[R]=0,X[R]=0,H[R]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:X,attributeDivisors:H,object:I,attributes:{},index:null}}function v(I,B,X,H){let R=c.attributes,q=B.attributes,F=0,z=X.getAttributes();for(let U in z)if(z[U].location>=0){let K=R[U],j=q[U];if(j===void 0&&(U==="instanceMatrix"&&I.instanceMatrix&&(j=I.instanceMatrix),U==="instanceColor"&&I.instanceColor&&(j=I.instanceColor)),K===void 0||K.attribute!==j||j&&K.data!==j.data)return!0;F++}return c.attributesNum!==F||c.index!==H}function y(I,B,X,H){let R={},q=B.attributes,F=0,z=X.getAttributes();for(let U in z)if(z[U].location>=0){let K=q[U];K===void 0&&(U==="instanceMatrix"&&I.instanceMatrix&&(K=I.instanceMatrix),U==="instanceColor"&&I.instanceColor&&(K=I.instanceColor));let j={};j.attribute=K,K&&K.data&&(j.data=K.data),R[U]=j,F++}c.attributes=R,c.attributesNum=F,c.index=H}function x(){let I=c.newAttributes;for(let B=0,X=I.length;B<X;B++)I[B]=0}function b(I){w(I,0)}function w(I,B){let X=c.newAttributes,H=c.enabledAttributes,R=c.attributeDivisors;X[I]=1,H[I]===0&&(e.enableVertexAttribArray(I),H[I]=1),R[I]!==B&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](I,B),R[I]=B)}function C(){let I=c.newAttributes,B=c.enabledAttributes;for(let X=0,H=B.length;X<H;X++)B[X]!==I[X]&&(e.disableVertexAttribArray(X),B[X]=0)}function _(I,B,X,H,R,q){i.isWebGL2===!0&&(X===5124||X===5125)?e.vertexAttribIPointer(I,B,X,R,q):e.vertexAttribPointer(I,B,X,H,R,q)}function S(I,B,X,H){if(i.isWebGL2===!1&&(I.isInstancedMesh||H.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();let R=H.attributes,q=X.getAttributes(),F=B.defaultAttributeValues;for(let z in q){let U=q[z];if(U.location>=0){let K=R[z];if(K===void 0&&(z==="instanceMatrix"&&I.instanceMatrix&&(K=I.instanceMatrix),z==="instanceColor"&&I.instanceColor&&(K=I.instanceColor)),K!==void 0){let j=K.normalized,Y=K.itemSize,V=r.get(K);if(V===void 0)continue;let ie=V.buffer,$=V.type,ee=V.bytesPerElement;if(K.isInterleavedBufferAttribute){let ne=K.data,ce=ne.stride,ue=K.offset;if(ne.isInstancedInterleavedBuffer){for(let ye=0;ye<U.locationSize;ye++)w(U.location+ye,ne.meshPerAttribute);I.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let ye=0;ye<U.locationSize;ye++)b(U.location+ye);e.bindBuffer(34962,ie);for(let ye=0;ye<U.locationSize;ye++)_(U.location+ye,Y/U.locationSize,$,j,ce*ee,(ue+Y/U.locationSize*ye)*ee)}else{if(K.isInstancedBufferAttribute){for(let ne=0;ne<U.locationSize;ne++)w(U.location+ne,K.meshPerAttribute);I.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=K.meshPerAttribute*K.count)}else for(let ne=0;ne<U.locationSize;ne++)b(U.location+ne);e.bindBuffer(34962,ie);for(let ne=0;ne<U.locationSize;ne++)_(U.location+ne,Y/U.locationSize,$,j,Y*ee,Y/U.locationSize*ne*ee)}}else if(F!==void 0){let j=F[z];if(j!==void 0)switch(j.length){case 2:e.vertexAttrib2fv(U.location,j);break;case 3:e.vertexAttrib3fv(U.location,j);break;case 4:e.vertexAttrib4fv(U.location,j);break;default:e.vertexAttrib1fv(U.location,j)}}}}C()}function A(){P();for(let I in o){let B=o[I];for(let X in B){let H=B[X];for(let R in H)f(H[R].object),delete H[R];delete B[X]}delete o[I]}}function E(I){if(o[I.id]===void 0)return;let B=o[I.id];for(let X in B){let H=B[X];for(let R in H)f(H[R].object),delete H[R];delete B[X]}delete o[I.id]}function L(I){for(let B in o){let X=o[B];if(X[I.id]===void 0)continue;let H=X[I.id];for(let R in H)f(H[R].object),delete H[R];delete X[I.id]}}function P(){D(),u=!0,c!==l&&(c=l,p(c.object))}function D(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:P,resetDefaultState:D,dispose:A,releaseStatesOfGeometry:E,releaseStatesOfProgram:L,initAttributes:x,enableAttribute:b,disableUnusedAttributes:C}}function KX(e,t,r,i){let n=i.isWebGL2,s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),r.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,p;if(n)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,u,h),r.update(u,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function ZX(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let _=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(_.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(_){if(_==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";_="mediump"}return _==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,h=e.getParameter(34930),d=e.getParameter(35660),p=e.getParameter(3379),f=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),x=d>0,b=a||t.has("OES_texture_float"),w=x&&b,C=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:w,maxSamples:C}}function JX(e){let t=this,r=null,i=0,n=!1,s=!1,a=new xn,o=new ti,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||i!==0||n;return n=d,i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){r=u(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,v=e.get(h);if(!n||f===null||f.length===0||s&&!g)s?u(null):c();else{let y=s?0:i,x=y*4,b=v.clippingState||null;l.value=b,b=u(f,d,x,p);for(let w=0;w!==x;++w)b[w]=r[w];v.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(h,d,p,f){let m=h!==null?h.length:0,g=null;if(m!==0){if(g=l.value,f!==!0||g===null){let v=p+m*4,y=d.matrixWorldInverse;o.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let x=0,b=p;x!==m;++x,b+=4)a.copy(h[x]).applyMatrix4(y,o),a.normal.toArray(g,b),g[b+3]=a.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,g}}function $X(e){let t=new WeakMap;function r(a,o){return o===a5?a.mapping=Bc:o===o5&&(a.mapping=kc),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===a5||o===o5)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new dW(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",n),r(c.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var w7=class extends fd{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},nu=4,gC=[.125,.215,.35,.446,.526,.582],ic=20,Ly=new w7,vC=new $e,Py=null,$l=(1+Math.sqrt(5))/2,fh=1/$l,yC=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,$l,fh),new T(0,$l,-fh),new T(fh,0,$l),new T(-fh,0,$l),new T($l,fh,0),new T(-$l,fh,0)],xC=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){Py=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=CC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=wC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Py),e.scissorTest=!1,cm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Bc||e.mapping===kc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Py=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:yt,minFilter:yt,generateMipmaps:!1,type:Wu,format:Xn,encoding:pa,depthBuffer:!1},i=bC(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=bC(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=eY(n)),this._blurMaterial=tY(n,e,t)}return i}_compileMaterial(e){let t=new $i(this._lodPlanes[0],e);this._renderer.compile(t,Ly)}_sceneToCubeUV(e,t,r,i){let n=new bi(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(vC),o.toneMapping=ro,o.autoClear=!1;let u=new d1({name:"PMREM.Background",side:ei,depthWrite:!1,depthTest:!1}),h=new $i(new fa,u),d=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(vC),d=!0);for(let f=0;f<6;f++){let m=f%3;m===0?(n.up.set(0,s[f],0),n.lookAt(a[f],0,0)):m===1?(n.up.set(0,0,s[f]),n.lookAt(0,a[f],0)):(n.up.set(0,s[f],0),n.lookAt(0,0,a[f]));let g=this._cubeSize;cm(i,m*g,f>2?g:0,g,g),o.setRenderTarget(i),d&&o.render(h,n),o.render(e,n)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===Bc||e.mapping===kc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=CC()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=wC());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new $i(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;cm(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,Ly)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=yC[(i-1)%yC.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new $i(this._lodPlanes[i],l),h=l.uniforms,d=this._sizeLods[r]-1,p=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*ic-1),f=n/p,m=isFinite(n)?1+Math.floor(c*f):ic;m>ic&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${ic}`);let g=[],v=0;for(let C=0;C<ic;++C){let _=C/f,S=Math.exp(-_*_/2);g.push(S),C===0?v+=S:C<m&&(v+=2*S)}for(let C=0;C<g.length;C++)g[C]=g[C]/v;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-r;let x=this._sizeLods[i],b=3*x*(i>y-nu?i-y+nu:0),w=4*(this._cubeSize-x);cm(t,b,w,3*x,2*x),o.setRenderTarget(t),o.render(u,Ly)}};function eY(e){let t=[],r=[],i=[],n=e,s=e-nu+1+gC.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-nu?l=gC[a-e+nu-1]:a===0&&(l=0),i.push(l);let c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,m=3,g=2,v=1,y=new Float32Array(m*f*p),x=new Float32Array(g*f*p),b=new Float32Array(v*f*p);for(let C=0;C<p;C++){let _=C%3*2/3-1,S=C>2?0:-1,A=[_,S,0,_+2/3,S,0,_+2/3,S+1,0,_,S,0,_+2/3,S+1,0,_,S+1,0];y.set(A,m*f*C),x.set(d,g*f*C);let E=[C,C,C,C,C,C];b.set(E,v*f*C)}let w=new nt;w.setAttribute("position",new st(y,m)),w.setAttribute("uv",new st(x,g)),w.setAttribute("faceIndex",new st(b,v)),t.push(w),n>nu&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function bC(e,t,r){let i=new jt(e,t,r);return i.texture.mapping=h1,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function cm(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function tY(e,t,r){let i=new Float32Array(ic),n=new T(0,1,0);return new Yt({name:"SphericalGaussianBlur",defines:{n:ic,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:C7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function wC(){return new Yt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:C7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function CC(){return new Yt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:C7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function C7(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function rY(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,c=l===a5||l===o5,u=l===Bc||l===kc;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return r===null&&(r=new xC(e)),h=c?r.fromEquirectangular(o,h):r.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{let h=o.image;if(c&&h&&h.height>0||u&&h&&n(h)){r===null&&(r=new xC(e));let d=c?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let l=0,c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function iY(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function nY(e,t,r,i){let n={},s=new WeakMap;function a(h){let d=h.target;d.index!==null&&t.remove(d.index);for(let f in d.attributes)t.remove(d.attributes[f]);d.removeEventListener("dispose",a),delete n[d.id];let p=s.get(d);p&&(t.remove(p),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,r.memory.geometries--}function o(h,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,r.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)t.update(d[f],34962);let p=h.morphAttributes;for(let f in p){let m=p[f];for(let g=0,v=m.length;g<v;g++)t.update(m[g],34962)}}function c(h){let d=[],p=h.index,f=h.attributes.position,m=0;if(p!==null){let y=p.array;m=p.version;for(let x=0,b=y.length;x<b;x+=3){let w=y[x+0],C=y[x+1],_=y[x+2];d.push(w,C,C,_,_,w)}}else{let y=f.array;m=f.version;for(let x=0,b=y.length/3-1;x<b;x+=3){let w=x+0,C=x+1,_=x+2;d.push(w,C,C,_,_,w)}}let g=new(KP(d)?yu:tD)(d,1);g.version=m;let v=s.get(h);v&&t.remove(v),s.set(h,g)}function u(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:u}}function sY(e,t,r,i){let n=i.isWebGL2,s;function a(d){s=d}let o,l;function c(d){o=d.type,l=d.bytesPerElement}function u(d,p){e.drawElements(s,p,o,d*l),r.update(p,s,1)}function h(d,p,f){if(f===0)return;let m,g;if(n)m=e,g="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,p,o,d*l,f),r.update(p,s,f)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=h}function aY(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function oY(e,t){return e[0]-t[0]}function lY(e,t){return Math.abs(t[1])-Math.abs(e[1])}function cY(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new pt,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,h,d){let p=c.morphTargetInfluences;if(t.isWebGL2===!0){let f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=f!==void 0?f.length:0,g=s.get(u);if(g===void 0||g.count!==m){let x=function(){I.dispose(),s.delete(u),u.removeEventListener("dispose",x)};g!==void 0&&g.texture.dispose();let b=u.morphAttributes.position!==void 0,w=u.morphAttributes.normal!==void 0,C=u.morphAttributes.color!==void 0,_=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],A=u.morphAttributes.color||[],E=0;b===!0&&(E=1),w===!0&&(E=2),C===!0&&(E=3);let L=u.attributes.position.count*E,P=1;L>t.maxTextureSize&&(P=Math.ceil(L/t.maxTextureSize),L=t.maxTextureSize);let D=new Float32Array(L*P*4*m),I=new eD(D,L,P,m);I.type=Cn,I.needsUpdate=!0;let B=E*4;for(let X=0;X<m;X++){let H=_[X],R=S[X],q=A[X],F=L*P*4*X;for(let z=0;z<H.count;z++){let U=z*B;b===!0&&(a.fromBufferAttribute(H,z),D[F+U+0]=a.x,D[F+U+1]=a.y,D[F+U+2]=a.z,D[F+U+3]=0),w===!0&&(a.fromBufferAttribute(R,z),D[F+U+4]=a.x,D[F+U+5]=a.y,D[F+U+6]=a.z,D[F+U+7]=0),C===!0&&(a.fromBufferAttribute(q,z),D[F+U+8]=a.x,D[F+U+9]=a.y,D[F+U+10]=a.z,D[F+U+11]=q.itemSize===4?a.w:1)}}g={count:m,texture:I,size:new W(L,P)},s.set(u,g),u.addEventListener("dispose",x)}let v=0;for(let x=0;x<p.length;x++)v+=p[x];let y=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(e,"morphTargetBaseInfluence",y),d.getUniforms().setValue(e,"morphTargetInfluences",p),d.getUniforms().setValue(e,"morphTargetsTexture",g.texture,r),d.getUniforms().setValue(e,"morphTargetsTextureSize",g.size)}else{let f=p===void 0?0:p.length,m=i[u.id];if(m===void 0||m.length!==f){m=[];for(let b=0;b<f;b++)m[b]=[b,0];i[u.id]=m}for(let b=0;b<f;b++){let w=m[b];w[0]=b,w[1]=p[b]}m.sort(lY);for(let b=0;b<8;b++)b<f&&m[b][1]?(o[b][0]=m[b][0],o[b][1]=m[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(oY);let g=u.morphAttributes.position,v=u.morphAttributes.normal,y=0;for(let b=0;b<8;b++){let w=o[b],C=w[0],_=w[1];C!==Number.MAX_SAFE_INTEGER&&_?(g&&u.getAttribute("morphTarget"+b)!==g[C]&&u.setAttribute("morphTarget"+b,g[C]),v&&u.getAttribute("morphNormal"+b)!==v[C]&&u.setAttribute("morphNormal"+b,v[C]),n[b]=_,y+=_):(g&&u.hasAttribute("morphTarget"+b)===!0&&u.deleteAttribute("morphTarget"+b),v&&u.hasAttribute("morphNormal"+b)===!0&&u.deleteAttribute("morphNormal"+b),n[b]=0)}let x=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(e,"morphTargetBaseInfluence",x),d.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function hY(e,t,r,i){let n=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,h=t.get(l,u);return n.get(h)!==c&&(t.update(h),n.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),h}function a(){n=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:s,dispose:a}}var nD=new Vr,sD=new eD,aD=new KG,oD=new x7,SC=[],_C=[],AC=new Float32Array(16),EC=new Float32Array(9),MC=new Float32Array(4);function md(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=SC[n];if(s===void 0&&(s=new Float32Array(n),SC[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function Gr(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Wr(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function Nv(e,t){let r=_C[t];r===void 0&&(r=new Int32Array(t),_C[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function uY(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function dY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Gr(r,t))return;e.uniform2fv(this.addr,t),Wr(r,t)}}function pY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Gr(r,t))return;e.uniform3fv(this.addr,t),Wr(r,t)}}function fY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Gr(r,t))return;e.uniform4fv(this.addr,t),Wr(r,t)}}function mY(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Gr(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Wr(r,t)}else{if(Gr(r,i))return;MC.set(i),e.uniformMatrix2fv(this.addr,!1,MC),Wr(r,i)}}function gY(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Gr(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Wr(r,t)}else{if(Gr(r,i))return;EC.set(i),e.uniformMatrix3fv(this.addr,!1,EC),Wr(r,i)}}function vY(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Gr(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Wr(r,t)}else{if(Gr(r,i))return;AC.set(i),e.uniformMatrix4fv(this.addr,!1,AC),Wr(r,i)}}function yY(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function xY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Gr(r,t))return;e.uniform2iv(this.addr,t),Wr(r,t)}}function bY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Gr(r,t))return;e.uniform3iv(this.addr,t),Wr(r,t)}}function wY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Gr(r,t))return;e.uniform4iv(this.addr,t),Wr(r,t)}}function CY(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function SY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Gr(r,t))return;e.uniform2uiv(this.addr,t),Wr(r,t)}}function _Y(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Gr(r,t))return;e.uniform3uiv(this.addr,t),Wr(r,t)}}function AY(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Gr(r,t))return;e.uniform4uiv(this.addr,t),Wr(r,t)}}function EY(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||nD,n)}function MY(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||aD,n)}function TY(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||oD,n)}function LY(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||sD,n)}function PY(e){switch(e){case 5126:return uY;case 35664:return dY;case 35665:return pY;case 35666:return fY;case 35674:return mY;case 35675:return gY;case 35676:return vY;case 5124:case 35670:return yY;case 35667:case 35671:return xY;case 35668:case 35672:return bY;case 35669:case 35673:return wY;case 5125:return CY;case 36294:return SY;case 36295:return _Y;case 36296:return AY;case 35678:case 36198:case 36298:case 36306:case 35682:return EY;case 35679:case 36299:case 36307:return MY;case 35680:case 36300:case 36308:case 36293:return TY;case 36289:case 36303:case 36311:case 36292:return LY}}function DY(e,t){e.uniform1fv(this.addr,t)}function IY(e,t){let r=md(t,this.size,2);e.uniform2fv(this.addr,r)}function OY(e,t){let r=md(t,this.size,3);e.uniform3fv(this.addr,r)}function RY(e,t){let r=md(t,this.size,4);e.uniform4fv(this.addr,r)}function BY(e,t){let r=md(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function kY(e,t){let r=md(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function NY(e,t){let r=md(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function zY(e,t){e.uniform1iv(this.addr,t)}function FY(e,t){e.uniform2iv(this.addr,t)}function jY(e,t){e.uniform3iv(this.addr,t)}function UY(e,t){e.uniform4iv(this.addr,t)}function VY(e,t){e.uniform1uiv(this.addr,t)}function HY(e,t){e.uniform2uiv(this.addr,t)}function GY(e,t){e.uniform3uiv(this.addr,t)}function WY(e,t){e.uniform4uiv(this.addr,t)}function qY(e,t,r){let i=this.cache,n=t.length,s=Nv(r,n);Gr(i,s)||(e.uniform1iv(this.addr,s),Wr(i,s));for(let a=0;a!==n;++a)r.setTexture2D(t[a]||nD,s[a])}function XY(e,t,r){let i=this.cache,n=t.length,s=Nv(r,n);Gr(i,s)||(e.uniform1iv(this.addr,s),Wr(i,s));for(let a=0;a!==n;++a)r.setTexture3D(t[a]||aD,s[a])}function YY(e,t,r){let i=this.cache,n=t.length,s=Nv(r,n);Gr(i,s)||(e.uniform1iv(this.addr,s),Wr(i,s));for(let a=0;a!==n;++a)r.setTextureCube(t[a]||oD,s[a])}function QY(e,t,r){let i=this.cache,n=t.length,s=Nv(r,n);Gr(i,s)||(e.uniform1iv(this.addr,s),Wr(i,s));for(let a=0;a!==n;++a)r.setTexture2DArray(t[a]||sD,s[a])}function KY(e){switch(e){case 5126:return DY;case 35664:return IY;case 35665:return OY;case 35666:return RY;case 35674:return BY;case 35675:return kY;case 35676:return NY;case 5124:case 35670:return zY;case 35667:case 35671:return FY;case 35668:case 35672:return jY;case 35669:case 35673:return UY;case 5125:return VY;case 36294:return HY;case 36295:return GY;case 36296:return WY;case 35678:case 36198:case 36298:case 36306:case 35682:return qY;case 35679:case 36299:case 36307:return XY;case 35680:case 36300:case 36308:case 36293:return YY;case 36289:case 36303:case 36311:case 36292:return QY}}var ZY=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=PY(t.type)}},JY=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=KY(t.type)}},$Y=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},Dy=/(\w+)(\])?(\[|\.)?/g;function TC(e,t){e.seq.push(t),e.map[t.id]=t}function eQ(e,t,r){let i=e.name,n=i.length;for(Dy.lastIndex=0;;){let s=Dy.exec(i),a=Dy.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===n){TC(r,c===void 0?new ZY(o,e,t):new JY(o,e,t));break}else{let u=r.map[o];u===void 0&&(u=new $Y(o),TC(r,u)),r=u}}}var S0=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);eQ(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function LC(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var tQ=0;function rQ(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function iQ(e){switch(e){case pa:return["Linear","( value )"];case dt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function PC(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+rQ(e.getShaderSource(t),a)}else return n}function nQ(e,t){let r=iQ(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function sQ(e,t){let r;switch(t){case uG:r="Linear";break;case dG:r="Reinhard";break;case pG:r="OptimizedCineon";break;case fG:r="ACESFilmic";break;case mG:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function aQ(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ep).join(`
`)}function oQ(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function lQ(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function Ep(e){return e!==""}function DC(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function IC(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var cQ=/^[ \t]*#include +<([\w\d./]+)>/gm;function d5(e){return e.replace(cQ,hQ)}function hQ(e,t){let r=ft[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return d5(r)}var uQ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function OC(e){return e.replace(uQ,dQ)}function dQ(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function RC(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function pQ(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===f7?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===HH?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Ap&&(t="SHADOWMAP_TYPE_VSM"),t}function fQ(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Bc:case kc:t="ENVMAP_TYPE_CUBE";break;case h1:t="ENVMAP_TYPE_CUBE_UV";break}return t}function mQ(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case kc:t="ENVMAP_MODE_REFRACTION";break}return t}function gQ(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case VP:t="ENVMAP_BLENDING_MULTIPLY";break;case cG:t="ENVMAP_BLENDING_MIX";break;case hG:t="ENVMAP_BLENDING_ADD";break}return t}function vQ(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function yQ(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=pQ(r),c=fQ(r),u=mQ(r),h=gQ(r),d=vQ(r),p=r.isWebGL2?"":aQ(r),f=oQ(s),m=n.createProgram(),g,v,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=[f].filter(Ep).join(`
`),g.length>0&&(g+=`
`),v=[p,f].filter(Ep).join(`
`),v.length>0&&(v+=`
`)):(g=[RC(r),"#define SHADER_NAME "+r.shaderName,f,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ep).join(`
`),v=[p,RC(r),"#define SHADER_NAME "+r.shaderName,f,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==ro?"#define TONE_MAPPING":"",r.toneMapping!==ro?ft.tonemapping_pars_fragment:"",r.toneMapping!==ro?sQ("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",ft.encodings_pars_fragment,nQ("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Ep).join(`
`)),a=d5(a),a=DC(a,r),a=IC(a,r),o=d5(o),o=DC(o,r),o=IC(o,r),a=OC(a),o=OC(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",r.glslVersion===nC?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===nC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let x=y+g+a,b=y+v+o,w=LC(n,35633,x),C=LC(n,35632,b);if(n.attachShader(m,w),n.attachShader(m,C),r.index0AttributeName!==void 0?n.bindAttribLocation(m,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),e.debug.checkShaderErrors){let A=n.getProgramInfoLog(m).trim(),E=n.getShaderInfoLog(w).trim(),L=n.getShaderInfoLog(C).trim(),P=!0,D=!0;if(n.getProgramParameter(m,35714)===!1){P=!1;let I=PC(n,w,"vertex"),B=PC(n,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+A+`
`+I+`
`+B)}else A!==""?console.warn("THREE.WebGLProgram: Program Info Log:",A):(E===""||L==="")&&(D=!1);D&&(this.diagnostics={runnable:P,programLog:A,vertexShader:{log:E,prefix:g},fragmentShader:{log:L,prefix:v}})}n.deleteShader(w),n.deleteShader(C);let _;this.getUniforms=function(){return _===void 0&&(_=new S0(n,m)),_};let S;return this.getAttributes=function(){return S===void 0&&(S=lQ(n,m)),S},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=tQ++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=C,this}var xQ=0,bQ=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new wQ(e),t.set(e,r)),r}},wQ=class{constructor(e){this.id=xQ++,this.code=e,this.usedTimes=0}};function CQ(e,t,r,i,n,s,a){let o=new y7,l=new bQ,c=[],u=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.vertexTextures,p=n.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(S,A,E,L,P){let D=L.fog,I=P.geometry,B=S.isMeshStandardMaterial?L.environment:null,X=(S.isMeshStandardMaterial?r:t).get(S.envMap||B),H=X&&X.mapping===h1?X.image.height:null,R=f[S.type];S.precision!==null&&(p=n.getMaxPrecision(S.precision),p!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",p,"instead."));let q=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,F=q!==void 0?q.length:0,z=0;I.morphAttributes.position!==void 0&&(z=1),I.morphAttributes.normal!==void 0&&(z=2),I.morphAttributes.color!==void 0&&(z=3);let U,K,j,Y;if(R){let ne=Js[R];U=ne.vertexShader,K=ne.fragmentShader}else U=S.vertexShader,K=S.fragmentShader,l.update(S),j=l.getVertexShaderID(S),Y=l.getFragmentShaderID(S);let V=e.getRenderTarget(),ie=S.alphaTest>0,$=S.clearcoat>0,ee=S.iridescence>0;return{isWebGL2:u,shaderID:R,shaderName:S.type,vertexShader:U,fragmentShader:K,defines:S.defines,customVertexShaderID:j,customFragmentShaderID:Y,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:p,instancing:P.isInstancedMesh===!0,instancingColor:P.isInstancedMesh===!0&&P.instanceColor!==null,supportsVertexTextures:d,outputEncoding:V===null?e.outputEncoding:V.isXRRenderTarget===!0?V.texture.encoding:pa,map:!!S.map,matcap:!!S.matcap,envMap:!!X,envMapMode:X&&X.mapping,envMapCubeUVHeight:H,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===OG,tangentSpaceNormalMap:S.normalMapType===IG,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===dt,clearcoat:$,clearcoatMap:$&&!!S.clearcoatMap,clearcoatRoughnessMap:$&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:$&&!!S.clearcoatNormalMap,iridescence:ee,iridescenceMap:ee&&!!S.iridescenceMap,iridescenceThicknessMap:ee&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===vu,alphaMap:!!S.alphaMap,alphaTest:ie,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!I.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!I.attributes.color&&I.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!D,useFog:S.fog===!0,fogExp2:D&&D.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:h,skinning:P.isSkinnedMesh===!0,morphTargets:I.morphAttributes.position!==void 0,morphNormals:I.morphAttributes.normal!==void 0,morphColors:I.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:z,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&E.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:ro,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===wn,flipSided:S.side===ei,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function g(S){let A=[];if(S.shaderID?A.push(S.shaderID):(A.push(S.customVertexShaderID),A.push(S.customFragmentShaderID)),S.defines!==void 0)for(let E in S.defines)A.push(E),A.push(S.defines[E]);return S.isRawShaderMaterial===!1&&(v(A,S),y(A,S),A.push(e.outputEncoding)),A.push(S.customProgramCacheKey),A.join()}function v(S,A){S.push(A.precision),S.push(A.outputEncoding),S.push(A.envMapMode),S.push(A.envMapCubeUVHeight),S.push(A.combine),S.push(A.vertexUvs),S.push(A.fogExp2),S.push(A.sizeAttenuation),S.push(A.morphTargetsCount),S.push(A.morphAttributeCount),S.push(A.numDirLights),S.push(A.numPointLights),S.push(A.numSpotLights),S.push(A.numSpotLightMaps),S.push(A.numHemiLights),S.push(A.numRectAreaLights),S.push(A.numDirLightShadows),S.push(A.numPointLightShadows),S.push(A.numSpotLightShadows),S.push(A.numSpotLightShadowsWithMaps),S.push(A.shadowMapType),S.push(A.toneMapping),S.push(A.numClippingPlanes),S.push(A.numClipIntersection),S.push(A.depthPacking)}function y(S,A){o.disableAll(),A.isWebGL2&&o.enable(0),A.supportsVertexTextures&&o.enable(1),A.instancing&&o.enable(2),A.instancingColor&&o.enable(3),A.map&&o.enable(4),A.matcap&&o.enable(5),A.envMap&&o.enable(6),A.lightMap&&o.enable(7),A.aoMap&&o.enable(8),A.emissiveMap&&o.enable(9),A.bumpMap&&o.enable(10),A.normalMap&&o.enable(11),A.objectSpaceNormalMap&&o.enable(12),A.tangentSpaceNormalMap&&o.enable(13),A.clearcoat&&o.enable(14),A.clearcoatMap&&o.enable(15),A.clearcoatRoughnessMap&&o.enable(16),A.clearcoatNormalMap&&o.enable(17),A.iridescence&&o.enable(18),A.iridescenceMap&&o.enable(19),A.iridescenceThicknessMap&&o.enable(20),A.displacementMap&&o.enable(21),A.specularMap&&o.enable(22),A.roughnessMap&&o.enable(23),A.metalnessMap&&o.enable(24),A.gradientMap&&o.enable(25),A.alphaMap&&o.enable(26),A.alphaTest&&o.enable(27),A.vertexColors&&o.enable(28),A.vertexAlphas&&o.enable(29),A.vertexUvs&&o.enable(30),A.vertexTangents&&o.enable(31),A.uvsVertexOnly&&o.enable(32),S.push(o.mask),o.disableAll(),A.fog&&o.enable(0),A.useFog&&o.enable(1),A.flatShading&&o.enable(2),A.logarithmicDepthBuffer&&o.enable(3),A.skinning&&o.enable(4),A.morphTargets&&o.enable(5),A.morphNormals&&o.enable(6),A.morphColors&&o.enable(7),A.premultipliedAlpha&&o.enable(8),A.shadowMapEnabled&&o.enable(9),A.physicallyCorrectLights&&o.enable(10),A.doubleSided&&o.enable(11),A.flipSided&&o.enable(12),A.useDepthPacking&&o.enable(13),A.dithering&&o.enable(14),A.specularIntensityMap&&o.enable(15),A.specularColorMap&&o.enable(16),A.transmission&&o.enable(17),A.transmissionMap&&o.enable(18),A.thicknessMap&&o.enable(19),A.sheen&&o.enable(20),A.sheenColorMap&&o.enable(21),A.sheenRoughnessMap&&o.enable(22),A.decodeVideoTexture&&o.enable(23),A.opaque&&o.enable(24),S.push(o.mask)}function x(S){let A=f[S.type],E;if(A){let L=Js[A];E=pd.clone(L.uniforms)}else E=S.uniforms;return E}function b(S,A){let E;for(let L=0,P=c.length;L<P;L++){let D=c[L];if(D.cacheKey===A){E=D,++E.usedTimes;break}}return E===void 0&&(E=new yQ(e,A,S,s),c.push(E)),E}function w(S){if(--S.usedTimes===0){let A=c.indexOf(S);c[A]=c[c.length-1],c.pop(),S.destroy()}}function C(S){l.remove(S)}function _(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:b,releaseProgram:w,releaseShaderCache:C,programs:c,dispose:_}}function SQ(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function _Q(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function BC(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function kC(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(h,d,p,f,m,g){let v=e[t];return v===void 0?(v={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:m,group:g},e[t]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=p,v.groupOrder=f,v.renderOrder=h.renderOrder,v.z=m,v.group=g),t++,v}function o(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.push(v):p.transparent===!0?n.push(v):r.push(v)}function l(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.unshift(v):p.transparent===!0?n.unshift(v):r.unshift(v)}function c(h,d){r.length>1&&r.sort(h||_Q),i.length>1&&i.sort(d||BC),n.length>1&&n.sort(d||BC)}function u(){for(let h=t,d=e.length;h<d;h++){let p=e[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:u,sort:c}}function AQ(){let e=new WeakMap;function t(i,n){let s=e.get(i),a;return s===void 0?(a=new kC,e.set(i,[a])):n>=s.length?(a=new kC,s.push(a)):a=s[n],a}function r(){e=new WeakMap}return{get:t,dispose:r}}function EQ(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new T,color:new $e};break;case"SpotLight":r={position:new T,direction:new T,color:new $e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new T,color:new $e,distance:0,decay:0};break;case"HemisphereLight":r={direction:new T,skyColor:new $e,groundColor:new $e};break;case"RectAreaLight":r={color:new $e,position:new T,halfWidth:new T,halfHeight:new T};break}return e[t.id]=r,r}}}function MQ(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var TQ=0;function LQ(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function PQ(e,t){let r=new EQ,i=MQ(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)n.probe.push(new T);let s=new T,a=new Ce,o=new Ce;function l(u,h){let d=0,p=0,f=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let m=0,g=0,v=0,y=0,x=0,b=0,w=0,C=0,_=0,S=0;u.sort(LQ);let A=h!==!0?Math.PI:1;for(let L=0,P=u.length;L<P;L++){let D=u[L],I=D.color,B=D.intensity,X=D.distance,H=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)d+=I.r*B*A,p+=I.g*B*A,f+=I.b*B*A;else if(D.isLightProbe)for(let R=0;R<9;R++)n.probe[R].addScaledVector(D.sh.coefficients[R],B);else if(D.isDirectionalLight){let R=r.get(D);if(R.color.copy(D.color).multiplyScalar(D.intensity*A),D.castShadow){let q=D.shadow,F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,n.directionalShadow[m]=F,n.directionalShadowMap[m]=H,n.directionalShadowMatrix[m]=D.shadow.matrix,b++}n.directional[m]=R,m++}else if(D.isSpotLight){let R=r.get(D);R.position.setFromMatrixPosition(D.matrixWorld),R.color.copy(I).multiplyScalar(B*A),R.distance=X,R.coneCos=Math.cos(D.angle),R.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),R.decay=D.decay,n.spot[v]=R;let q=D.shadow;if(D.map&&(n.spotLightMap[_]=D.map,_++,q.updateMatrices(D),D.castShadow&&S++),n.spotLightMatrix[v]=q.matrix,D.castShadow){let F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,n.spotShadow[v]=F,n.spotShadowMap[v]=H,C++}v++}else if(D.isRectAreaLight){let R=r.get(D);R.color.copy(I).multiplyScalar(B),R.halfWidth.set(D.width*.5,0,0),R.halfHeight.set(0,D.height*.5,0),n.rectArea[y]=R,y++}else if(D.isPointLight){let R=r.get(D);if(R.color.copy(D.color).multiplyScalar(D.intensity*A),R.distance=D.distance,R.decay=D.decay,D.castShadow){let q=D.shadow,F=i.get(D);F.shadowBias=q.bias,F.shadowNormalBias=q.normalBias,F.shadowRadius=q.radius,F.shadowMapSize=q.mapSize,F.shadowCameraNear=q.camera.near,F.shadowCameraFar=q.camera.far,n.pointShadow[g]=F,n.pointShadowMap[g]=H,n.pointShadowMatrix[g]=D.shadow.matrix,w++}n.point[g]=R,g++}else if(D.isHemisphereLight){let R=r.get(D);R.skyColor.copy(D.color).multiplyScalar(B*A),R.groundColor.copy(D.groundColor).multiplyScalar(B*A),n.hemi[x]=R,x++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Le.LTC_FLOAT_1,n.rectAreaLTC2=Le.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Le.LTC_HALF_1,n.rectAreaLTC2=Le.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=f;let E=n.hash;(E.directionalLength!==m||E.pointLength!==g||E.spotLength!==v||E.rectAreaLength!==y||E.hemiLength!==x||E.numDirectionalShadows!==b||E.numPointShadows!==w||E.numSpotShadows!==C||E.numSpotMaps!==_)&&(n.directional.length=m,n.spot.length=v,n.rectArea.length=y,n.point.length=g,n.hemi.length=x,n.directionalShadow.length=b,n.directionalShadowMap.length=b,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=C,n.spotShadowMap.length=C,n.directionalShadowMatrix.length=b,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=C+_-S,n.spotLightMap.length=_,n.numSpotLightShadowsWithMaps=S,E.directionalLength=m,E.pointLength=g,E.spotLength=v,E.rectAreaLength=y,E.hemiLength=x,E.numDirectionalShadows=b,E.numPointShadows=w,E.numSpotShadows=C,E.numSpotMaps=_,n.version=TQ++)}function c(u,h){let d=0,p=0,f=0,m=0,g=0,v=h.matrixWorldInverse;for(let y=0,x=u.length;y<x;y++){let b=u[y];if(b.isDirectionalLight){let w=n.directional[d];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),d++}else if(b.isSpotLight){let w=n.spot[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),f++}else if(b.isRectAreaLight){let w=n.rectArea[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),o.identity(),a.copy(b.matrixWorld),a.premultiply(v),o.extractRotation(a),w.halfWidth.set(b.width*.5,0,0),w.halfHeight.set(0,b.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),m++}else if(b.isPointLight){let w=n.point[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),p++}else if(b.isHemisphereLight){let w=n.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:n}}function NC(e,t){let r=new PQ(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(u){i.push(u)}function o(u){n.push(u)}function l(u){r.setup(i,u)}function c(u){r.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function DQ(e,t){let r=new WeakMap;function i(s,a=0){let o=r.get(s),l;return o===void 0?(l=new NC(e,t),r.set(s,[l])):a>=o.length?(l=new NC(e,t),o.push(l)):l=o[a],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var lD=class extends u1{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},IQ=class extends u1{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new T,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},OQ=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,RQ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function BQ(e,t,r){let i=new b7,n=new W,s=new W,a=new pt,o=new lD({depthPacking:YP}),l=new IQ,c={},u=r.maxTextureSize,h={[Ps]:ei,[ei]:Ps,[wn]:wn},d=new Yt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new W},radius:{value:4}},vertexShader:OQ,fragmentShader:RQ}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new nt;f.setAttribute("position",new st(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new $i(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f7,this.render=function(b,w,C){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;let _=e.getRenderTarget(),S=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),E=e.state;E.setBlending(Rr),E.buffers.color.setClear(1,1,1,1),E.buffers.depth.setTest(!0),E.setScissorTest(!1);for(let L=0,P=b.length;L<P;L++){let D=b[L],I=D.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;n.copy(I.mapSize);let B=I.getFrameExtents();if(n.multiply(B),s.copy(I.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/B.x),n.x=s.x*B.x,I.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/B.y),n.y=s.y*B.y,I.mapSize.y=s.y)),I.map===null){let H=this.type!==Ap?{minFilter:Xt,magFilter:Xt}:{};I.map=new jt(n.x,n.y,H),I.map.texture.name=D.name+".shadowMap",I.camera.updateProjectionMatrix()}e.setRenderTarget(I.map),e.clear();let X=I.getViewportCount();for(let H=0;H<X;H++){let R=I.getViewport(H);a.set(s.x*R.x,s.y*R.y,s.x*R.z,s.y*R.w),E.viewport(a),I.updateMatrices(D,H),i=I.getFrustum(),x(w,C,I.camera,D,this.type)}I.isPointLightShadow!==!0&&this.type===Ap&&v(I,C),I.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(_,S,A)};function v(b,w){let C=t.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,p.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new jt(n.x,n.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(w,null,C,d,m,null),p.uniforms.shadow_pass.value=b.mapPass.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(w,null,C,p,m,null)}function y(b,w,C,_,S,A){let E=null,L=C.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(L!==void 0)E=L;else if(E=C.isPointLight===!0?l:o,e.localClippingEnabled&&w.clipShadows===!0&&Array.isArray(w.clippingPlanes)&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){let P=E.uuid,D=w.uuid,I=c[P];I===void 0&&(I={},c[P]=I);let B=I[D];B===void 0&&(B=E.clone(),I[D]=B),E=B}return E.visible=w.visible,E.wireframe=w.wireframe,A===Ap?E.side=w.shadowSide!==null?w.shadowSide:w.side:E.side=w.shadowSide!==null?w.shadowSide:h[w.side],E.alphaMap=w.alphaMap,E.alphaTest=w.alphaTest,E.map=w.map,E.clipShadows=w.clipShadows,E.clippingPlanes=w.clippingPlanes,E.clipIntersection=w.clipIntersection,E.displacementMap=w.displacementMap,E.displacementScale=w.displacementScale,E.displacementBias=w.displacementBias,E.wireframeLinewidth=w.wireframeLinewidth,E.linewidth=w.linewidth,C.isPointLight===!0&&E.isMeshDistanceMaterial===!0&&(E.referencePosition.setFromMatrixPosition(C.matrixWorld),E.nearDistance=_,E.farDistance=S),E}function x(b,w,C,_,S){if(b.visible===!1)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&S===Ap)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,b.matrixWorld);let E=t.update(b),L=b.material;if(Array.isArray(L)){let P=E.groups;for(let D=0,I=P.length;D<I;D++){let B=P[D],X=L[B.materialIndex];if(X&&X.visible){let H=y(b,X,_,C.near,C.far,S);e.renderBufferDirect(C,null,E,H,b,B)}}}else if(L.visible){let P=y(b,L,_,C.near,C.far,S);e.renderBufferDirect(C,null,E,P,b,null)}}let A=b.children;for(let E=0,L=A.length;E<L;E++)x(A[E],w,C,_,S)}}function kQ(e,t,r){let i=r.isWebGL2;function n(){let G=!1,te=new pt,se=null,me=new pt(0,0,0,0);return{setMask:function(De){se!==De&&!G&&(e.colorMask(De,De,De,De),se=De)},setLocked:function(De){G=De},setClear:function(De,et,lt,Ct,Qt){Qt===!0&&(De*=Ct,et*=Ct,lt*=Ct),te.set(De,et,lt,Ct),me.equals(te)===!1&&(e.clearColor(De,et,lt,Ct),me.copy(te))},reset:function(){G=!1,se=null,me.set(-1,0,0,0)}}}function s(){let G=!1,te=null,se=null,me=null;return{setTest:function(De){De?ie(2929):$(2929)},setMask:function(De){te!==De&&!G&&(e.depthMask(De),te=De)},setFunc:function(De){if(se!==De){switch(De){case rG:e.depthFunc(512);break;case iG:e.depthFunc(519);break;case nG:e.depthFunc(513);break;case s5:e.depthFunc(515);break;case sG:e.depthFunc(514);break;case aG:e.depthFunc(518);break;case oG:e.depthFunc(516);break;case lG:e.depthFunc(517);break;default:e.depthFunc(515)}se=De}},setLocked:function(De){G=De},setClear:function(De){me!==De&&(e.clearDepth(De),me=De)},reset:function(){G=!1,te=null,se=null,me=null}}}function a(){let G=!1,te=null,se=null,me=null,De=null,et=null,lt=null,Ct=null,Qt=null;return{setTest:function(It){G||(It?ie(2960):$(2960))},setMask:function(It){te!==It&&!G&&(e.stencilMask(It),te=It)},setFunc:function(It,si,Xr){(se!==It||me!==si||De!==Xr)&&(e.stencilFunc(It,si,Xr),se=It,me=si,De=Xr)},setOp:function(It,si,Xr){(et!==It||lt!==si||Ct!==Xr)&&(e.stencilOp(It,si,Xr),et=It,lt=si,Ct=Xr)},setLocked:function(It){G=It},setClear:function(It){Qt!==It&&(e.clearStencil(It),Qt=It)},reset:function(){G=!1,te=null,se=null,me=null,De=null,et=null,lt=null,Ct=null,Qt=null}}}let o=new n,l=new s,c=new a,u=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,w=null,C=null,_=null,S=null,A=!1,E=null,L=null,P=null,D=null,I=null,B=e.getParameter(35661),X=!1,H=0,R=e.getParameter(7938);R.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(R)[1]),X=H>=1):R.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(R)[1]),X=H>=2);let q=null,F={},z=e.getParameter(3088),U=e.getParameter(2978),K=new pt().fromArray(z),j=new pt().fromArray(U);function Y(G,te,se){let me=new Uint8Array(4),De=e.createTexture();e.bindTexture(G,De),e.texParameteri(G,10241,9728),e.texParameteri(G,10240,9728);for(let et=0;et<se;et++)e.texImage2D(te+et,0,6408,1,1,0,6408,5121,me);return De}let V={};V[3553]=Y(3553,3553,1),V[34067]=Y(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ie(2929),l.setFunc(s5),Ne(!1),Oe(T9),ie(2884),Re(Rr);function ie(G){d[G]!==!0&&(e.enable(G),d[G]=!0)}function $(G){d[G]!==!1&&(e.disable(G),d[G]=!1)}function ee(G,te){return p[G]!==te?(e.bindFramebuffer(G,te),p[G]=te,i&&(G===36009&&(p[36160]=te),G===36160&&(p[36009]=te)),!0):!1}function ne(G,te){let se=m,me=!1;if(G)if(se=f.get(te),se===void 0&&(se=[],f.set(te,se)),G.isWebGLMultipleRenderTargets){let De=G.texture;if(se.length!==De.length||se[0]!==36064){for(let et=0,lt=De.length;et<lt;et++)se[et]=36064+et;se.length=De.length,me=!0}}else se[0]!==36064&&(se[0]=36064,me=!0);else se[0]!==1029&&(se[0]=1029,me=!0);me&&(r.isWebGL2?e.drawBuffers(se):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(se))}function ce(G){return g!==G?(e.useProgram(G),g=G,!0):!1}let ue={[Oh]:32774,[WH]:32778,[qH]:32779};if(i)ue[I9]=32775,ue[O9]=32776;else{let G=t.get("EXT_blend_minmax");G!==null&&(ue[I9]=G.MIN_EXT,ue[O9]=G.MAX_EXT)}let ye={[XH]:0,[YH]:1,[QH]:768,[jP]:770,[tG]:776,[$H]:774,[ZH]:772,[KH]:769,[UP]:771,[eG]:775,[JH]:773};function Re(G,te,se,me,De,et,lt,Ct){if(G===Rr){v===!0&&($(3042),v=!1);return}if(v===!1&&(ie(3042),v=!0),G!==GH){if(G!==y||Ct!==A){if((x!==Oh||C!==Oh)&&(e.blendEquation(32774),x=Oh,C=Oh),Ct)switch(G){case vu:e.blendFuncSeparate(1,771,1,771);break;case L9:e.blendFunc(1,1);break;case P9:e.blendFuncSeparate(0,769,0,1);break;case D9:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}else switch(G){case vu:e.blendFuncSeparate(770,771,1,771);break;case L9:e.blendFunc(770,1);break;case P9:e.blendFuncSeparate(0,769,0,1);break;case D9:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}b=null,w=null,_=null,S=null,y=G,A=Ct}return}De=De||te,et=et||se,lt=lt||me,(te!==x||De!==C)&&(e.blendEquationSeparate(ue[te],ue[De]),x=te,C=De),(se!==b||me!==w||et!==_||lt!==S)&&(e.blendFuncSeparate(ye[se],ye[me],ye[et],ye[lt]),b=se,w=me,_=et,S=lt),y=G,A=!1}function Se(G,te){G.side===wn?$(2884):ie(2884);let se=G.side===ei;te&&(se=!se),Ne(se),G.blending===vu&&G.transparent===!1?Re(Rr):Re(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),l.setFunc(G.depthFunc),l.setTest(G.depthTest),l.setMask(G.depthWrite),o.setMask(G.colorWrite);let me=G.stencilWrite;c.setTest(me),me&&(c.setMask(G.stencilWriteMask),c.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),c.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),_e(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits),G.alphaToCoverage===!0?ie(32926):$(32926)}function Ne(G){E!==G&&(G?e.frontFace(2304):e.frontFace(2305),E=G)}function Oe(G){G!==UH?(ie(2884),G!==L&&(G===T9?e.cullFace(1029):G===VH?e.cullFace(1028):e.cullFace(1032))):$(2884),L=G}function Ae(G){G!==P&&(X&&e.lineWidth(G),P=G)}function _e(G,te,se){G?(ie(32823),(D!==te||I!==se)&&(e.polygonOffset(te,se),D=te,I=se)):$(32823)}function Ue(G){G?ie(3089):$(3089)}function qe(G){G===void 0&&(G=33984+B-1),q!==G&&(e.activeTexture(G),q=G)}function N(G,te,se){se===void 0&&(q===null?se=33984+B-1:se=q);let me=F[se];me===void 0&&(me={type:void 0,texture:void 0},F[se]=me),(me.type!==G||me.texture!==te)&&(q!==se&&(e.activeTexture(se),q=se),e.bindTexture(G,te||V[G]),me.type=G,me.texture=te)}function O(){let G=F[q];G!==void 0&&G.type!==void 0&&(e.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)}function ae(){try{e.compressedTexImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function we(){try{e.compressedTexImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function xe(){try{e.texSubImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Te(){try{e.texSubImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ge(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ie(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function pe(){try{e.texStorage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ve(){try{e.texStorage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Xe(){try{e.texImage2D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Ye(){try{e.texImage3D.apply(e,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Q(G){K.equals(G)===!1&&(e.scissor(G.x,G.y,G.z,G.w),K.copy(G))}function J(G){j.equals(G)===!1&&(e.viewport(G.x,G.y,G.z,G.w),j.copy(G))}function de(G,te){let se=h.get(te);se===void 0&&(se=new WeakMap,h.set(te,se));let me=se.get(G);me===void 0&&(me=e.getUniformBlockIndex(te,G.name),se.set(G,me))}function Me(G,te){let se=h.get(te).get(G);u.get(te)!==se&&(e.uniformBlockBinding(te,se,G.__bindingPointIndex),u.set(te,se))}function He(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},q=null,F={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,w=null,C=null,_=null,S=null,A=!1,E=null,L=null,P=null,D=null,I=null,K.set(0,0,e.canvas.width,e.canvas.height),j.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ie,disable:$,bindFramebuffer:ee,drawBuffers:ne,useProgram:ce,setBlending:Re,setMaterial:Se,setFlipSided:Ne,setCullFace:Oe,setLineWidth:Ae,setPolygonOffset:_e,setScissorTest:Ue,activeTexture:qe,bindTexture:N,unbindTexture:O,compressedTexImage2D:ae,compressedTexImage3D:we,texImage2D:Xe,texImage3D:Ye,updateUBOMapping:de,uniformBlockBinding:Me,texStorage2D:pe,texStorage3D:Ve,texSubImage2D:xe,texSubImage3D:Te,compressedTexSubImage2D:Ge,compressedTexSubImage3D:Ie,scissor:Q,viewport:J,reset:He}}function NQ(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,h=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(N,O){return v?new OffscreenCanvas(N,O):yg("canvas")}function x(N,O,ae,we){let xe=1;if((N.width>we||N.height>we)&&(xe=we/Math.max(N.width,N.height)),xe<1||O===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){let Te=O?vg:Math.floor,Ge=Te(xe*N.width),Ie=Te(xe*N.height);m===void 0&&(m=y(Ge,Ie));let pe=ae?y(Ge,Ie):m;return pe.width=Ge,pe.height=Ie,pe.getContext("2d").drawImage(N,0,0,Ge,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+Ge+"x"+Ie+")."),pe}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function b(N){return u5(N.width)&&u5(N.height)}function w(N){return o?!1:N.wrapS!==Sr||N.wrapT!==Sr||N.minFilter!==Xt&&N.minFilter!==yt}function C(N,O){return N.generateMipmaps&&O&&N.minFilter!==Xt&&N.minFilter!==yt}function _(N){e.generateMipmap(N)}function S(N,O,ae,we,xe=!1){if(o===!1)return O;if(N!==null){if(e[N]!==void 0)return e[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let Te=O;return O===6403&&(ae===5126&&(Te=33326),ae===5131&&(Te=33325),ae===5121&&(Te=33321)),O===33319&&(ae===5126&&(Te=33328),ae===5131&&(Te=33327),ae===5121&&(Te=33323)),O===6408&&(ae===5126&&(Te=34836),ae===5131&&(Te=34842),ae===5121&&(Te=we===dt&&xe===!1?35907:32856),ae===32819&&(Te=32854),ae===32820&&(Te=32855)),(Te===33325||Te===33326||Te===33327||Te===33328||Te===34842||Te===34836)&&t.get("EXT_color_buffer_float"),Te}function A(N,O,ae){return C(N,ae)===!0||N.isFramebufferTexture&&N.minFilter!==Xt&&N.minFilter!==yt?Math.log2(Math.max(O.width,O.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?O.mipmaps.length:1}function E(N){return N===Xt||N===R9||N===ty?9728:9729}function L(N){let O=N.target;O.removeEventListener("dispose",L),D(O),O.isVideoTexture&&f.delete(O)}function P(N){let O=N.target;O.removeEventListener("dispose",P),B(O)}function D(N){let O=i.get(N);if(O.__webglInit===void 0)return;let ae=N.source,we=g.get(ae);if(we){let xe=we[O.__cacheKey];xe.usedTimes--,xe.usedTimes===0&&I(N),Object.keys(we).length===0&&g.delete(ae)}i.remove(N)}function I(N){let O=i.get(N);e.deleteTexture(O.__webglTexture);let ae=N.source,we=g.get(ae);delete we[O.__cacheKey],a.memory.textures--}function B(N){let O=N.texture,ae=i.get(N),we=i.get(O);if(we.__webglTexture!==void 0&&(e.deleteTexture(we.__webglTexture),a.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++)e.deleteFramebuffer(ae.__webglFramebuffer[xe]),ae.__webglDepthbuffer&&e.deleteRenderbuffer(ae.__webglDepthbuffer[xe]);else{if(e.deleteFramebuffer(ae.__webglFramebuffer),ae.__webglDepthbuffer&&e.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let xe=0;xe<ae.__webglColorRenderbuffer.length;xe++)ae.__webglColorRenderbuffer[xe]&&e.deleteRenderbuffer(ae.__webglColorRenderbuffer[xe]);ae.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let xe=0,Te=O.length;xe<Te;xe++){let Ge=i.get(O[xe]);Ge.__webglTexture&&(e.deleteTexture(Ge.__webglTexture),a.memory.textures--),i.remove(O[xe])}i.remove(O),i.remove(N)}let X=0;function H(){X=0}function R(){let N=X;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),X+=1,N}function q(N){let O=[];return O.push(N.wrapS),O.push(N.wrapT),O.push(N.wrapR||0),O.push(N.magFilter),O.push(N.minFilter),O.push(N.anisotropy),O.push(N.internalFormat),O.push(N.format),O.push(N.type),O.push(N.generateMipmaps),O.push(N.premultiplyAlpha),O.push(N.flipY),O.push(N.unpackAlignment),O.push(N.encoding),O.join()}function F(N,O){let ae=i.get(N);if(N.isVideoTexture&&Ue(N),N.isRenderTargetTexture===!1&&N.version>0&&ae.__version!==N.version){let we=N.image;if(we===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{$(ae,N,O);return}}r.bindTexture(3553,ae.__webglTexture,33984+O)}function z(N,O){let ae=i.get(N);if(N.version>0&&ae.__version!==N.version){$(ae,N,O);return}r.bindTexture(35866,ae.__webglTexture,33984+O)}function U(N,O){let ae=i.get(N);if(N.version>0&&ae.__version!==N.version){$(ae,N,O);return}r.bindTexture(32879,ae.__webglTexture,33984+O)}function K(N,O){let ae=i.get(N);if(N.version>0&&ae.__version!==N.version){ee(ae,N,O);return}r.bindTexture(34067,ae.__webglTexture,33984+O)}let j={[Ka]:10497,[Sr]:33071,[l5]:33648},Y={[Xt]:9728,[R9]:9984,[ty]:9986,[yt]:9729,[gG]:9985,[Gu]:9987};function V(N,O,ae){if(ae?(e.texParameteri(N,10242,j[O.wrapS]),e.texParameteri(N,10243,j[O.wrapT]),(N===32879||N===35866)&&e.texParameteri(N,32882,j[O.wrapR]),e.texParameteri(N,10240,Y[O.magFilter]),e.texParameteri(N,10241,Y[O.minFilter])):(e.texParameteri(N,10242,33071),e.texParameteri(N,10243,33071),(N===32879||N===35866)&&e.texParameteri(N,32882,33071),(O.wrapS!==Sr||O.wrapT!==Sr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(N,10240,E(O.magFilter)),e.texParameteri(N,10241,E(O.minFilter)),O.minFilter!==Xt&&O.minFilter!==yt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let we=t.get("EXT_texture_filter_anisotropic");if(O.magFilter===Xt||O.minFilter!==ty&&O.minFilter!==Gu||O.type===Cn&&t.has("OES_texture_float_linear")===!1||o===!1&&O.type===Wu&&t.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||i.get(O).__currentAnisotropy)&&(e.texParameterf(N,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,n.getMaxAnisotropy())),i.get(O).__currentAnisotropy=O.anisotropy)}}function ie(N,O){let ae=!1;N.__webglInit===void 0&&(N.__webglInit=!0,O.addEventListener("dispose",L));let we=O.source,xe=g.get(we);xe===void 0&&(xe={},g.set(we,xe));let Te=q(O);if(Te!==N.__cacheKey){xe[Te]===void 0&&(xe[Te]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,ae=!0),xe[Te].usedTimes++;let Ge=xe[N.__cacheKey];Ge!==void 0&&(xe[N.__cacheKey].usedTimes--,Ge.usedTimes===0&&I(O)),N.__cacheKey=Te,N.__webglTexture=xe[Te].texture}return ae}function $(N,O,ae){let we=3553;(O.isDataArrayTexture||O.isCompressedArrayTexture)&&(we=35866),O.isData3DTexture&&(we=32879);let xe=ie(N,O),Te=O.source;r.bindTexture(we,N.__webglTexture,33984+ae);let Ge=i.get(Te);if(Te.version!==Ge.__version||xe===!0){r.activeTexture(33984+ae),e.pixelStorei(37440,O.flipY),e.pixelStorei(37441,O.premultiplyAlpha),e.pixelStorei(3317,O.unpackAlignment),e.pixelStorei(37443,0);let Ie=w(O)&&b(O.image)===!1,pe=x(O.image,Ie,!1,u);pe=qe(O,pe);let Ve=b(pe)||o,Xe=s.convert(O.format,O.encoding),Ye=s.convert(O.type),Q=S(O.internalFormat,Xe,Ye,O.encoding,O.isVideoTexture);V(we,O,Ve);let J,de=O.mipmaps,Me=o&&O.isVideoTexture!==!0,He=Ge.__version===void 0||xe===!0,G=A(O,pe,Ve);if(O.isDepthTexture)Q=6402,o?O.type===Cn?Q=36012:O.type===Xo?Q=33190:O.type===Cc?Q=35056:Q=33189:O.type===Cn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===Sc&&Q===6402&&O.type!==GP&&O.type!==Xo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=Xo,Ye=s.convert(O.type)),O.format===Nc&&Q===6402&&(Q=34041,O.type!==Cc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=Cc,Ye=s.convert(O.type))),He&&(Me?r.texStorage2D(3553,1,Q,pe.width,pe.height):r.texImage2D(3553,0,Q,pe.width,pe.height,0,Xe,Ye,null));else if(O.isDataTexture)if(de.length>0&&Ve){Me&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,se=de.length;te<se;te++)J=de[te],Me?r.texSubImage2D(3553,te,0,0,J.width,J.height,Xe,Ye,J.data):r.texImage2D(3553,te,Q,J.width,J.height,0,Xe,Ye,J.data);O.generateMipmaps=!1}else Me?(He&&r.texStorage2D(3553,G,Q,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,pe.width,pe.height,Xe,Ye,pe.data)):r.texImage2D(3553,0,Q,pe.width,pe.height,0,Xe,Ye,pe.data);else if(O.isCompressedTexture)if(O.isCompressedArrayTexture){Me&&He&&r.texStorage3D(35866,G,Q,de[0].width,de[0].height,pe.depth);for(let te=0,se=de.length;te<se;te++)J=de[te],O.format!==Xn?Xe!==null?Me?r.compressedTexSubImage3D(35866,te,0,0,0,J.width,J.height,pe.depth,Xe,J.data,0,0):r.compressedTexImage3D(35866,te,Q,J.width,J.height,pe.depth,0,J.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Me?r.texSubImage3D(35866,te,0,0,0,J.width,J.height,pe.depth,Xe,Ye,J.data):r.texImage3D(35866,te,Q,J.width,J.height,pe.depth,0,Xe,Ye,J.data)}else{Me&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,se=de.length;te<se;te++)J=de[te],O.format!==Xn?Xe!==null?Me?r.compressedTexSubImage2D(3553,te,0,0,J.width,J.height,Xe,J.data):r.compressedTexImage2D(3553,te,Q,J.width,J.height,0,J.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Me?r.texSubImage2D(3553,te,0,0,J.width,J.height,Xe,Ye,J.data):r.texImage2D(3553,te,Q,J.width,J.height,0,Xe,Ye,J.data)}else if(O.isDataArrayTexture)Me?(He&&r.texStorage3D(35866,G,Q,pe.width,pe.height,pe.depth),r.texSubImage3D(35866,0,0,0,0,pe.width,pe.height,pe.depth,Xe,Ye,pe.data)):r.texImage3D(35866,0,Q,pe.width,pe.height,pe.depth,0,Xe,Ye,pe.data);else if(O.isData3DTexture)Me?(He&&r.texStorage3D(32879,G,Q,pe.width,pe.height,pe.depth),r.texSubImage3D(32879,0,0,0,0,pe.width,pe.height,pe.depth,Xe,Ye,pe.data)):r.texImage3D(32879,0,Q,pe.width,pe.height,pe.depth,0,Xe,Ye,pe.data);else if(O.isFramebufferTexture){if(He)if(Me)r.texStorage2D(3553,G,Q,pe.width,pe.height);else{let te=pe.width,se=pe.height;for(let me=0;me<G;me++)r.texImage2D(3553,me,Q,te,se,0,Xe,Ye,null),te>>=1,se>>=1}}else if(de.length>0&&Ve){Me&&He&&r.texStorage2D(3553,G,Q,de[0].width,de[0].height);for(let te=0,se=de.length;te<se;te++)J=de[te],Me?r.texSubImage2D(3553,te,0,0,Xe,Ye,J):r.texImage2D(3553,te,Q,Xe,Ye,J);O.generateMipmaps=!1}else Me?(He&&r.texStorage2D(3553,G,Q,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,Xe,Ye,pe)):r.texImage2D(3553,0,Q,Xe,Ye,pe);C(O,Ve)&&_(we),Ge.__version=Te.version,O.onUpdate&&O.onUpdate(O)}N.__version=O.version}function ee(N,O,ae){if(O.image.length!==6)return;let we=ie(N,O),xe=O.source;r.bindTexture(34067,N.__webglTexture,33984+ae);let Te=i.get(xe);if(xe.version!==Te.__version||we===!0){r.activeTexture(33984+ae),e.pixelStorei(37440,O.flipY),e.pixelStorei(37441,O.premultiplyAlpha),e.pixelStorei(3317,O.unpackAlignment),e.pixelStorei(37443,0);let Ge=O.isCompressedTexture||O.image[0].isCompressedTexture,Ie=O.image[0]&&O.image[0].isDataTexture,pe=[];for(let te=0;te<6;te++)!Ge&&!Ie?pe[te]=x(O.image[te],!1,!0,c):pe[te]=Ie?O.image[te].image:O.image[te],pe[te]=qe(O,pe[te]);let Ve=pe[0],Xe=b(Ve)||o,Ye=s.convert(O.format,O.encoding),Q=s.convert(O.type),J=S(O.internalFormat,Ye,Q,O.encoding),de=o&&O.isVideoTexture!==!0,Me=Te.__version===void 0||we===!0,He=A(O,Ve,Xe);V(34067,O,Xe);let G;if(Ge){de&&Me&&r.texStorage2D(34067,He,J,Ve.width,Ve.height);for(let te=0;te<6;te++){G=pe[te].mipmaps;for(let se=0;se<G.length;se++){let me=G[se];O.format!==Xn?Ye!==null?de?r.compressedTexSubImage2D(34069+te,se,0,0,me.width,me.height,Ye,me.data):r.compressedTexImage2D(34069+te,se,J,me.width,me.height,0,me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):de?r.texSubImage2D(34069+te,se,0,0,me.width,me.height,Ye,Q,me.data):r.texImage2D(34069+te,se,J,me.width,me.height,0,Ye,Q,me.data)}}}else{G=O.mipmaps,de&&Me&&(G.length>0&&He++,r.texStorage2D(34067,He,J,pe[0].width,pe[0].height));for(let te=0;te<6;te++)if(Ie){de?r.texSubImage2D(34069+te,0,0,0,pe[te].width,pe[te].height,Ye,Q,pe[te].data):r.texImage2D(34069+te,0,J,pe[te].width,pe[te].height,0,Ye,Q,pe[te].data);for(let se=0;se<G.length;se++){let me=G[se].image[te].image;de?r.texSubImage2D(34069+te,se+1,0,0,me.width,me.height,Ye,Q,me.data):r.texImage2D(34069+te,se+1,J,me.width,me.height,0,Ye,Q,me.data)}}else{de?r.texSubImage2D(34069+te,0,0,0,Ye,Q,pe[te]):r.texImage2D(34069+te,0,J,Ye,Q,pe[te]);for(let se=0;se<G.length;se++){let me=G[se];de?r.texSubImage2D(34069+te,se+1,0,0,Ye,Q,me.image[te]):r.texImage2D(34069+te,se+1,J,Ye,Q,me.image[te])}}}C(O,Xe)&&_(34067),Te.__version=xe.version,O.onUpdate&&O.onUpdate(O)}N.__version=O.version}function ne(N,O,ae,we,xe){let Te=s.convert(ae.format,ae.encoding),Ge=s.convert(ae.type),Ie=S(ae.internalFormat,Te,Ge,ae.encoding);i.get(O).__hasExternalTextures||(xe===32879||xe===35866?r.texImage3D(xe,0,Ie,O.width,O.height,O.depth,0,Te,Ge,null):r.texImage2D(xe,0,Ie,O.width,O.height,0,Te,Ge,null)),r.bindFramebuffer(36160,N),_e(O)?d.framebufferTexture2DMultisampleEXT(36160,we,xe,i.get(ae).__webglTexture,0,Ae(O)):(xe===3553||xe>=34069&&xe<=34074)&&e.framebufferTexture2D(36160,we,xe,i.get(ae).__webglTexture,0),r.bindFramebuffer(36160,null)}function ce(N,O,ae){if(e.bindRenderbuffer(36161,N),O.depthBuffer&&!O.stencilBuffer){let we=33189;if(ae||_e(O)){let xe=O.depthTexture;xe&&xe.isDepthTexture&&(xe.type===Cn?we=36012:xe.type===Xo&&(we=33190));let Te=Ae(O);_e(O)?d.renderbufferStorageMultisampleEXT(36161,Te,we,O.width,O.height):e.renderbufferStorageMultisample(36161,Te,we,O.width,O.height)}else e.renderbufferStorage(36161,we,O.width,O.height);e.framebufferRenderbuffer(36160,36096,36161,N)}else if(O.depthBuffer&&O.stencilBuffer){let we=Ae(O);ae&&_e(O)===!1?e.renderbufferStorageMultisample(36161,we,35056,O.width,O.height):_e(O)?d.renderbufferStorageMultisampleEXT(36161,we,35056,O.width,O.height):e.renderbufferStorage(36161,34041,O.width,O.height),e.framebufferRenderbuffer(36160,33306,36161,N)}else{let we=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let xe=0;xe<we.length;xe++){let Te=we[xe],Ge=s.convert(Te.format,Te.encoding),Ie=s.convert(Te.type),pe=S(Te.internalFormat,Ge,Ie,Te.encoding),Ve=Ae(O);ae&&_e(O)===!1?e.renderbufferStorageMultisample(36161,Ve,pe,O.width,O.height):_e(O)?d.renderbufferStorageMultisampleEXT(36161,Ve,pe,O.width,O.height):e.renderbufferStorage(36161,pe,O.width,O.height)}}e.bindRenderbuffer(36161,null)}function ue(N,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,N),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),F(O.depthTexture,0);let ae=i.get(O.depthTexture).__webglTexture,we=Ae(O);if(O.depthTexture.format===Sc)_e(O)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,we):e.framebufferTexture2D(36160,36096,3553,ae,0);else if(O.depthTexture.format===Nc)_e(O)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,we):e.framebufferTexture2D(36160,33306,3553,ae,0);else throw new Error("Unknown depthTexture format")}function ye(N){let O=i.get(N),ae=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture&&!O.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");ue(O.__webglFramebuffer,N)}else if(ae){O.__webglDepthbuffer=[];for(let we=0;we<6;we++)r.bindFramebuffer(36160,O.__webglFramebuffer[we]),O.__webglDepthbuffer[we]=e.createRenderbuffer(),ce(O.__webglDepthbuffer[we],N,!1)}else r.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=e.createRenderbuffer(),ce(O.__webglDepthbuffer,N,!1);r.bindFramebuffer(36160,null)}function Re(N,O,ae){let we=i.get(N);O!==void 0&&ne(we.__webglFramebuffer,N,N.texture,36064,3553),ae!==void 0&&ye(N)}function Se(N){let O=N.texture,ae=i.get(N),we=i.get(O);N.addEventListener("dispose",P),N.isWebGLMultipleRenderTargets!==!0&&(we.__webglTexture===void 0&&(we.__webglTexture=e.createTexture()),we.__version=O.version,a.memory.textures++);let xe=N.isWebGLCubeRenderTarget===!0,Te=N.isWebGLMultipleRenderTargets===!0,Ge=b(N)||o;if(xe){ae.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)ae.__webglFramebuffer[Ie]=e.createFramebuffer()}else{if(ae.__webglFramebuffer=e.createFramebuffer(),Te)if(n.drawBuffers){let Ie=N.texture;for(let pe=0,Ve=Ie.length;pe<Ve;pe++){let Xe=i.get(Ie[pe]);Xe.__webglTexture===void 0&&(Xe.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&N.samples>0&&_e(N)===!1){let Ie=Te?O:[O];ae.__webglMultisampledFramebuffer=e.createFramebuffer(),ae.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,ae.__webglMultisampledFramebuffer);for(let pe=0;pe<Ie.length;pe++){let Ve=Ie[pe];ae.__webglColorRenderbuffer[pe]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ae.__webglColorRenderbuffer[pe]);let Xe=s.convert(Ve.format,Ve.encoding),Ye=s.convert(Ve.type),Q=S(Ve.internalFormat,Xe,Ye,Ve.encoding,N.isXRRenderTarget===!0),J=Ae(N);e.renderbufferStorageMultisample(36161,J,Q,N.width,N.height),e.framebufferRenderbuffer(36160,36064+pe,36161,ae.__webglColorRenderbuffer[pe])}e.bindRenderbuffer(36161,null),N.depthBuffer&&(ae.__webglDepthRenderbuffer=e.createRenderbuffer(),ce(ae.__webglDepthRenderbuffer,N,!0)),r.bindFramebuffer(36160,null)}}if(xe){r.bindTexture(34067,we.__webglTexture),V(34067,O,Ge);for(let Ie=0;Ie<6;Ie++)ne(ae.__webglFramebuffer[Ie],N,O,36064,34069+Ie);C(O,Ge)&&_(34067),r.unbindTexture()}else if(Te){let Ie=N.texture;for(let pe=0,Ve=Ie.length;pe<Ve;pe++){let Xe=Ie[pe],Ye=i.get(Xe);r.bindTexture(3553,Ye.__webglTexture),V(3553,Xe,Ge),ne(ae.__webglFramebuffer,N,Xe,36064+pe,3553),C(Xe,Ge)&&_(3553)}r.unbindTexture()}else{let Ie=3553;(N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(o?Ie=N.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ie,we.__webglTexture),V(Ie,O,Ge),ne(ae.__webglFramebuffer,N,O,36064,Ie),C(O,Ge)&&_(Ie),r.unbindTexture()}N.depthBuffer&&ye(N)}function Ne(N){let O=b(N)||o,ae=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let we=0,xe=ae.length;we<xe;we++){let Te=ae[we];if(C(Te,O)){let Ge=N.isWebGLCubeRenderTarget?34067:3553,Ie=i.get(Te).__webglTexture;r.bindTexture(Ge,Ie),_(Ge),r.unbindTexture()}}}function Oe(N){if(o&&N.samples>0&&_e(N)===!1){let O=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],ae=N.width,we=N.height,xe=16384,Te=[],Ge=N.stencilBuffer?33306:36096,Ie=i.get(N),pe=N.isWebGLMultipleRenderTargets===!0;if(pe)for(let Ve=0;Ve<O.length;Ve++)r.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,null),r.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,null,0);r.bindFramebuffer(36008,Ie.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ie.__webglFramebuffer);for(let Ve=0;Ve<O.length;Ve++){Te.push(36064+Ve),N.depthBuffer&&Te.push(Ge);let Xe=Ie.__ignoreDepthValues!==void 0?Ie.__ignoreDepthValues:!1;if(Xe===!1&&(N.depthBuffer&&(xe|=256),N.stencilBuffer&&(xe|=1024)),pe&&e.framebufferRenderbuffer(36008,36064,36161,Ie.__webglColorRenderbuffer[Ve]),Xe===!0&&(e.invalidateFramebuffer(36008,[Ge]),e.invalidateFramebuffer(36009,[Ge])),pe){let Ye=i.get(O[Ve]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Ye,0)}e.blitFramebuffer(0,0,ae,we,0,0,ae,we,xe,9728),p&&e.invalidateFramebuffer(36008,Te)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),pe)for(let Ve=0;Ve<O.length;Ve++){r.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Ve,36161,Ie.__webglColorRenderbuffer[Ve]);let Xe=i.get(O[Ve]).__webglTexture;r.bindFramebuffer(36160,Ie.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Ve,3553,Xe,0)}r.bindFramebuffer(36009,Ie.__webglMultisampledFramebuffer)}}function Ae(N){return Math.min(h,N.samples)}function _e(N){let O=i.get(N);return o&&N.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&O.__useRenderToTexture!==!1}function Ue(N){let O=a.render.frame;f.get(N)!==O&&(f.set(N,O),N.update())}function qe(N,O){let ae=N.encoding,we=N.format,xe=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||N.format===h5||ae!==pa&&(ae===dt?o===!1?t.has("EXT_sRGB")===!0&&we===Xn?(N.format=h5,N.minFilter=yt,N.generateMipmaps=!1):O=JP.sRGBToLinear(O):(we!==Xn||xe!==Ei)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ae)),O}this.allocateTextureUnit=R,this.resetTextureUnits=H,this.setTexture2D=F,this.setTexture2DArray=z,this.setTexture3D=U,this.setTextureCube=K,this.rebindTextures=Re,this.setupRenderTarget=Se,this.updateRenderTargetMipmap=Ne,this.updateMultisampleRenderTarget=Oe,this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=ne,this.useMultisampledRTT=_e}function zQ(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===Ei)return 5121;if(s===bG)return 32819;if(s===wG)return 32820;if(s===vG)return 5120;if(s===yG)return 5122;if(s===GP)return 5123;if(s===xG)return 5124;if(s===Xo)return 5125;if(s===Cn)return 5126;if(s===Wu)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===CG)return 6406;if(s===Xn)return 6408;if(s===SG)return 6409;if(s===_G)return 6410;if(s===Sc)return 6402;if(s===Nc)return 34041;if(s===h5)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===AG)return 6403;if(s===EG)return 36244;if(s===WP)return 33319;if(s===MG)return 33320;if(s===TG)return 36249;if(s===ry||s===iy||s===ny||s===sy)if(a===dt)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===ry)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===iy)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===ny)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===sy)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===ry)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===iy)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===ny)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===sy)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===B9||s===k9||s===N9||s===z9)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===B9)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===k9)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===N9)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===z9)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===LG)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===F9||s===j9)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===F9)return a===dt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===j9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===U9||s===V9||s===H9||s===G9||s===W9||s===q9||s===X9||s===Y9||s===Q9||s===K9||s===Z9||s===J9||s===$9||s===eC)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===U9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===V9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===H9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===G9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===W9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===q9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===X9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Y9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Q9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===K9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Z9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===J9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===$9)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===eC)return a===dt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===ay)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===ay)return a===dt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===PG||s===tC||s===rC||s===iC)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===ay)return o.COMPRESSED_RED_RGTC1_EXT;if(s===tC)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===rC)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===iC)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Cc?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var FQ=class extends bi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},su=class extends Vt{constructor(){super(),this.isGroup=!0,this.type="Group"}},jQ={type:"move"},Iy=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new su,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new su,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new su,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let f of e.hand.values()){let m=t.getJointPose(f,r),g=this._getHandJoint(l,f);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],h=c.position.distanceTo(u.position),d=.02,p=.005;l.inputState.pinching&&h>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(jQ)))}return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new su;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},Xu=class extends Vr{constructor(e,t,r,i,n,s,a,o,l,c){if(c=c!==void 0?c:Sc,c!==Sc&&c!==Nc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Sc&&(r=Xo),r===void 0&&c===Nc&&(r=Cc),super(null,i,n,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Xt,this.minFilter=o!==void 0?o:Xt,this.flipY=!1,this.generateMipmaps=!1}},UQ=class extends pi{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],x=new Set,b=new Map,w=new bi;w.layers.enable(1),w.viewport=new pt;let C=new bi;C.layers.enable(2),C.viewport=new pt;let _=[w,C],S=new FQ;S.layers.enable(1),S.layers.enable(2);let A=null,E=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(z){let U=v[z];return U===void 0&&(U=new Iy,v[z]=U),U.getTargetRaySpace()},this.getControllerGrip=function(z){let U=v[z];return U===void 0&&(U=new Iy,v[z]=U),U.getGripSpace()},this.getHand=function(z){let U=v[z];return U===void 0&&(U=new Iy,v[z]=U),U.getHandSpace()};function L(z){let U=y.indexOf(z.inputSource);if(U===-1)return;let K=v[U];K!==void 0&&K.dispatchEvent({type:z.type,data:z.inputSource})}function P(){i.removeEventListener("select",L),i.removeEventListener("selectstart",L),i.removeEventListener("selectend",L),i.removeEventListener("squeeze",L),i.removeEventListener("squeezestart",L),i.removeEventListener("squeezeend",L),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",D);for(let z=0;z<v.length;z++){let U=y[z];U!==null&&(y[z]=null,v[z].disconnect(U))}A=null,E=null,e.setRenderTarget(m),d=null,h=null,u=null,i=null,g=null,F.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(z){n=z,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(z){a=z,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(z){l=z},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(z){if(i=z,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",L),i.addEventListener("selectstart",L),i.addEventListener("selectend",L),i.addEventListener("squeeze",L),i.addEventListener("squeezestart",L),i.addEventListener("squeezeend",L),i.addEventListener("end",P),i.addEventListener("inputsourceschange",D),f.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let U={antialias:i.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};d=new XRWebGLLayer(i,t,U),i.updateRenderState({baseLayer:d}),g=new jt(d.framebufferWidth,d.framebufferHeight,{format:Xn,type:Ei,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let U=null,K=null,j=null;f.depth&&(j=f.stencil?35056:33190,U=f.stencil?Nc:Sc,K=f.stencil?Cc:Xo);let Y={colorFormat:32856,depthFormat:j,scaleFactor:n};u=new XRWebGLBinding(i,t),h=u.createProjectionLayer(Y),i.updateRenderState({layers:[h]}),g=new jt(h.textureWidth,h.textureHeight,{format:Xn,type:Ei,depthTexture:new Xu(h.textureWidth,h.textureHeight,K,void 0,void 0,void 0,void 0,void 0,void 0,U),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let V=e.properties.get(g);V.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),F.setContext(i),F.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function D(z){for(let U=0;U<z.removed.length;U++){let K=z.removed[U],j=y.indexOf(K);j>=0&&(y[j]=null,v[j].disconnect(K))}for(let U=0;U<z.added.length;U++){let K=z.added[U],j=y.indexOf(K);if(j===-1){for(let V=0;V<v.length;V++)if(V>=y.length){y.push(K),j=V;break}else if(y[V]===null){y[V]=K,j=V;break}if(j===-1)break}let Y=v[j];Y&&Y.connect(K)}}let I=new T,B=new T;function X(z,U,K){I.setFromMatrixPosition(U.matrixWorld),B.setFromMatrixPosition(K.matrixWorld);let j=I.distanceTo(B),Y=U.projectionMatrix.elements,V=K.projectionMatrix.elements,ie=Y[14]/(Y[10]-1),$=Y[14]/(Y[10]+1),ee=(Y[9]+1)/Y[5],ne=(Y[9]-1)/Y[5],ce=(Y[8]-1)/Y[0],ue=(V[8]+1)/V[0],ye=ie*ce,Re=ie*ue,Se=j/(-ce+ue),Ne=Se*-ce;U.matrixWorld.decompose(z.position,z.quaternion,z.scale),z.translateX(Ne),z.translateZ(Se),z.matrixWorld.compose(z.position,z.quaternion,z.scale),z.matrixWorldInverse.copy(z.matrixWorld).invert();let Oe=ie+Se,Ae=$+Se,_e=ye-Ne,Ue=Re+(j-Ne),qe=ee*$/Ae*Oe,N=ne*$/Ae*Oe;z.projectionMatrix.makePerspective(_e,Ue,qe,N,Oe,Ae)}function H(z,U){U===null?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices(U.matrixWorld,z.matrix),z.matrixWorldInverse.copy(z.matrixWorld).invert()}this.updateCamera=function(z){if(i===null)return;S.near=C.near=w.near=z.near,S.far=C.far=w.far=z.far,(A!==S.near||E!==S.far)&&(i.updateRenderState({depthNear:S.near,depthFar:S.far}),A=S.near,E=S.far);let U=z.parent,K=S.cameras;H(S,U);for(let Y=0;Y<K.length;Y++)H(K[Y],U);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),z.matrix.copy(S.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale);let j=z.children;for(let Y=0,V=j.length;Y<V;Y++)j[Y].updateMatrixWorld(!0);K.length===2?X(S,w,C):S.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(!(h===null&&d===null))return o},this.setFoveation=function(z){o=z,h!==null&&(h.fixedFoveation=z),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=z)},this.getPlanes=function(){return x};let R=null;function q(z,U){if(c=U.getViewerPose(l||s),p=U,c!==null){let K=c.views;d!==null&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let j=!1;K.length!==S.cameras.length&&(S.cameras.length=0,j=!0);for(let Y=0;Y<K.length;Y++){let V=K[Y],ie=null;if(d!==null)ie=d.getViewport(V);else{let ee=u.getViewSubImage(h,V);ie=ee.viewport,Y===0&&(e.setRenderTargetTextures(g,ee.colorTexture,h.ignoreDepthValues?void 0:ee.depthStencilTexture),e.setRenderTarget(g))}let $=_[Y];$===void 0&&($=new bi,$.layers.enable(Y),$.viewport=new pt,_[Y]=$),$.matrix.fromArray(V.transform.matrix),$.projectionMatrix.fromArray(V.projectionMatrix),$.viewport.set(ie.x,ie.y,ie.width,ie.height),Y===0&&S.matrix.copy($.matrix),j===!0&&S.cameras.push($)}}for(let K=0;K<v.length;K++){let j=y[K],Y=v[K];j!==null&&Y!==void 0&&Y.update(j,U,l||s)}if(R&&R(z,U),U.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:U.detectedPlanes});let K=null;for(let j of x)U.detectedPlanes.has(j)||(K===null&&(K=[]),K.push(j));if(K!==null)for(let j of K)x.delete(j),b.delete(j),r.dispatchEvent({type:"planeremoved",data:j});for(let j of U.detectedPlanes)if(!x.has(j))x.add(j),b.set(j,U.lastChangedTime),r.dispatchEvent({type:"planeadded",data:j});else{let Y=b.get(j);j.lastChangedTime>Y&&(b.set(j,j.lastChangedTime),r.dispatchEvent({type:"planechanged",data:j}))}}p=null}let F=new iD;F.setAnimationLoop(q),this.setAnimationLoop=function(z){R=z},this.dispose=function(){}}};function VQ(e,t){function r(m,g){g.color.getRGB(m.fogColor.value,rD(e)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function i(m,g,v,y,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),u(m,g)):g.isMeshPhongMaterial?(n(m,g),c(m,g)):g.isMeshStandardMaterial?(n(m,g),h(m,g),g.isMeshPhysicalMaterial&&d(m,g,x)):g.isMeshMatcapMaterial?(n(m,g),p(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),f(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?o(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===ei&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===ei&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=t.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let b=e.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===ei&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function f(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function HQ(e,t,r,i){let n={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(y,x){let b=x.program;i.uniformBlockBinding(y,b)}function c(y,x){let b=n[y.id];b===void 0&&(f(y),b=u(y),n[y.id]=b,y.addEventListener("dispose",g));let w=x.program;i.updateUBOMapping(y,w);let C=t.render.frame;s[y.id]!==C&&(d(y),s[y.id]=C)}function u(y){let x=h();y.__bindingPointIndex=x;let b=e.createBuffer(),w=y.__size,C=y.usage;return e.bindBuffer(35345,b),e.bufferData(35345,w,C),e.bindBuffer(35345,null),e.bindBufferBase(35345,x,b),b}function h(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let x=n[y.id],b=y.uniforms,w=y.__cache;e.bindBuffer(35345,x);for(let C=0,_=b.length;C<_;C++){let S=b[C];if(p(S,C,w)===!0){let A=S.__offset,E=Array.isArray(S.value)?S.value:[S.value],L=0;for(let P=0;P<E.length;P++){let D=E[P],I=m(D);typeof D=="number"?(S.__data[0]=D,e.bufferSubData(35345,A+L,S.__data)):D.isMatrix3?(S.__data[0]=D.elements[0],S.__data[1]=D.elements[1],S.__data[2]=D.elements[2],S.__data[3]=D.elements[0],S.__data[4]=D.elements[3],S.__data[5]=D.elements[4],S.__data[6]=D.elements[5],S.__data[7]=D.elements[0],S.__data[8]=D.elements[6],S.__data[9]=D.elements[7],S.__data[10]=D.elements[8],S.__data[11]=D.elements[0]):(D.toArray(S.__data,L),L+=I.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,A,S.__data)}}e.bindBuffer(35345,null)}function p(y,x,b){let w=y.value;if(b[x]===void 0){if(typeof w=="number")b[x]=w;else{let C=Array.isArray(w)?w:[w],_=[];for(let S=0;S<C.length;S++)_.push(C[S].clone());b[x]=_}return!0}else if(typeof w=="number"){if(b[x]!==w)return b[x]=w,!0}else{let C=Array.isArray(b[x])?b[x]:[b[x]],_=Array.isArray(w)?w:[w];for(let S=0;S<C.length;S++){let A=C[S];if(A.equals(_[S])===!1)return A.copy(_[S]),!0}}return!1}function f(y){let x=y.uniforms,b=0,w=16,C=0;for(let _=0,S=x.length;_<S;_++){let A=x[_],E={boundary:0,storage:0},L=Array.isArray(A.value)?A.value:[A.value];for(let P=0,D=L.length;P<D;P++){let I=L[P],B=m(I);E.boundary+=B.boundary,E.storage+=B.storage}if(A.__data=new Float32Array(E.storage/Float32Array.BYTES_PER_ELEMENT),A.__offset=b,_>0){C=b%w;let P=w-C;C!==0&&P-E.boundary<0&&(b+=w-C,A.__offset=b)}b+=E.storage}return C=b%w,C>0&&(b+=w-C),y.__size=b,y.__cache={},this}function m(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function g(y){let x=y.target;x.removeEventListener("dispose",g);let b=a.indexOf(x.__bindingPointIndex);a.splice(b,1),e.deleteBuffer(n[x.id]),delete n[x.id],delete s[x.id]}function v(){for(let y in n)e.deleteBuffer(n[y]);a=[],n={},s={}}return{bind:l,update:c,dispose:v}}function GQ(){let e=yg("canvas");return e.style.display="block",e}function cD(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:GQ(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let h=null,d=null,p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=pa,this.physicallyCorrectLights=!1,this.toneMapping=ro,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,x=null,b=-1,w=null,C=new pt,_=new pt,S=null,A=t.width,E=t.height,L=1,P=null,D=null,I=new pt(0,0,A,E),B=new pt(0,0,A,E),X=!1,H=new b7,R=!1,q=!1,F=null,z=new Ce,U=new W,K=new T,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return x===null?L:1}let V=r;function ie(k,le){for(let ge=0;ge<k.length;ge++){let Z=k[ge],fe=t.getContext(Z,le);if(fe!==null)return fe}return null}try{let k={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ud}`),t.addEventListener("webglcontextlost",Q,!1),t.addEventListener("webglcontextrestored",J,!1),t.addEventListener("webglcontextcreationerror",de,!1),V===null){let le=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&le.shift(),V=ie(le,k),V===null)throw ie(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}V.getShaderPrecisionFormat===void 0&&(V.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(k){throw console.error("THREE.WebGLRenderer: "+k.message),k}let $,ee,ne,ce,ue,ye,Re,Se,Ne,Oe,Ae,_e,Ue,qe,N,O,ae,we,xe,Te,Ge,Ie,pe,Ve;function Xe(){$=new iY(V),ee=new ZX(V,$,e),$.init(ee),Ie=new zQ(V,$,ee),ne=new kQ(V,$,ee),ce=new aY,ue=new SQ,ye=new NQ(V,$,ne,ue,ee,Ie,ce),Re=new $X(m),Se=new rY(m),Ne=new mW(V,ee),pe=new QX(V,$,Ne,ee),Oe=new nY(V,Ne,ce,pe),Ae=new hY(V,Oe,Ne,ce),xe=new cY(V,ee,ye),O=new JX(ue),_e=new CQ(m,Re,Se,$,ee,pe,O),Ue=new VQ(m,ue),qe=new AQ,N=new DQ($,ee),we=new YX(m,Re,Se,ne,Ae,u,a),ae=new BQ(m,Ae,ee),Ve=new HQ(V,ce,ee,ne),Te=new KX(V,$,ce,ee),Ge=new sY(V,$,ce,ee),ce.programs=_e.programs,m.capabilities=ee,m.extensions=$,m.properties=ue,m.renderLists=qe,m.shadowMap=ae,m.state=ne,m.info=ce}Xe();let Ye=new UQ(m,V);this.xr=Ye,this.getContext=function(){return V},this.getContextAttributes=function(){return V.getContextAttributes()},this.forceContextLoss=function(){let k=$.get("WEBGL_lose_context");k&&k.loseContext()},this.forceContextRestore=function(){let k=$.get("WEBGL_lose_context");k&&k.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(k){k!==void 0&&(L=k,this.setSize(A,E,!1))},this.getSize=function(k){return k.set(A,E)},this.setSize=function(k,le,ge){if(Ye.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}A=k,E=le,t.width=Math.floor(k*L),t.height=Math.floor(le*L),ge!==!1&&(t.style.width=k+"px",t.style.height=le+"px"),this.setViewport(0,0,k,le)},this.getDrawingBufferSize=function(k){return k.set(A*L,E*L).floor()},this.setDrawingBufferSize=function(k,le,ge){A=k,E=le,L=ge,t.width=Math.floor(k*ge),t.height=Math.floor(le*ge),this.setViewport(0,0,k,le)},this.getCurrentViewport=function(k){return k.copy(C)},this.getViewport=function(k){return k.copy(I)},this.setViewport=function(k,le,ge,Z){k.isVector4?I.set(k.x,k.y,k.z,k.w):I.set(k,le,ge,Z),ne.viewport(C.copy(I).multiplyScalar(L).floor())},this.getScissor=function(k){return k.copy(B)},this.setScissor=function(k,le,ge,Z){k.isVector4?B.set(k.x,k.y,k.z,k.w):B.set(k,le,ge,Z),ne.scissor(_.copy(B).multiplyScalar(L).floor())},this.getScissorTest=function(){return X},this.setScissorTest=function(k){ne.setScissorTest(X=k)},this.setOpaqueSort=function(k){P=k},this.setTransparentSort=function(k){D=k},this.getClearColor=function(k){return k.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(k=!0,le=!0,ge=!0){let Z=0;k&&(Z|=16384),le&&(Z|=256),ge&&(Z|=1024),V.clear(Z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Q,!1),t.removeEventListener("webglcontextrestored",J,!1),t.removeEventListener("webglcontextcreationerror",de,!1),qe.dispose(),N.dispose(),ue.dispose(),Re.dispose(),Se.dispose(),Ae.dispose(),pe.dispose(),Ve.dispose(),_e.dispose(),Ye.dispose(),Ye.removeEventListener("sessionstart",me),Ye.removeEventListener("sessionend",De),F&&(F.dispose(),F=null),et.stop()};function Q(k){k.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function J(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let k=ce.autoReset,le=ae.enabled,ge=ae.autoUpdate,Z=ae.needsUpdate,fe=ae.type;Xe(),ce.autoReset=k,ae.enabled=le,ae.autoUpdate=ge,ae.needsUpdate=Z,ae.type=fe}function de(k){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",k.statusMessage)}function Me(k){let le=k.target;le.removeEventListener("dispose",Me),He(le)}function He(k){G(k),ue.remove(k)}function G(k){let le=ue.get(k).programs;le!==void 0&&(le.forEach(function(ge){_e.releaseProgram(ge)}),k.isShaderMaterial&&_e.releaseShaderCache(k))}this.renderBufferDirect=function(k,le,ge,Z,fe,Fe){le===null&&(le=j);let ct=fe.isMesh&&fe.matrixWorld.determinant()<0,Qe=ss(k,le,ge,Z,fe);ne.setMaterial(Z,ct);let vt=ge.index,Bt=1;Z.wireframe===!0&&(vt=Oe.getWireframeAttribute(ge),Bt=2);let Tt=ge.drawRange,Lt=ge.attributes.position,fi=Tt.start*Bt,dn=(Tt.start+Tt.count)*Bt;Fe!==null&&(fi=Math.max(fi,Fe.start*Bt),dn=Math.min(dn,(Fe.start+Fe.count)*Bt)),vt!==null?(fi=Math.max(fi,0),dn=Math.min(dn,vt.count)):Lt!=null&&(fi=Math.max(fi,0),dn=Math.min(dn,Lt.count));let Ca=dn-fi;if(Ca<0||Ca===1/0)return;pe.setup(fe,Z,Qe,ge,vt);let kl,Mr=Te;if(vt!==null&&(kl=Ne.get(vt),Mr=Ge,Mr.setIndex(kl)),fe.isMesh)Z.wireframe===!0?(ne.setLineWidth(Z.wireframeLinewidth*Y()),Mr.setMode(1)):Mr.setMode(4);else if(fe.isLine){let Pt=Z.linewidth;Pt===void 0&&(Pt=1),ne.setLineWidth(Pt*Y()),fe.isLineSegments?Mr.setMode(1):fe.isLineLoop?Mr.setMode(2):Mr.setMode(3)}else fe.isPoints?Mr.setMode(0):fe.isSprite&&Mr.setMode(4);if(fe.isInstancedMesh)Mr.renderInstances(fi,Ca,fe.count);else if(ge.isInstancedBufferGeometry){let Pt=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,l2=Math.min(ge.instanceCount,Pt);Mr.renderInstances(fi,Ca,l2)}else Mr.render(fi,Ca)},this.compile=function(k,le){function ge(Z,fe,Fe){Z.transparent===!0&&Z.side===wn&&Z.forceSinglePass===!1?(Z.side=ei,Z.needsUpdate=!0,Xr(Z,fe,Fe),Z.side=Ps,Z.needsUpdate=!0,Xr(Z,fe,Fe),Z.side=wn):Xr(Z,fe,Fe)}d=N.get(k),d.init(),f.push(d),k.traverseVisible(function(Z){Z.isLight&&Z.layers.test(le.layers)&&(d.pushLight(Z),Z.castShadow&&d.pushShadow(Z))}),d.setupLights(m.physicallyCorrectLights),k.traverse(function(Z){let fe=Z.material;if(fe)if(Array.isArray(fe))for(let Fe=0;Fe<fe.length;Fe++){let ct=fe[Fe];ge(ct,k,Z)}else ge(fe,k,Z)}),f.pop(),d=null};let te=null;function se(k){te&&te(k)}function me(){et.stop()}function De(){et.start()}let et=new iD;et.setAnimationLoop(se),typeof self<"u"&&et.setContext(self),this.setAnimationLoop=function(k){te=k,Ye.setAnimationLoop(k),k===null?et.stop():et.start()},Ye.addEventListener("sessionstart",me),Ye.addEventListener("sessionend",De),this.render=function(k,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;k.matrixWorldAutoUpdate===!0&&k.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Ye.enabled===!0&&Ye.isPresenting===!0&&(Ye.cameraAutoUpdate===!0&&Ye.updateCamera(le),le=Ye.getCamera()),k.isScene===!0&&k.onBeforeRender(m,k,le,x),d=N.get(k,f.length),d.init(),f.push(d),z.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),H.setFromProjectionMatrix(z),q=this.localClippingEnabled,R=O.init(this.clippingPlanes,q),h=qe.get(k,p.length),h.init(),p.push(h),lt(k,le,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(P,D),R===!0&&O.beginShadows();let ge=d.state.shadowsArray;if(ae.render(ge,k,le),R===!0&&O.endShadows(),this.info.autoReset===!0&&this.info.reset(),we.render(h,k),d.setupLights(m.physicallyCorrectLights),le.isArrayCamera){let Z=le.cameras;for(let fe=0,Fe=Z.length;fe<Fe;fe++){let ct=Z[fe];Ct(h,k,ct,ct.viewport)}}else Ct(h,k,le);x!==null&&(ye.updateMultisampleRenderTarget(x),ye.updateRenderTargetMipmap(x)),k.isScene===!0&&k.onAfterRender(m,k,le),pe.resetDefaultState(),b=-1,w=null,f.pop(),f.length>0?d=f[f.length-1]:d=null,p.pop(),p.length>0?h=p[p.length-1]:h=null};function lt(k,le,ge,Z){if(k.visible===!1)return;if(k.layers.test(le.layers)){if(k.isGroup)ge=k.renderOrder;else if(k.isLOD)k.autoUpdate===!0&&k.update(le);else if(k.isLight)d.pushLight(k),k.castShadow&&d.pushShadow(k);else if(k.isSprite){if(!k.frustumCulled||H.intersectsSprite(k)){Z&&K.setFromMatrixPosition(k.matrixWorld).applyMatrix4(z);let Fe=Ae.update(k),ct=k.material;ct.visible&&h.push(k,Fe,ct,ge,K.z,null)}}else if((k.isMesh||k.isLine||k.isPoints)&&(k.isSkinnedMesh&&k.skeleton.frame!==ce.render.frame&&(k.skeleton.update(),k.skeleton.frame=ce.render.frame),!k.frustumCulled||H.intersectsObject(k))){Z&&K.setFromMatrixPosition(k.matrixWorld).applyMatrix4(z);let Fe=Ae.update(k),ct=k.material;if(Array.isArray(ct)){let Qe=Fe.groups;for(let vt=0,Bt=Qe.length;vt<Bt;vt++){let Tt=Qe[vt],Lt=ct[Tt.materialIndex];Lt&&Lt.visible&&h.push(k,Fe,Lt,ge,K.z,Tt)}}else ct.visible&&h.push(k,Fe,ct,ge,K.z,null)}}let fe=k.children;for(let Fe=0,ct=fe.length;Fe<ct;Fe++)lt(fe[Fe],le,ge,Z)}function Ct(k,le,ge,Z){let fe=k.opaque,Fe=k.transmissive,ct=k.transparent;d.setupLightsView(ge),R===!0&&O.setGlobalState(m.clippingPlanes,ge),Fe.length>0&&Qt(fe,le,ge),Z&&ne.viewport(C.copy(Z)),fe.length>0&&It(fe,le,ge),Fe.length>0&&It(Fe,le,ge),ct.length>0&&It(ct,le,ge),ne.buffers.depth.setTest(!0),ne.buffers.depth.setMask(!0),ne.buffers.color.setMask(!0),ne.setPolygonOffset(!1)}function Qt(k,le,ge){let Z=ee.isWebGL2;F===null&&(F=new jt(1,1,{generateMipmaps:!0,type:$.has("EXT_color_buffer_half_float")?Wu:Ei,minFilter:Gu,samples:Z&&s===!0?4:0})),m.getDrawingBufferSize(U),Z?F.setSize(U.x,U.y):F.setSize(vg(U.x),vg(U.y));let fe=m.getRenderTarget();m.setRenderTarget(F),m.clear();let Fe=m.toneMapping;m.toneMapping=ro,It(k,le,ge),m.toneMapping=Fe,ye.updateMultisampleRenderTarget(F),ye.updateRenderTargetMipmap(F),m.setRenderTarget(fe)}function It(k,le,ge){let Z=le.isScene===!0?le.overrideMaterial:null;for(let fe=0,Fe=k.length;fe<Fe;fe++){let ct=k[fe],Qe=ct.object,vt=ct.geometry,Bt=Z===null?ct.material:Z,Tt=ct.group;Qe.layers.test(ge.layers)&&si(Qe,le,ge,vt,Bt,Tt)}}function si(k,le,ge,Z,fe,Fe){k.onBeforeRender(m,le,ge,Z,fe,Fe),k.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,k.matrixWorld),k.normalMatrix.getNormalMatrix(k.modelViewMatrix),fe.onBeforeRender(m,le,ge,Z,k,Fe),fe.transparent===!0&&fe.side===wn&&fe.forceSinglePass===!1?(fe.side=ei,fe.needsUpdate=!0,m.renderBufferDirect(ge,le,Z,fe,k,Fe),fe.side=Ps,fe.needsUpdate=!0,m.renderBufferDirect(ge,le,Z,fe,k,Fe),fe.side=wn):m.renderBufferDirect(ge,le,Z,fe,k,Fe),k.onAfterRender(m,le,ge,Z,fe,Fe)}function Xr(k,le,ge){le.isScene!==!0&&(le=j);let Z=ue.get(k),fe=d.state.lights,Fe=d.state.shadowsArray,ct=fe.state.version,Qe=_e.getParameters(k,fe.state,Fe,le,ge),vt=_e.getProgramCacheKey(Qe),Bt=Z.programs;Z.environment=k.isMeshStandardMaterial?le.environment:null,Z.fog=le.fog,Z.envMap=(k.isMeshStandardMaterial?Se:Re).get(k.envMap||Z.environment),Bt===void 0&&(k.addEventListener("dispose",Me),Bt=new Map,Z.programs=Bt);let Tt=Bt.get(vt);if(Tt!==void 0){if(Z.currentProgram===Tt&&Z.lightsStateVersion===ct)return Jc(k,Qe),Tt}else Qe.uniforms=_e.getUniforms(k),k.onBuild(ge,Qe,m),k.onBeforeCompile(Qe,m),Tt=_e.acquireProgram(Qe,vt),Bt.set(vt,Tt),Z.uniforms=Qe.uniforms;let Lt=Z.uniforms;(!k.isShaderMaterial&&!k.isRawShaderMaterial||k.clipping===!0)&&(Lt.clippingPlanes=O.uniform),Jc(k,Qe),Z.needsLights=$c(k),Z.lightsStateVersion=ct,Z.needsLights&&(Lt.ambientLightColor.value=fe.state.ambient,Lt.lightProbe.value=fe.state.probe,Lt.directionalLights.value=fe.state.directional,Lt.directionalLightShadows.value=fe.state.directionalShadow,Lt.spotLights.value=fe.state.spot,Lt.spotLightShadows.value=fe.state.spotShadow,Lt.rectAreaLights.value=fe.state.rectArea,Lt.ltc_1.value=fe.state.rectAreaLTC1,Lt.ltc_2.value=fe.state.rectAreaLTC2,Lt.pointLights.value=fe.state.point,Lt.pointLightShadows.value=fe.state.pointShadow,Lt.hemisphereLights.value=fe.state.hemi,Lt.directionalShadowMap.value=fe.state.directionalShadowMap,Lt.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,Lt.spotShadowMap.value=fe.state.spotShadowMap,Lt.spotLightMatrix.value=fe.state.spotLightMatrix,Lt.spotLightMap.value=fe.state.spotLightMap,Lt.pointShadowMap.value=fe.state.pointShadowMap,Lt.pointShadowMatrix.value=fe.state.pointShadowMatrix);let fi=Tt.getUniforms(),dn=S0.seqWithValue(fi.seq,Lt);return Z.currentProgram=Tt,Z.uniformsList=dn,Tt}function Jc(k,le){let ge=ue.get(k);ge.outputEncoding=le.outputEncoding,ge.instancing=le.instancing,ge.skinning=le.skinning,ge.morphTargets=le.morphTargets,ge.morphNormals=le.morphNormals,ge.morphColors=le.morphColors,ge.morphTargetsCount=le.morphTargetsCount,ge.numClippingPlanes=le.numClippingPlanes,ge.numIntersection=le.numClipIntersection,ge.vertexAlphas=le.vertexAlphas,ge.vertexTangents=le.vertexTangents,ge.toneMapping=le.toneMapping}function ss(k,le,ge,Z,fe){le.isScene!==!0&&(le=j),ye.resetTextureUnits();let Fe=le.fog,ct=Z.isMeshStandardMaterial?le.environment:null,Qe=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:pa,vt=(Z.isMeshStandardMaterial?Se:Re).get(Z.envMap||ct),Bt=Z.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,Tt=!!Z.normalMap&&!!ge.attributes.tangent,Lt=!!ge.morphAttributes.position,fi=!!ge.morphAttributes.normal,dn=!!ge.morphAttributes.color,Ca=Z.toneMapped?m.toneMapping:ro,kl=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,Mr=kl!==void 0?kl.length:0,Pt=ue.get(Z),l2=d.state.lights;if(R===!0&&(q===!0||k!==w)){let pn=k===w&&Z.id===b;O.setState(Z,k,pn)}let c2=!1;Z.version===Pt.__version?(Pt.needsLights&&Pt.lightsStateVersion!==l2.state.version||Pt.outputEncoding!==Qe||fe.isInstancedMesh&&Pt.instancing===!1||!fe.isInstancedMesh&&Pt.instancing===!0||fe.isSkinnedMesh&&Pt.skinning===!1||!fe.isSkinnedMesh&&Pt.skinning===!0||Pt.envMap!==vt||Z.fog===!0&&Pt.fog!==Fe||Pt.numClippingPlanes!==void 0&&(Pt.numClippingPlanes!==O.numPlanes||Pt.numIntersection!==O.numIntersection)||Pt.vertexAlphas!==Bt||Pt.vertexTangents!==Tt||Pt.morphTargets!==Lt||Pt.morphNormals!==fi||Pt.morphColors!==dn||Pt.toneMapping!==Ca||ee.isWebGL2===!0&&Pt.morphTargetsCount!==Mr)&&(c2=!0):(c2=!0,Pt.__version=Z.version);let Nl=Pt.currentProgram;c2===!0&&(Nl=Xr(Z,le,fe));let Y8=!1,Td=!1,h2=!1,ai=Nl.getUniforms(),zl=Pt.uniforms;if(ne.useProgram(Nl.program)&&(Y8=!0,Td=!0,h2=!0),Z.id!==b&&(b=Z.id,Td=!0),Y8||w!==k){if(ai.setValue(V,"projectionMatrix",k.projectionMatrix),ee.logarithmicDepthBuffer&&ai.setValue(V,"logDepthBufFC",2/(Math.log(k.far+1)/Math.LN2)),w!==k&&(w=k,Td=!0,h2=!0),Z.isShaderMaterial||Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshStandardMaterial||Z.envMap){let pn=ai.map.cameraPosition;pn!==void 0&&pn.setValue(V,K.setFromMatrixPosition(k.matrixWorld))}(Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshLambertMaterial||Z.isMeshBasicMaterial||Z.isMeshStandardMaterial||Z.isShaderMaterial)&&ai.setValue(V,"isOrthographic",k.isOrthographicCamera===!0),(Z.isMeshPhongMaterial||Z.isMeshToonMaterial||Z.isMeshLambertMaterial||Z.isMeshBasicMaterial||Z.isMeshStandardMaterial||Z.isShaderMaterial||Z.isShadowMaterial||fe.isSkinnedMesh)&&ai.setValue(V,"viewMatrix",k.matrixWorldInverse)}if(fe.isSkinnedMesh){ai.setOptional(V,fe,"bindMatrix"),ai.setOptional(V,fe,"bindMatrixInverse");let pn=fe.skeleton;pn&&(ee.floatVertexTextures?(pn.boneTexture===null&&pn.computeBoneTexture(),ai.setValue(V,"boneTexture",pn.boneTexture,ye),ai.setValue(V,"boneTextureSize",pn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let u2=ge.morphAttributes;if((u2.position!==void 0||u2.normal!==void 0||u2.color!==void 0&&ee.isWebGL2===!0)&&xe.update(fe,ge,Z,Nl),(Td||Pt.receiveShadow!==fe.receiveShadow)&&(Pt.receiveShadow=fe.receiveShadow,ai.setValue(V,"receiveShadow",fe.receiveShadow)),Z.isMeshGouraudMaterial&&Z.envMap!==null&&(zl.envMap.value=vt,zl.flipEnvMap.value=vt.isCubeTexture&&vt.isRenderTargetTexture===!1?-1:1),Td&&(ai.setValue(V,"toneMappingExposure",m.toneMappingExposure),Pt.needsLights&&as(zl,h2),Fe&&Z.fog===!0&&Ue.refreshFogUniforms(zl,Fe),Ue.refreshMaterialUniforms(zl,Z,L,E,F),S0.upload(V,Pt.uniformsList,zl,ye)),Z.isShaderMaterial&&Z.uniformsNeedUpdate===!0&&(S0.upload(V,Pt.uniformsList,zl,ye),Z.uniformsNeedUpdate=!1),Z.isSpriteMaterial&&ai.setValue(V,"center",fe.center),ai.setValue(V,"modelViewMatrix",fe.modelViewMatrix),ai.setValue(V,"normalMatrix",fe.normalMatrix),ai.setValue(V,"modelMatrix",fe.matrixWorld),fe.previousModelViewMatrix&&ai.setValue(V,"previousModelViewMatrix",fe.previousModelViewMatrix),k.previousProjectionMatrix&&ai.setValue(V,"previousProjectionMatrix",k.previousProjectionMatrix),Z.isShaderMaterial||Z.isRawShaderMaterial){let pn=Z.uniformsGroups;for(let d2=0,lB=pn.length;d2<lB;d2++)if(ee.isWebGL2){let Q8=pn[d2];Ve.update(Q8,Nl),Ve.bind(Q8,Nl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Nl}function as(k,le){k.ambientLightColor.needsUpdate=le,k.lightProbe.needsUpdate=le,k.directionalLights.needsUpdate=le,k.directionalLightShadows.needsUpdate=le,k.pointLights.needsUpdate=le,k.pointLightShadows.needsUpdate=le,k.spotLights.needsUpdate=le,k.spotLightShadows.needsUpdate=le,k.rectAreaLights.needsUpdate=le,k.hemisphereLights.needsUpdate=le}function $c(k){return k.isMeshLambertMaterial||k.isMeshToonMaterial||k.isMeshPhongMaterial||k.isMeshStandardMaterial||k.isShadowMaterial||k.isShaderMaterial&&k.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(k,le,ge){ue.get(k.texture).__webglTexture=le,ue.get(k.depthTexture).__webglTexture=ge;let Z=ue.get(k);Z.__hasExternalTextures=!0,Z.__hasExternalTextures&&(Z.__autoAllocateDepthBuffer=ge===void 0,Z.__autoAllocateDepthBuffer||$.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Z.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(k,le){let ge=ue.get(k);ge.__webglFramebuffer=le,ge.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(k,le=0,ge=0){x=k,v=le,y=ge;let Z=!0,fe=null,Fe=!1,ct=!1;if(k){let Qe=ue.get(k);Qe.__useDefaultFramebuffer!==void 0?(ne.bindFramebuffer(36160,null),Z=!1):Qe.__webglFramebuffer===void 0?ye.setupRenderTarget(k):Qe.__hasExternalTextures&&ye.rebindTextures(k,ue.get(k.texture).__webglTexture,ue.get(k.depthTexture).__webglTexture);let vt=k.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(ct=!0);let Bt=ue.get(k).__webglFramebuffer;k.isWebGLCubeRenderTarget?(fe=Bt[le],Fe=!0):ee.isWebGL2&&k.samples>0&&ye.useMultisampledRTT(k)===!1?fe=ue.get(k).__webglMultisampledFramebuffer:fe=Bt,C.copy(k.viewport),_.copy(k.scissor),S=k.scissorTest}else C.copy(I).multiplyScalar(L).floor(),_.copy(B).multiplyScalar(L).floor(),S=X;if(ne.bindFramebuffer(36160,fe)&&ee.drawBuffers&&Z&&ne.drawBuffers(k,fe),ne.viewport(C),ne.scissor(_),ne.setScissorTest(S),Fe){let Qe=ue.get(k.texture);V.framebufferTexture2D(36160,36064,34069+le,Qe.__webglTexture,ge)}else if(ct){let Qe=ue.get(k.texture),vt=le||0;V.framebufferTextureLayer(36160,36064,Qe.__webglTexture,ge||0,vt)}b=-1},this.readRenderTargetPixels=function(k,le,ge,Z,fe,Fe,ct){if(!(k&&k.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Qe=ue.get(k).__webglFramebuffer;if(k.isWebGLCubeRenderTarget&&ct!==void 0&&(Qe=Qe[ct]),Qe){ne.bindFramebuffer(36160,Qe);try{let vt=k.texture,Bt=vt.format,Tt=vt.type;if(Bt!==Xn&&Ie.convert(Bt)!==V.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Lt=Tt===Wu&&($.has("EXT_color_buffer_half_float")||ee.isWebGL2&&$.has("EXT_color_buffer_float"));if(Tt!==Ei&&Ie.convert(Tt)!==V.getParameter(35738)&&!(Tt===Cn&&(ee.isWebGL2||$.has("OES_texture_float")||$.has("WEBGL_color_buffer_float")))&&!Lt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=k.width-Z&&ge>=0&&ge<=k.height-fe&&V.readPixels(le,ge,Z,fe,Ie.convert(Bt),Ie.convert(Tt),Fe)}finally{let vt=x!==null?ue.get(x).__webglFramebuffer:null;ne.bindFramebuffer(36160,vt)}}},this.copyFramebufferToTexture=function(k,le,ge=0){let Z=Math.pow(2,-ge),fe=Math.floor(le.image.width*Z),Fe=Math.floor(le.image.height*Z);ye.setTexture2D(le,0),V.copyTexSubImage2D(3553,ge,0,0,k.x,k.y,fe,Fe),ne.unbindTexture()},this.copyTextureToTexture=function(k,le,ge,Z=0){let fe=le.image.width,Fe=le.image.height,ct=Ie.convert(ge.format),Qe=Ie.convert(ge.type);ye.setTexture2D(ge,0),V.pixelStorei(37440,ge.flipY),V.pixelStorei(37441,ge.premultiplyAlpha),V.pixelStorei(3317,ge.unpackAlignment),le.isDataTexture?V.texSubImage2D(3553,Z,k.x,k.y,fe,Fe,ct,Qe,le.image.data):le.isCompressedTexture?V.compressedTexSubImage2D(3553,Z,k.x,k.y,le.mipmaps[0].width,le.mipmaps[0].height,ct,le.mipmaps[0].data):V.texSubImage2D(3553,Z,k.x,k.y,ct,Qe,le.image),Z===0&&ge.generateMipmaps&&V.generateMipmap(3553),ne.unbindTexture()},this.copyTextureToTexture3D=function(k,le,ge,Z,fe=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Fe=k.max.x-k.min.x+1,ct=k.max.y-k.min.y+1,Qe=k.max.z-k.min.z+1,vt=Ie.convert(Z.format),Bt=Ie.convert(Z.type),Tt;if(Z.isData3DTexture)ye.setTexture3D(Z,0),Tt=32879;else if(Z.isDataArrayTexture)ye.setTexture2DArray(Z,0),Tt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}V.pixelStorei(37440,Z.flipY),V.pixelStorei(37441,Z.premultiplyAlpha),V.pixelStorei(3317,Z.unpackAlignment);let Lt=V.getParameter(3314),fi=V.getParameter(32878),dn=V.getParameter(3316),Ca=V.getParameter(3315),kl=V.getParameter(32877),Mr=ge.isCompressedTexture?ge.mipmaps[0]:ge.image;V.pixelStorei(3314,Mr.width),V.pixelStorei(32878,Mr.height),V.pixelStorei(3316,k.min.x),V.pixelStorei(3315,k.min.y),V.pixelStorei(32877,k.min.z),ge.isDataTexture||ge.isData3DTexture?V.texSubImage3D(Tt,fe,le.x,le.y,le.z,Fe,ct,Qe,vt,Bt,Mr.data):ge.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),V.compressedTexSubImage3D(Tt,fe,le.x,le.y,le.z,Fe,ct,Qe,vt,Mr.data)):V.texSubImage3D(Tt,fe,le.x,le.y,le.z,Fe,ct,Qe,vt,Bt,Mr),V.pixelStorei(3314,Lt),V.pixelStorei(32878,fi),V.pixelStorei(3316,dn),V.pixelStorei(3315,Ca),V.pixelStorei(32877,kl),fe===0&&Z.generateMipmaps&&V.generateMipmap(Tt),ne.unbindTexture()},this.initTexture=function(k){k.isCubeTexture?ye.setTextureCube(k,0):k.isData3DTexture?ye.setTexture3D(k,0):k.isDataArrayTexture||k.isCompressedArrayTexture?ye.setTexture2DArray(k,0):ye.setTexture2D(k,0),ne.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,ne.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var WQ=class extends cD{};WQ.prototype.isWebGL1Renderer=!0;var hD=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new $e(e),this.near=t,this.far=r}clone(){return new hD(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},dl=class extends Vt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},qQ=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=c5,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Jn()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Ti=new T,p5=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.applyMatrix4(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.applyNormalMatrix(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.transformDirection(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Za(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Za(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Za(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Za(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),r=qt(r,this.array),i=qt(i,this.array),n=qt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new st(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new p5(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},uD=class extends Vt{constructor(){super(),this.isBone=!0,this.type="Bone"}},xg=class extends Vr{constructor(e=null,t=1,r=1,i,n,s,a,o,l=Xt,c=Xt,u,h){super(null,s,a,o,l,c,i,n,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},zC=new Ce,XQ=new Ce,S7=class{constructor(e=[],t=[]){this.uuid=Jn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Ce)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Ce;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:XQ;zC.multiplyMatrices(a,t[n]),zC.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new S7(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=QP(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new xg(t,e,e,Xn,Cn);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new uD),this.bones.push(s),this.boneInverses.push(new Ce().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let s=t[i];e.bones.push(s.uuid);let a=r[i];e.boneInverses.push(a.toArray())}return e}},YQ=class extends st{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Ol=class extends u1{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new $e(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},FC=new T,jC=new T,UC=new Ce,Oy=new dd,hm=new Ln,bg=class extends Vt{constructor(e=new nt,t=new Ol){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)FC.fromBufferAttribute(t,i-1),jC.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=FC.distanceTo(jC);e.setAttribute("lineDistance",new ze(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),hm.copy(r.boundingSphere),hm.applyMatrix4(i),hm.radius+=n,e.ray.intersectsSphere(hm)===!1)return;UC.copy(i).invert(),Oy.copy(e.ray).applyMatrix4(UC);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new T,c=new T,u=new T,h=new T,d=this.isLineSegments?2:1,p=r.index,f=r.attributes.position;if(p!==null){let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){let x=p.getX(v),b=p.getX(v+1);if(l.fromBufferAttribute(f,x),c.fromBufferAttribute(f,b),Oy.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){if(l.fromBufferAttribute(f,v),c.fromBufferAttribute(f,v+1),Oy.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let x=e.ray.origin.distanceTo(h);x<e.near||x>e.far||t.push({distance:x,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},VC=new T,HC=new T,p1=class extends bg{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)VC.fromBufferAttribute(t,i),HC.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+VC.distanceTo(HC);e.setAttribute("lineDistance",new ze(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},QQ=class extends Vr{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:yt,this.magFilter=n!==void 0?n:yt,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},ya=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let c=r[i],u=r[i+1]-c,h=(s-c)/u;return(i+h)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new W:new T);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new T,i=[],n=[],s=[],a=new T,o=new Ce;for(let d=0;d<=e;d++){let p=d/e;i[d]=this.getTangentAt(p,new T)}n[0]=new T,s[0]=new T;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(jr(i[d-1].dot(i[d]),-1,1));n[d].applyMatrix4(o.makeRotationAxis(a,p))}s[d].crossVectors(i[d],n[d])}if(t===!0){let d=Math.acos(jr(n[0].dot(n[e]),-1,1));d/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let p=1;p<=e;p++)n[p].applyMatrix4(o.makeRotationAxis(i[p],d*p)),s[p].crossVectors(i[p],n[p])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},zv=class extends ya{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new W,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=o-this.aX,d=l-this.aY;o=h*c-d*u+this.aX,l=h*u+d*c+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},KQ=class extends zv{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function _7(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){n(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,h){let d=(a-s)/c-(o-s)/(c+u)+(o-a)/u,p=(o-a)/u-(l-a)/(u+h)+(l-o)/h;d*=u,p*=u,n(a,o,d,p)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var um=new T,Ry=new _7,By=new _7,ky=new _7,ZQ=class extends ya{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new T){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,c;this.closed||a>0?l=i[(a-1)%n]:(um.subVectors(i[0],i[1]).add(i[0]),l=um);let u=i[a%n],h=i[(a+1)%n];if(this.closed||a+2<n?c=i[(a+2)%n]:(um.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=um),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(u),d),f=Math.pow(u.distanceToSquared(h),d),m=Math.pow(h.distanceToSquared(c),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Ry.initNonuniformCatmullRom(l.x,u.x,h.x,c.x,p,f,m),By.initNonuniformCatmullRom(l.y,u.y,h.y,c.y,p,f,m),ky.initNonuniformCatmullRom(l.z,u.z,h.z,c.z,p,f,m)}else this.curveType==="catmullrom"&&(Ry.initCatmullRom(l.x,u.x,h.x,c.x,this.tension),By.initCatmullRom(l.y,u.y,h.y,c.y,this.tension),ky.initCatmullRom(l.z,u.z,h.z,c.z,this.tension));return r.set(Ry.calc(o),By.calc(o),ky.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new T().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function GC(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function JQ(e,t){let r=1-e;return r*r*t}function $Q(e,t){return 2*(1-e)*e*t}function eK(e,t){return e*e*t}function Kp(e,t,r,i){return JQ(e,t)+$Q(e,r)+eK(e,i)}function tK(e,t){let r=1-e;return r*r*r*t}function rK(e,t){let r=1-e;return 3*r*r*e*t}function iK(e,t){return 3*(1-e)*e*e*t}function nK(e,t){return e*e*e*t}function Zp(e,t,r,i,n){return tK(e,t)+rK(e,r)+iK(e,i)+nK(e,n)}var ws=class extends ya{constructor(t=new W,r=new W,i=new W,n=new W){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=r,this.v2=i,this.v3=n}getPoint(t,r=new W){let i=r,n=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(Zp(t,n.x,s.x,a.x,o.x),Zp(t,n.y,s.y,a.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},_0=class extends ya{constructor(e=new T,t=new T,r=new T,i=new T){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new T){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Zp(e,i.x,n.x,s.x,a.x),Zp(e,i.y,n.y,s.y,a.y),Zp(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Ts=class extends ya{constructor(t=new W,r=new W){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=r}getPoint(t,r=new W){let i=r;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,r){return this.getPoint(t,r)}getTangent(t,r){let i=r||new W;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},dD=class extends ya{constructor(e=new T,t=new T){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new T){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Cl=class extends ya{constructor(e=new W,t=new W,r=new W){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new W){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Kp(e,i.x,n.x,s.x),Kp(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},sK=class extends ya{constructor(e=new T,t=new T,r=new T){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new T){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Kp(e,i.x,n.x,s.x),Kp(e,i.y,n.y,s.y),Kp(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},A7=class extends ya{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new W){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(GC(a,o.x,l.x,c.x,u.x),GC(a,o.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new W().fromArray(i))}return this}},aK=Object.freeze({__proto__:null,ArcCurve:KQ,CatmullRomCurve3:ZQ,CubicBezierCurve:ws,CubicBezierCurve3:_0,EllipseCurve:zv,LineCurve:Ts,LineCurve3:dD,QuadraticBezierCurve:Cl,QuadraticBezierCurve3:sK,SplineCurve:A7}),pD=class extends ya{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ts(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new aK[i.type]().fromJSON(i))}return this}},wg=class extends pD{constructor(e){super(),this.type="Path",this.currentPoint=new W,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Ts(this.currentPoint.clone(),new W(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Cl(this.currentPoint.clone(),new W(e,t),new W(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new ws(this.currentPoint.clone(),new W(e,t),new W(r,i),new W(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new A7(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new zv(e,t,r,i,n,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},fD=class extends nt{constructor(e=[new W(0,-.5),new W(.5,0),new W(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=jr(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],c=1/t,u=new T,h=new W,d=new T,p=new T,f=new T,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){let y=r+v*c*i,x=Math.sin(y),b=Math.cos(y);for(let w=0;w<=e.length-1;w++){u.x=e[w].x*x,u.y=e[w].y,u.z=e[w].x*b,s.push(u.x,u.y,u.z),h.x=v/t,h.y=w/(e.length-1),a.push(h.x,h.y);let C=o[3*w+0]*x,_=o[3*w+1],S=o[3*w+0]*b;l.push(C,_,S)}}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){let x=y+v*e.length,b=x,w=x+e.length,C=x+e.length+1,_=x+1;n.push(b,w,_),n.push(C,_,w)}this.setIndex(n),this.setAttribute("position",new ze(s,3)),this.setAttribute("uv",new ze(a,2)),this.setAttribute("normal",new ze(l,3))}static fromJSON(e){return new fD(e.points,e.segments,e.phiStart,e.phiLength)}},E7=class extends nt{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],u=[],h=[],d=[],p=0,f=[],m=r/2,g=0;v(),s===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new ze(u,3)),this.setAttribute("normal",new ze(h,3)),this.setAttribute("uv",new ze(d,2));function v(){let x=new T,b=new T,w=0,C=(t-e)/r;for(let _=0;_<=n;_++){let S=[],A=_/n,E=A*(t-e)+e;for(let L=0;L<=i;L++){let P=L/i,D=P*o+a,I=Math.sin(D),B=Math.cos(D);b.x=E*I,b.y=-A*r+m,b.z=E*B,u.push(b.x,b.y,b.z),x.set(I,C,B).normalize(),h.push(x.x,x.y,x.z),d.push(P,1-A),S.push(p++)}f.push(S)}for(let _=0;_<i;_++)for(let S=0;S<n;S++){let A=f[S][_],E=f[S+1][_],L=f[S+1][_+1],P=f[S][_+1];c.push(A,E,P),c.push(E,L,P),w+=6}l.addGroup(g,w,0),g+=w}function y(x){let b=p,w=new W,C=new T,_=0,S=x===!0?e:t,A=x===!0?1:-1;for(let L=1;L<=i;L++)u.push(0,m*A,0),h.push(0,A,0),d.push(.5,.5),p++;let E=p;for(let L=0;L<=i;L++){let P=L/i*o+a,D=Math.cos(P),I=Math.sin(P);C.x=S*I,C.y=m*A,C.z=S*D,u.push(C.x,C.y,C.z),h.push(0,A,0),w.x=D*.5+.5,w.y=I*.5*A+.5,d.push(w.x,w.y),p++}for(let L=0;L<i;L++){let P=b+L,D=E+L;x===!0?c.push(D,D+1,P):c.push(D+1,D,P),_+=3}l.addGroup(g,_,x===!0?1:2),g+=_}}static fromJSON(e){return new E7(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},mD=class extends E7{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new mD(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},M7=class extends nt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),c(),this.setAttribute("position",new ze(n,3)),this.setAttribute("normal",new ze(n.slice(),3)),this.setAttribute("uv",new ze(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){let y=new T,x=new T,b=new T;for(let w=0;w<t.length;w+=3)d(t[w+0],y),d(t[w+1],x),d(t[w+2],b),o(y,x,b,v)}function o(v,y,x,b){let w=b+1,C=[];for(let _=0;_<=w;_++){C[_]=[];let S=v.clone().lerp(x,_/w),A=y.clone().lerp(x,_/w),E=w-_;for(let L=0;L<=E;L++)L===0&&_===w?C[_][L]=S:C[_][L]=S.clone().lerp(A,L/E)}for(let _=0;_<w;_++)for(let S=0;S<2*(w-_)-1;S++){let A=Math.floor(S/2);S%2===0?(h(C[_][A+1]),h(C[_+1][A]),h(C[_][A])):(h(C[_][A+1]),h(C[_+1][A+1]),h(C[_+1][A]))}}function l(v){let y=new T;for(let x=0;x<n.length;x+=3)y.x=n[x+0],y.y=n[x+1],y.z=n[x+2],y.normalize().multiplyScalar(v),n[x+0]=y.x,n[x+1]=y.y,n[x+2]=y.z}function c(){let v=new T;for(let y=0;y<n.length;y+=3){v.x=n[y+0],v.y=n[y+1],v.z=n[y+2];let x=m(v)/2/Math.PI+.5,b=g(v)/Math.PI+.5;s.push(x,1-b)}p(),u()}function u(){for(let v=0;v<s.length;v+=6){let y=s[v+0],x=s[v+2],b=s[v+4],w=Math.max(y,x,b),C=Math.min(y,x,b);w>.9&&C<.1&&(y<.2&&(s[v+0]+=1),x<.2&&(s[v+2]+=1),b<.2&&(s[v+4]+=1))}}function h(v){n.push(v.x,v.y,v.z)}function d(v,y){let x=v*3;y.x=e[x+0],y.y=e[x+1],y.z=e[x+2]}function p(){let v=new T,y=new T,x=new T,b=new T,w=new W,C=new W,_=new W;for(let S=0,A=0;S<n.length;S+=9,A+=6){v.set(n[S+0],n[S+1],n[S+2]),y.set(n[S+3],n[S+4],n[S+5]),x.set(n[S+6],n[S+7],n[S+8]),w.set(s[A+0],s[A+1]),C.set(s[A+2],s[A+3]),_.set(s[A+4],s[A+5]),b.copy(v).add(y).add(x).divideScalar(3);let E=m(b);f(w,A+0,v,E),f(C,A+2,y,E),f(_,A+4,x,E)}}function f(v,y,x,b){b<0&&v.x===1&&(s[y]=v.x-1),x.x===0&&x.z===0&&(s[y]=b/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new M7(e.vertices,e.indices,e.radius,e.details)}},gD=class extends M7{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new gD(e.radius,e.detail)}},Cg=class extends wg{constructor(e){super(e),this.uuid=Jn(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new wg().fromJSON(i))}return this}},oK={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=vD(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,h,d,p;if(i&&(s=dK(e,t,s,r)),e.length>80*r){o=c=e[0],l=u=e[1];for(let f=r;f<n;f+=r)h=e[f],d=e[f+1],h<o&&(o=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-o,u-l),p=p!==0?32767/p:0}return Rf(s,a,r,o,l,p,0),a}};function vD(e,t,r,i,n){let s,a;if(n===SK(e,t,r,i)>0)for(s=t;s<r;s+=i)a=WC(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=WC(s,e[s],e[s+1],a);return a&&Fv(a,a.next)&&(kf(a),a=a.next),a}function zc(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(Fv(r,r.next)||or(r.prev,r,r.next)===0)){if(kf(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Rf(e,t,r,i,n,s,a){if(!e)return;!a&&s&&vK(e,i,n,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?cK(e,i,n,s):lK(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),kf(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=hK(zc(e),t,r),Rf(e,t,r,i,n,s,2)):a===2&&uK(e,t,r,i,n,s):Rf(zc(e),t,r,i,n,s,1);break}}}function lK(e){let t=e.prev,r=e,i=e.next;if(or(t,r,i)>=0)return!1;let n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,c=i.y,u=n<s?n<a?n:a:s<a?s:a,h=o<l?o<c?o:c:l<c?l:c,d=n>s?n>a?n:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c,f=i.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&au(n,o,s,l,a,c,f.x,f.y)&&or(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function cK(e,t,r,i){let n=e.prev,s=e,a=e.next;if(or(n,s,a)>=0)return!1;let o=n.x,l=s.x,c=a.x,u=n.y,h=s.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,v=f5(p,f,t,r,i),y=f5(m,g,t,r,i),x=e.prevZ,b=e.nextZ;for(;x&&x.z>=v&&b&&b.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==a&&au(o,u,l,h,c,d,x.x,x.y)&&or(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==a&&au(o,u,l,h,c,d,b.x,b.y)&&or(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==n&&x!==a&&au(o,u,l,h,c,d,x.x,x.y)&&or(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==a&&au(o,u,l,h,c,d,b.x,b.y)&&or(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function hK(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!Fv(n,s)&&yD(n,i,i.next,s)&&Bf(n,s)&&Bf(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),kf(i),kf(i.next),i=e=s),i=i.next}while(i!==e);return zc(i)}function uK(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&bK(a,o)){let l=xD(a,o);a=zc(a,a.next),l=zc(l,l.next),Rf(a,t,r,i,n,s,0),Rf(l,t,r,i,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function dK(e,t,r,i){let n=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,c=vD(e,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(xK(c));for(n.sort(pK),s=0;s<n.length;s++)r=fK(n[s],r);return r}function pK(e,t){return e.x-t.x}function fK(e,t){let r=mK(e,t);if(!r)return t;let i=xD(r,e);return zc(i,i.next),zc(r,r.next)}function mK(e,t){let r=t,i=-1/0,n,s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let d=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(d<=s&&d>i&&(i=d,n=r.x<r.next.x?r:r.next,d===s))return n}r=r.next}while(r!==t);if(!n)return null;let o=n,l=n.x,c=n.y,u=1/0,h;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&au(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(h=Math.abs(a-r.y)/(s-r.x),Bf(r,e)&&(h<u||h===u&&(r.x>n.x||r.x===n.x&&gK(n,r)))&&(n=r,u=h)),r=r.next;while(r!==o);return n}function gK(e,t){return or(e.prev,e,t.prev)<0&&or(t.next,e,e.next)<0}function vK(e,t,r,i){let n=e;do n.z===0&&(n.z=f5(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,yK(n)}function yK(e){let t,r,i,n,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<c&&(o++,i=i.nextZ,!!i);t++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(a>1);return e}function f5(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function xK(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function au(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function bK(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!wK(e,t)&&(Bf(e,t)&&Bf(t,e)&&CK(e,t)&&(or(e.prev,e,t.prev)||or(e,t.prev,t))||Fv(e,t)&&or(e.prev,e,e.next)>0&&or(t.prev,t,t.next)>0)}function or(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Fv(e,t){return e.x===t.x&&e.y===t.y}function yD(e,t,r,i){let n=pm(or(e,t,r)),s=pm(or(e,t,i)),a=pm(or(r,i,e)),o=pm(or(r,i,t));return!!(n!==s&&a!==o||n===0&&dm(e,r,t)||s===0&&dm(e,i,t)||a===0&&dm(r,e,i)||o===0&&dm(r,t,i))}function dm(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function pm(e){return e>0?1:e<0?-1:0}function wK(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&yD(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Bf(e,t){return or(e.prev,e,e.next)<0?or(e,t,e.next)>=0&&or(e,e.prev,t)>=0:or(e,t,e.prev)<0||or(e,e.next,t)<0}function CK(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function xD(e,t){let r=new m5(e.i,e.x,e.y),i=new m5(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function WC(e,t,r,i){let n=new m5(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function kf(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function m5(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function SK(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var bD=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return bD.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];qC(e),XC(r,e);let s=e.length;t.forEach(qC);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,XC(r,t[o]);let a=oK.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function qC(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function XC(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var wD=class extends M7{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new wD(e.radius,e.detail)}},T7=class extends nt{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new T,h=new T,d=[],p=[],f=[],m=[];for(let g=0;g<=r;g++){let v=[],y=g/r,x=0;g==0&&s==0?x=.5/t:g==r&&o==Math.PI&&(x=-.5/t);for(let b=0;b<=t;b++){let w=b/t;u.x=-e*Math.cos(i+w*n)*Math.sin(s+y*a),u.y=e*Math.cos(s+y*a),u.z=e*Math.sin(i+w*n)*Math.sin(s+y*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(w+x,1-y),v.push(l++)}c.push(v)}for(let g=0;g<r;g++)for(let v=0;v<t;v++){let y=c[g][v+1],x=c[g][v],b=c[g+1][v],w=c[g+1][v+1];(g!==0||s>0)&&d.push(y,x,w),(g!==r-1||o<Math.PI)&&d.push(x,b,w)}this.setIndex(d),this.setAttribute("position",new ze(p,3)),this.setAttribute("normal",new ze(f,3)),this.setAttribute("uv",new ze(m,2))}static fromJSON(e){return new T7(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},CD=class extends nt{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],c=[],u=new T,h=new T,d=new T,p=new T,f=new T,m=new T,g=new T;for(let y=0;y<=r;++y){let x=y/r*n*Math.PI*2;v(x,n,s,e,d),v(x+.01,n,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let b=0;b<=i;++b){let w=b/i*Math.PI*2,C=-t*Math.cos(w),_=t*Math.sin(w);u.x=d.x+(C*g.x+_*f.x),u.y=d.y+(C*g.y+_*f.y),u.z=d.z+(C*g.z+_*f.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/r),c.push(b/i)}}for(let y=1;y<=r;y++)for(let x=1;x<=i;x++){let b=(i+1)*(y-1)+(x-1),w=(i+1)*y+(x-1),C=(i+1)*y+x,_=(i+1)*(y-1)+x;a.push(b,w,_),a.push(w,C,_)}this.setIndex(a),this.setAttribute("position",new ze(o,3)),this.setAttribute("normal",new ze(l,3)),this.setAttribute("uv",new ze(c,2));function v(y,x,b,w,C){let _=Math.cos(y),S=Math.sin(y),A=b/x*y,E=Math.cos(A);C.x=w*(2+E)*.5*_,C.y=w*(2+E)*S*.5,C.z=w*Math.sin(A)*.5}}static fromJSON(e){return new CD(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function _o(e,t,r){return SD(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function fm(e,t,r){return!e||!r&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function SD(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _K(e){function t(n,s){return e[n]-e[s]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function YC(e,t,r){let i=e.length,n=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let o=r[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function _D(e,t,r,i){let n=1,s=e[0];for(;s!==void 0&&s[i]===void 0;)s=e[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(t.push(s.time),r.push.apply(r,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(t.push(s.time),a.toArray(r,r.length)),s=e[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(t.push(s.time),r.push(a)),s=e[n++];while(s!==void 0)}var jv=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let o=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0;break r}break e}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let s=0;s!==i;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},AK=class extends jv{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ru,endingEnd:ru}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,a=i[n],o=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case iu:n=e,a=2*t-r;break;case mg:n=i.length-2,a=t+i[n]-i[n+1];break;default:n=e,a=r}if(o===void 0)switch(this.getSettings_().endingEnd){case iu:s=e,o=2*r-t;break;case mg:s=1,o=r+i[1]-i[0];break;default:s=e-1,o=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f;for(let b=0;b!==a;++b)n[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+x*s[u+b];return n}},AD=class extends jv{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(i-t),u=1-c;for(let h=0;h!==a;++h)n[h]=s[l+h]*u+s[o+h]*c;return n}},EK=class extends jv{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},xa=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fm(t,this.TimeBufferType),this.values=fm(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:fm(e.times,Array),values:fm(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new EK(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new AD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new AK(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case pg:t=this.InterpolantFactoryMethodDiscrete;break;case fg:t=this.InterpolantFactoryMethodLinear;break;case oy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pg;case this.InterpolantFactoryMethodLinear:return fg;case this.InterpolantFactoryMethodSmooth:return oy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=_o(r,n,s),this.values=_o(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=r[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(i!==void 0&&SD(i))for(let a=0,o=i.length;a!==o;++a){let l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=_o(this.times),t=_o(this.values),r=this.getValueSize(),i=this.getInterpolation()===oy,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(i)o=!0;else{let u=a*r,h=u-r,d=u+r;for(let p=0;p!==r;++p){let f=t[u+p];if(f!==t[h+p]||f!==t[d+p]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let u=a*r,h=s*r;for(let d=0;d!==r;++d)t[h+d]=t[u+d]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,o=s*r,l=0;l!==r;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=_o(e,0,s),this.values=_o(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=_o(this.times,0),t=_o(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};xa.prototype.TimeBufferType=Float32Array;xa.prototype.ValueBufferType=Float32Array;xa.prototype.DefaultInterpolation=fg;var gd=class extends xa{};gd.prototype.ValueTypeName="bool";gd.prototype.ValueBufferType=Array;gd.prototype.DefaultInterpolation=pg;gd.prototype.InterpolantFactoryMethodLinear=void 0;gd.prototype.InterpolantFactoryMethodSmooth=void 0;var ED=class extends xa{};ED.prototype.ValueTypeName="color";var Sg=class extends xa{};Sg.prototype.ValueTypeName="number";var MK=class extends jv{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)mt.slerpFlat(n,0,s,l-a,s,l,o);return n}},f1=class extends xa{InterpolantFactoryMethodLinear(e){return new MK(this.times,this.values,this.getValueSize(),e)}};f1.prototype.ValueTypeName="quaternion";f1.prototype.DefaultInterpolation=fg;f1.prototype.InterpolantFactoryMethodSmooth=void 0;var vd=class extends xa{};vd.prototype.ValueTypeName="string";vd.prototype.ValueBufferType=Array;vd.prototype.DefaultInterpolation=pg;vd.prototype.InterpolantFactoryMethodLinear=void 0;vd.prototype.InterpolantFactoryMethodSmooth=void 0;var _g=class extends xa{};_g.prototype.ValueTypeName="vector";var g5=class{constructor(e,t=-1,r,i=g7){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Jn(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(LK(r[s]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(xa.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let c=_K(o);o=YC(o,1,c),l=YC(l,1,c),!i&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new Sg(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(n);if(c&&c.length>1){let u=c[1],h=i[u];h||(i[u]=h=[]),h.push(l)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,u,h,d,p){if(h.length!==0){let f=[],m=[];_D(h,f,m,d),f.length!==0&&p.push(new c(u,f,m))}},i=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let h={},d;for(d=0;d<u.length;d++)if(u[d].morphTargets)for(let p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(let p in h){let f=[],m=[];for(let g=0;g!==u[d].morphTargets.length;++g){let v=u[d];f.push(v.time),m.push(v.morphTarget===p?1:0)}i.push(new Sg(".morphTargetInfluence["+p+"]",f,m))}o=h.length*s}else{let h=".bones["+t[c].name+"]";r(_g,h+".position",u,"pos",i),r(f1,h+".quaternion",u,"rot",i),r(_g,h+".scale",u,"scl",i)}}return i.length===0?null:new this(n,o,i,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function TK(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sg;case"vector":case"vector2":case"vector3":case"vector4":return _g;case"color":return ED;case"quaternion":return f1;case"bool":case"boolean":return gd;case"string":return vd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function LK(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=TK(e.type);if(e.times===void 0){let r=[],i=[];_D(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var QC={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},MD=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,n===!1&&i.onStart!==void 0&&i.onStart(c,s,a),n=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,h=l.length;u<h;u+=2){let d=l[u],p=l[u+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}},PK=new MD,L7=class{constructor(e){this.manager=e!==void 0?e:PK,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Ta={},DK=class extends Error{constructor(e,t){super(e),this.response=t}},v5=class extends L7{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=QC.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Ta[e]!==void 0){Ta[e].push({onLoad:t,onProgress:r,onError:i});return}Ta[e]=[],Ta[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Ta[e],u=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0,f=0,m=new ReadableStream({start(g){v();function v(){u.read().then(({done:y,value:x})=>{if(y)g.close();else{f+=x.byteLength;let b=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:d});for(let w=0,C=c.length;w<C;w++){let _=c[w];_.onProgress&&_.onProgress(b)}g.enqueue(x),v()}})}}});return new Response(m)}else throw new DK(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),u=c&&c[1]?c[1].toLowerCase():void 0,h=new TextDecoder(u);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{QC.add(e,l);let c=Ta[e];delete Ta[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=Ta[e];if(c===void 0)throw this.manager.itemError(e),l;delete Ta[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},m1=class extends Vt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new $e(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},IK=class extends m1{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new $e(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},Ny=new Ce,KC=new T,ZC=new T,P7=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new W(512,512),this.map=null,this.mapPass=null,this.matrix=new Ce,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new b7,this._frameExtents=new W(1,1),this._viewportCount=1,this._viewports=[new pt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;KC.setFromMatrixPosition(e.matrixWorld),t.position.copy(KC),ZC.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(ZC),t.updateMatrixWorld(),Ny.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ny),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Ny)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},OK=class extends P7{constructor(){super(new bi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=Of*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},RK=class extends m1{constructor(e,t,r=0,i=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new OK}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},JC=new Ce,Kd=new T,zy=new T,BK=class extends P7{constructor(){super(new bi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new W(4,2),this._viewportCount=6,this._viewports=[new pt(2,1,1,1),new pt(0,1,1,1),new pt(3,1,1,1),new pt(1,1,1,1),new pt(3,0,1,1),new pt(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Kd.setFromMatrixPosition(e.matrixWorld),r.position.copy(Kd),zy.copy(r.position),zy.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(zy),r.updateMatrixWorld(),i.makeTranslation(-Kd.x,-Kd.y,-Kd.z),JC.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(JC)}},kK=class extends m1{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new BK}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},NK=class extends P7{constructor(){super(new w7(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},zK=class extends m1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.shadow=new NK}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},FK=class extends nt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},TD=class extends L7{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new v5(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(h,d){if(t[d]!==void 0)return t[d];let p=h.interleavedBuffers[d],f=n(h,p.buffer),m=W1(p.type,f),g=new qQ(m,p.stride);return g.uuid=p.uuid,t[d]=g,g}function n(h,d){if(r[d]!==void 0)return r[d];let p=h.arrayBuffers[d],f=new Uint32Array(p).buffer;return r[d]=f,f}let s=e.isInstancedBufferGeometry?new FK:new nt,a=e.data.index;if(a!==void 0){let h=W1(a.type,a.array);s.setIndex(new st(h,1))}let o=e.data.attributes;for(let h in o){let d=o[h],p;if(d.isInterleavedBufferAttribute){let f=i(e.data,d.data);p=new p5(f,d.itemSize,d.offset,d.normalized)}else{let f=W1(d.type,d.array),m=d.isInstancedBufferAttribute?YQ:st;p=new m(f,d.itemSize,d.normalized)}d.name!==void 0&&(p.name=d.name),d.usage!==void 0&&p.setUsage(d.usage),d.updateRange!==void 0&&(p.updateRange.offset=d.updateRange.offset,p.updateRange.count=d.updateRange.count),s.setAttribute(h,p)}let l=e.data.morphAttributes;if(l)for(let h in l){let d=l[h],p=[];for(let f=0,m=d.length;f<m;f++){let g=d[f],v;if(g.isInterleavedBufferAttribute){let y=i(e.data,g.data);v=new p5(y,g.itemSize,g.offset,g.normalized)}else{let y=W1(g.type,g.array);v=new st(y,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),p.push(v)}s.morphAttributes[h]=p}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let h=0,d=c.length;h!==d;++h){let p=c[h];s.addGroup(p.start,p.count,p.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let h=new T;u.center!==void 0&&h.fromArray(u.center),s.boundingSphere=new Ln(h,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},jK=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=$C(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=$C();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function $C(){return(typeof performance>"u"?Date:performance).now()}var UK=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,s;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)r[n+a]=r[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(r,n,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,s=i;n!==s;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let s=0;s!==n;++s)e[t+s]=e[r+s]}_slerp(e,t,r,i){mt.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let s=this._workIndex*n;mt.multiplyQuaternionsFlat(e,s,e,t,e,r),mt.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){let s=1-i;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[r+a]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[r+s]*i}}},D7="\\[\\]\\.:\\/",VK=new RegExp("["+D7+"]","g"),I7="[^"+D7+"]",HK="[^"+D7.replace("\\.","")+"]",GK=/((?:WC+[\/:])*)/.source.replace("WC",I7),WK=/(WCOD+)?/.source.replace("WCOD",HK),qK=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",I7),XK=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",I7),YK=new RegExp("^"+GK+WK+qK+XK+"$"),QK=["material","materials","bones","map"],KK=class{constructor(e,t,r){let i=r||Gt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Gt=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Gt.parseTrackName(t),this.node=Gt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Gt.Composite(e,t,r):new Gt(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(VK,"")}static parseTrackName(e){let t=YK.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);QK.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=r(a.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=Gt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[i];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Gt.Composite=KK;Gt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Gt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Gt.prototype.GetterByBindingType=[Gt.prototype._getValue_direct,Gt.prototype._getValue_array,Gt.prototype._getValue_arrayElement,Gt.prototype._getValue_toArray];Gt.prototype.SetterByBindingTypeAndVersioning=[[Gt.prototype._setValue_direct,Gt.prototype._setValue_direct_setNeedsUpdate,Gt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_array,Gt.prototype._setValue_array_setNeedsUpdate,Gt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_arrayElement,Gt.prototype._setValue_arrayElement_setNeedsUpdate,Gt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_fromArray,Gt.prototype._setValue_fromArray_setNeedsUpdate,Gt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var ZK=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:ru,endingEnd:ru};for(let l=0;l!==s;++l){let c=n[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=XP,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,s=n/i,a=i/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case DG:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case g7:default:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,s=r===m7;if(e===0)return n===-1?i:s&&(n&1)===1?t-i:i;if(r===qP){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=iu,i.endingEnd=iu):(e?i.endingStart=this.zeroSlopeAtStart?iu:ru:i.endingStart=mg,t?i.endingEnd=this.zeroSlopeAtEnd?iu:ru:i.endingEnd=mg)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=r,this}},JK=new Float32Array(1),$K=class extends pi{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let u=0;u!==n;++u){let h=i[u],d=h.name,p=c[d];if(p!==void 0)++p.referenceCount,s[u]=p;else{if(p=s[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,o,d));continue}let f=t&&t._propertyBindings[u].binding.parsedPath;p=new UK(Gt.create(r,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,o,d),s[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let u=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,s=i[t];s===void 0&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new AD(new Float32Array(2),new Float32Array(2),1,JK),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,s=typeof e=="string"?g5.findByName(i,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(r===void 0&&(s!==null?r=s.blendMode:r=g7),o!==void 0){let u=o.actionByRoot[n];if(u!==void 0&&u.blendMode===r)return u;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new ZK(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?g5.findByName(r,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let s in r){let a=r[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},be=class{constructor(e){this.value=e}clone(){return new be(this.value.clone===void 0?this.value:this.value.clone())}},LD=class{constructor(e,t,r=0,i=1/0){this.ray=new dd(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new y7,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return y5(e,this,r,t),r.sort(eS),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)y5(e[i],this,r,t);return r.sort(eS),r}};function eS(e,t){return e.distance-t.distance}function y5(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)y5(n[s],t,r,!0)}}var tS=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(jr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},rS=new W,eZ=class{constructor(e=new W(1/0,1/0),t=new W(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=rS.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return rS.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},iS=new T,mm=new T,$n=class{constructor(e=new T,t=new T){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){iS.subVectors(e,this.start),mm.subVectors(this.end,this.start);let r=mm.dot(mm),i=mm.dot(iS)/r;return t&&(i=jr(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},nS=new T,tZ=class extends Vt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new nt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new ze(i,3));let n=new Ol({fog:!1,toneMapped:!1});this.cone=new p1(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),nS.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nS),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},rZ=class extends $i{constructor(e,t,r){let i=new T7(t,4,2),n=new d1({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},sS=new T,gm=new T,aS=new T,iZ=class extends Vt{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new nt;i.setAttribute("position",new ze([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new Ol({fog:!1,toneMapped:!1});this.lightPlane=new bg(i,n),this.add(this.lightPlane),i=new nt,i.setAttribute("position",new ze([0,0,0,0,0,1],3)),this.targetLine=new bg(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),sS.setFromMatrixPosition(this.light.matrixWorld),gm.setFromMatrixPosition(this.light.target.matrixWorld),aS.subVectors(gm,sS),this.lightPlane.lookAt(gm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gm),this.targetLine.scale.z=aS.length()}},vm=new T,hr=new fd,Ag=class extends p1{constructor(e){let t=new nt,r=new Ol({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,f){o(p),o(f)}function o(p){i.push(0,0,0),n.push(0,0,0),s[p]===void 0&&(s[p]=[]),s[p].push(i.length/3-1)}t.setAttribute("position",new ze(i,3)),t.setAttribute("color",new ze(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new $e(16755200),c=new $e(16711680),u=new $e(43775),h=new $e(16777215),d=new $e(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,r,i,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;hr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),vr("c",t,e,hr,0,0,-1),vr("t",t,e,hr,0,0,1),vr("n1",t,e,hr,-r,-i,-1),vr("n2",t,e,hr,r,-i,-1),vr("n3",t,e,hr,-r,i,-1),vr("n4",t,e,hr,r,i,-1),vr("f1",t,e,hr,-r,-i,1),vr("f2",t,e,hr,r,-i,1),vr("f3",t,e,hr,-r,i,1),vr("f4",t,e,hr,r,i,1),vr("u1",t,e,hr,r*.7,i*1.1,-1),vr("u2",t,e,hr,-r*.7,i*1.1,-1),vr("u3",t,e,hr,0,i*2,-1),vr("cf1",t,e,hr,-r,0,1),vr("cf2",t,e,hr,r,0,1),vr("cf3",t,e,hr,0,-i,1),vr("cf4",t,e,hr,0,i,1),vr("cn1",t,e,hr,-r,0,-1),vr("cn2",t,e,hr,r,0,-1),vr("cn3",t,e,hr,0,-i,-1),vr("cn4",t,e,hr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function vr(e,t,r,i,n,s,a){vm.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],vm.x,vm.y,vm.z)}}var Eg=class extends p1{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new nt;n.setIndex(new st(r,1)),n.setAttribute("position",new ze(i,3)),super(n,new Ol({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},nZ=class extends p1{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new nt;i.setAttribute("position",new ze(t,3)),i.setAttribute("color",new ze(r,3));let n=new Ol({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new $e,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ud}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ud);var Zd=".",O7=Symbol("target"),PD=Symbol("unsubscribe");function x5(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function sZ(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var ra=Array.isArray;function R7(e){return typeof e=="symbol"}var aZ={after:(e,t)=>ra(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>ra(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Zd),R7(t)?e+t.toString():e+t):e,initial:e=>{if(ra(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Zd);return t===-1?"":e.slice(0,t)},last:e=>{if(ra(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Zd);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(ra(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Zd);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Zd,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Vn=aZ;function oZ(e){return typeof e=="object"&&typeof e.next=="function"}function lZ(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[O7].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function oS(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&R7(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var cZ=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Vn.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function b5(e){return toString.call(e)==="[object Object]"}function ym(){return!0}function mh(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var DD=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),hZ=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),ID={push:ym,pop:ym,shift:ym,unshift:ym,copyWithin:mh,reverse:mh,sort:mh,splice:mh,flat:mh,fill:mh},uZ=new Set([...DD,...hZ,...Object.keys(ID)]);function xm(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var OD=["keys","values","entries"],RD=new Set(["has","toString"]),BD={add:xm,clear:xm,delete:xm,forEach:xm},dZ=new Set([...RD,...Object.keys(BD),...OD]);function bm(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var pZ=new Set([...RD,"get"]),kD={set:bm,clear:bm,delete:bm,forEach:bm},fZ=new Set([...pZ,...Object.keys(kD),...OD]),Sl=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return DD.has(e)}_shallowClone(e){let t=e;if(b5(e))t={...e};else if(ra(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(ra(i)?this._onIsChanged=ID[t]:i instanceof Set?this._onIsChanged=BD[t]:i instanceof Map&&(this._onIsChanged=kD[t]),i):r}update(e,t,r){let i=Vn.after(e,this._path);if(t!=="length"){let n=this.clone;Vn.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Vn.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},lS=class extends Sl{static isHandledMethod(e){return uZ.has(e)}},mZ=class extends Sl{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},cS=class extends Sl{static isHandledMethod(e){return dZ.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},hS=class extends Sl{static isHandledMethod(e){return fZ.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},gZ=class extends Sl{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},vZ=class extends Sl{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},Rh=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return b5(e)||ra(e)||x5(e)}static isHandledMethod(e,t){return b5(e)?Sl.isHandledMethod(t):ra(e)?lS.isHandledMethod(t):e instanceof Set?cS.isHandledMethod(t):e instanceof Map?hS.isHandledMethod(t):x5(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Sl;ra(e)?i=lS:e instanceof Date?i=mZ:e instanceof Set?i=cS:e instanceof Map?i=hS:e instanceof WeakSet?i=gZ:e instanceof WeakMap&&(i=vZ),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=Rh.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},yZ={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},B7=(e,t,r={})=>{r={...yZ,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new cZ(n),c=typeof r.onValidate=="function",u=new Rh(c),h=(y,x,b,w,C)=>!c||u.isCloning||r.onValidate(Vn.concat(l.getPath(y),x),b,w,C)===!0,d=(y,x,b,w)=>{!oS(l,r,x)&&!(a&&l.isDetached(y,e))&&p(l.getPath(y),x,b,w)},p=(y,x,b,w,C)=>{u.isCloning?u.update(y,x,w):t(Vn.concat(y,x),b,w,C)},f=y=>y&&(y[i]||y),m=(y,x,b,w)=>sZ(y)||b==="constructor"||s&&!Rh.isHandledMethod(x,b)||oS(l,r,b)||l.isGetInvariant(x,b)||a&&l.isDetached(x,e)?y:(w===void 0&&(w=l.getPath(x)),l.getProxy(y,Vn.concat(w,b),g,i)),g={get(y,x,b){if(R7(x)){if(x===i||x===O7)return y;if(x===PD&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let w=x5(y)?Reflect.get(y,x):Reflect.get(y,x,b);return m(w,y,x)},set(y,x,b,w){b=f(b);let C=y[i]||y,_=C[x];if(n(_,b)&&x in y)return!0;let S=h(y,x,b,_);return S&&l.setProperty(C,x,b,w,_)?(d(y,x,y[x],_),!0):!S},defineProperty(y,x,b){if(!l.isSameDescriptor(b,y,x)){let w=y[x];h(y,x,b.value,w)&&l.defineProperty(y,x,b,w)&&d(y,x,b.value,w)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let b=Reflect.get(y,x),w=h(y,x,void 0,b);return w&&l.deleteProperty(y,x,b)?(d(y,x,void 0,b),!0):!w},apply(y,x,b){let w=x[i]||x;if(l.isUnsubscribed)return Reflect.apply(y,w,b);if((o===!1||o!==!0&&!o.includes(y.name))&&Rh.isHandledType(w)){let C=Vn.initial(l.getPath(y)),_=Rh.isHandledMethod(w,y.name);u.start(w,C,b);let S=Reflect.apply(y,u.preferredThisArg(y,x,w),_?b.map(L=>f(L)):b),A=u.isChanged(w,n),E=u.stop();if(Rh.isHandledType(S)&&_&&(x instanceof Map&&y.name==="get"&&(C=Vn.concat(C,b[0])),S=l.getProxy(S,C,g)),A){let L={name:y.name,args:b,result:S},P=u.isCloning?Vn.initial(C):C,D=u.isCloning?Vn.last(C):"";h(Vn.get(e,P),D,w,E,L)?p(P,D,w,E,L):u.undo(w)}return(x instanceof Map||x instanceof Set)&&oZ(S)?lZ(S,y,x,C,m):S}return Reflect.apply(y,x,b)}},v=l.getProxy(e,r.pathAsArray?[]:"",g);return t=t.bind(v),c&&(r.onValidate=r.onValidate.bind(v)),v};B7.target=e=>e&&e[O7]||e;B7.unsubscribe=e=>e[PD]||e;var uS=B7,xZ=typeof global=="object"&&global&&global.Object===Object&&global,ND=xZ,bZ=typeof self=="object"&&self&&self.Object===Object&&self,wZ=ND||bZ||Function("return this")(),Is=wZ,CZ=Is.Symbol,is=CZ,zD=Object.prototype,SZ=zD.hasOwnProperty,_Z=zD.toString,Jd=is?is.toStringTag:void 0;function AZ(e){var t=SZ.call(e,Jd),r=e[Jd];try{e[Jd]=void 0;var i=!0}catch{}var n=_Z.call(e);return i&&(t?e[Jd]=r:delete e[Jd]),n}var EZ=AZ,MZ=Object.prototype,TZ=MZ.toString;function LZ(e){return TZ.call(e)}var PZ=LZ,DZ="[object Null]",IZ="[object Undefined]",dS=is?is.toStringTag:void 0;function OZ(e){return e==null?e===void 0?IZ:DZ:dS&&dS in Object(e)?EZ(e):PZ(e)}var Xc=OZ;function RZ(e){return e!=null&&typeof e=="object"}var uo=RZ,BZ="[object Symbol]";function kZ(e){return typeof e=="symbol"||uo(e)&&Xc(e)==BZ}var Uv=kZ;function NZ(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var FD=NZ,zZ=Array.isArray,ma=zZ,FZ=1/0,pS=is?is.prototype:void 0,fS=pS?pS.toString:void 0;function jD(e){if(typeof e=="string")return e;if(ma(e))return FD(e,jD)+"";if(Uv(e))return fS?fS.call(e):"";var t=e+"";return t=="0"&&1/e==-FZ?"-0":t}var jZ=jD,UZ=/\s/;function VZ(e){for(var t=e.length;t--&&UZ.test(e.charAt(t)););return t}var HZ=VZ,GZ=/^\s+/;function WZ(e){return e&&e.slice(0,HZ(e)+1).replace(GZ,"")}var qZ=WZ;function XZ(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ds=XZ,mS=0/0,YZ=/^[-+]0x[0-9a-f]+$/i,QZ=/^0b[01]+$/i,KZ=/^0o[0-7]+$/i,ZZ=parseInt;function JZ(e){if(typeof e=="number")return e;if(Uv(e))return mS;if(Ds(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ds(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=qZ(e);var r=QZ.test(e);return r||KZ.test(e)?ZZ(e.slice(2),r?2:8):YZ.test(e)?mS:+e}var gS=JZ;function $Z(e){return e}var eJ=$Z,tJ="[object AsyncFunction]",rJ="[object Function]",iJ="[object GeneratorFunction]",nJ="[object Proxy]";function sJ(e){if(!Ds(e))return!1;var t=Xc(e);return t==rJ||t==iJ||t==tJ||t==nJ}var UD=sJ,aJ=Is["__core-js_shared__"],Fy=aJ,vS=function(){var e=/[^.]+$/.exec(Fy&&Fy.keys&&Fy.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function oJ(e){return!!vS&&vS in e}var lJ=oJ,cJ=Function.prototype,hJ=cJ.toString;function uJ(e){if(e!=null){try{return hJ.call(e)}catch{}try{return e+""}catch{}}return""}var Yc=uJ,dJ=/[\\^$.*+?()[\]{}|]/g,pJ=/^\[object .+?Constructor\]$/,fJ=Function.prototype,mJ=Object.prototype,gJ=fJ.toString,vJ=mJ.hasOwnProperty,yJ=RegExp("^"+gJ.call(vJ).replace(dJ,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xJ(e){if(!Ds(e)||lJ(e))return!1;var t=UD(e)?yJ:pJ;return t.test(Yc(e))}var bJ=xJ;function wJ(e,t){return e==null?void 0:e[t]}var CJ=wJ;function SJ(e,t){var r=CJ(e,t);return bJ(r)?r:void 0}var Qc=SJ,_J=Qc(Is,"WeakMap"),w5=_J,yS=Object.create,AJ=function(){function e(){}return function(t){if(!Ds(t))return{};if(yS)return yS(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),EJ=AJ;function MJ(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var TJ=MJ;function LJ(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var PJ=LJ,DJ=800,IJ=16,OJ=Date.now;function RJ(e){var t=0,r=0;return function(){var i=OJ(),n=IJ-(i-r);if(r=i,n>0){if(++t>=DJ)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var BJ=RJ;function kJ(e){return function(){return e}}var NJ=kJ,zJ=function(){try{var e=Qc(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Mg=zJ,FJ=Mg?function(e,t){return Mg(e,"toString",{configurable:!0,enumerable:!1,value:NJ(t),writable:!0})}:eJ,jJ=FJ,UJ=BJ(jJ),VJ=UJ;function HJ(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var GJ=HJ,WJ=9007199254740991,qJ=/^(?:0|[1-9]\d*)$/;function XJ(e,t){var r=typeof e;return t=t??WJ,!!t&&(r=="number"||r!="symbol"&&qJ.test(e))&&e>-1&&e%1==0&&e<t}var k7=XJ;function YJ(e,t,r){t=="__proto__"&&Mg?Mg(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var VD=YJ;function QJ(e,t){return e===t||e!==e&&t!==t}var N7=QJ,KJ=Object.prototype,ZJ=KJ.hasOwnProperty;function JJ(e,t,r){var i=e[t];(!(ZJ.call(e,t)&&N7(i,r))||r===void 0&&!(t in e))&&VD(e,t,r)}var z7=JJ;function $J(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?VD(r,o,l):z7(r,o,l)}return r}var g1=$J,xS=Math.max;function e$(e,t,r){return t=xS(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=xS(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),TJ(e,this,o)}}var t$=e$,r$=9007199254740991;function i$(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=r$}var F7=i$;function n$(e){return e!=null&&F7(e.length)&&!UD(e)}var HD=n$,s$=Object.prototype;function a$(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||s$;return e===r}var j7=a$;function o$(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var l$=o$,c$="[object Arguments]";function h$(e){return uo(e)&&Xc(e)==c$}var bS=h$,GD=Object.prototype,u$=GD.hasOwnProperty,d$=GD.propertyIsEnumerable,p$=bS(function(){return arguments}())?bS:function(e){return uo(e)&&u$.call(e,"callee")&&!d$.call(e,"callee")},U7=p$;function f$(){return!1}var m$=f$,WD=typeof _n=="object"&&_n&&!_n.nodeType&&_n,wS=WD&&typeof An=="object"&&An&&!An.nodeType&&An,g$=wS&&wS.exports===WD,CS=g$?Is.Buffer:void 0,v$=CS?CS.isBuffer:void 0,y$=v$||m$,Tg=y$,x$="[object Arguments]",b$="[object Array]",w$="[object Boolean]",C$="[object Date]",S$="[object Error]",_$="[object Function]",A$="[object Map]",E$="[object Number]",M$="[object Object]",T$="[object RegExp]",L$="[object Set]",P$="[object String]",D$="[object WeakMap]",I$="[object ArrayBuffer]",O$="[object DataView]",R$="[object Float32Array]",B$="[object Float64Array]",k$="[object Int8Array]",N$="[object Int16Array]",z$="[object Int32Array]",F$="[object Uint8Array]",j$="[object Uint8ClampedArray]",U$="[object Uint16Array]",V$="[object Uint32Array]",er={};er[R$]=er[B$]=er[k$]=er[N$]=er[z$]=er[F$]=er[j$]=er[U$]=er[V$]=!0;er[x$]=er[b$]=er[I$]=er[w$]=er[O$]=er[C$]=er[S$]=er[_$]=er[A$]=er[E$]=er[M$]=er[T$]=er[L$]=er[P$]=er[D$]=!1;function H$(e){return uo(e)&&F7(e.length)&&!!er[Xc(e)]}var G$=H$;function W$(e){return function(t){return e(t)}}var V7=W$,qD=typeof _n=="object"&&_n&&!_n.nodeType&&_n,Jp=qD&&typeof An=="object"&&An&&!An.nodeType&&An,q$=Jp&&Jp.exports===qD,jy=q$&&ND.process,X$=function(){try{var e=Jp&&Jp.require&&Jp.require("util").types;return e||jy&&jy.binding&&jy.binding("util")}catch{}}(),Yu=X$,SS=Yu&&Yu.isTypedArray,Y$=SS?V7(SS):G$,XD=Y$,Q$=Object.prototype,K$=Q$.hasOwnProperty;function Z$(e,t){var r=ma(e),i=!r&&U7(e),n=!r&&!i&&Tg(e),s=!r&&!i&&!n&&XD(e),a=r||i||n||s,o=a?l$(e.length,String):[],l=o.length;for(var c in e)(t||K$.call(e,c))&&!(a&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||k7(c,l)))&&o.push(c);return o}var YD=Z$;function J$(e,t){return function(r){return e(t(r))}}var QD=J$,$$=QD(Object.keys,Object),eee=$$,tee=Object.prototype,ree=tee.hasOwnProperty;function iee(e){if(!j7(e))return eee(e);var t=[];for(var r in Object(e))ree.call(e,r)&&r!="constructor"&&t.push(r);return t}var nee=iee;function see(e){return HD(e)?YD(e):nee(e)}var H7=see;function aee(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var oee=aee,lee=Object.prototype,cee=lee.hasOwnProperty;function hee(e){if(!Ds(e))return oee(e);var t=j7(e),r=[];for(var i in e)i=="constructor"&&(t||!cee.call(e,i))||r.push(i);return r}var uee=hee;function dee(e){return HD(e)?YD(e,!0):uee(e)}var G7=dee,pee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fee=/^\w*$/;function mee(e,t){if(ma(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Uv(e)?!0:fee.test(e)||!pee.test(e)||t!=null&&e in Object(t)}var gee=mee,vee=Qc(Object,"create"),Nf=vee;function yee(){this.__data__=Nf?Nf(null):{},this.size=0}var xee=yee;function bee(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var wee=bee,Cee="__lodash_hash_undefined__",See=Object.prototype,_ee=See.hasOwnProperty;function Aee(e){var t=this.__data__;if(Nf){var r=t[e];return r===Cee?void 0:r}return _ee.call(t,e)?t[e]:void 0}var Eee=Aee,Mee=Object.prototype,Tee=Mee.hasOwnProperty;function Lee(e){var t=this.__data__;return Nf?t[e]!==void 0:Tee.call(t,e)}var Pee=Lee,Dee="__lodash_hash_undefined__";function Iee(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Nf&&t===void 0?Dee:t,this}var Oee=Iee;function yd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}yd.prototype.clear=xee;yd.prototype.delete=wee;yd.prototype.get=Eee;yd.prototype.has=Pee;yd.prototype.set=Oee;var _S=yd;function Ree(){this.__data__=[],this.size=0}var Bee=Ree;function kee(e,t){for(var r=e.length;r--;)if(N7(e[r][0],t))return r;return-1}var Vv=kee,Nee=Array.prototype,zee=Nee.splice;function Fee(e){var t=this.__data__,r=Vv(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():zee.call(t,r,1),--this.size,!0}var jee=Fee;function Uee(e){var t=this.__data__,r=Vv(t,e);return r<0?void 0:t[r][1]}var Vee=Uee;function Hee(e){return Vv(this.__data__,e)>-1}var Gee=Hee;function Wee(e,t){var r=this.__data__,i=Vv(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var qee=Wee;function xd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}xd.prototype.clear=Bee;xd.prototype.delete=jee;xd.prototype.get=Vee;xd.prototype.has=Gee;xd.prototype.set=qee;var Hv=xd,Xee=Qc(Is,"Map"),zf=Xee;function Yee(){this.size=0,this.__data__={hash:new _S,map:new(zf||Hv),string:new _S}}var Qee=Yee;function Kee(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Zee=Kee;function Jee(e,t){var r=e.__data__;return Zee(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Gv=Jee;function $ee(e){var t=Gv(this,e).delete(e);return this.size-=t?1:0,t}var ete=$ee;function tte(e){return Gv(this,e).get(e)}var rte=tte;function ite(e){return Gv(this,e).has(e)}var nte=ite;function ste(e,t){var r=Gv(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var ate=ste;function bd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}bd.prototype.clear=Qee;bd.prototype.delete=ete;bd.prototype.get=rte;bd.prototype.has=nte;bd.prototype.set=ate;var Wv=bd,ote="Expected a function";function W7(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(ote);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(W7.Cache||Wv),r}W7.Cache=Wv;var lte=W7,cte=500;function hte(e){var t=lte(e,function(i){return r.size===cte&&r.clear(),i}),r=t.cache;return t}var ute=hte,dte=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pte=/\\(\\)?/g,fte=ute(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(dte,function(r,i,n,s){t.push(n?s.replace(pte,"$1"):i||r)}),t}),mte=fte;function gte(e){return e==null?"":jZ(e)}var vte=gte;function yte(e,t){return ma(e)?e:gee(e,t)?[e]:mte(vte(e))}var wd=yte,xte=1/0;function bte(e){if(typeof e=="string"||Uv(e))return e;var t=e+"";return t=="0"&&1/e==-xte?"-0":t}var qv=bte;function wte(e,t){t=wd(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[qv(t[r++])];return r&&r==i?e:void 0}var KD=wte;function Cte(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var q7=Cte,AS=is?is.isConcatSpreadable:void 0;function Ste(e){return ma(e)||U7(e)||!!(AS&&e&&e[AS])}var _te=Ste;function ZD(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=_te),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?ZD(o,t-1,r,i,n):q7(n,o):i||(n[n.length]=o)}return n}var Ate=ZD;function Ete(e){var t=e==null?0:e.length;return t?Ate(e,1):[]}var Mte=Ete;function Tte(e){return VJ(t$(e,void 0,Mte),e+"")}var JD=Tte,Lte=QD(Object.getPrototypeOf,Object),X7=Lte,Pte="[object Object]",Dte=Function.prototype,Ite=Object.prototype,$D=Dte.toString,Ote=Ite.hasOwnProperty,Rte=$D.call(Object);function Bte(e){if(!uo(e)||Xc(e)!=Pte)return!1;var t=X7(e);if(t===null)return!0;var r=Ote.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&$D.call(r)==Rte}var kte=Bte;function Nte(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var zte=Nte;function Fte(){this.__data__=new Hv,this.size=0}var jte=Fte;function Ute(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Vte=Ute;function Hte(e){return this.__data__.get(e)}var Gte=Hte;function Wte(e){return this.__data__.has(e)}var qte=Wte,Xte=200;function Yte(e,t){var r=this.__data__;if(r instanceof Hv){var i=r.__data__;if(!zf||i.length<Xte-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Wv(i)}return r.set(e,t),this.size=r.size,this}var Qte=Yte;function Cd(e){var t=this.__data__=new Hv(e);this.size=t.size}Cd.prototype.clear=jte;Cd.prototype.delete=Vte;Cd.prototype.get=Gte;Cd.prototype.has=qte;Cd.prototype.set=Qte;var A0=Cd;function Kte(e,t){return e&&g1(t,H7(t),e)}var Zte=Kte;function Jte(e,t){return e&&g1(t,G7(t),e)}var $te=Jte,eI=typeof _n=="object"&&_n&&!_n.nodeType&&_n,ES=eI&&typeof An=="object"&&An&&!An.nodeType&&An,ere=ES&&ES.exports===eI,MS=ere?Is.Buffer:void 0,TS=MS?MS.allocUnsafe:void 0;function tre(e,t){if(t)return e.slice();var r=e.length,i=TS?TS(r):new e.constructor(r);return e.copy(i),i}var rre=tre;function ire(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var nre=ire;function sre(){return[]}var tI=sre,are=Object.prototype,ore=are.propertyIsEnumerable,LS=Object.getOwnPropertySymbols,lre=LS?function(e){return e==null?[]:(e=Object(e),nre(LS(e),function(t){return ore.call(e,t)}))}:tI,Y7=lre;function cre(e,t){return g1(e,Y7(e),t)}var hre=cre,ure=Object.getOwnPropertySymbols,dre=ure?function(e){for(var t=[];e;)q7(t,Y7(e)),e=X7(e);return t}:tI,rI=dre;function pre(e,t){return g1(e,rI(e),t)}var fre=pre;function mre(e,t,r){var i=t(e);return ma(e)?i:q7(i,r(e))}var iI=mre;function gre(e){return iI(e,H7,Y7)}var C5=gre;function vre(e){return iI(e,G7,rI)}var nI=vre,yre=Qc(Is,"DataView"),S5=yre,xre=Qc(Is,"Promise"),_5=xre,bre=Qc(Is,"Set"),A5=bre,PS="[object Map]",wre="[object Object]",DS="[object Promise]",IS="[object Set]",OS="[object WeakMap]",RS="[object DataView]",Cre=Yc(S5),Sre=Yc(zf),_re=Yc(_5),Are=Yc(A5),Ere=Yc(w5),ec=Xc;(S5&&ec(new S5(new ArrayBuffer(1)))!=RS||zf&&ec(new zf)!=PS||_5&&ec(_5.resolve())!=DS||A5&&ec(new A5)!=IS||w5&&ec(new w5)!=OS)&&(ec=function(e){var t=Xc(e),r=t==wre?e.constructor:void 0,i=r?Yc(r):"";if(i)switch(i){case Cre:return RS;case Sre:return PS;case _re:return DS;case Are:return IS;case Ere:return OS}return t});var Ff=ec,Mre=Object.prototype,Tre=Mre.hasOwnProperty;function Lre(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Tre.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Pre=Lre,Dre=Is.Uint8Array,Lg=Dre;function Ire(e){var t=new e.constructor(e.byteLength);return new Lg(t).set(new Lg(e)),t}var Q7=Ire;function Ore(e,t){var r=t?Q7(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Rre=Ore,Bre=/\w*$/;function kre(e){var t=new e.constructor(e.source,Bre.exec(e));return t.lastIndex=e.lastIndex,t}var Nre=kre,BS=is?is.prototype:void 0,kS=BS?BS.valueOf:void 0;function zre(e){return kS?Object(kS.call(e)):{}}var Fre=zre;function jre(e,t){var r=t?Q7(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Ure=jre,Vre="[object Boolean]",Hre="[object Date]",Gre="[object Map]",Wre="[object Number]",qre="[object RegExp]",Xre="[object Set]",Yre="[object String]",Qre="[object Symbol]",Kre="[object ArrayBuffer]",Zre="[object DataView]",Jre="[object Float32Array]",$re="[object Float64Array]",eie="[object Int8Array]",tie="[object Int16Array]",rie="[object Int32Array]",iie="[object Uint8Array]",nie="[object Uint8ClampedArray]",sie="[object Uint16Array]",aie="[object Uint32Array]";function oie(e,t,r){var i=e.constructor;switch(t){case Kre:return Q7(e);case Vre:case Hre:return new i(+e);case Zre:return Rre(e,r);case Jre:case $re:case eie:case tie:case rie:case iie:case nie:case sie:case aie:return Ure(e,r);case Gre:return new i;case Wre:case Yre:return new i(e);case qre:return Nre(e);case Xre:return new i;case Qre:return Fre(e)}}var lie=oie;function cie(e){return typeof e.constructor=="function"&&!j7(e)?EJ(X7(e)):{}}var hie=cie,uie="[object Map]";function die(e){return uo(e)&&Ff(e)==uie}var pie=die,NS=Yu&&Yu.isMap,fie=NS?V7(NS):pie,mie=fie,gie="[object Set]";function vie(e){return uo(e)&&Ff(e)==gie}var yie=vie,zS=Yu&&Yu.isSet,xie=zS?V7(zS):yie,bie=xie,wie=1,Cie=2,Sie=4,sI="[object Arguments]",_ie="[object Array]",Aie="[object Boolean]",Eie="[object Date]",Mie="[object Error]",aI="[object Function]",Tie="[object GeneratorFunction]",Lie="[object Map]",Pie="[object Number]",oI="[object Object]",Die="[object RegExp]",Iie="[object Set]",Oie="[object String]",Rie="[object Symbol]",Bie="[object WeakMap]",kie="[object ArrayBuffer]",Nie="[object DataView]",zie="[object Float32Array]",Fie="[object Float64Array]",jie="[object Int8Array]",Uie="[object Int16Array]",Vie="[object Int32Array]",Hie="[object Uint8Array]",Gie="[object Uint8ClampedArray]",Wie="[object Uint16Array]",qie="[object Uint32Array]",Kt={};Kt[sI]=Kt[_ie]=Kt[kie]=Kt[Nie]=Kt[Aie]=Kt[Eie]=Kt[zie]=Kt[Fie]=Kt[jie]=Kt[Uie]=Kt[Vie]=Kt[Lie]=Kt[Pie]=Kt[oI]=Kt[Die]=Kt[Iie]=Kt[Oie]=Kt[Rie]=Kt[Hie]=Kt[Gie]=Kt[Wie]=Kt[qie]=!0;Kt[Mie]=Kt[aI]=Kt[Bie]=!1;function E0(e,t,r,i,n,s){var a,o=t&wie,l=t&Cie,c=t&Sie;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!Ds(e))return e;var u=ma(e);if(u){if(a=Pre(e),!o)return PJ(e,a)}else{var h=Ff(e),d=h==aI||h==Tie;if(Tg(e))return rre(e,o);if(h==oI||h==sI||d&&!n){if(a=l||d?{}:hie(e),!o)return l?fre(e,$te(a,e)):hre(e,Zte(a,e))}else{if(!Kt[h])return n?e:{};a=lie(e,h,o)}}s||(s=new A0);var p=s.get(e);if(p)return p;s.set(e,a),bie(e)?e.forEach(function(g){a.add(E0(g,t,r,g,e,s))}):mie(e)&&e.forEach(function(g,v){a.set(v,E0(g,t,r,v,e,s))});var f=c?l?nI:C5:l?G7:H7,m=u?void 0:f(e);return GJ(m||e,function(g,v){m&&(v=g,g=e[v]),z7(a,v,E0(g,t,r,v,e,s))}),a}var lI=E0,Xie=1,Yie=4;function Qie(e){return lI(e,Xie|Yie)}var Xv=Qie,Kie="__lodash_hash_undefined__";function Zie(e){return this.__data__.set(e,Kie),this}var Jie=Zie;function $ie(e){return this.__data__.has(e)}var ene=$ie;function Pg(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Wv;++t<r;)this.add(e[t])}Pg.prototype.add=Pg.prototype.push=Jie;Pg.prototype.has=ene;var tne=Pg;function rne(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var ine=rne;function nne(e,t){return e.has(t)}var sne=nne,ane=1,one=2;function lne(e,t,r,i,n,s){var a=r&ane,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,p=r&one?new tne:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var f=e[h],m=t[h];if(i)var g=a?i(m,f,h,t,e,s):i(f,m,h,e,t,s);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!ine(t,function(v,y){if(!sne(p,y)&&(f===v||n(f,v,r,i,s)))return p.push(y)})){d=!1;break}}else if(!(f===m||n(f,m,r,i,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var cI=lne;function cne(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var hne=cne;function une(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var dne=une,pne=1,fne=2,mne="[object Boolean]",gne="[object Date]",vne="[object Error]",yne="[object Map]",xne="[object Number]",bne="[object RegExp]",wne="[object Set]",Cne="[object String]",Sne="[object Symbol]",_ne="[object ArrayBuffer]",Ane="[object DataView]",FS=is?is.prototype:void 0,Uy=FS?FS.valueOf:void 0;function Ene(e,t,r,i,n,s,a){switch(r){case Ane:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _ne:return!(e.byteLength!=t.byteLength||!s(new Lg(e),new Lg(t)));case mne:case gne:case xne:return N7(+e,+t);case vne:return e.name==t.name&&e.message==t.message;case bne:case Cne:return e==t+"";case yne:var o=hne;case wne:var l=i&pne;if(o||(o=dne),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=fne,a.set(e,t);var u=cI(o(e),o(t),i,n,s,a);return a.delete(e),u;case Sne:if(Uy)return Uy.call(e)==Uy.call(t)}return!1}var Mne=Ene,Tne=1,Lne=Object.prototype,Pne=Lne.hasOwnProperty;function Dne(e,t,r,i,n,s){var a=r&Tne,o=C5(e),l=o.length,c=C5(t),u=c.length;if(l!=u&&!a)return!1;for(var h=l;h--;){var d=o[h];if(!(a?d in t:Pne.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=a;++h<l;){d=o[h];var v=e[d],y=t[d];if(i)var x=a?i(y,v,d,t,e,s):i(v,y,d,e,t,s);if(!(x===void 0?v===y||n(v,y,r,i,s):x)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!(typeof b=="function"&&b instanceof b&&typeof w=="function"&&w instanceof w)&&(m=!1)}return s.delete(e),s.delete(t),m}var Ine=Dne,One=1,jS="[object Arguments]",US="[object Array]",wm="[object Object]",Rne=Object.prototype,VS=Rne.hasOwnProperty;function Bne(e,t,r,i,n,s){var a=ma(e),o=ma(t),l=a?US:Ff(e),c=o?US:Ff(t);l=l==jS?wm:l,c=c==jS?wm:c;var u=l==wm,h=c==wm,d=l==c;if(d&&Tg(e)){if(!Tg(t))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new A0),a||XD(e)?cI(e,t,r,i,n,s):Mne(e,t,l,r,i,n,s);if(!(r&One)){var p=u&&VS.call(e,"__wrapped__"),f=h&&VS.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return s||(s=new A0),n(m,g,r,i,s)}}return d?(s||(s=new A0),Ine(e,t,r,i,n,s)):!1}var kne=Bne;function hI(e,t,r,i,n){return e===t?!0:e==null||t==null||!uo(e)&&!uo(t)?e!==e&&t!==t:kne(e,t,r,i,hI,n)}var Nne=hI;function zne(e,t){return e!=null&&t in Object(e)}var Fne=zne;function jne(e,t,r){t=wd(t,e);for(var i=-1,n=t.length,s=!1;++i<n;){var a=qv(t[i]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++i!=n?s:(n=e==null?0:e.length,!!n&&F7(n)&&k7(a,n)&&(ma(e)||U7(e)))}var Une=jne;function Vne(e,t){return e!=null&&Une(e,t,Fne)}var Hne=Vne,Gne=function(){return Is.Date.now()},Vy=Gne,Wne="Expected a function",qne=Math.max,Xne=Math.min;function Yne(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Wne);t=gS(t)||0,Ds(r)&&(u=!!r.leading,h="maxWait"in r,s=h?qne(gS(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(C){var _=i,S=n;return i=n=void 0,c=C,a=e.apply(S,_),a}function f(C){return c=C,o=setTimeout(v,t),u?p(C):a}function m(C){var _=C-l,S=C-c,A=t-_;return h?Xne(A,s-S):A}function g(C){var _=C-l,S=C-c;return l===void 0||_>=t||_<0||h&&S>=s}function v(){var C=Vy();if(g(C))return y(C);o=setTimeout(v,m(C))}function y(C){return o=void 0,d&&i?p(C):(i=n=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function b(){return o===void 0?a:y(Vy())}function w(){var C=Vy(),_=g(C);if(i=arguments,n=this,l=C,_){if(o===void 0)return f(l);if(h)return clearTimeout(o),o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return w.cancel=x,w.flush=b,w}var K7=Yne;function Qne(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Kne=Qne;function Zne(e,t){return t.length<2?e:KD(e,zte(t,0,-1))}var Jne=Zne;function $ne(e,t){return Nne(e,t)}var Z7=$ne;function ese(e,t){return t=wd(t,e),e=Jne(e,t),e==null||delete e[qv(Kne(t))]}var tse=ese;function rse(e){return kte(e)?void 0:e}var ise=rse,nse=1,sse=2,ase=4,ose=JD(function(e,t){var r={};if(e==null)return r;var i=!1;t=FD(t,function(s){return s=wd(s,e),i||(i=s.length>1),s}),g1(e,nI(e),r),i&&(r=lI(r,nse|sse|ase,ise));for(var n=t.length;n--;)tse(r,t[n]);return r}),E5=ose;function lse(e,t,r,i){if(!Ds(e))return e;t=wd(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=qv(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var u=o[l];c=i?i(u,l,o):void 0,c===void 0&&(c=Ds(u)?u:k7(t[n+1])?[]:{})}z7(o,l,c),o=o[l]}return e}var cse=lse;function hse(e,t,r){for(var i=-1,n=t.length,s={};++i<n;){var a=t[i],o=KD(e,a);r(o,a)&&cse(s,wd(a,e),o)}return s}var use=hse;function dse(e,t){return use(e,t,function(r,i){return Hne(e,i)})}var pse=dse,fse=JD(function(e,t){return e==null?{}:pse(e,t)}),io=fse,mse="Expected a function";function gse(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(mse);return Ds(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),K7(e,t,{leading:i,maxWait:t,trailing:n})}var vse=gse;function yse(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Fc(e,t){return Object.setPrototypeOf(e,t),e}var xse=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),bse=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),wse=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Yv&&"ontouchend"in document,Cse=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Sse=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,_se=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},Ase=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},Ese=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Mse=xse();Mse&&Ese();var Yv=bse(),uI=wse(),Tse=Cse(),Sn=Sse(),HS=_se(),GS=Number(Ase());function dI(e){return Array.isArray(e)?e:[e]}function Lse(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function Cm(e){return Yv?e.metaKey:e.ctrlKey}var tt=[],Dg={},Mp={},M0={};function pI(e){tt.includes(e)||tt.push(e)}function xu(e){delete Dg[e.pointerId];for(let t=0;t<tt.length;t++)if(tt[t].pointerId===e.pointerId){tt.splice(t,1);break}}function Pse(){tt.splice(0,tt.length)}function Ig(e){if(e.pointerType!=="touch")return;let t=Dg[e.pointerId];t===void 0&&(t={x:0,y:0},Dg[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function Hy(e){let t=e.pointerId===tt[0].pointerId?tt[1]:tt[0];return Dg[t.pointerId]}function fI(e){Mp[e.key]=!0,M0[e.key]=M0[e.key]===void 0?1:M0[e.key]+1}function mI(e){if(Yv&&Mp.Meta)for(let t in Mp)Mp[t]=!1;else Mp[e.key]=!1;M0={}}function Dse(e){e.addEventListener("pointerdown",pI,!0),e.addEventListener("pointerdown",Ig,!0),e.addEventListener("pointermove",Ig,!0),e.addEventListener("pointerup",xu,!0),e.addEventListener("pointercancel",xu,!0),e.addEventListener("pointerleave",xu,!0),window.addEventListener("keydown",fI,!0),window.addEventListener("keyup",mI,!0)}function Ise(e){e.removeEventListener("pointerdown",pI,!0),e.removeEventListener("pointerdown",Ig,!0),e.removeEventListener("pointermove",Ig,!0),e.removeEventListener("pointerup",xu,!0),e.removeEventListener("pointercancel",xu,!0),e.removeEventListener("pointerleave",xu,!0),window.removeEventListener("keydown",fI,!0),window.removeEventListener("keyup",mI,!0)}var gI,Ose=new Promise(e=>{gI=e}),Sm;function Rse(){if(Sm)return Sm;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@0.9.452/build",r=c1(()=>import("./navmesh-0b92f809.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});gI(a)}return Sm=e(),Sm}var vI,Bse=new Promise(e=>{vI=e}),_m;function kse(){if(_m)return _m;async function e(){let t=await c1(()=>import("./physics-dee4de67.js"),[]);await t.init(),vI(t)}return _m=e(),_m}var wt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,wt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,wt.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,wt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function J7(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&J7(i)}return Object.freeze(e)}function Nse(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var yI=class extends Error{};function Gy(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function Yo(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function $7(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function zse(){return typeof process<"u"}function xI(e,t){for(let r of e)t(r.id,r.data)!==!0&&xI(r.children,t)}function bI(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)bI(r,t)}var an=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,an.prototype)}deepFreeze(){let e=0;for(;e<this.length;)J7(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&bI(r,t)}}traverse(e){xI(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=i[n];return i=[...i],i[n]={...s,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let s=i,a=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let o=i.findIndex(l=>l.id===a);if(o<0)throw new Error;i=[...i],i[o]={...i[o],children:s}}Object.setPrototypeOf(i,an.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:i,data:n,children:s};return o=[...o,l],o.sort((c,u)=>c.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(a=>a.id===t);e.localIndex=n,i=[...i];let s=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...s,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let h=t;for(;h!==null;){if(h===void 0)throw new Error;if(h===i)throw new yI("cyclic tree");h=this.parent(h)}}let n=this.parent(i);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(h=>h.id===i);a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(n,a);n=t,a=c.childrenArray(n);let u=l.fi;return l={...l,fi:r},a=[...a,l],a.sort((h,d)=>h.fi-d.fi),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(n,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>Nse(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return Yo(0,r,r);{let n=i[0].fi;return Yo(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=i.find(a=>a.fi>n.fi);if(s===void 0){let a=i[i.length-1].fi;return Yo(a,a+r,r)}else return Yo(n.fi,s.fi,r)}}},Og;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a={...r},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let c=n[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(Og||(Og={}));var at=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,at.prototype)}deepFreeze(){let e=0;for(;e<this.length;)J7(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,at.prototype);let t=e;return zse()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a={...i[n],fi:t};return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return Yo(0,t,t);{let i=r[0].fi;return Yo(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return Yo(s,s+t,t)}else return Yo(i.fi,n.fi,t)}}};function Qu(e){return e&&typeof e=="object"&&e instanceof Hr}var Hr=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!Qu(r))return null;i+=1}r=r?Gy(r):new Hr;for(let[o,l]of Object.entries(e.props)){let c=r[o];n[o]=c,l===void 0?delete r[o]:r[o]=l}for(;i>0;){if(Object.keys(r).length===0){let o=t[i-1];o&&(r=Gy(o),delete r[e.path[i-1]])}else{let o=t[i-1];if(o){let l=Gy(o);l[e.path[i-1]]=r,r=l}else{let l=new Hr;l[e.path[i-1]]=r,r=l}}i-=1}let s=Object.setPrototypeOf(r,Hr.prototype),a={...e,props:n};return{data:s,actual:e,reverse:a}}},pl;(e=>{function t(n,s){return jf(n,s)??n}e.apply=t;function r(n,s){return t8(n,s)}e.merge=r;function i(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=ua.zoomOnce(l,o[a]),l===void 0)return s;if(!Qu(l))return;a+=1}if(l===void 0)return s;if(Qu(l))if(s.type===0){let c={...s.props};for(let u of Object.keys(l))delete c[u];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=e8([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=i})(pl||(pl={}));function e8(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=jf(n.data,t[s]);if(r=r||a!==void 0,a===void 0&&(a=n.data),n.children){let o=e8(n.children,t);return o!==void 0?r=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(r)return i}function Fse(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=jf(n.data,t[s]);return r=r||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function jf(e,t){if(!Qu(t))return t;if(e instanceof an){let r=e8(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof at)return Fse(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,s)=>{let a=jf(n,t[s]);return r=r||a!==void 0,a===void 0&&(a=n),a});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof Hr)return t8(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,s]of Object.entries(e)){let a=jf(s,t[n]);i=i||a!==void 0,a===void 0&&(a=s),r[n]=a}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function t8(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Qu(t))return t;if(!Qu(e))return pl.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new Hr;for(let n of r){let s=t8(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=s}return i}function jse(e,t){let r={cur:[],result:[],len:0};return e=Uf(e,t,r)??e,[e,r.result]}function Rg(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function Bg(e){e&&(e.len-=1)}function Use(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function wI(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=Uf(s.data,t,Rg(r,a));Bg(r),i=i||l!==void 0,l===void 0&&(l=s.data);let c=wI(s.children,t,r);return c!==void 0?i=!0:c=s.children,{...s,id:a,data:l,children:c}});if(i)return n}function Vse(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=Uf(s.data,t,Rg(r,a));return Bg(r),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function Uf(e,t,r){if(e instanceof an){let i=wI(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof at)return Vse(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((s,a)=>{let o=Uf(s,t,Rg(r,a));return Bg(r),i=i||o!==void 0,o===void 0&&(o=s),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!$7(e)){let i={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"&&s!=="text"){let o=t[s];if(typeof o=="string"){if(r!==null)throw new Error("not supported");n=!0,s=o}let l=Uf(a,t,Rg(r,s));Bg(r),n=n||l!==void 0,l===void 0&&(l=a),i[s]=l}else i[s]=a;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&Use(r),i}else return}}var M5;(e=>{function t(r,i){let n=ua.zoom(i,r.path);if(typeof n=="object"){let s={};for(let a of Object.keys(r.props))s[a]=n[a];return{...r,props:s}}else return{...r,props:{}}}e.replaceProps=t})(M5||(M5={}));var Ni;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var u;return((u=i(l,c))==null?void 0:u.data)??l}e.applySimple=r;function i(l,c){var d,p;let u=c.path;for(var h=[];;){let f;if(l instanceof Hr&&c.type===0&&(f=l.runOp({...c,path:u.slice(h.length)}),f===null&&(f=void 0)),f===void 0&&h.length===u.length&&(l instanceof an||l instanceof at||l instanceof wt?f=l.runOp(c):f=Og.runOp(l,c)),f!==void 0)if(f!==null){let v=f.data;for(let y=h.length-1;y>=0;y--){let x=u[y],b=h[y];if(b instanceof an){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof at){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof wt){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof Hr){let w={...b,[x]:v};v=Object.setPrototypeOf(w,Hr.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let w=v;v=[...b],v[x]=w}else v={...b,[x]:v};else return null}return{data:v,actual:{...f.actual,path:u},reverse:{...f.reverse,path:u}}}else return null;let m=u[h.length],g;if(l instanceof an){if(typeof m=="number")throw new Error("");g=(d=l.get(m))==null?void 0:d.data}else if(l instanceof at){if(typeof m=="number")throw new Error("");g=(p=l.get(m))==null?void 0:p.data}else l!==null&&(g=l[m]);if(g!==void 0)h.push(l),l=g;else return null}}e.apply=i;function n(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=n;function s(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=s;function a(l,c){return n(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=o})(Ni||(Ni={}));var T5;(e=>{function t(){return[]}e.empty=t;function r(c,u){let h=[];for(let d of c){let[p,...f]=d.path;p===u&&h.push({...d,path:f})}return h}e.removePrefix=r;function i(c,u){return c.map(h=>({...h,path:[u,...h.path]}))}e.addPrefix=i;function n(c,u){return[...c,...u]}e.concat=n;function s(c,u){return[...c.filter(h=>!u.some(d=>Ni.subsumed(h,d))),...u]}e.compress=s;function a(c,u){return c.every(h=>u.every(d=>Ni.commutative(h,d)))}e.commutative=a;function o(c,u){for(let h of u){let d=l(c,h);d!==null&&(c=d.data)}return c}e.applyAll=o;function l(c,u){var h=c;let d=[],p=[];for(let f of u)try{if(f.type===3){let m=ua.zoom(h,[...f.path,f.id]),g=Ni.apply(h,{...f,type:2});if(g!==null){h=g.data;let[v,y]=jse(h,{[f.id]:m});h=v;for(let x of y){let b=x[x.length-1];x.splice(x.length-1,1),d.push({type:0,path:x,props:{[b]:m}}),p.push({type:0,path:x,props:{[b]:f.id}})}p.push(g.reverse),d.push(g.actual)}}else{let m=Ni.apply(h,f);m!==null&&(d.push(m.actual),h=m.data,p.push(m.reverse))}}catch(m){if(m instanceof yI)return null;throw m}return{data:h,actual:d,reverse:p.reverse()}}e.apply=l})(T5||(T5={}));var CI=Symbol(),Hse=Symbol(),Qv=Symbol(),v1=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof _I);){let s=i._path,a=i._current;if(s!==""&&n.splice(0,0,s),i=i._parent,i===null)return;i.update(s,a)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[Qv];r&&r(),delete this._children[e]}}}},Gse=class extends v1{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,Og.runOp(this._current,e),e.path)}},Wse=class extends v1{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,wt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},SI={get(e,t){if(t===Qv)return()=>{e._parent=null};if(t===CI)return e._current;if(t===Hse)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=Kv(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},qse={...SI,set(e,t,r){let i={type:0,props:{[t]:ii(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},Xse={...SI,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},r8=class extends v1{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Qv]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=Kv(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},i8=class extends v1{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Qv]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=Kv(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function Wy(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&ua.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var _I=class extends v1{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){Wy(this.ts,t,e),Wy(this.actual,r,e),Wy(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Kv(e,t,r){return r instanceof an?new r8(e,t,r):r instanceof at?new i8(e,t,r):r instanceof wt?new Proxy(new Wse(e,t,r),Xse):r!==null&&typeof r=="object"?$7(r)?r:new Proxy(new Gse(e,t,r),qse):r}function AI(e){let t=new _I(e);return[Kv(t,"",e),t]}function Vf(e,t){let[r,i]=AI(e);return t(r),i.result()}function ii(e){return e instanceof r8||e instanceof i8?e._current:e!==null&&typeof e=="object"?e[CI]:e}var ua;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function r(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return a}e.removeOverridden=r;function i(s,a){if((s instanceof an||s instanceof r8)&&typeof a=="string"||(s instanceof at||s instanceof i8)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=i;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=i(s,a[o]),o+=1;return s}e.zoom=n})(ua||(ua={}));function Yse(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function Yn(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var EI=class{},WS=class extends EI{constructor(e){super(),this.id=e}},qS=class extends EI{constructor(e){super(),this.data=e}},L5;try{L5=new TextDecoder}catch{}var ke,fl,re=0,Ki={},Ot,Qo,Hn=0,ia=0,yn,no,Vi=[],kt,XS={useRecords:!1,mapsAsObjects:!0},MI=class{},TI=new MI;TI.name="MessagePack 0xC1";var Ku=!1,kg=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(ke)return RI(()=>(D5(),this?this.unpack(e,t):kg.prototype.unpack.call(XS,e,t)));fl=t>-1?t:e.length,re=0,ia=0,Qo=null,yn=null,ke=e;try{kt=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw ke=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof kg){if(Ki=this,this.structures)return Ot=this.structures,Am();(!Ot||Ot.length>0)&&(Ot=[])}else Ki=XS,(!Ot||Ot.length>0)&&(Ot=[]);return Am()}unpackMultiple(e,t){let r,i=0;try{Ku=!0;let n=e.length,s=this?this.unpack(e,n):Jv.unpack(e,n);if(t){for(t(s);re<n;)if(i=re,t(Am())===!1)return}else{for(r=[s];re<n;)i=re,r.push(Am());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{Ku=!1,D5()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function Am(){try{if(!Ki.trusted&&!Ku){let t=Ot.sharedLength||0;t<Ot.length&&(Ot.length=t)}let e=pr();if(re==fl)Ot.restoreStructures&&YS(),Ot=null,ke=null,no&&(no=null);else if(re>fl){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Ku)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Ot.restoreStructures&&YS(),D5(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function YS(){for(let e in Ot.restoreStructures)Ot[e]=Ot.restoreStructures[e];Ot.restoreStructures=null}function pr(){let e=ke[re++];if(e<160)if(e<128){if(e<64)return e;{let t=Ot[e&63]||Ki.getStructures&&LI()[e&63];return t?(t.read||(t.read=n8(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Ki.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[DI()]=pr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(pr(),pr());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=pr();return t}else if(e<192){let t=e-160;if(ia>=re)return Qo.slice(re-Hn,(re+=t)-Hn);if(ia==0&&fl<140){let r=t<16?s8(t):PI(t);if(r!=null)return r}return P5(t)}else{let t;switch(e){case 192:return null;case 193:return yn?(t=pr(),t>0?yn[1].slice(yn.position1,yn.position1+=t):yn[0].slice(yn.position0,yn.position0-=t)):TI;case 194:return!1;case 195:return!0;case 196:return qy(ke[re++]);case 197:return t=kt.getUint16(re),re+=2,qy(t);case 198:return t=kt.getUint32(re),re+=4,qy(t);case 199:return Hl(ke[re++]);case 200:return t=kt.getUint16(re),re+=2,Hl(t);case 201:return t=kt.getUint32(re),re+=4,Hl(t);case 202:if(t=kt.getFloat32(re),Ki.useFloat32>2){let r=a8[(ke[re]&127)<<1|ke[re+1]>>7];return re+=4,(r*t+(t>0?.5:-.5)>>0)/r}return re+=4,t;case 203:return t=kt.getFloat64(re),re+=8,t;case 204:return ke[re++];case 205:return t=kt.getUint16(re),re+=2,t;case 206:return t=kt.getUint32(re),re+=4,t;case 207:return Ki.int64AsNumber?(t=kt.getUint32(re)*4294967296,t+=kt.getUint32(re+4)):t=kt.getBigUint64(re),re+=8,t;case 208:return kt.getInt8(re++);case 209:return t=kt.getInt16(re),re+=2,t;case 210:return t=kt.getInt32(re),re+=4,t;case 211:return Ki.int64AsNumber?(t=kt.getInt32(re)*4294967296,t+=kt.getUint32(re+4)):t=kt.getBigInt64(re),re+=8,t;case 212:if(t=ke[re++],t==114)return $S(ke[re++]&63);{let r=Vi[t];if(r)return r.read?(re++,r.read(pr())):r.noBuffer?(re++,r()):r(ke.subarray(re,++re));throw new Error("Unknown extension "+t)}case 213:return t=ke[re],t==114?(re++,$S(ke[re++]&63,ke[re++])):Hl(2);case 214:return Hl(4);case 215:return Hl(8);case 216:return Hl(16);case 217:return t=ke[re++],ia>=re?Qo.slice(re-Hn,(re+=t)-Hn):Kse(t);case 218:return t=kt.getUint16(re),re+=2,ia>=re?Qo.slice(re-Hn,(re+=t)-Hn):Zse(t);case 219:return t=kt.getUint32(re),re+=4,ia>=re?Qo.slice(re-Hn,(re+=t)-Hn):Jse(t);case 220:return t=kt.getUint16(re),re+=2,KS(t);case 221:return t=kt.getUint32(re),re+=4,KS(t);case 222:return t=kt.getUint16(re),re+=2,ZS(t);case 223:return t=kt.getUint32(re),re+=4,ZS(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var Qse=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function n8(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>Qse.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(pr);return e.highByte===0&&(e.read=QS(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=pr()}return i}return r.count=0,e.highByte===0?QS(t,r):r}var QS=(e,t)=>function(){let r=ke[re++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=Ot[i]||LI()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=n8(n,e)),n.read()};function LI(){let e=RI(()=>(ke=null,Ki.getStructures()));return Ot=Ki._mergeStructures(e,Ot)}var P5=Zv,Kse=Zv,Zse=Zv,Jse=Zv;function Zv(e){let t;if(e<16&&(t=s8(e)))return t;if(e>64&&L5)return L5.decode(ke.subarray(re,re+=e));let r=re+e,i=[];for(t="";re<r;){let n=ke[re++];if(!(n&128))i.push(n);else if((n&224)===192){let s=ke[re++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=ke[re++]&63,a=ke[re++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=ke[re++]&63,a=ke[re++]&63,o=ke[re++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=Kr.apply(String,i),i.length=0)}return i.length>0&&(t+=Kr.apply(String,i)),t}function KS(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=pr();return t}function ZS(e){if(Ki.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[DI()]=pr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(pr(),pr());return t}}var Kr=String.fromCharCode;function PI(e){let t=re,r=new Array(e);for(let i=0;i<e;i++){let n=ke[re++];if((n&128)>0){re=t;return}r[i]=n}return Kr.apply(String,r)}function s8(e){if(e<4)if(e<2){if(e===0)return"";{let t=ke[re++];if((t&128)>1){re-=1;return}return Kr(t)}}else{let t=ke[re++],r=ke[re++];if((t&128)>0||(r&128)>0){re-=2;return}if(e<3)return Kr(t,r);let i=ke[re++];if((i&128)>0){re-=3;return}return Kr(t,r,i)}else{let t=ke[re++],r=ke[re++],i=ke[re++],n=ke[re++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){re-=4;return}if(e<6){if(e===4)return Kr(t,r,i,n);{let s=ke[re++];if((s&128)>0){re-=5;return}return Kr(t,r,i,n,s)}}else if(e<8){let s=ke[re++],a=ke[re++];if((s&128)>0||(a&128)>0){re-=6;return}if(e<7)return Kr(t,r,i,n,s,a);let o=ke[re++];if((o&128)>0){re-=7;return}return Kr(t,r,i,n,s,a,o)}else{let s=ke[re++],a=ke[re++],o=ke[re++],l=ke[re++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){re-=8;return}if(e<10){if(e===8)return Kr(t,r,i,n,s,a,o,l);{let c=ke[re++];if((c&128)>0){re-=9;return}return Kr(t,r,i,n,s,a,o,l,c)}}else if(e<12){let c=ke[re++],u=ke[re++];if((c&128)>0||(u&128)>0){re-=10;return}if(e<11)return Kr(t,r,i,n,s,a,o,l,c,u);let h=ke[re++];if((h&128)>0){re-=11;return}return Kr(t,r,i,n,s,a,o,l,c,u,h)}else{let c=ke[re++],u=ke[re++],h=ke[re++],d=ke[re++];if((c&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){re-=12;return}if(e<14){if(e===12)return Kr(t,r,i,n,s,a,o,l,c,u,h,d);{let p=ke[re++];if((p&128)>0){re-=13;return}return Kr(t,r,i,n,s,a,o,l,c,u,h,d,p)}}else{let p=ke[re++],f=ke[re++];if((p&128)>0||(f&128)>0){re-=14;return}if(e<15)return Kr(t,r,i,n,s,a,o,l,c,u,h,d,p,f);let m=ke[re++];if((m&128)>0){re-=15;return}return Kr(t,r,i,n,s,a,o,l,c,u,h,d,p,f,m)}}}}}function qy(e){return Ki.copyBuffers?Uint8Array.prototype.slice.call(ke,re,re+=e):ke.subarray(re,re+=e)}function Hl(e){let t=ke[re++];if(Vi[t])return Vi[t](ke.subarray(re,re+=e));throw new Error("Unknown extension type "+t)}var JS=new Array(4096);function DI(){let e=ke[re++];if(e>=160&&e<192){if(e=e-160,ia>=re)return Qo.slice(re-Hn,(re+=e)-Hn);if(!(ia==0&&fl<180))return P5(e)}else return re--,pr();let t=(e<<5^(e>1?kt.getUint16(re):e>0?ke[re]:0))&4095,r=JS[t],i=re,n=re+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=kt.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=ke[i++],s!=r[a++]){i=1879048192;break}if(i===n)return re=i,r.string;n-=3,i=re}for(r=[],JS[t]=r,r.bytes=e;i<n;)s=kt.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=ke[i++],r.push(s);let o=e<16?s8(e):PI(e);return o!=null?r.string=o:r.string=P5(e)}var $S=(e,t)=>{var r=pr();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=Ot[e];return n&&n.isShared&&((Ot.restoreStructures||(Ot.restoreStructures=[]))[e]=n),Ot[e]=r,r.read=n8(r,i),r.read()},II=typeof self=="object"?self:global;Vi[0]=()=>{};Vi[0].noBuffer=!0;Vi[101]=()=>{let e=pr();return(II[e[0]]||Error)(e[1])};Vi[105]=e=>{let t=kt.getUint32(re-4);no||(no=new Map);let r=ke[re],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};no.set(t,n);let s=pr();return n.used?Object.assign(i,s):(n.target=s,s)};Vi[112]=e=>{let t=kt.getUint32(re-4),r=no.get(t);return r.used=!0,r.target};Vi[115]=()=>new Set(pr());var OI=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Vi[116]=e=>{let t=e[0],r=OI[t];if(!r)throw new Error("Could not find typed array for code "+t);return new II[r](Uint8Array.prototype.slice.call(e,1).buffer)};Vi[120]=()=>{let e=pr();return new RegExp(e[0],e[1])};Vi[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=re;re+=t-4,yn=[pr(),pr()],yn.position0=0,yn.position1=0;let i=re;re=r;try{return pr()}finally{re=i}};Vi[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function RI(e){let t=fl,r=re,i=Hn,n=ia,s=Qo,a=no,o=yn,l=new Uint8Array(ke.slice(0,fl)),c=Ot,u=Ot.slice(0,Ot.length),h=Ki,d=Ku,p=e();return fl=t,re=r,Hn=i,ia=n,Qo=s,no=a,yn=o,ke=l,Ku=d,Ot=c,Ot.splice(0,Ot.length,...u),Ki=h,kt=new DataView(ke.buffer,ke.byteOffset,ke.byteLength),p}function D5(){ke=null,no=null,Ot=null}function $se(e){e.unpack?Vi[e.type]=e.unpack:Vi[e.type]=e}var a8=new Array(147);for(let e=0;e<256;e++)a8[e]=+("1e"+Math.floor(45.15-e*.30103));var Jv=new kg({useRecords:!1});Jv.unpack;Jv.unpackMultiple;Jv.unpack;var eae=new Float32Array(1);new Uint8Array(eae.buffer,0,4);var T0;try{T0=new TextEncoder}catch{}var Ng,o8,$v=typeof Buffer<"u",Xy=$v?Buffer.allocUnsafeSlow:Uint8Array,BI=$v?Buffer:Uint8Array,e_=$v?4294967296:2144337920,ve,yr,he=0,Bs,ks=null,tae=/[\u0080-\uFFFF]/,$d=Symbol("record-id"),kI=class extends kg{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=BI.prototype.utf8Write?function(C,_,S){return ve.utf8Write(C,_,S)}:T0&&T0.encodeInto?function(C,_){return T0.encodeInto(C,ve.subarray(_)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=u?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(C,_){if(ve||(ve=new Xy(8192),yr=new DataView(ve.buffer,0,8192),he=0),Bs=ve.length-10,Bs-he<2048?(ve=new Xy(ve.length),yr=new DataView(ve.buffer,0,ve.length),Bs=ve.length-10,he=0):he=he+7&2147483640,t=he,s=l.structuredClone?new Map:null,l.bundleStrings?(ks=["",""],ve[he++]=214,ve[he++]=98,ks.position=he-t,he+=4):ks=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let S=r.sharedLength||0;if(S>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let A=0;A<S;A++){let E=r[A];if(!E)continue;let L,P=r.transitions;for(let D=0,I=E.length;D<I;D++){let B=E[D];L=P[B],L||(L=P[B]=Object.create(null)),P=L}P[$d]=A+64}a=S}c||(r.nextId=S+64)}i&&(i=!1),n=r||[];try{if(x(C),ks){yr.setUint32(ks.position+t,he-ks.position-t);let S=ks;ks=null,x(S[0]),x(S[1])}if(l.offset=he,s&&s.idsToInsert){he+=s.idsToInsert.length*6,he>Bs&&w(he),l.offset=he;let S=iae(ve.subarray(t,he),s.idsToInsert);return s=null,S}return _&nae?(ve.start=t,ve.end=he,ve):ve.subarray(t,he)}finally{if(r){if(y<10&&y++,v>1e4)r.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let S=0,A=g.length;S<A;S++)g[S][$d]=0;g=[]}if(i&&l.saveStructures){let S=r.sharedLength||h;r.length>S&&(r=r.slice(0,S));let A=ve.subarray(t,he);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(C)):(a=S,A)}}_&sae&&(he=t)}};let x=C=>{he>Bs&&(ve=w(he));var _=typeof C,S;if(_==="string"){let A=C.length;if(ks&&A>=8&&A<4096){let P=tae.test(C);ks[P?0:1]+=C,ve[he++]=193,x(P?-A:A);return}let E;A<32?E=1:A<256?E=2:A<65536?E=3:E=5;let L=A*3;if(he+L>Bs&&(ve=w(he+L)),A<64||!o){let P,D,I,B=he+E;for(P=0;P<A;P++)D=C.charCodeAt(P),D<128?ve[B++]=D:D<2048?(ve[B++]=D>>6|192,ve[B++]=D&63|128):(D&64512)===55296&&((I=C.charCodeAt(P+1))&64512)===56320?(D=65536+((D&1023)<<10)+(I&1023),P++,ve[B++]=D>>18|240,ve[B++]=D>>12&63|128,ve[B++]=D>>6&63|128,ve[B++]=D&63|128):(ve[B++]=D>>12|224,ve[B++]=D>>6&63|128,ve[B++]=D&63|128);S=B-he-E}else S=o(C,he+E,L);S<32?ve[he++]=160|S:S<256?(E<2&&ve.copyWithin(he+2,he+1,he+1+S),ve[he++]=217,ve[he++]=S):S<65536?(E<3&&ve.copyWithin(he+3,he+2,he+2+S),ve[he++]=218,ve[he++]=S>>8,ve[he++]=S&255):(E<5&&ve.copyWithin(he+5,he+3,he+3+S),ve[he++]=219,yr.setUint32(he,S),he+=4),he+=S}else if(_==="number")if(C>>>0===C)C<64?ve[he++]=C:C<256?(ve[he++]=204,ve[he++]=C):C<65536?(ve[he++]=205,ve[he++]=C>>8,ve[he++]=C&255):(ve[he++]=206,yr.setUint32(he,C),he+=4);else if(C>>0===C)C>=-32?ve[he++]=256+C:C>=-128?(ve[he++]=208,ve[he++]=C+256):C>=-32768?(ve[he++]=209,yr.setInt16(he,C),he+=2):(ve[he++]=210,yr.setInt32(he,C),he+=4);else{let A;if((A=this.useFloat32)>0&&C<4294967296&&C>=-2147483648){ve[he++]=202,yr.setFloat32(he,C);let E;if(A<4||(E=C*a8[(ve[he]&127)<<1|ve[he+1]>>7])>>0===E){he+=4;return}else he--}ve[he++]=203,yr.setFloat64(he,C),he+=8}else if(_==="object")if(!C)ve[he++]=192;else{if(s){let E=s.get(C);if(E){if(!E.id){let L=s.idsToInsert||(s.idsToInsert=[]);E.id=L.push(E)}ve[he++]=214,ve[he++]=112,yr.setUint32(he,E.id),he+=4;return}else s.set(C,{offset:he-t})}let A=C.constructor;if(A===Object)b(C,!0);else if(A===Array){S=C.length,S<16?ve[he++]=144|S:S<65536?(ve[he++]=220,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=221,yr.setUint32(he,S),he+=4);for(let E=0;E<S;E++)x(C[E])}else if(A===Map){S=C.size,S<16?ve[he++]=128|S:S<65536?(ve[he++]=222,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=223,yr.setUint32(he,S),he+=4);for(let[E,L]of C)x(E),x(L)}else{for(let E=0,L=Ng.length;E<L;E++){let P=o8[E];if(C instanceof P){let D=Ng[E];if(D.write){D.type&&(ve[he++]=212,ve[he++]=D.type,ve[he++]=0),x(D.write.call(this,C));return}let I=ve,B=yr,X=he;ve=null;let H;try{H=D.pack.call(this,C,R=>(ve=I,I=null,he+=R,he>Bs&&w(he),{target:ve,targetView:yr,position:he-R}),x)}finally{I&&(ve=I,yr=B,he=X,Bs=ve.length-10)}H&&(H.length+he>Bs&&w(H.length+he),he=rae(H,ve,he,D.type));return}}b(C,!C.hasOwnProperty)}}else if(_==="boolean")ve[he++]=C?195:194;else if(_==="bigint"){if(C<BigInt(1)<<BigInt(63)&&C>=-(BigInt(1)<<BigInt(63)))ve[he++]=211,yr.setBigInt64(he,C);else if(C<BigInt(1)<<BigInt(64)&&C>0)ve[he++]=207,yr.setBigUint64(he,C);else if(this.largeBigIntToFloat)ve[he++]=203,yr.setFloat64(he,Number(C));else throw new RangeError(C+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(_==="undefined")this.encodeUndefinedAsNil?ve[he++]=192:(ve[he++]=212,ve[he++]=0,ve[he++]=0);else if(_==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+_)},b=this.useRecords===!1?this.variableMapSize?C=>{let _=Object.keys(C),S=_.length;S<16?ve[he++]=128|S:S<65536?(ve[he++]=222,ve[he++]=S>>8,ve[he++]=S&255):(ve[he++]=223,yr.setUint32(he,S),he+=4);let A;for(let E=0;E<S;E++)x(A=_[E]),x(C[A])}:(C,_)=>{ve[he++]=222;let S=he-t;he+=2;let A=0;for(let E in C)(_||C.hasOwnProperty(E))&&(x(E),x(C[E]),A++);ve[S+++t]=A>>8,ve[S+t]=A&255}:C=>{let _=Object.keys(C),S,A=n.transitions||(n.transitions=Object.create(null)),E=0;for(let P=0,D=_.length;P<D;P++){let I=_[P];S=A[I],S||(S=A[I]=Object.create(null),E++),A=S}let L=A[$d];if(L)L>=96&&p?(ve[he++]=((L-=96)&31)+96,ve[he++]=L>>5):ve[he++]=L;else{L=n.nextId,L||(L=64),L<f&&this.shouldShareStructure&&!this.shouldShareStructure(_)?(L=n.nextOwnId,L<m||(L=f),n.nextOwnId=L+1):(L>=m&&(L=f),n.nextId=L+1);let P=_.highByte=L>=96&&p?L-96>>5:-1;A[$d]=L,n[L-64]=_,L<f?(_.isShared=!0,n.sharedLength=L-63,i=!0,P>=0?(ve[he++]=(L&31)+96,ve[he++]=P):ve[he++]=L):(P>=0?(ve[he++]=213,ve[he++]=114,ve[he++]=(L&31)+96,ve[he++]=P):(ve[he++]=212,ve[he++]=114,ve[he++]=L),E&&(v+=y*E),g.length>=d&&(g.shift()[$d]=0),g.push(A),x(_))}for(let P=0,D=_.length;P<D;P++)x(C[_[P]])},w=C=>{let _;if(C>16777216){if(C-t>e_)throw new Error("Packed buffer would be larger than maximum buffer size");_=Math.min(e_,Math.round(Math.max((C-t)*(C>67108864?1.25:2),4194304)/4096)*4096)}else _=(Math.max(C-t<<2,ve.length-1)>>12)+1<<12;let S=new Xy(_);return yr=new DataView(S.buffer,0,_),ve.copy?ve.copy(S,0,t,C):S.set(ve.slice(t,C)),he-=t,t=0,Bs=S.length-10,ve=S}}useBuffer(e){ve=e,yr=new DataView(ve.buffer,ve.byteOffset,ve.byteLength),he=0}};o8=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,MI];Ng=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?t_(e,16,t):r_($v?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==BI&&this.structuredClone?t_(e,OI.indexOf(r.name),t):r_(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function t_(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function r_(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function rae(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function iae(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function Sd(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");o8.unshift(e.Class),Ng.unshift(e)}$se(e)}var NI=new kI({useRecords:!1});NI.pack;NI.pack;var nae=512,sae=1024,i_=new kI({structuredClone:!0});Sd({Class:wt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,wt.prototype),e}});Sd({Class:at.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,at.prototype),e}});Sd({Class:an.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,an.prototype),e}});Sd({Class:WS.prototype.constructor,type:4,write(e){return e.id},read(e){return new WS(e)}});Sd({Class:qS.prototype.constructor,type:5,write(e){return e.data},read(e){return new qS(e)}});Sd({Class:Hr.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Hr.prototype),e}});function aae(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function I5(e){if($7(e))return e;if(Array.isArray(e))return e.map(I5);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=I5(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var O5;(e=>{function t(n){return i_.pack(n)}e.serialize=t;function r(n){return i_.unpack(n)}e.deserialize=r;function i(n){return aae(t(I5(n))).toString()}e.checksum=i})(O5||(O5={}));var Ns={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Create"],MouseHover:["Transition","Animation","Create","Destroy","SwitchCamera","SceneTransition"],Scroll:["Transition","Animation","Create"],Start:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition"],Conditional:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MousePress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","SceneTransition","Reset"],KeyDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyPress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","Reset"],GameControl:["Transition","Animation","Audio","Video","Create"],Collision:["Transition","Animation","Audio","Video","Create","Destroy","Reset"],Trigger:["Transition","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],Resize:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset"]},n_;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,toggle:!1,actions:new at}:{type:i,disabled:!1,key:void 0,toggle:!1,actions:new at}}e.defaultData=r})(n_||(n_={}));var zg;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(zg||(zg={}));var R5;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:zg.propertyDefaultData(n),rOperand:{...zg.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=i})(R5||(R5={}));var s_;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new at,outActions:new at,condition:R5.distanceDefaultData(i)}}e.defaultData=r})(s_||(s_={}));var a_;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new at,drop:new at}})(a_||(a_={}));var B5;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new at})(B5||(B5={}));var k5;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(k5||(k5={}));var o_;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new at}}e.defaultData=r})(o_||(o_={}));var l_;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new at}}e.defaultData=r})(l_||(l_={}));var c_;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new at}}e.defaultData=r})(c_||(c_={}));var h_;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new at}}e.defaultData=r})(h_||(h_={}));var u_;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,toggle:!1,target:"all",triggeringObjects:[],actions:new at,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(u_||(u_={}));var N5;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function r(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=r;function i(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=i;function n(){let a={size:"mobile",operator:"<",actions:new at},o={size:"tablet",operator:"<",actions:new at},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new at},c=new at;return c.push({id:gt.generateUUID(),fi:0,data:a},{id:gt.generateUUID(),fi:1,data:o},{id:gt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new at}}e.defaultBreakpointData=s})(N5||(N5={}));var _d="personal camera",$p="a218fcc3-276b-49b9-b485-49037fd14f5f",oae=2960946,ns=5526619,ou;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s]}e.lerp=r})(ou||(ou={}));var Ac;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=o})(Ac||(Ac={}));var Fg;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(Fg||(Fg={}));var Zu;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/c,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/c,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/c}return a}e.applyMatrix4=i})(Zu||(Zu={}));var Ri;(e=>{function t(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}e.toRgb255a1=r;function i(l){return{r:l.r,g:l.g,b:l.b}}e.clone=i;function n(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}e.fromHex=n;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}e.toHex=s;function a(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}e.equals=a;function o(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u}}e.lerp=o})(Ri||(Ri={}));var Cs;(e=>{e.white={...Ri.white,a:1},e.transparent={...Ri.white,a:0};function t(a){return{r:a[0],g:a[1],b:a[2],a:a[3]}}e.from0to1=t;function r(a,o){return{...Ri.fromHex(a),a:o}}e.fromHexAndA=r;function i(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:a.a}}e.toRgb255a1=i;function n(a,o){return Ri.equals(a,o)&&a.a===o.a}e.equals=n;function s(a,o,l){return{r:a.r+(o.r-a.r)*l,g:a.g+(o.g-a.g)*l,b:a.b+(o.b-a.b)*l,a:a.a+(o.a-a.a)*l}}e.lerp=s})(Cs||(Cs={}));var z5;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(z5||(z5={}));var d_;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(d_||(d_={}));var p_;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(p_||(p_={}));var zo;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(zo||(zo={}));var jc;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(jc||(jc={}));var Ju;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){return r.type==="PerspectiveCamera"?r.perspective.zoom:r.orthographic.zoom}e.getZoom=t})(Ju||(Ju={}));var Ko;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let s={...i};if(zI.forEach(a=>{Object.assign(s,{[a]:n[a]??i[a]})}),s.radial={...i.radial},n.radial){let a=i.radial,o=n.radial;FI.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...i.linear},n.linear){let a=i.linear,o=n.linear;jI.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...i.grid},n.grid){let a=i.grid,o=n.grid;UI.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...i.toObject},n.toObject){let a=i.toObject,o=n.toObject;VI.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...i.randomnessObject},n.randomnessObject){let a=i.randomnessObject,o=n.randomnessObject;HI.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=r})(Ko||(Ko={}));var F5;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let s=[];i.count!==void 0&&s.push({type:0,path:n,props:{count:i.count}});for(let a of t){let o=i[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=r})(F5||(F5={}));var zI=["count"],FI=["radius","start","end","position","scale","rotation"],jI=["position","scale","rotation"],UI=["count","size"],VI=["count","position","scale","rotation"],HI=["strength","scale","rotation","position","movement","seed","freqScale"],j5;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(j5||(j5={}));var U5;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:Cs.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:Cs.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Cs.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(U5||(U5={}));var $u;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})($u||($u={}));var V5;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(V5||(V5={}));var H5;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(H5||(H5={}));var G5;(e=>e.defaultData={...H5.defaultData,...V5.defaultData})(G5||(G5={}));var f_;(e=>{function t(r,i){var s,a;let n=[];if("material"in r){let o=typeof r.material=="string"?i.materials[r.material]??((s=i.lib.materials[r.material])==null?void 0:s.asset):r.material;o&&n.push(o)}else if("materials"in r)for(let o of r.materials){let l=typeof o=="string"?i.materials[o]??((a=i.lib.materials[o])==null?void 0:a.asset):o;l&&n.push(l)}return n}e.getMaterialData=t})(f_||(f_={}));var jg;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(jg||(jg={}));var m_;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(m_||(m_={}));function lae(e){return e.type!=="displace"}var g_;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(g_||(g_={}));var GI=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],cae=["wrapping","image","video","name"],Yi;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function r(s,a){return s==="light"&&a?i(a):n(s)}e.defaultData=r;function i(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:jg.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...a,type:"color",color:Ri.fromHex(ns)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Ri.fromHex(6710886),a:1},colorB:{...Ri.fromHex(6710886),a:1},colorC:{...Ri.fromHex(16777215),a:1},colorD:{...Ri.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:Cs.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Cs.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:Cs.fromHexAndA(0,1),contourColor:Cs.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Ri.fromHex(0),a:1},colorB:{...Ri.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Yi||(Yi={}));var Si;(e=>{function t(c){return!c.layers.some(u=>u.data.type==="texture"&&u.data.projection!==0||u.data.type==="depth"&&!u.data.isWorldSpace||u.data.type==="noise"||u.data.type==="displace")}e.isMergable=t;function r(c){let u="";return c.layers.forEach(h=>{Object.entries(h.data).forEach(([d,p])=>{u+=`${d}${p}`,Array.isArray(p)?p.forEach(f=>u+=`${f}`):typeof p=="object"?Object.values(p).forEach(f=>{typeof f=="number"?u+=`${f.toFixed(4)}`:u+=`${f}`}):u+=`${p}`})}),u}e.getHash=r;function i(){return{layers:new at}}e.defaultEmptyData=i;function n(c="layer1",u="layer2"){return a("phong",c,u)}e.defaultData=n;function s(c,u){return{...c,name:u}}e.withName=s;function a(c,u="layer1",h="layer2"){let d=new at;return d.push({fi:0,data:Yi.defaultData("light",c),id:u}),d.push({fi:1,data:Yi.defaultData("color"),id:h}),{layers:d}}e.defaultTwoLayerData=a;function o(c,u="phong",h="layer1",d="layer2"){let p=Yi.defaultData("texture");Object.assign(p.texture,{image:c});let f=new at;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:Yi.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerTextureData=o;function l(c,u="phong",h="layer1",d="layer2"){let p=Yi.defaultData("video");Object.assign(p.texture,{video:c});let f=new at;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:Yi.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerVideoTextureData=l})(Si||(Si={}));var Ug;(e=>{function t(){return{points:new at,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(Ug||(Ug={}));var Vg;(e=>{function t(){return{points:new at,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(Vg||(Vg={}));var WI={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},W5;(e=>{function t(r,i){let n={...r};return XI.forEach(s=>{Object.assign(n,{[s]:i[s]??r[s]})}),n}e.merge=t})(W5||(W5={}));var qI={shape:WI,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},XI=["depth","offset","angle","twist","startScale","endScale"],Hg;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}e.isParametricMesh=r})(Hg||(Hg={}));var q5;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,W5.merge(n.extrusion,i.extrusion))),n}e.merge=t})(q5||(q5={}));var bu;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:Vg.defaultData(),extrusion:qI};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:Ug.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}e.defaultData=t})(bu||(bu={}));var v_=["width","height","depth"],X5;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:Ri.white,near:.1,far:2e3})(X5||(X5={}));var Gg;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focalLength:2,focusDistance:2,bokehScale:2},noise:{...t,blendFunction:16}}})(Gg||(Gg={}));var Y5;(e=>e.defaultData={softShadowQuality:"low"})(Y5||(Y5={}));var Q5;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(Q5||(Q5={}));var K5;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(K5||(K5={}));var ed;(e=>e.defaultData={usePhysics:!1,gravity:-10})(ed||(ed={}));var Z5;(e=>e.defaultData={playCamera:_d,gameControlObject:null})(Z5||(Z5={}));var J5;(e=>e.defaultData={backgroundColor:Cs.fromHexAndA(oae,1),postprocessing:Gg.defaultData,fog:X5.defaultData,globalPhysics:ed.defaultData,ambient:Q5.defaultData,ao:K5.defaultData,shadow:Y5.defaultData,publish:Z5.defaultData})(J5||(J5={}));var y_;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(y_||(y_={}));var td;(e=>{e.identity={...z5.identity,hiddenMatrix:Zu.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,s){return yse({position:Ac.isEqual(n.position,s.position)?void 0:s.position,rotation:Ac.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:Ac.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:Zu.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=i})(td||(td={}));var Ui;(e=>e.defaultData={states:new at,events:new at,visible:!0,raycastLock:!1,physics:$u.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...td.identity,cloner:null})(Ui||(Ui={}));var $5;(e=>e.defaultData={type:"Empty",...Ui.defaultData})($5||($5={}));var x_;(e=>e.defaultData={type:"Component",...Ui.defaultData})(x_||(x_={}));var wu;(e=>e.defaultData={type:"Mesh",...Ui.defaultData,...G5.defaultData})(wu||(wu={}));var Hf;(e=>e.defaultData={...Ui.defaultData,...td.identity,position:[0,0,Ju.DefaultTargetOffset],...Ju.defaultData})(Hf||(Hf={}));var ex;(e=>{function t(r){return{...Ui.defaultData,...U5.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(ex||(ex={}));var Wg;(e=>{function t(i,n,s=0){for(;s<n.length;){let a=i?i[n[s]]:void 0;if(n.length===s+1)return a;if(a)i=a.descendants,s+=1;else return}}e.resolveWithDes=t;function r(i,n,s=0){let a=t(i,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=r})(Wg||(Wg={}));var Zo;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Ui.defaultData,...n,component:i,overrides:new Hr,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=td.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(Zo||(Zo={}));var rd;(e=>e.defaultData={type:"Page",...Ui.defaultData,physics:{...$u.defaultData,fusedBody:!1},...J5.defaultData,camera:Hf.defaultData})(rd||(rd={}));var tx;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Zu.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:$u.defaultData,states:new at,events:new at,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Ju.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Ui.defaultData,...wu.defaultData,geometry:bu.defaultData("RectangleGeometry"),material:Si.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Ui.defaultData,...wu.defaultData,geometry:bu.defaultData("BooleanGeometry"),material:Si.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Ui.defaultData,...wu.defaultData,geometry:bu.defaultData("TextGeometry"),material:Si.defaultTwoLayerData("phong","layer1","layer2")}))(tx||(tx={}));var fc;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new Hr}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new Hr})))):jc.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function r(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=Vf(o.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(a.material.layers)){let h=l.layers.data(c);h&&Yi.patch(h,u)}}).data),o.materials&&a.materials&&(o.materials=Vf(o.materials,l=>{var c,u;for(let h=0;h<o.materials.length;h++){let d=a.materials[h];if(typeof d!="string")for(let[p,f]of Object.entries(d.layers)){let m=(u=(c=l[h])==null?void 0:c.layers)==null?void 0:u.data(p);m&&Yi.patch(m,f)}}}).data),o}function i(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function u(h,d){for(let[p,f]of Object.entries(d.layers)){let{texture:m,...g}=f;if(m!==void 0&&Object.keys(m).length>0){let v={path:[...h,"layers",p,"texture"],props:m,type:0};l.push(v)}if(Object.keys(g).length>0){let v={path:[...h,"layers",p],props:g,type:0};l.push(v)}}}for(let[h,d]of Object.entries(a))if(h!=="name")if(h==="cloner")l.push(...F5.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")u(["material"],d);else if(h==="materials")for(let[p,f]of Object.entries(d))u(["materials",p],f);else if(c[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let p={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(p),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let p={path:[h],props:d,type:0};l.push(p)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[h]=d;return l}e.toOps=i;function n(s,a){var l,c,u,h,d,p;if(a===void 0)return s;let o={...s};if(Object.assign(o,td.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((c=o.pathSnapping)==null?void 0:c.slide)??0,offset:((u=a.pathSnapping)==null?void 0:u.offset)??((h=o.pathSnapping)==null?void 0:h.offset)??0})}),jc.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let f=a;((d=f.orthographic)==null?void 0:d.zoom)!==void 0&&(o.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(o.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(o.targetOffset=f.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:q5.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=r(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Ko.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Ko.merge(o.cloner,a.cloner)});else if(j5.is(s.type)){let f=a;f.intensity!==void 0&&(o.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?o.color=f.color:o.color=Ri.clone(f.color))}return o}e.patch=n})(fc||(fc={}));var qg;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(qg||(qg={}));var Ec;(e=>e.defaultData={orbitControls:qg.defaultData,playPage:$p,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(Ec||(Ec={}));var rx;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(rx||(rx={}));var ix;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(ix||(ix={}));var Cu;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...rx.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:ix.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Cu||(Cu={}));var Gf;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,s){i.scene.objects.traverseFrom(n,(a,o)=>{var l;if(o.type==="Instance"){let c=(l=Qg.getComponentData(i,o.component))==null?void 0:l.data;c&&s(a,o,c.events)}else s(a,o,o.events)})}e.traverseModuleInstances=r})(Gf||(Gf={}));var Su;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function t(n={withLight:!0,withSquare:!0}){let s=[],a=tx.defaultMeshObject;n.withLight===!0&&s.push({fi:-1,data:ex.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),n.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:a,children:[]});let o=new an;return o.push({fi:1,id:$p,data:{...rd.defaultData,name:"Scene 1"},children:s}),o}e.defaultData={objects:t(),publish:Ec.defaultData,styles:Cu.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new an,publish:Ec.defaultData,styles:Cu.defaultData()}},e.emptyDataWithPage=function(n){return{objects:t(n),publish:Ec.defaultData,styles:Cu.defaultData()}};function r(n){return{...e.defaultData,objects:Fc(n,an.prototype)}}e.withObjs=r;function i(n,s){return r([{id:n,data:s,children:[],fi:0}])}e.withObj=i})(Su||(Su={}));var ef;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(ef||(ef={}));var Xg;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(Xg||(Xg={}));var nx;(e=>e.all=["images","videos","colors","audios","fonts","materials"])(nx||(nx={}));var b_;(e=>e.all=[...nx.all,"components"])(b_||(b_={}));var w_;(e=>{function t(){return{images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,materials:new wt,components:new wt}}e.defaultData=t})(w_||(w_={}));var Wf;(e=>{function t(){return{images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,materials:new wt,components:new wt}}e.defaultData=t})(Wf||(Wf={}));var Ha;(e=>{function t(){let n={};return n["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Fc(n,wt.prototype)}e.defaultColors=t;function r(n){let s={};return n!=null&&n.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...Xg.emptyImage,name:"AI generated image"}),Fc(s,wt.prototype)}e.defaultImages=r;function i(){return{catelogs:new wt,materials:new wt,images:new wt,videos:new wt,colors:new wt,audios:new wt,fonts:new wt,lib:Wf.defaultData()}}e.emptyData=i})(Ha||(Ha={}));var sx;(e=>e.list=["idle","move","jump","run"])(sx||(sx={}));var Yg;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new at,move:new at,jump:new at,run:new at},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Cs.fromHexAndA(3728051,1)}}))(Yg||(Yg={}));function C_(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...io(ii(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...ii(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function Uo(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Vo(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,s)=>{n===void 0&&(i.materials[s]=Si.defaultData(),n=i.materials[s]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=Si.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=Si.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&t(n.material)})})}function hae(e){Object.assign(e.scene.publish,{orbitControls:{...qg.defaultData,...ii(e.scene.publish.orbitControls)}})}function uae(e){Object.assign(e.scene.publish.settings,{video:{...Ec.defaultData.settings.video,...ii(e.scene.publish.settings.video)}})}function dae(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,s]of Object.entries(i))if((GI.includes(n)||typeof s=="boolean")&&delete i[n],n==="texture")for(let[a,o]of Object.entries(s))(cae.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function pae(e){e.scene.publish.withBackground=!0}function fae(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function mae(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function gae(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function vae(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=ii(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=ii(r).booleanExclude!==!0)}})}function yae(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function xae(e){function t(i){Object.setPrototypeOf(i,Hr.prototype),i.texture&&Object.setPrototypeOf(i.texture,Hr.prototype)}function r(i){Object.setPrototypeOf(i,Hr.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=ii(a.material).layers;r(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=ii(l).layers;r(c),l.layers=c}})})}function S_(e){e.layers===void 0&&Object.assign(e,Si.defaultTwoLayerData("lambert"))}function Yy(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...ii(t),colors:r,steps:i};Object.assign(t,n)}})}function bae(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function __(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&Yy(i)}):"material"in r&&typeof r.material!="string"&&Yy(r.material)}),Object.values(e.shared.materials).forEach(t=>Yy(t))}function wae(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function Cae(e){e.shared.audios=Fc({},wt.prototype)}function Sae(e){e.shared.videos=Fc({},wt.prototype)}function _ae(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function Aae(e){Object.entries(ii(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(ii(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function Eae(e){e.scene.publish.settings.web.preload=!1}function A_(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function E_(e){e.layers&&e.layers.forEach(t=>{lae(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function Mae(e){e.shared.fonts=Fc({},wt.prototype)}function Tae(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Lae(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let s=Si.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=Tae(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Ui.defaultData,...wu.defaultData,flatShading:!1,wireframe:!1,geometry:{...bu.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:ii(n.states),events:ii(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=ii(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function Pae(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new at,move:new at,jump:new at}});else{let s=new at;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:gt.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(u,io(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(u,{control1:{...a.control1},control2:{...a.control2}});let h={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},d={state:a.state,...h,...u},p={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new at({fi:0,id:gt.generateUUID(),data:c},{fi:1,id:gt.generateUUID(),data:d})};s.push({fi:l,id:o,data:p})}),delete n.targets)}})})}function Dae(e){e.scene.objects.traverse((t,r)=>{function i(n,s){var l;let a=new at,o=[];if(r.events.forEach((c,u,h)=>{if(c.type==="Audio"&&c.trigger===s){let d;o.push(u),c.interaction==="play"?d={...io(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...io(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:h,id:u,data:d})}}),o.forEach(c=>r.events.delete(c)),a.length){let c=(l=r.events.find(u=>u.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,a):r.events.insertBefore(null,[{id:gt.generateUUID(),data:{type:n,actions:a}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function M_(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=Yi.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function T_(e){Uo(e,M_),Vo(e,M_)}function Iae(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function Oae(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function Rae(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=Si.defaultTwoLayerData("phong"))})}function Bae(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function kae(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function Nae(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function zae(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function Fae(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function jae(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function Uae(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=Yg.defaultDataThirdPerson.navmesh)})})}function Vae(e){e.scene.styles||(e.scene.styles=Cu.defaultData())}function L_(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function Hae(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Vo(e,L_),Uo(e,L_)}function Gae(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new at})})})}function Wae(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function P_(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function qae(e,t){if(t<1&&(Vo(e,C_),Uo(e,C_),e.schema=1),t<2&&(hae(e),e.schema=2),t<3&&(dae(e),e.schema=3),t<4&&(pae(e),e.schema=4),t<5&&(fae(e),e.schema=5),t<6&&(mae(e),e.schema=6),t<7&&(gae(e),e.schema=7),t<8&&(e.schema=8),t<9&&(__(e),e.schema=9),t<10&&(bae(e),e.schema=10),t<11&&(wae(e),e.schema=11),t<12&&(__(e),e.schema=12),t<13&&(Cae(e),e.schema=13),t<14&&(_ae(e),e.schema=14),t<15&&(Aae(e),e.schema=15),t<16&&(Eae(e),e.schema=16),t<17&&(Vo(e,A_),Uo(e,A_),e.schema=17),t<18&&(Vo(e,S_),Uo(e,S_),e.schema=18),t<19&&(uae(e),e.schema=19),t<20&&(Mae(e),Lae(e),e.schema=20),t<21&&(Pae(e),Dae(e),e.schema=21),t<22&&(T_(e),e.schema=22),t<23&&(Iae(e),e.schema=23),t<24&&(Oae(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(Sae(e),t<25&&(e.schema=25)),t<26&&(vae(e),e.schema=26),t<27&&(yae(e),e.schema=27),t<28&&(T_(e),e.schema=28),t<29&&(xae(e),e.schema=29),t<30&&(Rae(e),e.schema=30),t<31&&(Bae(e),e.schema=31),t<33&&(kae(e),e.schema=33),t<34&&(Nae(e),e.schema=34),t<35&&(zae(e),e.schema=35),t<36&&(Fae(e),e.schema=36),t<37&&(jae(e),e.schema=37),t<38&&(Vo(e,E_),Uo(e,E_),e.schema=38),t<39&&(Uae(e),e.schema=39),t<40&&(Vae(e),e.schema=40),t<41&&(Hae(e),e.schema=41),t<42&&(Gae(e),e.schema=42),t<43&&(Wae(e),e.schema=43),t<99){Vo(e,P_),Uo(e,P_),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=_d);let r=ii(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=$p,i.insertBefore(null,null,[{id:$p,data:{...rd.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:io(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:io(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...ed.defaultData,...io(e.scene.environment,"usePhysics","gravity")},camera:ii(e.scene.ownerCamera)??rd.defaultData.camera,name:"Scene"},children:[]}]);for(let a of r)a.id!==Su.TRASH_CAN_ID&&i.move($p,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,$u.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function D_(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function Xae(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}var nc=104;function YI(e){let t=e.schema??0;t!==nc&&(console.warn("updating from ",t,"to ",nc),qae(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=Ec.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Vo(e,D_),Uo(e,D_),e.schema=101),t<102&&(Xae(e),e.schema=102),t<104&&(e.shared.catelogs=new wt,e.shared.lib=Wf.defaultData(),e.schema=104))}var Qg;(e=>{e.defaultData={schema:nc,scene:Su.defaultData,frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",ef.defaultData),shared:{...Ha.emptyData(),colors:Ha.defaultColors()}},e.emptyDataForImports=function(n){let s=Su.emptyDataWithPage(n);return{schema:nc,scene:s,frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",ef.defaultData),shared:{...Ha.emptyData(),colors:Ha.defaultColors(),images:Ha.defaultImages(n)}}},e.emptyData=function(){return{schema:nc,scene:Su.emptyDataWithPage(),frames:new wt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",ef.defaultData),shared:Ha.emptyData()}},e.collabHelper={...T5,updateSchema(n){return(n.schema??0)<nc?Vf(n,YI):(n.schema??0)-nc}};function t(n){let s=e.collabHelper.updateSchema(n);return typeof s=="number"?s===0?n:null:s.data}e.updateSchemaDirectly=t;function r(n){return{...n,shared:{...n.shared,lib:Wf.defaultData()}}}e.withoutLib=r;function i(n,s){let a=n.scene.objects.get(s);if(a&&a.data.type==="Component")return a;{let o=n.shared.lib.components[s];if(o)return o.asset}}e.getComponentData=i})(Qg||(Qg={}));function mc(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new nt,c=0;for(let u=0;u<e.length;++u){let h=e[u],d=0;if(r!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[p]===void 0&&(a[p]=[]),a[p].push(h.morphAttributes[p])}if(t){let p;if(r)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,u),c+=p}}if(r){let u=0,h=[];for(let d=0;d<e.length;++d){let p=e[d].index;for(let f=0;f<p.count;++f)h.push(p.getX(f)+u);u+=e[d].attributes.position.count}l.setIndex(h)}for(let u in s){let h=I_(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,h)}for(let u in a){let h=a[u][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let d=0;d<h;++d){let p=[];for(let m=0;m<a[u].length;++m)p.push(a[u][m][d]);let f=I_(p);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(f)}}return l}function I_(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new st(s,r,i)}var Yae=Math.pow(2,-24),Em=class{constructor(){}};function na(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function O_(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function R_(e,t){t.set(e)}function B_(e,t,r){let i,n;for(let s=0;s<3;s++){let a=s+3;i=e[s],n=t[s],r[s]=i<n?i:n,i=e[a],n=t[a],r[a]=i>n?i:n}}function Mm(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],s=t[e+2*i+1],a=n-s,o=n+s;a<r[i]&&(r[i]=a),o>r[i+3]&&(r[i+3]=o)}}function ep(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function Qae(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new st(n,1));for(let s=0;s<r;s++)n[s]=s}}function Kae(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,s)=>n-s);for(let n=0;n<i.length-1;n++){let s=i[n],a=i[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function Qy(e,t,r,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=n!==null;for(let y=t*6,x=(t+r)*6;y<x;y+=6){let b=e[y+0],w=e[y+1],C=b-w,_=b+w;C<s&&(s=C),_>l&&(l=_),v&&b<h&&(h=b),v&&b>f&&(f=b);let S=e[y+2],A=e[y+3],E=S-A,L=S+A;E<a&&(a=E),L>c&&(c=L),v&&S<d&&(d=S),v&&S>m&&(m=S);let P=e[y+4],D=e[y+5],I=P-D,B=P+D;I<o&&(o=I),B>u&&(u=B),v&&P<p&&(p=P),v&&P>g&&(g=P)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=u,v&&(n[0]=h,n[1]=d,n[2]=p,n[3]=f,n[4]=m,n[5]=g)}function Zae(e,t,r,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=t*6,h=(t+r)*6;u<h;u+=6){let d=e[u+0];d<n&&(n=d),d>o&&(o=d);let p=e[u+2];p<s&&(s=p),p>l&&(l=p);let f=e[u+4];f<a&&(a=f),f>c&&(c=f)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function Jae(e,t,r,i,n){let s=r,a=r+i-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let u=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=u;let h=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=h;let d=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=d}s++,a--}else return s}}var Ba=32,$ae=(e,t)=>e.candidate-t.candidate,Ao=new Array(Ba).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Tm=new Float32Array(6);function eoe(e,t,r,i,n,s){let a=-1,o=0;if(s===0)a=O_(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=O_(e),a!==-1&&(o=toe(r,i,n,a));else if(s===2){let l=ep(e),c=1.25*n,u=i*6,h=(i+n)*6;for(let d=0;d<3;d++){let p=t[d],f=(t[d+3]-p)/Ba;if(n<Ba/4){let m=[...Ao];m.length=n;let g=0;for(let y=u;y<h;y+=6,g++){let x=m[g];x.candidate=r[y+2*d],x.count=0;let{bounds:b,leftCacheBounds:w,rightCacheBounds:C}=x;for(let _=0;_<3;_++)C[_]=1/0,C[_+3]=-1/0,w[_]=1/0,w[_+3]=-1/0,b[_]=1/0,b[_+3]=-1/0;Mm(y,r,b)}m.sort($ae);let v=n;for(let y=0;y<v;y++){let x=m[y];for(;y+1<v&&m[y+1].candidate===x.candidate;)m.splice(y+1,1),v--}for(let y=u;y<h;y+=6){let x=r[y+2*d];for(let b=0;b<v;b++){let w=m[b];x>=w.candidate?Mm(y,r,w.rightCacheBounds):(Mm(y,r,w.leftCacheBounds),w.count++)}}for(let y=0;y<v;y++){let x=m[y],b=x.count,w=n-x.count,C=x.leftCacheBounds,_=x.rightCacheBounds,S=0;b!==0&&(S=ep(C)/l);let A=0;w!==0&&(A=ep(_)/l);let E=1+1.25*(S*b+A*w);E<c&&(a=d,c=E,o=x.candidate)}}else{for(let v=0;v<Ba;v++){let y=Ao[v];y.count=0,y.candidate=p+f+v*f;let x=y.bounds;for(let b=0;b<3;b++)x[b]=1/0,x[b+3]=-1/0}for(let v=u;v<h;v+=6){let y=~~((r[v+2*d]-p)/f);y>=Ba&&(y=Ba-1);let x=Ao[y];x.count++,Mm(v,r,x.bounds)}let m=Ao[Ba-1];R_(m.bounds,m.rightCacheBounds);for(let v=Ba-2;v>=0;v--){let y=Ao[v],x=Ao[v+1];B_(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let v=0;v<Ba-1;v++){let y=Ao[v],x=y.count,b=y.bounds,w=Ao[v+1].rightCacheBounds;x!==0&&(g===0?R_(b,Tm):B_(b,Tm,Tm)),g+=x;let C=0,_=0;g!==0&&(C=ep(Tm)/l);let S=n-g;S!==0&&(_=ep(w)/l);let A=1+1.25*(C*g+_*S);A<c&&(a=d,c=A,o=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function toe(e,t,r,i){let n=0;for(let s=t,a=t+r;s<a;s++)n+=e[s*6+i*2];return n/r}function roe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,s=new Float32Array(n*6),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let h=0;h<n;h++){let d=h*3,p=h*6,f,m,g;a?(f=i[d+0],m=i[d+1],g=i[d+2]):(f=i[d+0]*c+l,m=i[d+1]*c+l,g=i[d+2]*c+l);for(let v=0;v<3;v++){let y,x,b;a?(y=r[u[v]](f),x=r[u[v]](m),b=r[u[v]](g)):(y=o[f+v],x=o[m+v],b=o[g+v]);let w=y;x<w&&(w=x),b<w&&(w=b);let C=y;x>C&&(C=x),b>C&&(C=b);let _=(C-w)/2,S=v*2;s[p+S+0]=w+_,s[p+S+1]=_+(Math.abs(w)+_)*Yae,w<t[v]&&(t[v]=w),C>t[v+3]&&(t[v+3]=C)}}return s}function ioe(e,t){function r(v){d&&d(v/p)}function i(v,y,x,b=null,w=0){if(!f&&w>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),x<=u||w>=l)return r(y+x),v.offset=y,v.count=x,v;let C=eoe(v.boundingData,b,a,y,x,h);if(C.axis===-1)return r(y+x),v.offset=y,v.count=x,v;let _=Jae(o,a,y,x,C);if(_===y||_===y+x)r(y+x),v.offset=y,v.count=x;else{v.splitAxis=C.axis;let S=new Em,A=y,E=_-y;v.left=S,S.boundingData=new Float32Array(6),Qy(a,A,E,S.boundingData,s),i(S,A,E,s,w+1);let L=new Em,P=_,D=x-E;v.right=L,L.boundingData=new Float32Array(6),Qy(a,P,D,L.boundingData,s),i(L,P,D,s,w+1)}return v}Qae(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=roe(e,n),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,m=[],g=Kae(e);if(g.length===1){let v=g[0],y=new Em;y.boundingData=n,Zae(a,v.offset,v.count,s),i(y,v.offset,v.count,s),m.push(y)}else for(let v of g){let y=new Em;y.boundingData=new Float32Array(6),Qy(a,v.offset,v.count,y.boundingData,s),i(y,v.offset,v.count,s),m.push(y)}return m}function noe(e,t){let r=ioe(e,t),i,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<r.length;u++){let h=r[u],d=l(h),p=new o(32*d);i=new Float32Array(p),n=new Uint32Array(p),s=new Uint16Array(p),c(0,h),a.push(p)}return a;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,h){let d=u/4,p=u/2,f=!!h.count,m=h.boundingData;for(let g=0;g<6;g++)i[d+g]=m[g];if(f){let g=h.offset,v=h.count;return n[d+6]=g,s[p+14]=v,s[p+15]=65535,u+32}else{let g=h.left,v=h.right,y=h.splitAxis,x;if(x=c(u+32,g),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=x/4,x=c(x,v),n[d+7]=y,x}}}var po=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,r){let i=1/0,n=-1/0;for(let s=0,a=t.length;s<a;s++){let o=t[s][r];i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}setFromPoints(t,r){let i=1/0,n=-1/0;for(let s=0,a=r.length;s<a;s++){let o=r[s],l=t.dot(o);i=l<i?l:i,n=l>n?l:n}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}};po.prototype.setFromBox=function(){let e=new T;return function(t,r){let i=r.min,n=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*o+n.x*(1-o),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();var soe=function(){let e=new T,t=new T,r=new T;return function(i,n,s){let a=i.start,o=e,l=n.start,c=t;r.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let u=r.dot(c),h=c.dot(o),d=c.dot(c),p=r.dot(o),f=o.dot(o)*d-h*h,m,g;f!==0?m=(u*h-p*d)/f:m=0,g=(u+m*h)/d,s.x=m,s.y=g}}(),l8=function(){let e=new W,t=new T,r=new T;return function(i,n,s,a){soe(i,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){i.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?i.at(0,s):i.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=i.start:c=i.end;let u;l<0?u=n.start:u=n.end;let h=t,d=r;if(i.closestPointToPoint(u,!0,t),n.closestPointToPoint(c,!0,r),h.distanceToSquared(u)<=d.distanceToSquared(c)){s.copy(h),a.copy(u);return}else{s.copy(c),a.copy(d);return}}}}(),aoe=function(){let e=new T,t=new T,r=new xn,i=new $n;return function(n,s){let{radius:a,center:o}=n,{a:l,b:c,c:u}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(r);if(Math.abs(h.distanceToPoint(o))<=a){let d=h.projectPoint(o,t);if(s.containsPoint(d))return!0}return!1}}(),ooe=1e-15;function gh(e){return Math.abs(e)<ooe}var fo=class extends wi{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new T),this.satBounds=new Array(4).fill().map(()=>new po),this.points=[this.a,this.b,this.c],this.sphere=new Ln,this.plane=new xn,this.needsUpdate=!0}intersectsSphere(e){return aoe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=n[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let u=n[2],h=s[2];u.subVectors(t,r),h.setFromPoints(u,i);let d=n[3],p=s[3];d.subVectors(r,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};fo.prototype.closestPointToSegment=function(){let e=new T,t=new T,r=new $n;return function(i,n=null,s=null){let{start:a,end:o}=i,l=this.points,c,u=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;r.start.copy(l[h]),r.end.copy(l[d]),l8(r,i,e,t),c=e.distanceToSquared(t),c<u&&(u=c,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(u)}}();fo.prototype.intersectsTriangle=function(){let e=new fo,t=new Array(3),r=new Array(3),i=new po,n=new po,s=new T,a=new T,o=new T,l=new T,c=new $n,u=new $n,h=new $n;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;r[0]=d.a,r[1]=d.b,r[2]=d.c;for(let w=0;w<4;w++){let C=v[w],_=y[w];if(i.setFromPoints(_,r),C.isSeparated(i))return!1}let x=d.satBounds,b=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let w=0;w<4;w++){let C=x[w],_=b[w];if(i.setFromPoints(_,t),C.isSeparated(i))return!1}for(let w=0;w<4;w++){let C=y[w];for(let _=0;_<4;_++){let S=b[_];if(s.crossVectors(C,S),i.setFromPoints(s,t),n.setFromPoints(s,r),i.isSeparated(n))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let v=this.points,y=!1,x=0;for(let D=0;D<3;D++){let I=v[D],B=v[(D+1)%3];c.start.copy(I),c.end.copy(B),c.delta(a);let X=y?u.start:u.end,H=gh(g.distanceToPoint(I));if(gh(g.normal.dot(a))&&H){u.copy(c),x=2;break}if((g.intersectLine(c,X)||H)&&!gh(X.distanceTo(B))){if(x++,y)break;y=!0}}if(x===1&&d.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(x!==2)return!1;let b=d.points,w=!1,C=0;for(let D=0;D<3;D++){let I=b[D],B=b[(D+1)%3];c.start.copy(I),c.end.copy(B),c.delta(o);let X=w?h.start:h.end,H=gh(m.distanceToPoint(I));if(gh(m.normal.dot(o))&&H){h.copy(c),C=2;break}if((m.intersectLine(c,X)||H)&&!gh(X.distanceTo(B))){if(C++,w)break;w=!0}}if(C===1&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(C!==2)return!1;if(u.delta(a),h.delta(o),a.dot(o)<0){let D=h.start;h.start=h.end,h.end=D}let _=u.start.dot(a),S=u.end.dot(a),A=h.start.dot(a),E=h.end.dot(a),L=S<A,P=_<E;return _!==E&&A!==S&&L===P?!1:(p&&(l.subVectors(u.start,h.start),l.dot(a)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(a)<0?p.end.copy(u.end):p.end.copy(h.end)),!0)}}}();fo.prototype.distanceToPoint=function(){let e=new T;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();fo.prototype.distanceToTriangle=function(){let e=new T,t=new T,r=["a","b","c"],i=new $n,n=new $n;return function(s,a=null,o=null){let l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let u=0;u<3;u++){let h,d=r[u],p=s[d];this.closestPointToPoint(p,e),h=p.distanceToSquared(e),h<c&&(c=h,a&&a.copy(e),o&&o.copy(p));let f=this[d];s.closestPointToPoint(f,e),h=f.distanceToSquared(e),h<c&&(c=h,a&&a.copy(f),o&&o.copy(e))}for(let u=0;u<3;u++){let h=r[u],d=r[(u+1)%3];i.set(this[h],this[d]);for(let p=0;p<3;p++){let f=r[p],m=r[(p+1)%3];n.set(s[f],s[m]),l8(i,n,e,t);let g=e.distanceToSquared(t);g<c&&(c=g,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var ga=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new T,this.max=new T,this.matrix=new Ce,this.invMatrix=new Ce,this.points=new Array(8).fill().map(()=>new T),this.satAxes=new Array(3).fill().map(()=>new T),this.satBounds=new Array(3).fill().map(()=>new po),this.alignedSatBounds=new Array(3).fill().map(()=>new po),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ga.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let h=1*l|2*c|4*u,d=i[h];d.x=l?r.x:t.x,d.y=c?r.y:t.y,d.z=u?r.z:t.z,d.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let c=s[l],u=n[l],h=1<<l,d=i[h];c.subVectors(a,d),u.setFromPoints(c,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ga.prototype.intersectsBox=function(){let e=new po;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,a[0].isSeparated(e)||(e.min=r.y,e.max=i.y,a[1].isSeparated(e))||(e.min=r.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=n[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();ga.prototype.intersectsTriangle=function(){let e=new fo,t=new Array(3),r=new po,i=new po,n=new T;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let h=0;h<3;h++){let d=a[h],p=o[h];if(r.setFromPoints(p,t),d.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let h=0;h<3;h++){let d=l[h],p=c[h];if(r.setFromPoints(p,u),d.isSeparated(r))return!1}for(let h=0;h<3;h++){let d=o[h];for(let p=0;p<4;p++){let f=c[p];if(n.crossVectors(d,f),r.setFromPoints(n,t),i.setFromPoints(n,u),r.isSeparated(i))return!1}}return!0}}();ga.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ga.prototype.distanceToPoint=function(){let e=new T;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ga.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new $n),r=new Array(12).fill().map(()=>new $n),i=new T,n=new T;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,i),s.closestPointToPoint(i,n),o&&o.copy(i),l&&l.copy(n)),0;let c=a*a,u=s.min,h=s.max,d=this.points,p=1/0;for(let m=0;m<8;m++){let g=d[m];n.copy(g).clamp(u,h);let v=g.distanceToSquared(n);if(v<p&&(p=v,o&&o.copy(g),l&&l.copy(n),v<c))return Math.sqrt(v)}let f=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){let y=(m+1)%3,x=(m+2)%3,b=g<<y|v<<x,w=1<<m|g<<y|v<<x,C=d[b],_=d[w];t[f].set(C,_);let S=e[m],A=e[y],E=e[x],L=r[f],P=L.start,D=L.end;P[S]=u[S],P[A]=g?u[A]:h[A],P[E]=v?u[E]:h[A],D[S]=h[S],D[A]=g?u[A]:h[A],D[E]=v?u[E]:h[A],f++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){n.x=m?h.x:u.x,n.y=g?h.y:u.y,n.z=v?h.z:u.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<p&&(p=y,o&&o.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let g=t[m];for(let v=0;v<12;v++){let y=r[v];l8(g,y,i,n);let x=i.distanceToSquared(n);if(x<p&&(p=x,o&&o.copy(i),l&&l.copy(n),x<c))return Math.sqrt(x)}}return Math.sqrt(p)}}();var vh=new T,yh=new T,xh=new T,Lm=new W,Pm=new W,Dm=new W,k_=new T,N_=new T,z_=new T,Im=new T;function loe(e,t,r,i,n,s){let a;return s===ei?a=e.intersectTriangle(i,r,t,!0,n):a=e.intersectTriangle(t,r,i,s!==wn,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function coe(e,t,r,i,n,s,a,o,l){vh.fromBufferAttribute(t,s),yh.fromBufferAttribute(t,a),xh.fromBufferAttribute(t,o);let c=loe(e,vh,yh,xh,Im,l);if(c){i&&(Lm.fromBufferAttribute(i,s),Pm.fromBufferAttribute(i,a),Dm.fromBufferAttribute(i,o),c.uv=wi.getInterpolation(Im,vh,yh,xh,Lm,Pm,Dm,new W)),n&&(Lm.fromBufferAttribute(n,s),Pm.fromBufferAttribute(n,a),Dm.fromBufferAttribute(n,o),c.uv1=wi.getInterpolation(Im,vh,yh,xh,Lm,Pm,Dm,new W)),r&&(k_.fromBufferAttribute(r,s),N_.fromBufferAttribute(r,a),z_.fromBufferAttribute(r,o),c.normal=wi.getInterpolation(Im,vh,yh,xh,k_,N_,z_,new T),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a:s,b:a,c:o,normal:new T,materialIndex:0};wi.getNormal(vh,yh,xh,u.normal),c.face=u,c.faceIndex=s}return c}function QI(e,t,r,i,n){let s=i*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:h,uv1:d}=e.attributes,p=coe(r,c,u,h,d,a,o,l,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function hoe(e,t,r,i,n,s){for(let a=i,o=i+n;a<o;a++)QI(e,t,r,a,s)}function uoe(e,t,r,i,n){let s=1/0,a=null;for(let o=i,l=i+n;o<l;o++){let c=QI(e,t,r,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function $s(e,t,r,i){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function F_(e,t,r,i,n,s,a){let o=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if($s(a,c*3,o,l),a.needsUpdate=!0,i(a,c,n,s))return!0;return!1}var KI=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Ho(e,t){return t[e+15]===65535}function _u(e,t){return t[e+6]}function qf(e,t){return t[e+14]}function Xf(e){return e+8}function Yf(e,t){return t[e+6]}function doe(e,t){return t[e+7]}var lu=new Er,Kg=new T,poe=["x","y","z"];function ax(e,t,r,i,n){let s=e*2,a=Ad,o=ml,l=gl;if(Ho(s,o)){let c=_u(e,l),u=qf(s,o);hoe(t,r,i,c,u,n)}else{let c=Xf(e);Zg(c,a,i,Kg)&&ax(c,t,r,i,n);let u=Yf(e,l);Zg(u,a,i,Kg)&&ax(u,t,r,i,n)}}function ox(e,t,r,i){let n=e*2,s=Ad,a=ml,o=gl;if(Ho(n,a)){let l=_u(e,o),c=qf(n,a);return uoe(t,r,i,l,c)}else{let l=doe(e,o),c=poe[l],u=i.direction[c]>=0,h,d;u?(h=Xf(e),d=Yf(e,o)):(h=Yf(e,o),d=Xf(e));let p=Zg(h,s,i,Kg)?ox(h,t,r,i):null;if(p){let m=p.point[c];if(u?m<=s[d+l]:m>=s[d+l+3])return p}let f=Zg(d,s,i,Kg)?ox(d,t,r,i):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var foe=function(){let e,t,r=[],i=new KI(()=>new Er);return function(...s){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let a=n(...s);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let o=r.length;return o>0&&(t=r[o-1],e=r[o-2]),a};function n(s,a,o,l,c=null,u=0,h=0){function d(y){let x=y*2,b=ml,w=gl;for(;!Ho(x,b);)y=Xf(y),x=y*2;return _u(y,w)}function p(y){let x=y*2,b=ml,w=gl;for(;!Ho(x,b);)y=Yf(y,w),x=y*2;return _u(y,w)+qf(x,b)}let f=s*2,m=Ad,g=ml,v=gl;if(Ho(f,g)){let y=_u(s,v),x=qf(f,g);return na(s,m,e),l(y,x,!1,h,u+s,e)}else{let y=Xf(s),x=Yf(s,v),b=y,w=x,C,_,S,A;if(c&&(S=e,A=t,na(b,m,S),na(w,m,A),C=c(S),_=c(A),_<C)){b=x,w=y;let X=C;C=_,_=X,S=A}S||(S=e,na(b,m,S));let E=Ho(b*2,g),L=o(S,E,C,h+1,u+b),P;if(L===2){let X=d(b),H=p(b)-X;P=l(X,H,!0,h+1,u+b,S)}else P=L&&n(b,a,o,l,c,u,h+1);if(P)return!0;A=t,na(w,m,A);let D=Ho(w*2,g),I=o(A,D,_,h+1,u+w),B;if(I===2){let X=d(w),H=p(w)-X;B=l(X,H,!0,h+1,u+w,A)}else B=I&&n(w,a,o,l,c,u,h+1);return!!B}}}(),moe=function(){let e=new fo,t=new fo,r=new Ce,i=new ga,n=new ga;return function s(a,o,l,c,u=null){let h=a*2,d=Ad,p=ml,f=gl;if(u===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),u=i),Ho(h,p)){let m=o,g=m.index,v=m.attributes.position,y=l.index,x=l.attributes.position,b=_u(a,f),w=qf(h,p);if(r.copy(c).invert(),l.boundsTree)return na(a,d,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:C=>n.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(c),C.b.applyMatrix4(c),C.c.applyMatrix4(c),C.needsUpdate=!0;for(let _=b*3,S=(w+b)*3;_<S;_+=3)if($s(t,_,g,v),t.needsUpdate=!0,C.intersectsTriangle(t))return!0;return!1}});for(let C=b*3,_=w+b*3;C<_;C+=3){$s(e,C,g,v),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let S=0,A=y.count;S<A;S+=3)if($s(t,S,y,x),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let m=a+8,g=f[a+6];return na(m,d,lu),!!(u.intersectsBox(lu)&&s(m,o,l,c,u)||(na(g,d,lu),u.intersectsBox(lu)&&s(g,o,l,c,u)))}}}();function Zg(e,t,r,i){return na(e,t,lu),r.intersectBox(lu,i)}var lx=[],L0,Ad,ml,gl;function Tp(e){L0&&lx.push(L0),L0=e,Ad=new Float32Array(e),ml=new Uint16Array(e),gl=new Uint32Array(e)}function Om(){L0=null,Ad=null,ml=null,gl=null,lx.length&&Tp(lx.pop())}var Ky=Symbol("skip tree generation"),Zy=new Er,Jy=new Er,bh=new Ce,Gl=new ga,tp=new ga,rp=new T,Rm=new T,goe=new T,voe=new T,yoe=new T,j_=new Er,zs=new KI(()=>new fo),tf=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),tf.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),s;return t.cloneBuffers?s={roots:i.map(a=>a.slice()),index:n.array.slice()}:s={roots:i,index:n.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),tf.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,s=new tf(t,{...r,[Ky]:!0});if(s._roots=n,r.setIndex){let a=t.getIndex();if(a===null){let o=new st(e.index,1,!1);t.setIndex(o)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[Ky]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[Ky]||(this._roots=noe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Er))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,s,a,o,l=0,c=this._roots;for(let h=0,d=c.length;h<d;h++)n=c[h],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),u(0,l),l+=n.byteLength;function u(h,d,p=!1){let f=h*2;if(a[f+15]===65535){let m=s[h+6],g=a[f+14],v=1/0,y=1/0,x=1/0,b=-1/0,w=-1/0,C=-1/0;for(let _=3*m,S=3*(m+g);_<S;_++){let A=r[_],E=i.getX(A),L=i.getY(A),P=i.getZ(A);E<v&&(v=E),E>b&&(b=E),L<y&&(y=L),L>w&&(w=L),P<x&&(x=P),P>C&&(C=P)}return o[h+0]!==v||o[h+1]!==y||o[h+2]!==x||o[h+3]!==b||o[h+4]!==w||o[h+5]!==C?(o[h+0]=v,o[h+1]=y,o[h+2]=x,o[h+3]=b,o[h+4]=w,o[h+5]=C,!0):!1}else{let m=h+8,g=s[h+6],v=m+d,y=g+d,x=p,b=!1,w=!1;e?x||(b=e.has(v),w=e.has(y),x=!b&&!w):(b=!0,w=!0);let C=x||b,_=x||w,S=!1;C&&(S=u(m,d,x));let A=!1;_&&(A=u(g,d,x));let E=S||A;if(E)for(let L=0;L<3;L++){let P=m+L,D=g+L,I=o[P],B=o[P+3],X=o[D],H=o[D+3];o[h+L]=I<X?I:X,o[h+L+3]=B>H?B:H}return E}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);s(0);function s(a,o=0){let l=a*2,c=n[l+15]===65535;if(c){let u=i[a+6],h=n[l+14];e(o,c,new Float32Array(r,a*4,6),u,h)}else{let u=a+8,h=i[a+6],d=i[a+7];e(o,c,new Float32Array(r,a*4,6),d)||(s(u,o+1),s(h,o+1))}}}raycast(e,t=Ps){let r=this._roots,i=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=a?t[o[c].materialIndex].side:l,d=n.length;if(Tp(r[c]),ax(0,i,h,e,n),Om(),a){let p=o[c].materialIndex;for(let f=d,m=n.length;f<m;f++)n[f].face.materialIndex=p}}return n}raycastFirst(e,t=Ps){let r=this._roots,i=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=n?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=s?t[o[c].materialIndex].side:l;Tp(r[c]);let d=ox(0,i,h,e);Om(),d!=null&&(a==null||d.distance<a.distance)&&(a=d,s&&(d.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(Tp(n),i=moe(0,r,e,t),Om(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let h=t;t=(d,p,f,m)=>{let g=p*3;return h(d,g,g+1,g+2,f,m)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=zs.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let h=o;o=(d,p,f,m,g)=>h(d,p,f,m,g)?!0:F_(d,p,i,l,f,m,n)}else o||(l?o=(h,d,p,f)=>F_(h,d,i,l,p,f,n):o=(h,d,p)=>p);let c=!1,u=0;for(let h of this._roots){if(Tp(h),c=foe(0,i,a,o,s,u),Om(),c)break;u+=h.byteLength}return zs.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;bh.copy(t).invert();let c=zs.getPrimitive(),u=zs.getPrimitive();if(n){let d=function(p,f,m,g,v,y,x,b){for(let w=m,C=m+g;w<C;w++){$s(u,w*3,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let _=p,S=p+f;_<S;_++)if($s(c,_*3,s,a),c.needsUpdate=!0,n(c,u,_,w,v,y,x,b))return!0}return!1};if(i){let p=i;i=function(f,m,g,v,y,x,b,w){return p(f,m,g,v,y,x,b,w)?!0:d(f,m,g,v,y,x,b,w)}}else i=d}e.getBoundingBox(Jy),Jy.applyMatrix4(t);let h=this.shapecast({intersectsBounds:d=>Jy.intersectsBox(d),intersectsRange:(d,p,f,m,g,v)=>(Zy.copy(v),Zy.applyMatrix4(bh),e.shapecast({intersectsBounds:y=>Zy.intersectsBox(y),intersectsRange:(y,x,b,w,C)=>i(d,p,y,x,m,g,w,C)}))});return zs.releasePrimitive(c),zs.releasePrimitive(u),h}intersectsBox(e,t){return Gl.set(e.min,e.max,t),Gl.needsUpdate=!0,this.shapecast({intersectsBounds:r=>Gl.intersectsBox(r),intersectsTriangle:r=>Gl.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Gl.set(e.boundingBox.min,e.boundingBox.max,t),Gl.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,h=zs.getPrimitive(),d=zs.getPrimitive(),p=Rm,f=goe,m=null,g=null;i&&(m=voe,g=yoe);let v=1/0,y=null,x=null;return bh.copy(t).invert(),tp.matrix.copy(bh),this.shapecast({boundsTraverseOrder:b=>Gl.distanceToBox(b),intersectsBounds:(b,w,C)=>C<v&&C<s?(w&&(tp.min.copy(b.min),tp.max.copy(b.max),tp.needsUpdate=!0),!0):!1,intersectsRange:(b,w)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:C=>tp.distanceToBox(C),intersectsBounds:(C,_,S)=>S<v&&S<s,intersectsRange:(C,_)=>{for(let S=C*3,A=(C+_)*3;S<A;S+=3){$s(d,S,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let E=b*3,L=(b+w)*3;E<L;E+=3){$s(h,E,l,o),h.needsUpdate=!0;let P=h.distanceToTriangle(d,p,m);if(P<v&&(f.copy(p),g&&g.copy(m),v=P,y=E/3,x=S/3),P<n)return!0}}}});{let C=u?u.count:c.count;for(let _=0,S=C;_<S;_+=3){$s(d,_,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let A=b*3,E=(b+w)*3;A<E;A+=3){$s(h,A,l,o),h.needsUpdate=!0;let L=h.distanceToTriangle(d,p,m);if(L<v&&(f.copy(p),g&&g.copy(m),v=L,y=A/3,x=_/3),L<n)return!0}}}}}),zs.releasePrimitive(h),zs.releasePrimitive(d),v===1/0?null:(r.point?r.point.copy(f):r.point=f.clone(),r.distance=v,r.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(bh),f.applyMatrix4(bh),i.distance=f.sub(i.point).length(),i.faceIndex=x),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(rp.copy(e).clamp(c.min,c.max),rp.distanceToSquared(e)),intersectsBounds:(c,u,h)=>h<a&&h<s,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,rp);let h=e.distanceToSquared(rp);return h<a&&(Rm.copy(rp),a=h,o=u),h<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(Rm):t.point=Rm.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{na(0,new Float32Array(t),j_),e.union(j_)}),e}},ip=hd(kH()),xoe=.5*(Math.sqrt(3)-1),np=(3-Math.sqrt(3))/6,boe=1/3,Fs=1/6,rf=e=>Math.floor(e)|0,U_=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),$y=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function e3(e=Math.random){let t=ZI(e),r=new Float64Array(t).map(n=>U_[n%12*2]),i=new Float64Array(t).map(n=>U_[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,c=(n+s)*xoe,u=rf(n+c),h=rf(s+c),d=(u+h)*np,p=u-d,f=h-d,m=n-p,g=s-f,v,y;m>g?(v=1,y=0):(v=0,y=1);let x=m-v+np,b=g-y+np,w=m-1+2*np,C=g-1+2*np,_=u&255,S=h&255,A=.5-m*m-g*g;if(A>=0){let P=_+t[S],D=r[P],I=i[P];A*=A,a=A*A*(D*m+I*g)}let E=.5-x*x-b*b;if(E>=0){let P=_+v+t[S+y],D=r[P],I=i[P];E*=E,o=E*E*(D*x+I*b)}let L=.5-w*w-C*C;if(L>=0){let P=_+1+t[S+1],D=r[P],I=i[P];L*=L,l=L*L*(D*w+I*C)}return 70*(a+o+l)}}function woe(e=Math.random){let t=ZI(e),r=new Float64Array(t).map(s=>$y[s%12*3]),i=new Float64Array(t).map(s=>$y[s%12*3+1]),n=new Float64Array(t).map(s=>$y[s%12*3+2]);return function(s,a,o){let l,c,u,h,d=(s+a+o)*boe,p=rf(s+d),f=rf(a+d),m=rf(o+d),g=(p+f+m)*Fs,v=p-g,y=f-g,x=m-g,b=s-v,w=a-y,C=o-x,_,S,A,E,L,P;b>=w?w>=C?(_=1,S=0,A=0,E=1,L=1,P=0):b>=C?(_=1,S=0,A=0,E=1,L=0,P=1):(_=0,S=0,A=1,E=1,L=0,P=1):w<C?(_=0,S=0,A=1,E=0,L=1,P=1):b<C?(_=0,S=1,A=0,E=0,L=1,P=1):(_=0,S=1,A=0,E=1,L=1,P=0);let D=b-_+Fs,I=w-S+Fs,B=C-A+Fs,X=b-E+2*Fs,H=w-L+2*Fs,R=C-P+2*Fs,q=b-1+3*Fs,F=w-1+3*Fs,z=C-1+3*Fs,U=p&255,K=f&255,j=m&255,Y=.6-b*b-w*w-C*C;if(Y<0)l=0;else{let ee=U+t[K+t[j]];Y*=Y,l=Y*Y*(r[ee]*b+i[ee]*w+n[ee]*C)}let V=.6-D*D-I*I-B*B;if(V<0)c=0;else{let ee=U+_+t[K+S+t[j+A]];V*=V,c=V*V*(r[ee]*D+i[ee]*I+n[ee]*B)}let ie=.6-X*X-H*H-R*R;if(ie<0)u=0;else{let ee=U+E+t[K+L+t[j+P]];ie*=ie,u=ie*ie*(r[ee]*X+i[ee]*H+n[ee]*R)}let $=.6-q*q-F*F-z*z;if($<0)h=0;else{let ee=U+1+t[K+1+t[j+1]];$*=$,h=$*$*(r[ee]*q+i[ee]*F+n[ee]*z)}return 32*(l+c+u+h)}}function ZI(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var us=new wi,Coe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;us.a.fromBufferAttribute(e,i),us.b.fromBufferAttribute(e,i+1),us.c.fromBufferAttribute(e,i+2),n*=us.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),us.a.fromBufferAttribute(this.positionAttribute,e*3),us.b.fromBufferAttribute(this.positionAttribute,e*3+1),us.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(us.a,i).addScaledVector(us.b,n).addScaledVector(us.c,1-(i+n)),us.getNormal(r),this}},Soe=hd(FP()),_oe=new Ce,Aoe=new Ce,Eoe=new Ce,Qf;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(Qf||(Qf={}));var c8=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new Ce,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Ce,this.matrixWorldRigid=new Ce,this.shearScale=new Ce,this.shearScaleInv=new Ce}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Vt&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)Qf.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Qf.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:s}=(0,Soe.SVD)(r),a=_oe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=Aoe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=Eoe.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new Ce().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Ce?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},Moe=class extends c8(Vt){},Toe=e=>e.type==="Mesh",Ci=class extends Moe{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new Ci(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return Toe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},sc=new T,ac=new T,Au=new Ce,JI=[new T(-1,1,1),new T(-1,-1,1),new T(1,-1,1),new T(1,1,1),new T(-1,1,-1),new T(-1,-1,-1),new T(1,-1,-1),new T(1,1,-1)],Loe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],Poe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],V_=(e,t,r)=>{e.updateEntityBoxSize(sc,ac),Au.copy(t).multiply(e.matrixWorld),ac.x===0&&ac.y===0&&ac.z===0?r.push(new T(sc.x,sc.y,sc.z).applyMatrix4(Au)):JI.forEach(i=>{r.push(i.clone().multiply(ac).add(sc).applyMatrix4(Au))})},H_=class extends Er{constructor(){super(...arguments),this.matrix=new Ce,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new Ce().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new T);return}V_(n,t,i)}}):V_(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(Au.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(ac).multiplyScalar(.5),this.getCenter(sc),Au.copy(this.matrix).setPosition(sc),this.vertices=JI.map(e=>e.clone().multiply(ac).applyMatrix4(Au))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=Loe.map(([e,t])=>new $n(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new T))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=Poe.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},Jo={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},Doe=class extends pD{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(e*l/n),u=o.getPoints(c);for(let h=0;h<u.length;h++){let d=u[h];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},cx=.001;function hx(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=cx}function t3(e,t){let r=new T(...e.position),i=new T(...e.controlNext.position),n=new T(...t.controlPrevious.position),s=new T(...t.position);return hx(r,i,s)&&hx(r,n,s)}function $I(e){let t=e.points.map(u=>new T(...u.data.position)),r=[e.points[0]],i=new T(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)hx(i,t[u],t[u+1])||(r.push(e.points[u]),i=t[u]);r.push(e.points[e.points.length-1]);let n=e.isClosed,s=r.length-(n?0:1),a=r.length,o=[];for(let u=0;u<a;u++){let h=r[u].data,d=new T(...h.position),p=new T(...h.controlPrevious.position),f=new T(...h.controlNext.position),m={position:d,baseRoundness:h.roundness,controlPrevious:p,controlNext:f};if(h.roundness===0||!e.isClosed&&(u===0||u===a-1)){o[u]={...m,removedLength:0};continue}let g=n&&u==0?a-1:u-1,v=n&&u==a-1?0:u+1,y=r[g].data,x=r[v].data,b=new T(...y.position),w=new T(...x.position),C=b.clone().sub(d).normalize(),_=w.clone().sub(d).normalize();Object.assign(m,{prevDir:C,nextDir:_});let S=t3(y,h),A=t3(h,x);if(!S||!A)o[u]={...m,removedLength:0};else{let E=C.clone().add(_).normalize(),L=E.clone().cross(C).length()/C.dot(E);o[u]={...m,tan:L,removedLength:h.roundness/L}}}for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d];if(p.removedLength!==0||f.removedLength!==0){let m=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,m/2),f.removedLength=Math.min(f.removedLength,m/2)}}let l=[];for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d],m=null;if(!t3(r[h].data,r[d].data))p.position.distanceTo(f.position)>cx&&(m=new _0(p.position,p.controlNext,f.controlPrevious,f.position));else{let g=p.position.clone(),v=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&g.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&v.add(f.prevDir.clone().setLength(f.removedLength))),g.distanceTo(v)>cx&&(m=new _0(g,g.clone().lerp(v,.3),v.clone().lerp(g,.3),v))}l[2*u+1]=m}for(let u=0;u<a;u++){let h=o[u];if(h.removedLength===0){l[2*u]=null;continue}let d=h.position,p=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),f=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),m=h.tan*h.removedLength,g=h.prevDir.clone().add(h.nextDir).normalize(),v=p.clone().lerp(f,.5),y=p.distanceTo(f)/2,x=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(v),b=g.clone().multiplyScalar(-m).add(x),w=d.distanceTo(b)/d.distanceTo(v),C=h.prevDir.clone().multiplyScalar(w*d.distanceTo(p)).add(d),_=C.clone().lerp(b,2),S=p.clone().lerp(C,4/3),A=f.clone().lerp(_,4/3);l[2*u]=new _0(p,S,A,f)}let c=new Doe;return l.forEach(u=>{u&&c.add(u)}),c}var Mt;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(Mt||(Mt={}));var Ga=e=>Mt.is(e),Ioe={type:"completeState",isfromEntity:!0},h8=e=>class extends c8(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new H_,this._recursiveBBox=new H_,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(Mt.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Mt.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(Mt.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)fc.toOps(this.data,n.data).forEach(s=>{let a=M5.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=fc.patch(this.data,n),fc.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Ga(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(Mt.is(r[i]))return r[i];if(Mt.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Mt.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)Ga(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{Mt.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Ga(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Ga(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)Ga(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Ga(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return E5(r,t)}updateTransformState(t){let r=!1;return t.position&&(this.position.fromArray(t.position),r=!0),t.rotation&&(this.rotation.fromArray(t.rotation),r=!0),t.scale&&(r=!0,this.scale.fromArray(t.scale)),t.hiddenMatrix!==void 0&&(r=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Zu.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),r}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Mt.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Mt.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return E5(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let s=this.data;this.data=r;let a=t,o=Yn(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let h=ua.zoom(u,t.path.slice(2));if(h)for(let d in t.props)t.props[d]===void 0&&d in h&&(c[d]=h[d])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...h}=l;l=h}if(t.props.material!==void 0&&"material"in l){let{material:u,...h}=l;l=h}let c=ua.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,fc.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),Yn(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let h=i.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=t.props[u],h.updateState(pl.apply(h.component.data,h.overrideData),i))}}else{let u=i.scene.findInstance([this.uuid,...l]);if(u){let h=ua.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let d=t.props;if(h)for(let[p,f]of Object.entries(t.props))f===void 0&&(d===t.props&&(d={...t.props}),d[p]=h[p]);t={...t,props:d}}u.overrideData=Wg.resolve(r.overrides,l),u.updateByOp(t,Ni.applySimple(u.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of Zo.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of Zo.rootOverrideProps)if(Yn(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=pl.filterOp(c.overrideData,l);u&&c.updateByOp(u,Ni.applySimple(c.data,u),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=pl.filterOp(c.overrideData,t);if(u){let h;s===c.data&&t===u?h=r:h=Ni.applySimple(c.data,u),c.updateByOp(u,h,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!jc.is(t.props.type)&&Jo.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){Jo.changeEntityProptotype(this,r,i);for(let n of this.children)Mt.is(n)&&n.updateVisible()}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),Yn(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),Yn(t.path,["cloner"])!==null){let n=Ni.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible()}}updatePathSnapping(t){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var f,m,g,v,y;let r=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,i=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,n=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let a=t.find(r);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=$I(o.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let u=l.getPointAt(c),h=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new Ce;a.updateMatrixWorld();let d=new Ce().multiplyMatrices(h.clone().invert(),a.matrixWorld);u.applyMatrix4(d);let p={position:u.toArray(),rotation:o.rotation};if(s==="tangential"){let x=new Ce().extractRotation(a.matrixWorld),b=l.getTangentAt(c).applyMatrix4(x).add(u),w=new Ce().lookAt(u,b,new T(0,1,0)),C=new $r().setFromRotationMatrix(w);p={...p,rotation:[C.x,C.y,C.z]}}this.updateTransformState(p),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent(Ioe)})}updateVisible(){var t;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((t=this.dataPatched.cloner)==null?void 0:t.hideBase)!==!0)}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible()),this.updateTransformState(t)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof Jo.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new Jo.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}},eO=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters),i=r.width/2,n=r.radiusTop??i,s=r.radiusBottom??i;return n===s?(n=i,s=i):n>s?(n=i,s=s*i/n):(n=n*i/s,s=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:s})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:h,cornerSegments:d,hollow:p}=e.parameters,f;return h||p?f=new tO(c,u,i,n,s,a,o,l*Math.PI/180,h,h,d,p):f=new E7(c,u,i,n,s,a,o,l*Math.PI/180),f.scale(1,1,r/t),Object.assign(f,{userData:{...e,type:"CylinderGeometry"}})}};function Eo(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function G_(e){return new W(e.y,-e.x)}var tO=class extends nt{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let p=[],f=[],m=[],g=[],v=0,y=r/2,x=new T,b=new T;d&&e==0&&(e=l),d&&t==0&&(t=c);let w=new W(e,y),C=new W(t,-y),_=null,S=null,A=null,E=null,L=w.clone().sub(C),P=0,D=0,I=0;h>0&&(P=Math.min(e,t)*(1-h),D=e-P,I=t-P);let B=w.clone();B.x-=P;let X=Math.PI-L.angle(),H=L.angle(),R=Math.tan(H/2),q=Math.tan(X/2),F=R+q,z=h?F:q,U=h?F:R;if(l=Math.min(l,(e-D)/z,L.length()/F),c=Math.min(c,(t-I)/U,L.length()/F),l>0){let $=l/R;_=w.clone().sub(new W($,l)),h&&(A=_.clone(),A.x-=P-F*l),w.sub(L.clone().setLength($))}if(c>0){let $=c/q;S=C.clone().sub(new W($,-c)),C.add(L.clone().setLength($)),h&&(E=S.clone(),E.x-=P-F*c,B.sub(L.clone().setLength($)))}L=w.clone().sub(C);let K=L.length()<.5,j=[];for(let $=0;$<=i;$++){let ee=[],ne=$/i,ce=ne*o+a,ue=new W(Math.sin(ce),Math.cos(ce));E&&S?(Y(ee,ne,ue,X,c,E,-1,!0),Y(ee,ne,ue,H,c,S,-1,!1)):S?(V(ee,ue,S.x,0,-1),Y(ee,ne,ue,H,c,S,-1,!1)):s||V(ee,ue,t,I,-1);let ye=G_(L).normalize();if(Eo(ye,ue,x),!K)for(let Re=0;Re<=n;Re++){let Se=Re/n,Ne=L.clone().multiplyScalar(Se).add(C);Eo(Ne,ue,b),f.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(ne,.5+b.y/r),ee.push(v++)}if(A&&_?(Y(ee,ne,ue,X,l,_,1,!1),Y(ee,ne,ue,H,l,A,1,!0)):_?(Y(ee,ne,ue,X,l,_,1,!1),V(ee,ue,_.x,0,1)):s||V(ee,ue,e,D,1),h&&!K){let Re=G_(L).multiplyScalar(-1).normalize();Eo(Re,ue,x);for(let Se=0;Se<=n;Se++){let Ne=Se/n,Oe=L.clone().multiplyScalar(-Ne).add(B);Eo(Oe,ue,b),f.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(ne,.5+b.y/r),ee.push(v++)}}h&&!s&&ee.push(ee[0]),j.push(ee)}for(let $=0;$<j.length-1;$++)for(let ee=0;ee<j[0].length-1;ee++){if(s&&h&&ee==n)continue;let ne=j[$][ee],ce=j[$+1][ee],ue=j[$+1][ee+1],ye=j[$][ee+1],Re=f[ue*3+0],Se=f[ue*3+2];p.push(ne,ce,ye),(Re!=0||Se!=0)&&p.push(ce,ue,ye)}o<Math.PI*2&&(ie(-1,j[0],a),ie(1,j[j.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new ze(f,3)),this.setAttribute("normal",new ze(m,3)),this.setAttribute("uv",new ze(g,2));function Y($,ee,ne,ce,ue,ye,Re,Se){for(let Ne=0;Ne<u+1;Ne++){let Oe=Ne/u,Ae=Re<0?Oe:1-Oe;Se&&(Ae-=1),Ae*=ce;let _e=new W(Math.sin(Ae),Math.cos(Ae)*Re),Ue=_e.clone().multiplyScalar(ue).add(ye);Eo(Ue,ne,b),f.push(b.x,b.y,b.z),Eo(_e,ne,x),m.push(x.x,x.y,x.z),g.push(ee,.5+b.y/r),$.push(v++)}}function V($,ee,ne,ce,ue){let ye=new T,Re=new W,Se=[ne,ce];ue<0&&Se.reverse();for(let Ne of Se)Re.set(Ne,y*ue),Eo(Re,ee,ye),f.push(ye.x,ye.y,ye.z),m.push(0,ue,0),g.push(.5,.5),$.push(v++)}function ie($,ee,ne){let ce=new W(Math.sin(ne),Math.cos(ne)),ue=new W(-Math.cos(ne),Math.sin(ne)),ye=new T,Re=$<0?(Oe,Ae,_e)=>p.push(Oe,Ae,_e):(Oe,Ae,_e)=>p.push(Oe,_e,Ae),Se=new W((e+t+D+I)/4,0);Eo(Se,ce,ye),f.push(ye.x,ye.y,ye.z),m.push(ue.x,0,ue.y),g.push(.5,.5);let Ne=v++;for(let Oe of ee){let Ae=f.slice(Oe*3,Oe*3+3);f.push(...Ae),m.push(ue.x,0,ue.y);let _e=g.slice(Oe*2,Oe*2+2);g.push(..._e),v++}for(let Oe=Ne+1;Oe<v-1;Oe++)Re(Ne,Oe,Oe+1);Re(Ne,v-1,Ne+1)}}},Ooe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:h}=e.parameters,d;return c>0||u>0||l<360?d=new tO(0,t/2,i,n,s,a,o,l*Math.PI/180,c,u,h,0,!0):d=new mD(t/2,i,n,s,a),d.scale(1,1,r/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},Roe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o==0?c=new fa(t,r,i,n,s,a):c=new Boe(t,r,i,n,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},r3=Math.PI/2,Boe=class extends nt{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let c=[],u=[],h=[],d=[],p=0,f=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,i,s,2),m("x","z","y",1,-1,e,r,-t,i,s,3),m("x","y","z",1,-1,e,t,r,i,n,4),m("x","y","z",-1,-1,e,t,-r,i,n,5),a>0&&(g("z","y","x",-1,-1,1,r,t,e,s,0),g("z","y","x",1,-1,-1,r,t,e,s,1),g("z","y","x",-1,1,-1,r,t,e,s,1),g("z","y","x",1,1,1,r,t,e,s,0),g("x","y","z",-1,-1,-1,e,t,r,i,0),g("x","y","z",1,-1,1,e,t,r,i,1),g("x","y","z",-1,1,1,e,t,r,i,0),g("x","y","z",1,1,-1,e,t,r,i,1),g("y","x","z",-1,-1,1,t,e,r,n,0),g("y","x","z",1,-1,-1,t,e,r,n,1),g("y","x","z",1,1,1,t,e,r,n,1),g("y","x","z",-1,1,-1,t,e,r,n,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new ze(u,3)),this.setAttribute("normal",new ze(h,3)),this.setAttribute("uv",new ze(d,2));function m(y,x,b,w,C,_,S,A,E,L,P){let D=(_-2*a)/E,I=(S-2*a)/L,B=_/2-a,X=S/2-a,H=A/2,R=E+1,q=L+1,F=0,z=0,U=new T;for(let K=0;K<q;K++){let j=K*I-X;for(let Y=0;Y<R;Y++){let V=Y*D-B;U[y]=V*w,U[x]=j*C,U[b]=H,u.push(U.x,U.y,U.z),U[y]=0,U[x]=0,U[b]=A>0?1:-1,h.push(U.x,U.y,U.z),d.push(Y/E),d.push(1-K/L),F+=1}}for(let K=0;K<L;K++)for(let j=0;j<E;j++){let Y=p+j+R*K,V=p+j+R*(K+1),ie=p+(j+1)+R*(K+1),$=p+(j+1)+R*K;c.push(Y,V,$),c.push(V,ie,$),z+=6}l.addGroup(f,z,P),f+=z,p+=F}function g(y,x,b,w,C,_,S,A,E,L,P){let D=(S-2*a)/L,I=S/2-a,B=A/2-a,X=E/2,H=L+1,R=0,q=0,F=new T,z=new T;for(let U=0;U<o+1;U++){let K=U/o*r3,j=Math.sin(K)*a,Y=(1-Math.cos(K))*a,V=Math.sin(K),ie=Math.cos(K);F[x]=(B+j)*C,F[b]=(X-Y)*_,z[y]=0,z[x]=V*Math.sign(F[x]),z[b]=ie*Math.sign(F[b]);for(let $=0;$<H;$++){let ee=$*D-I;F[y]=ee*w,u.push(F.x,F.y,F.z),h.push(z.x,z.y,z.z),d.push($/L),d.push(0),R+=1}}for(let U=0;U<o;U++)for(let K=0;K<L;K++){let j=p+K+H*U,Y=p+K+H*(U+1),V=p+(K+1)+H*(U+1),ie=p+(K+1)+H*U;c.push(j,Y,ie),c.push(Y,V,ie),q+=6}l.addGroup(f,q,P),f+=q,p+=R}function v(y,x,b){let w=new T,C=new T(e/2,t/2,r/2);C.subScalar(a);let _=[],S=y*x*b>0?(E,L,P)=>c.push(E,L,P):(E,L,P)=>c.push(E,P,L);for(let E=0;E<=o;E++){let L=[],P=r3*(1-E/o),D=Math.cos(P),I=Math.sin(P),B=0;for(let X=0;X<=E;X++){let H=Math.cos(B),R=Math.sin(B);w.x=D*H,w.y=I,w.z=D*R;let q=C.clone().addScaledVector(w,a);u.push(y*q.x,x*q.y,b*q.z),h.push(y*w.x,x*w.y,b*w.z),d.push(0,0),L.push(p++),B+=r3/E}_.push(L)}let A=_.length-1;for(let E=0;E<A;E++){let L=_[E],P=_[E+1],D=L.length-1;S(L[0],P[1],P[0]);for(let I=1;I<=D;I++)S(L[I-1],L[I],P[I]),S(L[I],P[I+1],P[I])}}}},u8=class extends nt{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),u(),this.setAttribute("position",new ze(a,3)),this.setAttribute("normal",new ze(l,3)),this.setAttribute("uv",new ze(o,2));return;function c(){var H;n=Math.min(1-1e-5,n),n==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],d=new T,p=d.clone(),f=new wi,m=n*i,g=i-m,v=s+1,y=new T,x=(R,q)=>y.subVectors(R,q).normalize(),b=(R,q)=>Array(R).fill(void 0).map(q),w=b(e.length/3,(R,q)=>new T().fromArray(e,q*3).setLength(i)),C=[],_=1e6;for(let R=0;R<w.length;R++){let q=w[R],F=[],z,U,K,j=1e10,Y=-1;for(;(Y=t.indexOf(R,Y+1))!=-1;){let ee=Y-Y%3;z=t[ee+(Y+1)%3],U=t[ee+(Y+2)%3],K=q.distanceToSquared(w[z]),j=Math.min(j,K),F.push([z,U,K])}j+=1e-6;let V=[],ie=0,$=F.length;for(let ee=0;ee<$;ee++){[z,U,K]=F[ie];let ne=((H=C[z])==null?void 0:H.includes(R))==!0;K<=j&&V.push(z+ +ne*_),ie=F.findIndex(ce=>ce[0]==U)}C.push(V)}let S=[];{let R=0,q=0,F,z,U=h==3;for(let K=0;K<=s;K++){F=K*(K+1)/2,z=(K+1)*(K+2)/2;for(let j=0;j<s-K;j++)[R,q]=[F+j+K+2,z+j+K+3],S.push(F,z,...U?[q,F]:[R,z],q,R),[F,z]=[R,q];S.push(F,z,F+s+2)}}let A=d.clone(),E=d.clone(),L=d.clone(),P=d.clone(),D=d.clone(),I=[],B=b(w.length,()=>b(h,()=>d.clone()));for(let R=0;R<w.length;R++){d.copy(w[R]).normalize(),A.copy(d).multiplyScalar(g);let q=C[R];for(let V=0;V<q.length;V++){let ie=q[V],$=q[(V+1)%h];f.setFromPointsAndIndices(w,R,ie%_,$%_),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(A,B[R][V])}let F=[],z=[],U=[],K=new T;s==0&&[...B[R]].reduce((V,ie)=>V.add(ie),K).multiplyScalar(1/h);for(let V=0;V<h;V++){let ie=[],$=(V-1+h)%h,ee=B[R][$],ne=B[R][V];d.copy(ee).sub(A),p.copy(ne).sub(A);let ce=A.angleTo(d),ue=d.angleTo(p),ye=Math.cos(ce)*m;s==0?E.copy(K):E.copy(A).setLength(g+ye),z.push(ye);let Re=[E,ee,ne];for(let Se=0;Se<2;Se++){let Ne=Re[Se],Oe=Re[Se+1];P.subVectors(Ne,A),D.subVectors(Oe,A),L.crossVectors(P,D).normalize();for(let Ae=0;Ae<v;Ae++){let _e=[ce,ue][Se]*Ae/v;d.copy(P).applyAxisAngle(L,_e).add(A),F.push(d.clone()),Se&&(x(d,A),ie.push([Ae==0?Ne:d.clone(),y.clone()]))}Se&&(x(Oe,A),ie.push([Oe,y.clone()]))}U.push(ie)}I.push(U);let j=2*v,Y=2;for(let V=0;V<h;V++){let ie=j*V,$=j*((V+1)%h),ee=[F[ie]];for(let ce=1;ce<v;ce++){P=F[ie+ce],D=F[$+ce],ee.push(P);for(let ue=1,ye=ce-Y+1;ue<=ye;ue++)d.lerpVectors(P,D,ue/(ye+1)),d.sub(A).setLength(z[V]).add(A),ee.push(d.clone());ee.push(D)}for(let ce=0;ce<v;ce++)ee.push(F[ce+v+ie]);ee.push(F[$+v]);let ne=S.map(ce=>ee[ce]);a.push(...ne.map(ce=>[ce.x,ce.y,ce.z]).flat()),l.push(...ne.map(ce=>(x(ce,A),[y.x,y.y,y.z])).flat())}}let X=[];for(let R=0;R<C.length;R++)for(let q=0;q<h;q++){let F=C[R][q];if(F<_){let z=C[F].findIndex(j=>j%_==R),U=I[R][q],K=I[F][z];for(let j=0;j<v;j++){let Y=U[j],V=K[v-j],ie=U[j+1],$=K[v-(j+1)];[Y,V,ie,ie,V,$].forEach(ee=>{a.push(ee[0].x,ee[0].y,ee[0].z),l.push(ee[1].x,ee[1].y,ee[1].z)})}X.push(U[0][0],K[v][0],U[v][0],K[0][0])}}for(;X.length;){let R,q,F,z;[R,q]=X.splice(0,2);let U=[R];for(;R!=q;)U.push(q),F=X.indexOf(q),z=F%2,q=X.splice(F-z,2)[1-z];y.subVectors(U[0],U[1]).cross(d.subVectors(U[0],U[2])).normalize();let K=y.dot(U[0])<0;K&&y.negate();for(let j=1;j<=U.length-2;j++)[U[j+ +K],U[j+1-+K],U[0]].forEach(Y=>{a.push(Y.x,Y.y,Y.z),l.push(y.x,y.y,y.z)})}}function u(){let h=new T;for(let C=0;C<a.length;C+=3){h.x=a[C+0],h.y=a[C+1],h.z=a[C+2];let _=b(h)/2/Math.PI+.5,S=w(h)/Math.PI+.5;o.push(_,1-S)}let d=new T,p=new T,f=new T,m=new T,g=new W,v=new W,y=new W,x=(C,_,S,A)=>{A<0&&C.x===1&&(o[_]=C.x-1),S.x===0&&S.z===0&&(o[_]=A/2/Math.PI+.5)};for(let C=0,_=0;C<a.length;C+=9,_+=6){d.set(a[C+0],a[C+1],a[C+2]),p.set(a[C+3],a[C+4],a[C+5]),f.set(a[C+6],a[C+7],a[C+8]),g.set(o[_+0],o[_+1]),v.set(o[_+2],o[_+3]),y.set(o[_+4],o[_+5]),m.copy(d).add(p).add(f).divideScalar(3);let S=b(m);x(g,_+0,d,S),x(v,_+2,p,S),x(y,_+4,f,S)}for(let C=0;C<o.length;C+=6){let _=o[C+0],S=o[C+2],A=o[C+4],E=Math.max(_,S,A),L=Math.min(_,S,A);E>.9&&L<.1&&(_<.2&&(o[C+0]+=1),S<.2&&(o[C+2]+=1),A<.2&&(o[C+4]+=1))}function b(C){return Math.atan2(C.z,-C.x)}function w(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}}static fromJSON(e){return new u8(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},koe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new rO(t*.5,s,a):new gD(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},rO=class extends u8{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new rO(e.radius,e.corner,e.cornerSides)}},sp=1e-12,d8=class{constructor(e){this.position=new W,this.startPosition=new W,this.uuid=gt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new d8(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},ux=class extends d8{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new ux(this.parent).copy(this)}},Eu=class extends d8{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new ux(this),new ux(this))}static create(e,t){let r=new Eu(e,new W(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new Eu(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new W,t=new W){let[r,i]=this.computeTangents();return r&&i&&(W_(r,e),W_(i,t)),[e,t]}computeTangent(e=new W){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new W){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function W_(e,t=new W){let r=e.length();return t.set(-e.y/r,e.x/r)}var p8=e=>e,Ed=new W,e2=new W,Noe=new W,zoe=new W,Foe=new W,joe=new W,iO=new T,nO=new T;function Uoe(e){let t=new W;t.addVectors(e.v0,Ed.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new W;return r.addVectors(e.v2,e2.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new ws(e.v0,t,r,e.v2)}function Lp(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function Voe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function Hoe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function sO(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function Goe(e,t,r){return X_(e,t)&&X_(t,r)&&dx(e.position,t.position,r.position)}function dx(e,t,r){return Ed.copy(t).sub(e).cross(e2.copy(r).sub(e))===0}function Woe(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),n.set(o-l,a-c),[i,n]}function qoe(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function Xoe(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,c=r.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),h;return sO(t,e,r)>Math.PI&&(u*=-1),Lp(c,o)?h=(o+c)*(i/u-.5)*8/3/(a-l):h=(a+l)*(i/u-.5)*8/3/(c-o),n.set(t.x-h*o,t.y+h*a),s.set(r.x+h*c,r.y-h*l),[n,s]}function q_(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function X_(e,t){return dx(e.position,e.controls[1].position,t.position)&&dx(e.position,t.controls[0].position,t.position)}function Yoe(e,t,r,i,n=.5){let s=Ed.subVectors(t,e).multiplyScalar(n).add(e),a=e2.subVectors(r,t).multiplyScalar(n).add(t),o=Noe.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=zoe.subVectors(a,s).multiplyScalar(n).add(s),u=Foe.subVectors(o,a).multiplyScalar(n).add(a),h=o,d=joe.subVectors(u,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,u.x,u.y,h.x,h.y,i.x,i.y]}function Qoe(e,t,r=12,i=!0){let n=nO.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=p8(t[o]),c=Ed,u=Mc(l,r);for(let h=0;h<=u;h++)if(l instanceof ws||l instanceof Cl||l instanceof Ts){if(l.getPoint(h/u,c),n.set(c.x,c.y,0),s!==void 0&&Hoe(s,n))continue;s===void 0&&(s=iO),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function Koe(e,t,r,i=12,n=!0){let s=nO.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,u=p8(t[l]),h=Ed,d=Mc(u,i);o.push(d);for(let p=0;p<=d;p++)if(u instanceof ws||u instanceof Cl||u instanceof Ts){if(u.getPoint(p/d,h),s.set(h.x,h.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=iO:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function Y_(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=Mc(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=Mc(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=Mc(e[0].roundedCurveCorner,t)*.5),i}function Mc(e,t=12){return e&&e instanceof zv?t*2:e&&(e instanceof Ts||e instanceof dD)?1:e&&e instanceof A7?t*e.points.length:t}function Zoe(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=p8(t[a]),l=Mc(o,r),c=Ed;for(let u=0;u<=l;u++)if(o instanceof ws||o instanceof Cl||o instanceof Ts){if(o.getPoint(u/l,c),n!==void 0&&Voe(n,c,sp))continue;n===void 0&&(n=e2),n.copy(c),e.push(c.x,c.y),s++}}return Lp(e[0],e[e.length-2],sp)&&Lp(e[1],e[e.length-1],sp)&&(e.pop(),e.pop()),i&&s>1&&!(Lp(e[s-1],e[1],sp)&&Lp(e[s-2],e[0],sp))&&(e.push(e[0],e[1]),s++),e}var i3=new W,Joe=new W,$oe=new W,ele=new W,tle=new W,rle=new W,mr=class extends Cg{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new xn(new T(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=gt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new mr;return i.isClosed=e.isClosed,i.points=e.points.map(n=>Eu.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>mr.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length,l=a.getPointIndexById(e);if(l<0)i+=o;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=e-t;if(s<=n.points.length-1)return n.points[s];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=i3.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i];s.position.multiply(r),s.controls[0].position.multiply(r),s.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=gt.generateUUID()){let i;e instanceof W?i=e:i=new W(e,t);let n=new Eu(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return Qoe(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=Y_(this.points,e,!1),this.roundedCurveDivisions=Y_(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return Koe(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),Zoe(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=Mc(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=i.reduce((a,o)=>a+o,0));for(let a=0,o=i.length;a<o;a++){let l=i[a];if(s<r+l)return[a,(s-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(q_(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(i3.set(r.x,r.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){q_(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],s=this.points[r-1]??this.points[this.points.length-1],a=this.points[r+1]??this.points[0],o=n.roundness,l=s&&a&&Goe(s,n,a);if(!n.controlsMoved()&&o>0&&!l){let c=n.curveBefore,u=n.curveAfter;if(c===void 0||u===void 0)continue;let h=n.roundedCurveBefore,d=n.roundedCurveAfter,p=c.getLength(),f=u.getLength(),m=Math.min(o,p*.499),g=Math.min(o,f*.499),v=Math.min(m,g),y=1-v/p,x=v/f,b=c.getPointAt(y,i3),w=u.getPointAt(x,Joe);this._subSplitCurve(c,h,y,b,void 0),this._subSplitCurve(u,d,x,void 0,w);let C;if(this.useCubicForRoundedCorners){let _=sO(b,n.position,w)/2,S=Math.tan(_)*b.distanceTo(n.position),[A,E]=Woe(b,w,S,$oe,ele),L=qoe(A,E,n.position),[P,D]=Xoe(L,b,w,S,tle,rle);C=new ws(b.clone(),P.clone(),D.clone(),w.clone())}else C=new Cl(b.clone(),n.position.clone(),w.clone());n.roundedCurveCorner=C,this.roundedCurves.splice(r+t,0,C),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof Ts)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(r,0),l=Yoe(s.v0,s.v1,s.v2,s.v3,o);return i!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new mr(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],c=e.points[n+4],u=e.points[n+5],h=e.points[n+6],d=new Eu(gt.generateUUID(),new W(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(c,u),d.roundness=h,this.points.push(d)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new mr;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=(i,n)=>{n instanceof ws&&n.v3.equals(i.position)&&i.controls[0].position.copy(n.v2)},r=i=>{let n=[],s,a;for(s=0,a=i.length;s<a;s++)i[s]instanceof Cl&&(i[s]=Uoe(i[s]));for(s=0,a=i.length;s<a;s++){let c=i[s],u=s>0?i[s-1]:null,h;c instanceof ws?(h=this.createPoint(c.v0),h.controls[1].position.copy(c.v1)):c instanceof Ts&&(h=this.createPoint(c.v1)),h!==void 0&&(u!==null&&t(h,u),n.push(h))}let o=i[i.length-1],l=!1;return o instanceof ws?o.v3.equals(n[0].position)&&(n[0].controls[0].position.copy(o.v2),l=!0):o instanceof Ts&&o.v2.equals(n[0].position)&&(l=!0),this.isClosed=l,n};return this.points=r(e.curves),e instanceof Cg&&(this.shapeHoles=e.holes.map(i=>{let n=new mr;return n.fromShape(i),n})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},px=Math.PI*2;function n3({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function ile(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function Q_(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function nle(e,t,r,i,n,s,a,o,l,c){let u=Math.pow(n,2),h=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=u*h-u*p-h*d;f<0&&(f=0),f/=u*p+h*d,f=Math.sqrt(f)*(l===c?-1:1);let m=f*n/s*o,g=f*-s/n*a,v=m+(e+r)/2,y=g+(t+i)/2,x=(a-m)/n,b=(o-g)/s,w=(-a-m)/n,C=(-o-g)/s,_=Q_(1,0,x,b),S=Q_(x,b,w,C);return!c&&S>0&&(S-=px),c&&S<0&&(S+=px),{centerx:v,centery:y,ang1:_,ang2:S}}function sle({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let c=(e-r)/2,u=(t-i)/2;if(c===0&&u===0)return[];n=Math.abs(n),s=Math.abs(s);let h=Math.pow(c,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(s,2);h>1&&(n*=Math.sqrt(h),s*=Math.sqrt(h));let d=nle(e,t,r,i,n,s,c,u,a,o),{ang1:p,ang2:f}=d,{centerx:m,centery:g}=d,v=Math.abs(f)/(px/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);f/=y;for(let x=0;x<y;x++)l.push(ile(p,f)),p+=f;return l.map(x=>{let{x:b,y:w}=n3(x[0],n,s,m,g),{x:C,y:_}=n3(x[1],n,s,m,g),{x:S,y:A}=n3(x[2],n,s,m,g);return{x1:b,y1:w,x2:C,y2:_,x:S,y:A}})}var Ft;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Ft||(Ft={}));var Or;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Or||(Or={}));function rt(e,t){if(!e)throw t||"Assertion Failed!"}var Ke=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){rt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){rt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){rt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){rt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),ap=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),Bm=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),Bh=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),K_=function(){function e(){var t=new Bh,r=new ap,i=new Bm(0),n=new Bm(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new Bm(0),i=new Bm(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;rt(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;rt(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new Bh,r=new Bh,i=new ap,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new Bh;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new ap;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new ap;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new Bh;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new ap;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&Ke.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&Ke.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,c;for(s=t,s=t;(n=s.next)!==t;s=n){rt(n.prev===s),l=n.anEdge;do rt(l.Sym!==l),rt(l.Sym.Sym===l),rt(l.Lnext.Onext.Sym===l),rt(l.Onext.Sym.Lnext===l),rt(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(rt(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){rt(a.prev===o),l=a.anEdge;do rt(l.Sym!==l),rt(l.Sym.Sym===l),rt(l.Lnext.Onext.Sym===l),rt(l.Onext.Sym.Lnext===l),rt(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(rt(a.prev===o&&a.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)rt(l.Sym.next===c.Sym),rt(l.Sym!==l),rt(l.Sym.Sym===l),rt(l.Org!==null),rt(l.Dst!==null),rt(l.Lnext.Onext.Sym===l),rt(l.Onext.Sym.Lnext===l);rt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),Z_=function(){function e(){this.handle=null}return e}(),J_=function(){function e(){this.key=null,this.node=0}return e}(),ale=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new Z_,this.handles[i]=new J_;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,rt(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new Z_;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new J_}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;rt(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),s3=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),$_=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),ole=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new $_,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new $_;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),lle=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?Ke.vertLeq(s.Org,a.Org)?Ke.edgeSign(a.Dst,s.Org,a.Org)<=0:Ke.edgeSign(s.Dst,a.Org,s.Org)>=0:Ke.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return Ke.edgeSign(s.Dst,n,s.Org)>=0;var o=Ke.edgeEval(s.Dst,n,s.Org),l=Ke.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&rt(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){rt(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new s3;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case Ft.ODD:return(r&1)!==0;case Ft.NONZERO:return r!==0;case Ft.POSITIVE:return r>0;case Ft.NEGATIVE:return r<0;case Ft.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,c,u,h=!0;c=i;do rt(Ke.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),h=!1,l=o,u=c;l.dirty=!0,rt(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=Ke.vertL1dist(r,t),s=Ke.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(Ke.vertLeq(n.Org,s.Org)){if(Ke.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;Ke.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(Ke.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if(rt(!Ke.vertEq(n.Dst,s.Dst)),Ke.vertLeq(n.Dst,s.Dst)){if(Ke.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if(Ke.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,c=s.Dst,u,h,d=new Bh,p,f;if(rt(!Ke.vertEq(c,l)),rt(Ke.edgeSign(l,t.event,a)<=0),rt(Ke.edgeSign(c,t.event,o)>=0),rt(a!==t.event&&o!==t.event),rt(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),h=Math.max(o.t,c.t),u>h))return!1;if(Ke.vertLeq(a,o)){if(Ke.edgeSign(c,a,o)>0)return!1}else if(Ke.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),Ke.intersect(l,a,c,o,d),rt(Math.min(a.t,l.t)<=d.t),rt(d.t<=Math.max(o.t,c.t)),rt(Math.min(c.s,l.s)<=d.s),rt(d.s<=Math.max(o.s,a.s)),Ke.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),p=Ke.vertLeq(a,o)?a:o,Ke.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),Ke.vertEq(d,a)||Ke.vertEq(d,o)?(e.checkForRightSplice(t,r),!1):!Ke.vertEq(l,t.event)&&Ke.edgeSign(l,t.event,d)>=0||!Ke.vertEq(c,t.event)&&Ke.edgeSign(c,t.event,d)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),f=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,f,!0),!0):(Ke.edgeSign(l,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),Ke.edgeSign(c,t.event,d)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),Ke.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),Ke.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,r,i.Onext,s,s,!0);return}Ke.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,Ke.vertEq(n.Org,i)){rt(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!Ke.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}rt(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(rt(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),Ke.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,c=new s3;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,Ke.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=Ke.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,r.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);rt(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new s3,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new ole(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(rt(r.fixUpperEdge),rt(++i===1)),rt(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,Ke.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new ale(s,Ke.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,rt(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!Ke.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),cle=function(){function e(){this.mesh=new K_,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Ft.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],c=[0,0,0],u=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],f=[null,null,null],m=this.mesh.vHead;r=m.next;for(var g=0;g<3;++g)s=r.coords[g],c[g]=s,f[g]=r,l[g]=s,p[g]=r;for(r=m.next;r!==m;r=r.next)for(var v=0;v<3;++v)s=r.coords[v],s<c[v]&&(c[v]=s,f[v]=r),s>l[v]&&(l[v]=s,p[v]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=f[y],n=p[y],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=m.next;r!==m;r=r.next)h[0]=r.coords[0]-n.coords[0],h[1]=r.coords[1]-n.coords[1],h[2]=r.coords[2]-n.coords[2],d[0]=u[1]*h[2]-u[2]*h[1],d[1]=u[2]*h[0]-u[0]*h[2],d[2]=u[0]*h[1]-u[1]*h[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;Ke.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;Ke.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if(Ke.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(Ke.edgeGoesLeft(n.Lnext)||Ke.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(Ke.edgeGoesRight(i.Lprev)||Ke.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,r===Or.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var h=c.n*n;this.vertices[h+0]=c.coords[0],this.vertices[h+1]=c.coords[1],n>2&&(this.vertices[h+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1;if(r===Or.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new K_),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=Ft.ODD),r===void 0&&(r=Or.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),lle.computeInterior(this,a);var o=this.mesh;return r===Or.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===Or.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function $o(e){var t=e.windingRule,r=t===void 0?Ft.ODD:t,i=e.elementType,n=i===void 0?Or.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,u=c===void 0?[0,0,1]:c,h=e.contours,d=h===void 0?[]:h,p=e.strict,f=p===void 0?!0:p,m=e.debug,g=m===void 0?!1:m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var v=new cle;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(r,n,a,l,u,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}Ft.ODD;Ft.NONZERO;Ft.POSITIVE;Ft.NEGATIVE;Ft.ABS_GEQ_TWO;Or.POLYGONS;Or.CONNECTED_POLYGONS;Or.BOUNDARY_CONTOURS;var fx=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*fx.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*fx.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},aO=fx;aO.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var hle=hd(zH()),f8={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},oO={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},lO={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},a3=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),m8=class extends nt{constructor(e,t,r=0,i=12,n=3,s=Ft.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(A=>{let E=A.extractShapePointsToFlatArray([],i),L=[];for(let P=E.length-1;P>=1;P-=2){let D=E[P-1],I=E[P-0];L.push(D,I)}return L}),c=[],u=[];for(let A=0;A<o.length;A+=2)u.push([o[A],o[A+1]]);c.push(u);for(let A=0;A<l.length;A++){let E=l[A],L=[];for(let P=0;P<E.length;P+=2)L.push([E[P],E[P+1]]);c.push(L)}let h=c[0].length?(0,hle.default)(c).distance:r;r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,h,t/2),this._bevelSegments=Math.floor(n));let d;try{d=$o({windingRule:s,elementType:Or.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{d=f8}let p;try{p=$o({windingRule:Ft.ODD,elementType:Or.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=oO}if(!d)throw new Error("error generating geometry");let f=d.elementCount;if(p){d.elementCount+=p.elementCount;for(let A=0;A<p.elements.length;A++){let E=p.elements[A],L=A%2===0?d.vertexCount:0;d.elements.push(E+L)}for(let A=0;A<p.vertexIndices.length;A++){let E=p.vertexIndices[A],L=d.vertexCount;d.vertexIndices.push(E+L)}for(let A=0;A<p.vertices.length;A++){let E=p.vertices[A];d.vertices.push(E)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let A=0,E=d.vertexCount;A<E;A++){let L=A*2,P=d.vertices[L+0],D=d.vertices[L+1];P<m&&(m=P),P>g&&(g=P),D<v&&(v=D),D>y&&(y=D)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new aO(this._computeBufferEstimatedSize(d));let x=[],b=[];for(let A=d.elementCount-1;A>=0;A--){let E=A>=f,L=A*2,P=d.elements[L+0],D=d.elements[L+1],I=P+D,B={start:P,count:D,normals:[],continuous:[],concave:[]},X=P,H=I-1,R=P+1,q=this._shape.roundedCurves.length;do{let j=X-P,Y=d.vertices[H*2+0],V=d.vertices[H*2+1],ie=d.vertices[X*2+0],$=d.vertices[X*2+1],ee=d.vertices[R*2+0],ne=d.vertices[R*2+1],ce=ie-Y,ue=$-V,ye=Math.sqrt(ce*ce+ue*ue);ce/=ye,ue/=ye;let Re=ie-ee,Se=$-ne,Ne=Math.sqrt(Re*Re+Se*Se);Re/=Ne,Se/=Ne,B.normals[j*2+0]=-Se,B.normals[j*2+1]=Re,B.concave[j]=ce*Se-ue*Re>0;let Oe=d.vertexIndices[X];if(Array.isArray(Oe))B.continuous[j]=!1;else{let[Ae,_e]=this._shape.getCurveIndexFromVertexId(Oe-1,!0);if(_e>0&&_e<1)B.continuous[j]=!0;else{let Ue=_e===1?Ae+1:Ae-1;Ue=(Ue+q)%q;let qe=_e===1?0:1,N=this._shape.roundedCurves[Ae].getTangent(_e),O=this._shape.roundedCurves[Ue].getTangent(qe);B.continuous[j]=N.dot(O)>.95}}E&&(B.normals[j*2+0]*=-1,B.normals[j*2+1]*=-1),[H,X,R]=[X,R,R+1],R>=I&&(R-=D)}while(R!==P+1);let F=[];F.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(P*2,I*2),vertexCount:D,vertexIndices:new Array(D).fill(!0).map((j,Y)=>[Y,Y]),elements:[0,D],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(P*2,I*2)});let z=0;for(let j=1;j<=this._bevelSegments;j++){let Y=j/this._bevelSegments*Math.PI/2,V=(1-Math.cos(Y))*this._bevel,ie=[],$=[],ee=0;for(let ce=0;ce<D;ce++){let ue=ce*2,ye=(ce-1+D)%D*2,Re=d.vertices[B.start*2+ue+0],Se=d.vertices[B.start*2+ue+1],Ne=-B.normals[ye+0]*V,Oe=-B.normals[ye+1]*V,Ae=-B.normals[ue+0]*V,_e=-B.normals[ue+1]*V;if(B.concave[ce]||!B.concave[ce]&&E){let Ue=Math.atan2(Oe,Ne),qe=Math.atan2(_e,Ae);qe>Ue&&(qe-=Math.PI*2);let N=qe-Ue;if(B.continuous[ce]||E){let O=Ue+N/2,ae=Math.cos(O)*V,we=Math.sin(O)*V;ie[2*ee+0]=Re+ae*(E?-1:1),ie[2*ee+1]=Se+we*(E?-1:1),$[ee]=ce,ee++}else{let O=Math.max(1,Math.floor(i/4*Math.abs(N)/Math.PI));for(let ae=0;ae<=O;ae++){let we=Ue+N*(ae/O),xe=Math.cos(we)*V,Te=Math.sin(we)*V;ie[2*ee+0]=Re+xe,ie[2*ee+1]=Se+Te,$[ee]=ce,ee++}}}else ie[2*ee+0]=Re+Ne,ie[2*ee+1]=Se+Oe,$[ee]=ce,ee++,ie[2*ee+0]=Re,ie[2*ee+1]=Se,$[ee]=ce,ee++,ie[2*ee+0]=Re+Ae,ie[2*ee+1]=Se+_e,$[ee]=ce,ee++}let ne=$o({windingRule:Ft.POSITIVE,elementType:Or.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ie],edgeCreateCallback:ce=>{let ue=ce.Org.idx,ye=$[ue],Re=$[(ue+1)%$.length];ce.idx=[ye,Re],ce.Sym.idx=[Re,ye]},vertexIdCallback:ce=>{let ue=ce.Lprev.idx;return[ue?ue[1]:0,ce.idx?ce.idx[0]:0]}});if(!ne)throw console.log("Error"),new Error(`error generating bevel geometry for ${j}'th loop`);if(!ne.vertexCount){let ce=(j-1)/this._bevelSegments*Math.PI/2;z=(1-Math.sin(ce))*this._bevel;break}for(let ce=0;ce<ne.vertexIndices.length;ce++){let[ue,ye]=ne.vertexIndices[ce];if(ue===ye)continue;let Re=ye;ye<ue&&(Re+=D);for(let Se=ue;Se<Re;Se++){let Ne=Se%D,Oe=(Se+1)%D;if(!B.continuous[Ne]||!B.continuous[Oe]){ne.vertexIndices[ce]=[ue,Ne],ne.vertexIndices.splice(ce+1,0,[Oe,ye]),ne.vertices.splice((ce+1)*2,0,ne.vertices[ce*2],ne.vertices[ce*2+1]);break}}}F.push({bevelI:j,angle:Y,size:V,boundary:ne,reverseMap:$,insetPoints:ie})}let U=(j,Y,V)=>{let ie=0,$=j.boundary.vertexIndices.length;for(;ie<$&&V(j.boundary.vertexIndices[Y]);)Y=(Y+1)%$,ie++;return ie},K=x.length;for(let j=1;j<F.length;j++){let Y=F[j-1],V=F[j],ie=Y.boundary.vertexIndices.length,$=V.boundary.vertexIndices.length;if(!ie||!$)break;let ee=B.concave.length,ne=0,ce=a3(ne,D);for(;!Y.boundary.vertexIndices.filter(ce).length||!V.boundary.vertexIndices.filter(ce).length;)ne++,ce=a3(ne,D);let ue=Y.boundary.vertexIndices.findIndex(ce),ye=V.boundary.vertexIndices.findIndex(ce);do ue=(ue+1)%ie;while(ce(Y.boundary.vertexIndices[ue]));do ye=(ye+1)%$;while(ce(V.boundary.vertexIndices[ye]));ne=(ne+1)%D;let Re=ne,Se=0,Ne=this._buildBevelVert(B,Y,(ue-1+ie)%ie,void 0,Se),Oe=this._buildBevelVert(B,V,(ye-1+$)%$,void 0,Se),Ae=Ne,_e=Oe,Ue,qe,N=!1;do{Se=(ne||ee)/ee,ce=a3(ne,D);let O=U(Y,ue,ce),ae=U(V,ye,ce),we=N;if(N=!1,O&&!ae){for(let xe=0;xe<O;xe++)Ue=this._buildBevelVert(B,Y,(ue+xe)%ie,xe/(O-1),Se),x.push(Ae.topN,Ue.topP,_e.topN),a===!1&&x.push(Ue.bottomP,Ae.bottomN,_e.bottomN),Ae=Ue;N=!0}else if(!O&&ae)for(let xe=0;xe<ae;xe++)qe=this._buildBevelVert(B,V,(ye+xe)%$,xe/(ae-1),Se),x.push(_e.topN,Ae.topP,qe.topP),a===!1&&x.push(Ae.bottomP,_e.bottomN,qe.bottomP),_e=qe;else if(O&&ae)if(Ue=this._buildBevelVert(B,Y,ue,0,Se),qe=this._buildBevelVert(B,V,ye,0,Se),we?(x.push(Ae.topN,qe.topP,_e.topN),x.push(Ae.topN,Ue.topP,qe.topP),a===!1&&(x.push(qe.bottomP,Ae.bottomN,_e.bottomN),x.push(qe.bottomP,Ue.bottomP,Ae.bottomN))):(x.push(_e.topN,Ae.topN,Ue.topP),x.push(_e.topN,Ue.topP,qe.topP),a===!1&&(x.push(Ue.bottomP,Ae.bottomN,_e.bottomN),x.push(Ue.bottomP,_e.bottomN,qe.bottomP))),Ae=Ue,_e=qe,O===ae)for(let xe=1;xe<O;xe++)Ue=this._buildBevelVert(B,Y,(ue+xe)%ie,xe/(O-1),Se),qe=this._buildBevelVert(B,V,(ye+xe)%$,xe/(ae-1),Se),x.push(Ae.topN,Ue.topP,_e.topN),x.push(_e.topN,Ue.topP,qe.topP),a===!1&&(x.push(Ue.bottomP,Ae.bottomN,_e.bottomN),x.push(Ue.bottomP,_e.bottomN,qe.bottomP)),Ae=Ue,_e=qe;else if(O>ae){let xe=O/ae,Te=0;for(let Ge=1;Ge<O;Ge++)Ue=this._buildBevelVert(B,Y,(ue+Ge)%ie,Ge/(O-1),Se),x.push(Ae.topN,Ue.topP,_e.topN),a===!1&&x.push(Ue.bottomP,Ae.bottomN,_e.bottomN),Ae=Ue,Ge>(Te+1)*xe&&(Te++,qe=this._buildBevelVert(B,V,(ye+Te)%$,Te/(ae-1),Se),x.push(_e.topN,Ue.topP,qe.topP),a===!1&&x.push(Ue.bottomP,_e.bottomN,qe.bottomP),_e=qe)}else{let xe=ae/O,Te=0;for(let Ge=1;Ge<ae;Ge++)qe=this._buildBevelVert(B,V,(ye+Ge)%$,Ge/(ae-1),Se),x.push(_e.topN,Ue.topP,qe.topP),a===!1&&x.push(Ue.bottomP,_e.bottomN,qe.bottomP),_e=qe,Ge>(Te+1)*xe&&(Te++,Ue=this._buildBevelVert(B,Y,(ue+Te)%ie,Te/(O-1),Se),x.push(Ae.topN,Ue.topP,_e.topN),a===!1&&x.push(Ue.bottomP,Ae.bottomN,_e.bottomN),Ae=Ue)}ue=(ue+O)%ie,ye=(ye+ae)%$,ne=(ne+1)%ee}while(ne!==Re)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(F,B,x),E){let j=[];for(let Y=x.length-1;Y>=K+2;Y-=3){let V=x[Y-2],ie=x[Y-1],$=x[Y-0];j.push($,ie,V)}x.splice(K,x.length-K,...j)}if(E){let j=[];for(let Y=F[F.length-1].boundary.vertices.length-1;Y>=1;Y-=2){let V=F[F.length-1].boundary.vertices[Y-1],ie=F[F.length-1].boundary.vertices[Y-0];j.push(V,ie)}b.push(j)}if(!E){let j=F[F.length-1],Y;try{Y=$o({windingRule:F.length>1?Ft.POSITIVE:Ft.ODD,elementType:Or.POLYGONS,vertexSize:2,strict:!0,contours:[j.insetPoints,...b]})}catch{Y=lO}if(!Y)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let V=0;V<Y.elementCount*3;V+=3){let ie=this._buildSurfaceVert(Y,Y.elements[V+0],z),$=this._buildSurfaceVert(Y,Y.elements[V+1],z),ee=this._buildSurfaceVert(Y,Y.elements[V+2],z);x.push(ie.top,$.top,ee.top),a===!1&&x.push(ee.bottom,$.bottom,ie.bottom)}}this.vertexCache={}}this._buffer.shrink();let w=new st(Uint32Array.from(x),1),C=new st(this._buffer.positions,3),_=new st(this._buffer.normals,3),S=new st(this._buffer.uvs,2);C.needsUpdate=!0,_.needsUpdate=!0,S.needsUpdate=!0,w.needsUpdate=!0,this.setAttribute("position",C),this.setAttribute("normal",_),this.setAttribute("uv",S),this.setIndex(w)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[i]=h,h}_buildBevelVert(e,t,r,i=1,n){let s=`${t.bevelI}:${r}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[r],l,c,u,h;a!==o?(c=a,l=o,h=!1,u=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,h=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||h);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=r*2,m=l*2,g=c*2,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],x=(1-p)*this._bevel,b=(v-this._minX)/this._width,w=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(b=n),w=1);let C=e.normals[m+0],_=e.normals[m+1],S=e.normals[g+0],A=e.normals[g+1];if(h){let I=S-C,B=A-_;C=C+I*(1-i),_=_+B*(1-i);let X=Math.sqrt(C*C+_*_);C/=X,_/=X}let E=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),L=E*3,P=E*2,D={i:r,fi:l,topP:E+0,topN:E+0,bottomP:E+1,bottomN:E+1,pathBevelUCoord:n};return this._buffer.positions[L+0]=v,this._buffer.positions[L+1]=y,this._buffer.positions[L+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[L+0]=C*d,this._buffer.normals[L+1]=_*d,this._buffer.normals[L+2]=p,this._buffer.uvs[P+0]=b,this._buffer.uvs[P+1]=w,this.forPathBevel===!1&&(this._buffer.positions[L+3]=v,this._buffer.positions[L+4]=y,this._buffer.positions[L+5]=x,this._buffer.normals[L+3]=C*d,this._buffer.normals[L+4]=_*d,this._buffer.normals[L+5]=-p,this._buffer.uvs[P+2]=w,this._buffer.uvs[P+3]=b),u||(this.forPathBevel?(E+=1,L+=3,P+=2):(E+=2,L+=6,P+=4),D.topP=E+0,D.bottomP=E+1,this._buffer.positions[L+0]=v,this._buffer.positions[L+1]=y,this._buffer.positions[L+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[L+0]=S*d,this._buffer.normals[L+1]=A*d,this._buffer.normals[L+2]=p,this._buffer.uvs[P+0]=b,this._buffer.uvs[P+1]=w,this.forPathBevel===!1&&(this._buffer.positions[L+3]=v,this._buffer.positions[L+4]=y,this._buffer.positions[L+5]=x,this._buffer.normals[L+3]=S*d,this._buffer.normals[L+4]=A*d,this._buffer.normals[L+5]=-p,this._buffer.uvs[P+2]=w,this._buffer.uvs[P+3]=b)),this.vertexCache[s]=D,D}clone(){let e=new m8(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Xv(this.userData),e}},cO=class extends nt{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=Ft.ODD,this.elementType=Or.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Ft.ODD,elementType:Or.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let d=0,p=i.length/2;d<p;d++){let f=d*2,m=i[f+0],g=i[f+1];if(l!==void 0&&m!==l&&(a=!1),c!==void 0&&g!==c&&(o=!1),l=m,c=g,!a&&!o)break}if(!a&&!o)try{s=$o({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=f8}let u=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new st(new Float32Array(u*3),3),this._normalAttribute=new st(new Float32Array(u*3),3),this._uvAttribute=new st(new Float32Array(u*2),2),this._indexAttribute=new st(new Uint32Array(h*3),1),s){let d=1/0,p=-1/0,f=1/0,m=-1/0;for(let y=0,x=u;y<x;y++){let b=y*2,w=s.vertices[b+0],C=s.vertices[b+1];w<d&&(d=w),w>p&&(p=w),C<f&&(f=C),C>m&&(m=C)}let g=p-d,v=m-f;for(let y=0,x=u;y<x;y++){let b=y*2,w=s.vertices[b+0],C=s.vertices[b+1],_=(w-d)/g,S=(C-f)/v;this._positionAttribute.setXYZ(y,w,C,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,_,S)}for(let y=0,x=h;y<x;y++){let b=y*3,w=s.elements[b+0],C=s.elements[b+1],_=s.elements[b+2];this._indexAttribute.setX(b+0,w),this._indexAttribute.setX(b+1,C),this._indexAttribute.setX(b+2,_)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new cO(this._shape,this._curveSegments);return e.userData=Xv(this.userData),e}},hO=class extends m8{constructor(e,t,r=0,i=12,n=3,s=Ft.ODD){super(e,t,r,i,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new hO(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Xv(this.userData),e}},Kc=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,u;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Ft.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??r.roundness;a!==void 0&&(a instanceof mr?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new mr(i,n).fromJSON(a),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((u=e.parameters)==null?void 0:u.roundness)>0&&a.update());let l=a??new mr(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new cO(e.shape,n,{windingRule:a}):o=new hO(e.shape,t,r,n,i,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},uO=Math.PI*2,g8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof mr?e.shape:new mr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,h=r*.5,d=ule(c,u,h,n*Math.PI/180,i,s);c.isClosed=!0,c.update();let p=Kc.create({shape:c,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(p,{userData:{...e,type:"EllipseGeometry"}})}};function ule(e,t,r,i,n,s){if(i>=uO)return n>30||n%4===0?(ple(e,t,r,s),Math.round(n/4)):eA(e,i,n,t,r,s);i=Math.max(i,.001);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=sle({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?dle(e,a.x,a.y,c,n,t,r,s):eA(e,i,n,t,r,s)}function dle(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(Mu(t,r));for(let c=0,u=i.length;c<u;c++){let h=i[c],d=e.points[c],p=Mu(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),p.controls[0].position.set(h.x2,h.y2),e.addPoint(p)}return o>0?dO(e,s,a,o):e.addPoint(Mu(0,0)),l}function eA(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,c=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(Mu(c,u))}return t<uO?s>0?dO(e,i,n,s):e.addPoint(Mu(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&pO(e,i,n,s)),1}function ple(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(km(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(km(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(km(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(km(n,s-r,n+o,s-r,n-o,s-r)),i>0&&pO(e,t,r,i)}function Mu(e,t){return new Eu(gt.generateUUID(),new W(e,t))}function km(e,t,r,i,n,s){let a=Mu(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function dO(e,t,r,i){fO(e,t,r,i).forEach(n=>e.addPoint(n))}function pO(e,t,r,i){let n=fO(e,t,r,i),s=new mr;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function fO(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new W(n/t,s/r),o=e.points.map(l=>{let c=l.clone();return c.uuid=gt.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),o}var fle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),s=Math.abs(r.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:h}=e.parameters,d=new mO(!1,t,r,i,n,s,a,o,l,c,u,h);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},o3=new yu([0,0,0],1),mO=class extends nt{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,c=1,u=1,h=1){if(super(),s===0)return;let d=e&&s===1;d&&(h=0),u>100&&(u=100),u===0&&(h=0);let p=()=>new T,f=new T,m=p(),g=p(),v=p(),y,x,b,w,C,_,S,A,E=p(),L=p(),P=p(),D=p(),I=p(),B=p(),X=p(),H=p(),R=r-2*o+.001,q=R/s,F=Math.ceil(a*s),z=F+1,U=R/F,K=-R/2,j=c+1,Y=2*Math.PI/c,V=Math.PI/2/h,ie=.01,$=Math.min((1-u/100)*o,o-ie),ee=o-$,ne=0,ce=2,ue=h*ce+ce,ye=j*ue/ce,Re=ye+j*z,Se=j*(z+ue),[Ne,Oe,Ae]=[3,3,2].map(pe=>Array(Se*pe).fill(0)),_e=[],Ue=n-o;function qe(pe,Ve){let Xe=Math.PI/2;_=Ve*U,A=2*Math.PI*(_%q)/q+Xe,_+=K,S=Math.sin(A)*Ue,C=Math.cos(A)*Ue,e?pe.set(C,S,_):pe.set(C,_,S)}qe(f,-1e-10),qe(m,0),E.copy(f),qe(f,1);let N=f.distanceTo(m),O=d?0:ee+$,ae=N*F+2*O,we=$,xe=ae-O;for(let pe=0;pe<=F;pe++){qe(g,pe),H.subVectors(g,E).normalize(),E.copy(g),B.copy(g).setComponent(+e+1,0).normalize(),X.crossVectors(H,B).normalize();let Ve=pe===0,Xe=pe===F,Ye=Ve?3*Math.PI/2:V,Q=Ve?we:xe,J=Ve?j:Re,de=Ve?0:Se-j,Me=H.clone().multiplyScalar(Ve?-ee:ee).add(g),He=H.clone().multiplyScalar(Ve?-1:1).normalize();for(let G=0;G<j;G++){let te=G*Y;if(L.addVectors(f.copy(B).multiplyScalar(o*Math.cos(te)),m.copy(X).multiplyScalar(o*Math.sin(te))),P.copy(L).normalize(),Ve||Xe){d||(ne=de+G,[0,1,2].forEach(se=>{Ne[ne*3+se]=Me.getComponent(se),Oe[ne*3+se]=He.getComponent(se)}),Ae[ne*2]=+Xe,Ae[ne*2+1]=G/c),m.copy(P).multiplyScalar($),v.addVectors(g,m);for(let se=0;se<h;se++){let me=se*V+Ye;D.addVectors(f.copy(H).multiplyScalar(ee*Math.sin(me)),m.copy(P).multiplyScalar(ee*Math.cos(me))),I.copy(D).normalize(),m.addVectors(v,D),D.normalize(),ne=J+se*j+G,[0,1,2].forEach(et=>{Ne[ne*3+et]=m.getComponent(et),Oe[ne*3+et]=I.getComponent(et)});let De=+Ve+Math.sin(me);Ae[ne*2]=(Q+ee*De)/ae,Ae[ne*2+1]=G/c}}m.addVectors(g,L),ne=ye+pe*j+G,[0,1,2].forEach(se=>{Ne[ne*3+se]=m.getComponent(se),Oe[ne*3+se]=P.getComponent(se)}),Ae[ne*2]=(O+pe*N)/ae,Ae[ne*2+1]=G/c}}let Te=z+2*h+ce,[Ge,Ie]=[+d,Te-1];for(let pe=Ge;pe<=Ie-1;pe++){let Ve=d&&pe===Ie-1;for(let Xe=0;Xe<j-1;Xe++)y=pe*j+Xe,x=y+1,b=(Ve?Xe:y)+j,w=(Ve?Xe+1:x)+j,pe===0?_e.push(x,w,b):pe===Te-2?_e.push(y,x,b):_e.push(y,x,b,x,w,b)}this.setIndex(_e),this.setAttribute("position",new ze(Ne,3)),this.setAttribute("normal",new ze(Oe,3)),this.setAttribute("uv",new ze(Ae,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let h=0;h<e.radialSegments;h++)n=c*r+h,s=n+1,a=(u?h:n)+r,o=(u?h+1:s)+r,i[l++]=n,i[l++]=s,i[l++]=a,i[l++]=s,i[l++]=o,i[l++]=a;return i.length=l,o3.array=i,o3.count=i.length,o3}},mle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new gO(t*.5,s,a):new wD(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},gO=class extends u8{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new gO(e.radius,e.corner,e.cornerSides)}},gle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new Cg;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new fD(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},js=new Ce,l3=new Vt,Nm=new T,Jg=class extends pi{constructor(){super(),this.uuid=gt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new ti().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return js.makeRotationX(e),this.applyMatrix4(js),this}rotateY(e){return js.makeRotationY(e),this.applyMatrix4(js),this}rotateZ(e){return js.makeRotationZ(e),this.applyMatrix4(js),this}translate(e,t,r){return js.makeTranslation(e,t,r),this.applyMatrix4(js),this}scale(e,t,r){return js.makeScale(e,t,r),this.applyMatrix4(js),this}lookAt(e){return l3.lookAt(e),l3.updateMatrix(),this.applyMatrix4(l3.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<n.count;h++)t.vertices.push(new T().fromBufferAttribute(n,h)),a!==void 0&&t.colors.push(new $e().fromBufferAttribute(a,h));function c(h,d,p,f){let m=a===void 0?[]:[t.colors[h].clone(),t.colors[d].clone(),t.colors[p].clone()],g=s===void 0?[]:[new T().fromBufferAttribute(s,h),new T().fromBufferAttribute(s,d),new T().fromBufferAttribute(s,p)],v=new mx(h,d,p,g,m,f);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new W().fromBufferAttribute(o,h),new W().fromBufferAttribute(o,d),new W().fromBufferAttribute(o,p)]),l!==void 0&&t.faceVertexUvs[1].push([new W().fromBufferAttribute(l,h),new W().fromBufferAttribute(l,d),new W().fromBufferAttribute(l,p)])}let u=e.groups;if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h],p=d.start,f=d.count;for(let m=p,g=p+f;m<g;m+=3)r!==void 0?c(r.getX(m),r.getX(m+1),r.getX(m+2),d.materialIndex):c(m,m+1,m+2,d.materialIndex)}else if(r!==void 0)for(let h=0;h<r.count;h+=3)c(r.getX(h),r.getX(h+1),r.getX(h+2));else for(let h=0;h<n.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Nm).negate(),this.translate(Nm.x,Nm.y,Nm.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new Ce;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new T,t=new T;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new T;if(e){let r=new T,i=new T;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];r.subVectors(c,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new Jg;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new T,c={a:new T,b:new T,c:new T};n.push(l),s.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Er),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ln),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(i=new ti().getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let p=a[h].clone();t!==void 0&&p.applyMatrix4(t),s.push(p)}for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone());for(let h=0,d=l.length;h<d;h++){let p=l[h],f,m,g=p.vertexNormals,v=p.vertexColors,y=new mx(p.a+n,p.b+n,p.c+n);y.normal.copy(p.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let x=0,b=g.length;x<b;x++)f=g[x].clone(),i!==void 0&&f.applyMatrix3(i).normalize(),y.vertexNormals.push(f);y.color.copy(p.color);for(let x=0,b=v.length;x<b;x++)m=v[x],y.vertexColors.push(m.clone());y.materialIndex=p.materialIndex+r,o.push(y)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,x=g.length;y<x;y++)v.push(g[y].clone());this.faceVertexUvs[h].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],u=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[u]===void 0?(t[u]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let u=[c.a,c.b,c.c];for(let h=0;h<3;h++)if(u[h]===u[(h+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new T(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(e[f]=p[f]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];t.push(f.x,f.y,f.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],m=!0,g=!1,v=this.faceVertexUvs[0][p]!==void 0,y=f.normal.length()>0,x=f.vertexNormals.length>0,b=f.color.r!==1||f.color.g!==1||f.color.b!==1,w=f.vertexColors.length>0,C=0;if(C=c(C,0,0),C=c(C,1,m),C=c(C,2,g),C=c(C,3,v),C=c(C,4,y),C=c(C,5,x),C=c(C,6,b),C=c(C,7,w),r.push(C),r.push(f.a,f.b,f.c),r.push(f.materialIndex),v){let _=this.faceVertexUvs[0][p];r.push(d(_[0]),d(_[1]),d(_[2]))}if(y&&r.push(u(f.normal)),x){let _=f.vertexNormals;r.push(u(_[0]),u(_[1]),u(_[2]))}if(b&&r.push(h(f.color)),w){let _=f.vertexColors;r.push(h(_[0]),h(_[1]),h(_[2]))}}function c(p,f,m){return m?p|1<<f:p&~(1<<f)}function u(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return n[f]!==void 0||(n[f]=i.length/3,i.push(p.x,p.y,p.z)),n[f]}function h(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return a[f]!==void 0||(a[f]=s.length,s.push(p.getHex())),a[f]}function d(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=o.length/2,o.push(p.x,p.y)),l[f]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new Jg().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let r=e.colors;for(let h=0,d=r.length;h<d;h++)this.colors.push(r[h].clone());let i=e.faces;for(let h=0,d=i.length;h<d;h++)this.faces.push(i[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,x=g.length;y<x;y++){let b=g[y];v.push(b.clone())}this.faceVertexUvs[h].push(v)}}let n=e.morphTargets;for(let h=0,d=n.length;h<d;h++){let p={};if(p.name=n[h].name,n[h].vertices!==void 0){p.vertices=[];for(let f=0,m=n[h].vertices.length;f<m;f++)p.vertices.push(n[h].vertices[f].clone())}if(n[h].normals!==void 0){p.normals=[];for(let f=0,m=n[h].normals.length;f<m;f++)p.normals.push(n[h].normals[f].clone())}this.morphTargets.push(p)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let p={};if(s[h].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,m=s[h].vertexNormals.length;f<m;f++){let g=s[h].vertexNormals[f],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),p.vertexNormals.push(v)}}if(s[h].faceNormals!==void 0){p.faceNormals=[];for(let f=0,m=s[h].faceNormals.length;f<m;f++)p.faceNormals.push(s[h].faceNormals[f].clone())}this.morphNormals.push(p)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new vle().fromGeometry(this),t=new nt,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",zm.call(new st(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",zm.call(new st(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",tA.call(new st(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",rA.call(new st(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",rA.call(new st(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new ze(l.data.length*3,3);c.name=l.name,n.push(zm.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new ze(e.skinIndices.length*4,4);t.setAttribute("skinIndex",iA.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new ze(e.skinWeights.length*4,4);t.setAttribute("skinWeight",iA.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new nt,r=e.geometry;if(e.isPoints||e.isLine){let i=new ze(r.vertices.length*3,3),n=new ze(r.colors.length*3,3);if(t.setAttribute("position",zm.call(i,r.vertices)),t.setAttribute("color",tA.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new ze(r.lineDistances.length,1);t.setAttribute("lineDistance",yle.call(s,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};Jg.prototype.isGeometry=!0;var vle=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let g=0;g<o;g++)l[g]={name:a[g].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,h;if(u>0){h=[];for(let g=0;g<u;g++)h[g]={name:c[g].name,data:[]};this.morphTargets.normal=h}let d=e.skinIndices,p=e.skinWeights,f=d.length===r.length,m=p.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<t.length;g++){let v=t[g];this.vertices.push(r[v.a],r[v.b],r[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let b=v.normal;this.normals.push(b,b,b)}let x=v.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let b=v.color;this.colors.push(b,b,b)}if(n===!0){let b=i[0][g];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new W,new W,new W))}if(s===!0){let b=i[1][g];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new W,new W,new W))}for(let b=0;b<o;b++){let w=a[b].vertices;l[b].data.push(w[v.a],w[v.b],w[v.c])}for(let b=0;b<u;b++){let w=c[b].vertexNormals[g];h[b].data.push(w.a,w.b,w.c)}f&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},mx=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new T,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new $e,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function yle(e){return this.array.set(e),this}function tA(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new $e),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}function rA(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new W),t[r++]=s.x,t[r++]=s.y}return this}function zm(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new T),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}function iA(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new pt),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}var xle=["a","b","c"];function ble(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function c3(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function h3(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(i.has(l))c=i.get(l);else{let u=r[a],h=r[o];c={a:u,b:h,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),s[e].edges.push(c),s[t].edges.push(c)}function wle(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],h3(a.a,a.b,e,i,a,r),h3(a.b,a.c,e,i,a,r),h3(a.c,a.a,e,i,a,r)}function Fm(e,t,r,i,n){e.push(new mx(t,r,i,void 0,void 0,n))}function wh(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function jm(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var Cle=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof nt?e=new Jg().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new T,r,i,n,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,h=[],d=new Map;wle(o,l,h,d);let p=[],f,m,g,v,y,x,b;for(let ie of Array.from(d.keys())){for(m=d.get(ie),g=new T,y=3/8,x=1/8,b=m.faces.length,b!=2&&(y=.5,x=0,b!=1),g.addVectors(m.a,m.b).multiplyScalar(y),t.set(0,0,0),s=0;s<b;s++){for(v=m.faces[s],a=0;a<3&&(f=o[ble(v,xle[a])],!(f!==m.a&&f!==m.b));a++);f&&t.add(f)}t.multiplyScalar(x),g.add(t),m.newEdge=p.length,p.push(g)}let w,C,_,S,A,E,L,P=[];for(i=0,n=o.length;i<n;i++){for(E=o[i],A=h[i].edges,r=A.length,r==3?w=3/16:r>3&&(w=3/(8*r)),C=1-r*Number(w),_=w,r<=2&&(r==2?(C=3/4,_=1/8):r==1||r==0),L=E.clone().multiplyScalar(C),t.set(0,0,0),s=0;s<r;s++)S=A[s],f=S.a!==E?S.a:S.b,t.add(f);t.multiplyScalar(Number(_)),L.add(t),P.push(L)}let D=P.concat(p),I=P.length,B,X,H,R=[],q=[],F,z,U,K,j=new W,Y=new W,V=new W;for(i=0,n=l.length;i<n;i++)v=l[i],B=Number(c3(v.a,v.b,d).newEdge)+I,X=Number(c3(v.b,v.c,d).newEdge)+I,H=Number(c3(v.c,v.a,d).newEdge)+I,Fm(R,B,X,H,v.materialIndex),Fm(R,v.a,B,H,v.materialIndex),Fm(R,v.b,X,B,v.materialIndex),Fm(R,v.c,H,X,v.materialIndex),u&&(F=c[i],z=F[0],U=F[1],K=F[2],j.set(wh(z.x,U.x),wh(z.y,U.y)),Y.set(wh(U.x,K.x),wh(U.y,K.y)),V.set(wh(z.x,K.x),wh(z.y,K.y)),jm(q,j,Y,V),jm(q,z,j,V),jm(q,U,Y,j),jm(q,K,V,Y));e.vertices=D,e.faces=R,u&&(e.faceVertexUvs[0]=q)}},kr=new T,Sle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new nt().copy(new fa(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(kr),i={width:kr.x,height:kr.y,depth:kr.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=e.geometry??new nt().copy(new fa(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(kr)):kr.set(a.width,a.height,a.depth),(t!==kr.x||r!==kr.y||i!==kr.z)&&s.scale(kr.x===0?1:t/kr.x,kr.y===0?1:r/kr.y,kr.z===0?1:i/kr.z);let o=s.originalGeometry;try{n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new Cle(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new TD(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(kr);let s=100/kr.x;Object.assign(n.parameters,{width:100,height:kr.y*s,depth:kr.z*s}),t(this.build(n))})}},vO=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof mr?e.shape:new mr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5,h=0,d=0,p=2*Math.PI/i;for(let m=0;m<i;m++){let g=p*m,v=h+Math.sin(g)*c,y=d+Math.cos(g)*u;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let f=Kc.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(f,{userData:{...e,type:"PolygonGeometry"}})}},_le=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new Ele(t*.5,r,n,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function op(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function u3(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(c)),s.addScaledVector(o,i/Math.sin(c))}}function Ale(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var Ele=class extends nt{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],c=[],u=[],h=0,d=t/2,p=Math.PI/r,f=e*Math.cos(Math.PI/r),m=2*Math.PI/r,g=(r-2)*Math.PI/r,v=Math.PI-g,y=new T(0,-d,0),x=new T(0,d,0),b=new W(e,-d),w=new W(f,-d),C=new W(0,x.y).sub(w),_=new W(0,x.y).sub(b),S=new W(C.y,-C.x).normalize(),A=new W(_.y,-_.x).normalize(),E=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-C.angle())/2)-1e-8;s=Math.min(s,E);let L;{let H=new T(S.x,S.y,0),R=new T(Math.cos(m)*H.x,H.y,Math.sin(m)*H.x);L=H.angleTo(R)}let P=s/Math.tan((Math.PI-C.angle())/2),D=s/Math.tan((Math.PI-L)/2),I=new T;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),u.push(0,0);let H=h++,R=[],q=b.clone(),F=P/Math.cos(Math.PI/r);q.x-=F;for(let z=0;z<r;z++){let U=z/r*Math.PI*2+p,K=new W(Math.sin(U),Math.cos(U));op(q,K,I),l.push(I.x,I.y,I.z),c.push(0,-1,0),u.push(0,0),R.push(h++)}for(let z=0;z<R.length;z++)o.push(R[z],H,R[(z+1)%R.length])}{let H=new T,R=new T,q=new T,F=new T,z=new T,U=new T;for(let K=0;K<r;K++){let j=K/r*Math.PI*2+p,Y=(K+.5)/r*Math.PI*2+p,V=(K+1)/r*Math.PI*2+p,ie=new W(Math.sin(j),Math.cos(j)),$=new W(Math.sin(Y),Math.cos(Y)),ee=new W(Math.sin(V),Math.cos(V));op(b,ie,R),op(b,ee,q),op(S,$,H),u3(x,R,q,D,D,F),l.push(F.x,F.y,F.z),u3(R,x,q,D,P,z),l.push(z.x,z.y,z.z),u3(q,R,x,P,D,U),l.push(U.x,U.y,U.z),c.push(H.x,H.y,H.z),c.push(H.x,H.y,H.z),c.push(H.x,H.y,H.z),u.push(0,0),u.push(0,0),u.push(0,0);let ne=h++,ce=h++,ue=h++;if(o.push(ne,ce,ue),s>0){{let Se=R.clone().add(q).multiplyScalar(.5),Ne=x.clone().sub(Se).normalize(),Oe=y.clone().sub(Se).normalize().add(Ne).normalize().multiplyScalar(-1),Ae=U.clone().sub(z);B(Se,Ae,Oe,C.angle())}let ye,Re;{let Se=new T;op(A,ee,Se);let Ne=U.clone().add(F).multiplyScalar(.5);Ne=Ale(Ne,q,x);let Oe=U.clone().sub(F);[ye,Re]=B(Ne,Oe,Se,L,F.y)}{let Se=ye,Ne=Se.clone().setY(0).normalize(),Oe=new T(0,-1,0),Ae=Ne.clone().cross(Oe);X(Se,Ne,Oe,Ae)}{let Se=C.angle(),Ne=Math.PI-Se,Oe=x.clone();Oe.y-=s/Math.sin(Se-Math.PI/2);let Ae=new T,_e=[];for(let qe=0;qe<a;qe++){let N=[],O=Math.PI/2-Ne*qe/a,ae=Math.cos(O),we=Math.sin(O),xe=Y;for(let Te=0;Te<=qe;Te++){let Ge=Math.cos(xe),Ie=Math.sin(xe);H.x=ae*Ie,H.y=we,H.z=ae*Ge,Ae.copy(Oe).addScaledVector(H,s),l.push(Ae.x,Ae.y,Ae.z),c.push(H.x,H.y,H.z),u.push(0,0),N.push(h++),xe+=Math.PI*2/qe/r}_e.push(N)}Re.reverse(),_e.push(Re);let Ue=_e.length-1;for(let qe=0;qe<Ue;qe++){let N=_e[qe],O=_e[qe+1],ae=N.length-1;o.push(O[1],N[0],O[0]);for(let we=1;we<=ae;we++)o.push(N[we],N[we-1],O[we]),o.push(O[we+1],N[we],O[we])}}}}}this.setIndex(o),this.setAttribute("position",new ze(l,3)),this.setAttribute("normal",new ze(c,3)),this.setAttribute("uv",new ze(u,2));function B(H,R,q,F,z){let U=-F/2,K=(Math.PI-F)/2,j=R.clone().normalize().cross(q);H.addScaledVector(q,-s/Math.sin(K));let Y=new T,V=new T,ie=1,$=h,ee=[];for(let ne=0;ne<=a;ne++){let ce=U+ne/a*F;V.set(0,0,0),V.addScaledVector(j,Math.sin(ce)),V.addScaledVector(q,Math.cos(ce));for(let ue=0;ue<=ie;ue++){let ye=ue/ie-.5;if(Y.copy(H),Y.addScaledVector(R,ye),Y.addScaledVector(V,s),z!=null){let Re=Math.max(0,Y.y-z);Y.addScaledVector(R,-Re/R.y)}l.push(Y.x,Y.y,Y.z),c.push(V.x,V.y,V.z),u.push(0,0),ue===0&&ee.push(h),h++}}for(let ne=0;ne<a;ne++)for(let ce=0;ce<ie;ce++){let ue=$+ce+(ie+1)*ne,ye=ue+(ie+1),Re=ye+1,Se=ue+1;o.push(ue,ye,Se),o.push(ye,Re,Se)}return[H.clone().addScaledVector(R,.5),ee]}function X(H,R,q,F){let z=Math.PI/2,U=_.angle()-z,K=[],j=new T,Y=new T;for(let ie=0;ie<=a;ie++){let $=[],ee=ie/a;for(let ne=0;ne<=ie;ne++){let ce=((ie?ne/ie:0)-.5)*v,ue=Math.cos(ce),ye=Math.sin(ce),Re=Math.atan(Math.tan(U)*ue),Se=(z+Re)*ee,Ne=Math.cos(Se),Oe=Math.sin(Se);j.set(0,0,0),j.addScaledVector(R,Oe*ue),j.addScaledVector(q,Ne),j.addScaledVector(F,Oe*ye),Y.copy(H).addScaledVector(j,s),l.push(Y.x,Y.y,Y.z),c.push(j.x,j.y,j.z),u.push(0,0),$.push(h++)}K.push($)}let V=K.length-1;for(let ie=0;ie<V;ie++){let $=K[ie],ee=K[ie+1],ne=$.length-1;o.push($[0],ee[1],ee[0]);for(let ce=1;ce<=ne;ce++)o.push($[ce-1],$[ce],ee[ce]),o.push($[ce],ee[ce+1],ee[ce])}}}},yO=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof mr?e.shape:new mr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},u={x:-c.x,y:-c.y},h={x:c.x,y:c.y};function d(b,w,C){return w>r&&C>i?Math.min(b*r/w,b*i/C):w>r?b*r/w:C>i?b*i/C:b}let p=[];p[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),p[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),p[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),p[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let f=u.x,m=h.x,g=h.y,v=u.y;t.addPoint(t.createPoint(f,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(f,v)),t.isClosed=!0;let y=!0;for(let b=0,w=t.points.length;b<w;b++)t.points[b].roundness=p[b],b>0&&p[b]!==p[b-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=s!==1,t.update();let x=Kc.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...e,type:"RectangleGeometry"}})}},Mle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,u=new T7(.5*t,n,s,a,o,l,c);return u.scale(1,r/t,i/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},Tle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new kv(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},Lle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new Ple(t,r,i,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},Ple=class extends nt{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let u=[],h=Math.PI/2,d=(ie=0,$=0,ee=0)=>new T(ie,$,ee),p=d(),f=d(),[m,g,v]=[t/2,e/2,r/2],y=-g,x=+g,[b,w,C]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],_=(ie,$=!1)=>Math.sin(ie-Math.PI/(1+ +$)),S=(ie,$=!1)=>Math.cos(ie-Math.PI/(1+ +$));C.y=Math.sin(i)*t-m;let A=Math.cos(i)*t-v,E=b.z-c;i<=h?(C.z=Math.min(A,E),C.z==E&&(C.y-=(A-E)/Math.tan(h-i))):w.z=Math.min(w.z-A-v,b.z-c),p.subVectors(b,w),f.subVectors(C,w);let L=Math.min(p.length(),f.length())*n/100,P=L*Math.tan(i/2),D=L/Math.cos(i/2),I=p.clone().normalize().add(f.normalize()).setLength(D).add(w);p.set(0,_(i,!0),S(i,!0)),u.push([C,p.clone()]);let B=(Math.PI-i)/s;for(let ie=0;ie<=s;ie++){let $=h+i+ie*B;p.set(0,Math.sin($)*P,Math.cos($)*P),p.add(I),f.set(0,_($),S($)),u.push([p.clone(),f.clone()])}u.push([b,d(0,1,0)]);let X=Math.sin(B/2)*P*2,H=u.length-1,R=u[0][0].distanceTo(u[1][0]),q=u[H-1][0].distanceTo(u[H][0]),F=R+X*s+q;u[0].push(1);for(let ie=0;ie<=s;ie++)u[ie+1].push(1-(R+ie*X)/F);u[H].push(0);let[z,U,K]=u[0],j,Y,V;for(let ie=1;ie<u.length;ie++)[j,Y,V]=u[ie],a.push(y,z.y,z.z,y,j.y,j.z,x,z.y,z.z,x,z.y,z.z,y,j.y,j.z,x,j.y,j.z),o.push(0,U.y,U.z,0,Y.y,Y.z,0,U.y,U.z,0,U.y,U.z,0,Y.y,Y.z,0,Y.y,Y.z),l.push(0,K,0,V,1,K,1,K,0,V,1,V),[z,U,K]=[j,Y,V];this.setAttribute("position",new ze(a,3)),this.setAttribute("normal",new ze(o,3)),this.setAttribute("uv",new ze(l,2))}},xO=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof mr?e.shape:new mr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,h=t*.5,d=r*.5,p=0,f=0,m=a*Math.PI/360/n,g=Math.PI/2*3*-1,v=h*i/100,y=d*i/100;if(n===3&&i===50){m=2*Math.PI/n;for(let b=0;b<n;b++){let w=m*b,C=p+Math.sin(w)*h,_=f+Math.cos(w)*d;u.addPoint(u.createPoint(C,_))}}else for(let b=0;b<n;b++){let w=p+Math.cos(g)*h,C=f+Math.sin(g)*d;u.addPoint(u.createPoint(w,C)),g+=m,w=p+Math.cos(g)*v,C=f+Math.sin(g)*y,u.addPoint(u.createPoint(w,C)),g+=m}u.isClosed=!0;for(let b=0,w=u.points.length;b<w;b++)u.points[b].roundness=s;u.roundness=s,u.update();let x=Kc.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(x,{userData:{...e,type:"StarGeometry"}})}},Dle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new kv(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},Ile=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=Ole(t,r,i,t*.5,a,s,0,0,n,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function Ole(e,t,r,i,n,s,a,o,l,c,u){return[t,r]=[r,t],a=t/2,n/=2*Math.PI,n==1&&(c=0),new mO(!0,e,t,r,i,n,s,a,o,l,c,u)}var Rle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new CD(o,r,i,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},Ble=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof mr?e.shape:new mr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5;o?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=i;l.roundness=i,l.update();let h=Kc.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:{...e,type:"TriangleGeometry"}})}};function kle(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var Nle=new Ce,zle=new Ce;function Fle(e,t,r){let i=[new T,new T,new T],n=[new T,new T,new T];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((s,a)=>{let o=n[a],l=gt.lerp(s.length(),o.length(),r);s.lerp(o,r).setLength(l)}),new Ce().makeBasis(i[0],i[1],i[2])}var jle=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=(t==null?void 0:t.shapeData)??g8.create({parameters:WI}).userData.shape;return{path:e.path??Vg.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:s,extrusion:{...qI,...r.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new Ule(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new nt,{userData:{...e,type:"PathGeometry"}})}},Ule=class extends nt{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!kle(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion,n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*n),a=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],c=[];for(let H=0;H<o;H++){let R=this.inputs.path.isClosed?(H+s)%e.length:Math.min(H+s,e.length-1);l.push(e[R].clone()),c.push(t[R].clone())}let u=(H,R,q)=>{l[H]=l[H].clone().lerp(l[R],q),c[H]=Fle(c[H],c[R],q)},h=0,d=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(d||i===0)&&(h=d,u(0,1,h));let p=0,f=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&f&&(p=f,u(l.length-1,l.length-2,1-p)),r===0){let H=l.length-1;l[H].copy(l[0]),c[H].copy(c[0])}this._applyPathModifiers(c,h,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:x,infos:b,vertices:w}=this._computeShapePoints(y),C=0,_;v==="round"&&(_=new m8(this.inputs.shapeData,2*m,m,y,g,void 0,!0),C=_.getAttribute("position").count);let S=0,A=0;b.sort((H,R)=>H.start-R.start),b.forEach(H=>{H.verticesStart=S,H.verticesCount=H.continuous.reduce((R,q,F)=>R+(F===0||!q?2:1),0),A+=H.verticesCount,S=A});let E=A*o,L,P=0;if(this._isOpenEnded()&&v==="flat"){try{L=$o({windingRule:Ft.ODD,elementType:Or.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{L=lO}P=L.vertexCount}let D=E+2*P+C*2,I=E+2*P,B={positions:new Float32Array(D*3),normals:new Float32Array(D*3),uvs:new Float32Array(D*2)},X=[];if(b.forEach(H=>{this._extrudeRegion(H,w,c,l,B,X,this._isGeometryClosed()&&!this._isOpenEnded())}),L&&(this._closeEnd(L,E,X,B,c[0],l[0],!1),this._closeEnd(L,E+P,X,B,c[c.length-1],l[l.length-1],!0)),_){B.positions.set(_.getAttribute("position").array,I*3),B.normals.set(_.getAttribute("normal").array,I*3),B.uvs.set(_.getAttribute("uv").array,I*2);let H=X.length;X.push(..._.getIndex().array.map(F=>F+I)),I+=C,B.positions.set(_.getAttribute("position").array,I*3),B.normals.set(_.getAttribute("normal").array,I*3),B.uvs.set(_.getAttribute("uv").array,I*2);let R=X.length;X.push(..._.getIndex().array.map(F=>F+I)),this.setAttribute("position",new st(B.positions,3)),this.setAttribute("normal",new st(B.normals,3)),this.setAttribute("uv",new st(B.uvs,2)),this.setIndex(X);let q=Nle;q.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(q,I,D),q.copy(c[0]).setPosition(l[0]).multiply(zle.makeScale(1,1,-1)),this.applyMatrix4OnRange(q,I-C,I),this.reverseIndicesOnRange(H,R)}else this.setAttribute("position",new st(B.positions,3)),this.setAttribute("normal",new st(B.normals,3)),this.setAttribute("uv",new st(B.uvs,2)),this.setIndex(X)}_extractPathPoints(){let e=$I(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new T,s=new T,a=new T,o=new T,l=new T(0,1,0);for(let f=0;f<r;f++){let m=e[f],g;f===0?g=i?e[e.length-2]:m.clone().multiplyScalar(2).sub(e[1]):g=e[f-1];let v;f===r-1?v=i?e[1]:m.clone().multiplyScalar(2).sub(e[f-1]):v=e[f+1];let y=m.clone().sub(g).normalize(),x=v.clone().sub(m).normalize(),b=y.clone().add(x).normalize();a.copy(b),f===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let w=l.clone().cross(b).normalize(),C=b.clone().cross(w).normalize();l.copy(C),o.copy(w),f===0&&(n.copy(C),s.copy(b));let _=new Ce().makeBasis(w,C,b);t.push(_)}let c=i?s:a,u=i?n:new T(0,1,0),h=c.clone().cross(o).normalize(),d=Math.acos(u.dot(h));if(isNaN(d))return t;let p=u.clone().cross(h);c.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let m=new Ce().makeRotationZ(d*f/t.length);t[f].multiply(m)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new Ce,c=new Ce;return e.forEach((u,h)=>{let d=h===0?0:h===i-1?1:(h-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(gt.lerp(n,n+s,d));let p=gt.lerp(a,o,d);c.makeScale(p,p,p),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Ft.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),h=[];for(let d=u.length-1;d>=1;d-=2){let p=u[d-1],f=u[d-0];h.push(p,f)}return h}),s;try{s=$o({windingRule:t,elementType:Or.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=f8}let a;try{a=$o({windingRule:Ft.ODD,elementType:Or.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=oO}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let u=a.elements[c],h=c%2===0?s.vertexCount:0;s.elements.push(u+h)}for(let c=0;c<a.vertexIndices.length;c++){let u=a.vertexIndices[c],h=s.vertexCount;s.vertexIndices.push(u+h)}for(let c=0;c<a.vertices.length;c++){let u=a.vertices[c];s.vertices.push(u)}}for(let c=0,u=s.vertexCount;c<u;c++){let h=c*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let u=c>=o,h=c*2,d=s.elements[h+0],p=s.elements[h+1],f=d+p,m={start:d,count:p,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=d,v=f-1,y=d+1,x=r.roundedCurves.length;do{let b=g-d;s.vertices[v*2+0],s.vertices[v*2+1];let w=s.vertices[g*2+0],C=s.vertices[g*2+1],_=s.vertices[y*2+0],S=s.vertices[y*2+1],A=w-_,E=C-S,L=Math.sqrt(A*A+E*E);A/=L,E/=L,m.normals[b*2+0]=-E,m.normals[b*2+1]=A;let P=s.vertexIndices[g];if(Array.isArray(P))m.continuous[b]=!1;else{let[D,I]=r.getCurveIndexFromVertexId(P-1,!0);if(I>0&&I<1)m.continuous[b]=!0;else{let B=I===1?D+1:D-1;B=(B+x)%x;let X=I===1?0:1,H=r.roundedCurves[D].getTangent(I),R=r.roundedCurves[B].getTangent(X);m.continuous[b]=H.dot(R)>.95}}u&&(m.normals[b*2+0]*=-1,m.normals[b*2+1]*=-1),[v,g,y]=[g,y,y+1],y>=f&&(y-=p)}while(y!==d+1)}return{regions:[i,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,r,i,n){let s=t*2,a=t*3;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,r,i,n,s,a){let o=new T,l=new T,c=new T,u=new T,h=new W;r.forEach((p,f)=>{let m=i[f],g=e.verticesStart*r.length+e.verticesCount*f;for(let v=0;v<e.count;v++){let y=(e.start+v)*2;if(o.set(t[y+0],t[y+1],0),c.copy(o).applyMatrix4(p).add(m),e.continuous[v])u.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let x=v===0?(e.start+e.count-1)*2:y-2;l.set(t[x+0],t[x+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(p).normalize(),h.set(v===0?1:v/e.count,f/(r.length-1)),this._insertVertex(n,g,c,u,h),g++,!e.continuous[v]||v===0){if(v===0)u.set(e.normals[v*2+0],e.normals[v*2+1],0),h.set(0,f/(r.length-1));else{let x=v===e.count-1?e.start*2:y+2;l.set(t[x+0],t[x+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(p).normalize(),this._insertVertex(n,g,c,u,h),g++}}});let d=r.length-1;for(let p=0;p<d;p++){let f=e.verticesStart*r.length+e.verticesCount*p,m=e.verticesStart*r.length+e.verticesCount*(p+1),g=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&g++;let y=v===e.count-1?0:g+1,x=f+g,b=f+y,w=m+y,C=m+g;e.isHole?s.push(x,w,b,x,C,w):s.push(x,b,w,x,w,C),g++}}}_closeEnd(e,t,r,i,n,s,a){let o=e.vertexCount,l=new T(0,0,a?-1:1).applyMatrix4(n),c=new T,u=new W;for(let d=0;d<o;d++){let p=2*d;c.set(e.vertices[p+0],e.vertices[p+1],0).applyMatrix4(n).add(s),this._insertVertex(i,t+d,c,l,u)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let p=3*d,f=h[p+0]+t,m=h[p+(a?1:2)]+t,g=h[p+(a?2:1)]+t;r.push(f,m,g)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new ti().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let h=c.array,d=u.array,p=c.itemSize;for(let f=t*p,m=r*p;f<m;f+=p){if(f===t)debugger;s=h[f+0],a=h[f+1],o=h[f+2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]),h[f+0]=(i[0]*s+i[4]*a+i[8]*o+i[12])*l,h[f+1]=(i[1]*s+i[5]*a+i[9]*o+i[13])*l,h[f+2]=(i[2]*s+i[6]*a+i[10]*o+i[14])*l,s=d[f+0],a=d[f+1],o=d[f+2],d[f+0]=n[0]*s+n[3]*a+n[6]*o,d[f+1]=n[1]*s+n[4]*a+n[7]*o,d[f+2]=n[2]*s+n[5]*a+n[8]*o}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),s=r.getX(i+1),a=r.getX(i+2);r.setXYZ(i,a,s,n)}r.needsUpdate=!0}}};function bO(){let e=new nt;return e.setAttribute("position",new st(new Float32Array([]),3)),e.setIndex(new st(new Uint16Array([]),1)),e}var Vle=bO().attributes,Hle=12,Gle=1,wO=class extends nt{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Vle),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=l===2?o.toUpperCase():l===3?o.toLowerCase():o,u=Wle(e,t,c),{shapes:h,charWidths:d,charCoords:p}=t.generateShapes(u,e),f=r*.5,m=i*.5,g=h.map(x=>new mr().fromShape(x));this.vectorShapes=g;let v=g.map(x=>Kc.create({shape:x,parameters:{depth:n,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:n<=0?Ft.NONZERO:Ft.ODD,subdivisions:this.isLowResolution&&n>0?Gle:Hle}})),y=v.length?mc(v):bO();y.translate(-f,m,0),this.dispose(),this.wrappedText=u,this.charCoords=p,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([x,b])=>{this.setAttribute(x,b)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=Fc(new nt,wO.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function Wle(e,t,r){r=r??e.text;let i=[""],n="";for(let s of r)n+=s,s===" "||s===`
`?(i[i.length-1]+=n,n="",s===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var CO,v8=new Promise(e=>{CO=e}),nA=!1,Um;function qle(){if(nA)return;if(Um)return Um;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.452/build",r=c1(()=>import("./process-10f79362.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});CO(a),nA=!0}return Um=e(),Um}function $g(e,t,r){let i={parameters:e,type:e.type};if(e.type==="PathGeometry")i.path=e.path;else if(e.type==="VectorGeometry"){let s=mr.createFromState(e.shape,e.width,e.height);i.shape=s}else if(e.type==="NonParametricGeometry")e.data.groups&&e.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),i.geometry=new TD().parse(e);else{if(e.type==="SubdivGeometry")return new Bi(e,r);if(e.type==="TextGeometry")return new wO(e,t)}let n;try{n=cA(i)}catch(s){console.error(s)}if(!n){let s=mr.createFromState(Ug.defaultData(),100,100);i.shape=s,n=cA(i)}return n}var Xle=new Ce;function gx(e,t,r,i){let n=e.position.array,s=e.normal.array,a=Xle.makeScale(t,r,i).invert().elements,o,l,c;for(var u=0,h=n.length;u<h;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,o=s[u],l=s[u+1],c=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*c,s[u+1]=a[1]*o+a[5]*l+a[9]*c,s[u+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var Vm=new Er,Ch=new T,Ze;v8.then(e=>{Ze=e});var sA=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),aA=new Uint32Array([0,1,2,3]),oA=new Uint8Array([4]),Bi=class extends nt{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=Ac.div(t,r);this.subdividedGeometry&&gx(this.subdividedGeometry.attributes,...i),this.originalGeometry&&gx(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(Ch.fromArray(i));let s=Ch.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=Bi.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new fa(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Bi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Ln,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Vm.setFromBufferAttribute(t),Vm.getCenter(r),e.boundingSphere.radius=r.distanceTo(Vm.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Vm.getSize(Ch);let i={width:Ch.x,height:Ch.y,depth:Ch.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,s,a,o=(e==null?void 0:e.phongAngle)??35;r===!1&&(o=-1),t&&(Ze.free_bvh(t),Ze.free_subdivision_surface(t));try{n=Bi.allocate(e,i)}catch(l){console.error(l,e),n=Bi.allocate({positionWASM:sA,indexWASM:aA,verticesPerFaceWASM:oA},i)}if(Ze.set_destination_refinement_level(n,0),s=Bi.buildLevel(n,!0,o),e.subdivisions>0)try{Ze.set_destination_refinement_level(n,e.subdivisions),a=Bi.buildLevel(n,!1,o)}catch{try{Ze.set_destination_refinement_level(n,e.subdivisions-1),a=Bi.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:$g(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let s,a,o,l;({positions:s,triIndices:l}=t2(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,h=u+e.radialSegments*3;c=[u,h]}return{indices:a,verticesPerFace:o}=SO(s,l,i,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var x;let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=sA,i=aA,n=oA);let o=r.length,l=i.length,c=n.length,u=r.length+s.length+a.length,h=i.length+n.length,d=u*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,p=u*Float32Array.BYTES_PER_ELEMENT,f=Ze._malloc(d),m=new Float32Array(Ze.HEAPF32.buffer,f,u),g=new Uint32Array(Ze.HEAPU32.buffer,f+p,h);m.set(r,0),m.set(s,r.length),m.set(a,r.length+s.length),g.set(i,0),g.set(n,i.length);let v;(x=e==null?void 0:e.scaleBaked)!=null&&x.some(b=>b!==1)&&(v=new Ce().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let y=v?Ze.alloc_subdivision_surface2(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):Ze.alloc_subdivision_surface(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ze._free(f),y}static buildLevel(e,t,r,i,n){let s=n?Ze.get_mesh_data2(e,t?Ze.Level.CONTROL:Ze.Level.REFINED,r,n.elements):Ze.get_mesh_data(e,t?Ze.Level.CONTROL:Ze.Level.REFINED,r),a=8,o=Ze.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,4+4),c=0,u=Ze.HEAPU32[o[c]>>2],h=Ze.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=Ze.HEAPU32[o[c]>>2],p=Ze.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=Ze.HEAPU32[o[c]>>2],m=Ze.HEAPU32.subarray(f>>2,(f>>2)+l[c]);c++;let g=Ze.HEAPU32[o[c]>>2],v=Ze.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new nt;if(y.setIndex(new yu(v,1)),y.setAttribute("position",new ze(h,3)),y.setAttribute("normal",new ze(p,3)),t){y.setAttribute("faceMap",new yu(m,1));let x=new Float32Array(p.length/3*4).fill(0);y.setAttribute("color",new st(x,4))}return Ze.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(h),i.getAttribute("normal").copyArray(p),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ze.free_mesh_data(s)}static freeSubdivPointer(e){Ze.free_bvh(e),Ze.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=Ze.get_wireframe_data_for_base_level(e),n=4,s=Ze.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,2+2),o=0,l=Ze.HEAPU32[s[o]>>2],c=Ze.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=Ze.HEAPU32[s[o]>>2],h=Ze.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let d=new nt;d.setAttribute("position",new ze(c,3));let p=new Float32Array(c.length);for(let f=0,m=c.length;f<m;)p[f++]=r.r,p[f++]=r.g,p[f++]=r.b;return d.setAttribute("color",new st(p,3)),d.setIndex(new yu(h,1)),Ze.free_wireframe_data_for_base_level(i),d}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,Ze.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||Ze.set_destination_refinement_level(e,t);let n=r?Ze.get_topological_data2(e,i?Ze.Level.CONTROL:Ze.Level.REFINED,r.elements):Ze.get_topological_data(e,i?Ze.Level.CONTROL:Ze.Level.REFINED),s=6,a=Ze.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,3+3),l=0,c=Ze.HEAPU32[a[l]>>2],u=new Float32Array(Ze.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let h=Ze.HEAPU32[a[l]>>2],d=new Uint32Array(Ze.HEAPU32.subarray(h>>2,(h>>2)+o[l]));l++;let p=Ze.HEAPU32[a[l]>>2],f=new Uint8Array(Ze.HEAPU32.subarray(p>>2,(p>>2)+o[l]));return Ze.free_topological_data(n),{positions:u,indices:d,verticesPerFace:f}}},lA=["getX","getY","getZ"];function t2(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let c=0;c<i;c++){let u=t?t.getX(c):c,h="";for(let d=0;d<3;d++)h+=`${~~(e[lA[d]](u)*o)},`;if(h in r)s.push(r[h]);else{for(let d=0;d<3;d++)a.push(e[lA[d]](u));r[h]=n,s.push(n),n++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var Hm=new T,d3=new T,p3=new T,f3=new T;function SO(e,t,r,i){let n=[],s=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let d=l.length/2/c;l=l.filter((p,f)=>Math.floor(f/2)%d===0)}let u=0;for(let d=0;d<l.length;d+=2)u+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);e.length=0;let h=0;if(u<0)for(let d=0;d<l.length;d+=2)e.push(l[d],l[d+1],0),n.push(h++);else for(let d=l.length-2;d>=0;d-=2)e.push(l[d],l[d+1],0),n.push(h++);return s.push(h),{indices:n,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){Hm.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),d3.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),p3.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),f3.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),d3.sub(Hm).normalize(),p3.sub(Hm).normalize(),f3.sub(Hm).normalize();let l=d3.cross(p3).dot(f3);Math.abs(l)>.005||i&&i.some((c,u)=>u%2===1?!1:o>=i[u]&&o<i[u+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let h=0,d=0;h<e.length;h+=3,d++)e[h+2]===0&&(l.push(d),u++),e[h+2]===a&&c.push(d);if(r.userData.parameters.extrudeBevelSize===0){let h=c[0];c[0]=c[1],c[1]=h}l.reverse(),n.push(...l,...c),s.push(u,u)}return{indices:n,verticesPerFace:s}}var Fa={};RH(Fa,{calcBoolean:()=>Jle,calcBooleanTopological:()=>Zle,freeMeshSet:()=>rce,getMeshSet:()=>$le,hasOpenEdges:()=>ece,transformMeshSet:()=>tce});var _O,Yle=new Promise(e=>{_O=e}),Gm;function Qle(){if(Gm)return Gm;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@0.9.452/build",r=c1(()=>import("./boolean-613a7c9c.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});_O(a)}return Gm=e(),Gm}var bt,Tu;Yle.then(e=>bt=e);function Kle(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=t2(e.getAttribute("position"),n),o;if(t&&r){let{indices:l,verticesPerFace:c}=SO(s,a,e);o=c.length,i=[];for(let u=0,h=0;u<o;u++){i.push(c[u]);for(let d=0;d<c[u];d++)i.push(l[h++])}}else{let l=a.length;i=Array(l+l/3),o=0;for(let c=0,u=0;u<i.length;)i[u++]=3,o++,i[u++]=a[c++],i[u++]=a[c++],i[u++]=a[c++]}return{positions:s,faceIndices:i,nFaces:o}}function AO(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=bt._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(bt.HEAPU32.buffer,s,t):new Float32Array(bt.HEAPF32.buffer,s,t)).set(e,0),s}function EO(e){switch(e){case 0:return bt.OP.UNION;case 1:return bt.OP.INTERSECTION;case 2:return bt.OP.A_MINUS_B;case 3:return bt.OP.B_MINUS_A;case 4:return bt.OP.SYMMETRIC_DIFFERENCE;case 5:return bt.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function Zle(e,t){Tu===void 0&&(Tu=bt.init_csg());let r=AO(e),i=bt.csg_calc_topological(Tu,r,e.length,EO(t));bt._free(r);let n=6,s=bt.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,3+3),o=0,l=bt.HEAPU32[s[o]>>2],c=new Float32Array(bt.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=bt.HEAPU32[s[o]>>2],h=new Uint32Array(bt.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=bt.HEAPU32[s[o]>>2],p=new Uint8Array(bt.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return bt.free_mesh_data(i),{positions:c,indices:h,verticesPerFace:p}}function Jle(e,t,r,i){Tu===void 0&&(Tu=bt.init_csg());let n=AO(e),s=bt.csg_calc(Tu,n,e.length,i,EO(t));bt._free(n);let a=5,o=bt.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,2+3),c=0,u=bt.HEAPU32[o[c]>>2],h=bt.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=bt.HEAPU32[o[c]>>2],p=bt.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=l[c];r.setAttribute("position",new ze(h,3)),r.setAttribute("normal",new ze(p,3));let m=bt.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new Ln),r.boundingSphere.center.set(m[0],m[1],m[2]),r.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,r.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},bt.free_mesh_data(s),f}function $le(e,t,r){if(bt===void 0)return-1;let i,n,s;if(t&&e.userData.positions!==void 0){let m=e.userData;s=m.verticesPerFace.length,i=m.positions,n=Array(m.verticesPerFace.reduce((g,v)=>g+v,0)+s);for(let g=0,v=0,y=0;g<m.verticesPerFace.length;g++){n[y++]=m.verticesPerFace[g];for(let x=0;x<m.verticesPerFace[g];x++)n[y++]=m.indices[v++]}}else({positions:i,faceIndices:n,nFaces:s}=Kle(e,t,r));let a=i.length,o=n.length,l=i.length,c=n.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=bt._malloc(u),p=new Float32Array(bt.HEAPF32.buffer,d,l),f=new Uint32Array(bt.HEAPU32.buffer,d+h,c);return p.set(i,0),f.set(n,0),bt.get_csg_mesh(d,a,d+h,o,s)}function ece(e){return bt.has_open_edges(e)}function tce(e,t){bt.transform_csg_mesh(e,t.elements)}function rce(e){bt.free_csg_mesh(e)}var ice={ConeGeometry:Ooe,CubeGeometry:Roe,CylinderGeometry:eO,DodecahedronGeometry:koe,EllipseGeometry:g8,HelixGeometry:fle,IcosahedronGeometry:mle,LatheGeometry:gle,NonParametricGeometry:Sle,PolygonGeometry:vO,PyramidGeometry:_le,RectangleGeometry:yO,SphereGeometry:Mle,PlaneGeometry:Tle,BackdropGeometry:Lle,StarGeometry:xO,TextFrameGeometry:Dle,TorusGeometry:Ile,TorusKnotGeometry:Rle,TriangleGeometry:Ble,PathGeometry:jle,VectorGeometry:Kc},cA=e=>ice[e.type].create(e);function lp(e){return e!==null&&"booleanOp"in e}var MO=class extends h8($i){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Ce}updateVisible(){super.updateVisible(),this.visible=!lp(this.parent)&&this.visible,lp(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Fa.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),lp(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof MO&&(e.freeBooleanPointer(),lp(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e){let t=super.updateTransformState(e);return t&&lp(this.parent)&&this.invalidateDownstreamBooleanData(!0),t}},Wm=new Er;function y8(e,t=0,r=e.count,i,n){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=t;h<r;h++){let d=e.getX(h),p=e.getY(h),f=e.getZ(h);d<s&&(s=d),p<a&&(a=p),f<o&&(o=f),d>l&&(l=d),p>c&&(c=p),f>u&&(u=f)}Wm.min.set(s,a,o),Wm.max.set(l,c,u),Wm.getCenter(i),Wm.getSize(n).multiplyScalar(.5)}var nce=new nt,sce=new d1,cn=class extends MO{constructor(e,t){super(nce,sce),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?y8(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},hA=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Rl=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=gt.generateUUID(),this.type=e,this.name=""}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getHash(){let e="{",t,r;for(t in this)r=this[t],r instanceof Rl&&(e+='"'+t+'":'+r.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)t=this.hashProperties[i],r=this[t],e+='"'+t+'":"'+String(r)+'",';return e+='"id":"'+this.uuid+'"}',e}},ace=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Zi=new ace,Ht=class extends Rl{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=gt.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},un=class extends Ht{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}},hi=class extends un{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof W?e:new W(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},jn=class extends un{constructor(t=0,r,i){super("v3"),this.nodeType="Vector3",this.value=t instanceof T?t:new T(t,r,i)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,r,i,n,s,a){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,r)}},on=class extends $e{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],s=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},ja=class extends un{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof on?e:new on(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},oce=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,uA=/[a-z_0-9]+/gi,Pe=class extends Ht{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=uA.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let u=l[c],h=u[0],d=this.isMethod?!this.getInputByName(h):!0,p=h;if(this.keywords[h]||this.useKeywords&&d&&Zi.containsKeyword(h)){let f=this.keywords[h];if(!f){let m=Zi.getKeywordData(h);m.cache&&(f=e.keywords[h]),f=f||Zi.getKeyword(h,e),m.cache&&(e.keywords[h]=f)}p=f.build(e)}h!==p&&o[u.index+a-1]!=="."&&(o=o.substring(0,u.index+a)+p+o.substring(u.index+h.length+a),a+=p.length-h.length),this.getIncludeByName(p)===void 0&&Zi.contains(p)&&e.include(Zi.get(p))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=oce.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(uA);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let c=s[a++];this.inputs.push({name:c,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},lce=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,TO=class extends Ht{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||TO.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=lce.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},zt=TO;zt.PI="PI",zt.PI2="PI2",zt.RECIPROCAL_PI="RECIPROCAL_PI",zt.RECIPROCAL_PI2="RECIPROCAL_PI2",zt.LOG2="LOG2",zt.EPSILON="EPSILON";var cce=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),hce=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),LO=class extends Ht{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=cce.exec(e);if(t){let r=t[2],i;for(;i=hce.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},x8=class extends Ht{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Zi.addKeyword("uv",function(){return new x8});Zi.addKeyword("uv2",function(){return new x8(1)});var kh=class extends Ht{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??kh.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case pa:return["Linear"];case dt:return["sRGB"];default:return[]}}generate(e,t){var a;let r=this.input.build(e,"v4"),i=this.getType(e),n=kh.Nodes[this.method],s=e.include(n);if(s===kh.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+r+", "+o+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=kh.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=kh.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},aa=kh;aa.Nodes={LinearToLinear:new Pe(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Pe(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Pe(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},aa.LINEAR_TO_LINEAR="LinearToLinear",aa.SRGB_TO_LINEAR="sRGBToLinear",aa.LINEAR_TO_SRGB="LinearTosRGB";var Zt=class extends Pe{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},qa=class extends un{constructor(e=new Vr,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new x8,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new aa(new Zt("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},Be=class extends un{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},dA=class extends Ht{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],u=this.inputs[l]||this.inputs[c.name];o.push(u.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},PO=class extends Ht{constructor(e,t,r=PO.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},qi=PO;qi.ADD="+",qi.SUB="-",qi.MUL="*",qi.DIV="/";var Nt=class extends Ht{constructor(e,t=Nt.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Nt.MIX:case Nt.CLAMP:case Nt.REFRACT:case Nt.SMOOTHSTEP:case Nt.FACEFORWARD:return 3;case Nt.MIN:case Nt.MAX:case Nt.MOD:case Nt.STEP:case Nt.REFLECT:case Nt.DISTANCE:case Nt.DOT:case Nt.CROSS:case Nt.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Nt.LENGTH:case Nt.DISTANCE:case Nt.DOT:return"f";case Nt.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Nt.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Nt.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Nt.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Nt.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case Nt.MIN:case Nt.MAX:case Nt.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case Nt.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Nt.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let h=this.getNumInputs(e);if(u.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},ht=Nt;ht.RAD="radians",ht.DEG="degrees",ht.EXP="exp",ht.EXP2="exp2",ht.LOG="log",ht.LOG2="log2",ht.SQRT="sqrt",ht.INV_SQRT="inversesqrt",ht.FLOOR="floor",ht.CEIL="ceil",ht.NORMALIZE="normalize",ht.FRACT="fract",ht.SATURATE="saturate",ht.SIN="sin",ht.COS="cos",ht.TAN="tan",ht.ASIN="asin",ht.ACOS="acos",ht.ARCTAN="atan",ht.ABS="abs",ht.SIGN="sign",ht.LENGTH="length",ht.NEGATE="negate",ht.INVERT="invert",ht.MIN="min",ht.MAX="max",ht.MOD="mod",ht.STEP="step",ht.REFLECT="reflect",ht.DISTANCE="distance",ht.DOT="dot",ht.CROSS="cross",ht.POW="pow",ht.MIX="mix",ht.CLAMP="clamp",ht.REFRACT="refract",ht.SMOOTHSTEP="smoothstep",ht.FACEFORWARD="faceforward";var Pp=class extends Ht{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new dA(Pp.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new aa(new Zt("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new aa(new Zt("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new aa(new Zt("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new aa(new Zt("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new Zt(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Zt(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Zt(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Zt(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new Zt("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new dA(Pp.Nodes.roughnessToMip,[i]),s=new ht(n,Pp.Nodes.m0,Pp.Nodes.cubeUV_maxMipLevel,ht.CLAMP),a=new ht(s,ht.FLOOR),o=new ht(s,ht.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new qi(a,new Be(1).setReadonly(!0),qi.ADD)),u=new ht(l,c,o,ht.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},vx=Pp;vx.Nodes=function(){let e=new LO(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new zt("float cubeUV_maxMipLevel 8.0",!0),r=new zt("float cubeUV_minMipLevel 4.0",!0),i=new zt("float cubeUV_maxTileSize 256.0",!0),n=new zt("float cubeUV_minTileSize 16.0",!0),s=new Pe(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new Pe(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new Pe(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new zt("float r0 1.0",!0),c=new zt("float v0 0.339",!0),u=new zt("float m0 -2.0",!0),h=new zt("float r1 0.8",!0),d=new zt("float v1 0.276",!0),p=new zt("float m1 -1.0",!0),f=new zt("float r4 0.4",!0),m=new zt("float v4 0.046",!0),g=new zt("float m4 2.0",!0),v=new zt("float r5 0.305",!0),y=new zt("float v5 0.016",!0),x=new zt("float m5 3.0",!0),b=new zt("float r6 0.21",!0),w=new zt("float v6 0.0038",!0),C=new zt("float m6 4.0",!0),_=[l,c,u,h,d,p,f,m,g,v,y,x,b,w,C],S=new Pe(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,_);return{bilinearCubeUV:o,roughnessToMip:S,m0:u,cubeUV_maxMipLevel:t}}();var Nh=class extends Ht{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??Nh.VIEW}getShared(){return this.scope===Nh.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case Nh.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Nh.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case Nh.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},en=Nh;en.LOCAL="local",en.WORLD="world",en.VIEW="view",en.NORMAL="normal";Zi.addKeyword("viewNormal",function(){return new en(en.VIEW)});Zi.addKeyword("localNormal",function(){return new en(en.NORMAL)});Zi.addKeyword("worldNormal",function(){return new en(en.WORLD)});var ka=class extends Ht{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??ka.LOCAL}getType(){switch(this.scope){case ka.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case ka.LOCAL:case ka.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case ka.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case ka.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case ka.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case ka.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Ss=ka;Ss.LOCAL="local",Ss.WORLD="world",Ss.VIEW="view",Ss.PROJECTION="projection";Zi.addKeyword("position",function(){return new Ss});Zi.addKeyword("worldPosition",function(){return new Ss(Ss.WORLD)});Zi.addKeyword("viewPosition",function(){return new Ss(Ss.VIEW)});var Ys=class extends Ht{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Ys.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Ys.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case Ys.VECTOR:{let n=new en(en.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new Ss(Ss.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case Ys.CUBE:{let n=new Ys(Ys.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Ys.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new Ys(Ys.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},Lu=Ys;Lu.CUBE="cube",Lu.SPHERE="sphere",Lu.VECTOR="vector";var uce=class extends Ht{constructor(e=new qa,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new vx(this.value,t??new Lu(Lu.VECTOR),r),this.irradianceNode=new vx(this.value,new en(en.WORLD),new Be(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},dce=class extends un{constructor(e=new x7,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new Lu,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new aa(new Zt("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},pce=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,fce=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,mce=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,gce=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,pA=["x","y","z","w"],vce=["float","vec2","vec3","vec4"],yce={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},xce={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},bce=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(pce),this.addFragmentParsCode(fce),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(mce),this.addFragmentFinalCode(gce)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:r+=t+" "+c+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Rl?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new hA({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new hA({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var s;let i;if(e=typeof e=="string"?Zi.get(e):e,this.context.include===!1)return e.name;e instanceof Pe?i=this.includes.functions:e instanceof zt?i=this.includes.consts:e instanceof LO&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof Pe&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return r&&(a.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return vce[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case Bc:case kc:return new dce(r);case h1:return new uce(new qa(r));default:return new qa(r)}else{if(r.isVector2)return new hi(r);if(r.isVector3)return new jn(r);if(r.isVector4)return new ja(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return yce[e]||e}getFormatByType(e){return xce[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return pA[e]}getIndexByElement(e){return pA.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=pa,t===pa&&this.context.gamma&&(t=dt),t}},gr=class extends un{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof on?e:new on(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},Wt=class extends un{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},ki=class extends un{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},tc=class extends un{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},b8=class extends un{},wce=class extends b8{constructor(e){super("v3"),this.image=e,this._value=new T}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},yx=class extends b8{constructor(e,t){super("t"),this.image=e,this.wrap=t}get value(){return this.image.getTexture(this.wrap)}},DO=class extends un{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new ti}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},va=class extends un{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new Ce}generateReadonly(t,r,i,n,s,a){return t.format("mat4("+this.value.elements.join(", ")+")",n,r)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function fA(e,t,r){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0)}var Cce=class extends DO{constructor(e,t){super(new ti),this.repeat=e,this.offset=t,fA(this.value,e,t)}updateMatrix(){fA(this.value,this.repeat,this.offset)}},rc=class extends un{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof pt?new Array(e).fill(t):new Array(e).fill(new pt(0))}},mA=class extends Ht{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},IO=class extends Ht{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(IO.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},xx=IO;xx.Nodes=function(){return{customColor:new Pe(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var OO=class extends Ht{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(OO.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},RO=OO;RO.Nodes=function(){return{customNormal:new Pe(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Dp=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(Dp.Nodes.cylindrical);break;case 2:i=e.include(Dp.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new Pe(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(o);break;case 4:i=e.include(Dp.Nodes.triplanar);break;default:i=e.include(Dp.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${r}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(a),n.push(o),n.push(l),n.push(c)}else{let s=`${r}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},w8=Dp;w8.Nodes=function(){let e=new Pe(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new Pe(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new Pe(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new Pe(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var Ip=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=h,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new Pe(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Ip.Nodes.vectorLinearWorldSpaceDepth,Ip.Nodes.vectorLinearObjectSpaceDepth,Ip.Nodes.vectorSphericalObjectSpaceDepth,Ip.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},BO=Ip;BO.Nodes=function(){let e=new Pe(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new Pe(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new Pe(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new Pe(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var Sce=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new Pe(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},kO=class extends Ht{constructor(e,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(kO.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},NO=kO;NO.Nodes=function(){return{gradient:new Pe(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var zO=class extends Ht{constructor(e,t,r,i){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(zO.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},FO=zO;FO.Nodes=function(){return{matcap:new Pe(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var C8=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(C8||{}),Qi=function(){let e=new Pe(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new Pe(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new zt("float F3 0.3333333"),t.keywords.G3=new zt("float G3 0.1666667");let r=new Pe(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new Pe("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new Pe("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new Pe(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),a=new Pe("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new Pe("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new Pe(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),c=new Pe(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new zt("int NUM_OCTAVES 5");let u=new Pe("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new Pe(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,u]),d=new Pe(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new Pe(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new Pe(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new Pe(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new Pe(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new Pe(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new Pe(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,p,f,m,g,v]);return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:c,perlin:h,voronoi:y}}(),jO=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(C8)[this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new Pe(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Qi.simplex,Qi.simplexFractal,Qi.simplexAshima,Qi.fbm,Qi.perlin,Qi.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};jO.numOctaves=5;var UO=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(UO.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},VO=UO;VO.Nodes=function(){let e=new Pe(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Pe(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Na=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new Pe(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new Pe(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let u=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let o=new Pe(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,Na.DrawFunctions.circle,Na.DrawFunctions.ring,Na.DrawFunctions.polygon,Na.DrawFunctions.cross,Na.DrawFunctions.diamond,Na.DrawFunctions.checkerboard,Na.DrawFunctions.line,Na.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},HO=Na;HO.DrawFunctions=function(){let e=new Pe(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new Pe(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new Pe(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new Pe(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new Pe(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new Pe(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new Pe(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new Pe(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new Pe(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new Pe(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var GO=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(GO.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},WO=GO;WO.Nodes=function(){let e=new Pe(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Qi.simplex]);return{rainbow:new Pe(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var qO=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(qO.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},XO=qO;XO.Nodes=function(){let e=new Pe(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new Pe(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new Pe(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new Pe(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new Pe(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new Pe(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Qi.simplex,e,r,n])}}();var _ce=function(){return{textureBicubic:new Pe(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function Ace(e,t){return e>=t?new W(t/e,1):new W(1,e/t)}var YO=class extends Ht{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,Je.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(YO.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},QO=YO;QO.Nodes=function(){let e=new Pe(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new Pe(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new Pe(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new Pe(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[_ce.textureBicubic,r,e]),n=new Pe(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new Pe(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var bx=(e=>(e.NOISE="noise",e.MAP="map",e))(bx||{}),KO=class extends Ht{constructor(e,t,r,i,n,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new Wt(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(bx)[this.displacementTypeIndex.value]==="map"&&(this.mat=new DO(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=i,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(bx)[this.displacementTypeIndex.value]){case"map":{r=e.include(KO.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(C8)[this.noiseFunctionIndex.value],s=new Pe(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new Pe(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[Qi.simplex,Qi.simplexFractal,Qi.simplexAshima,Qi.fbm,Qi.perlin,Qi.voronoi]),l=new Pe(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},ZO=KO;ZO.Nodes=function(){let e=new Pe(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new Pe(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Pe(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var Je={normalRenderTarget:new qa,normalRenderTargetDepth:new qa,transmissionRenderTarget:new qa,aspectRatio:new hi,transmissionSize:new hi(2048,2048),transmissionRenderTargetDepth:new qa,aoRenderTarget:new qa,aoEnabled:new ki,pixelRatioNode:new Be(1),resolution:new hi,penumbraSize:new tc(5,.5),frameIndex:new Wt(0),transmissionLod:new Wt(2)};for(let e of Object.values(Je))e.isRenderGlobal=!0;var JO=class extends Rl{constructor(){super("basic"),this.nodeType="Basic",this.color=new gr(ns),this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.previousModelViewMatrix=new va,this.previouseProjectionMatrix=new va}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({resolution:Je.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(pd.merge([Le.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new gr(ns)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",r.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${r.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},Ece=class extends Rl{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new gr(ns),this.emissive=new gr(0),this.emissiveIntensity=new Be(1),this.previousModelViewMatrix=new va,this.previouseProjectionMatrix=new va,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new ki(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({resolution:Je.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(pd.merge([Le.fog,Le.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Je.penumbraSize}),e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({aoMap:Je.aoRenderTarget}),e.mergeUniform({aoEnabled:Je.aoEnabled}),this.color===void 0&&(this.color=new gr(ns)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&h.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},id=function(){let e=new Pe(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new Pe(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),Mce=class extends Rl{constructor(){super("phong"),this.nodeType="Phong",this.color=new gr(ns),this.specular=new gr(1118481),this.shininess=new Be(30),this.previousModelViewMatrix=new va,this.previouseProjectionMatrix=new va,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new ki(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({resolution:Je.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(pd.merge([Le.fog,Le.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Je.penumbraSize}),e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({aoMap:Je.aoRenderTarget}),e.mergeUniform({aoEnabled:Je.aoEnabled}),this.color===void 0&&(this.color=new gr(ns)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(id.dHdxy),e.include(id.perturbNormalArb);let p=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${g}
					`)}h.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},Tce=class extends Rl{constructor(){super("standard"),this.nodeType="Standard",this.color=new gr(ns),this.roughness=new Be(.3),this.metalness=new Be(0),this.reflectivity=new Be(.5),this.previousModelViewMatrix=new va,this.previouseProjectionMatrix=new va,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0),this.occlusion=new ki(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({resolution:Je.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(pd.merge([Le.fog,Le.lights])),Le.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Je.penumbraSize}),e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({aoMap:Je.aoRenderTarget}),e.mergeUniform({aoEnabled:Je.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new gr(ns)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(id.dHdxy),e.include(id.perturbNormalArb);let m=this.bumpMap.texture.flow(e,"t"),g=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${y}
					`)}if(p.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(e,"t"),g=this.roughnessMap.flow(e,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else p.push(s.code,"	float roughnessFactor = "+s.result+";");u&&p.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&p.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push(`gl_FragColor.a *= ${h.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join(`
`)}return t}},Lce=class extends Rl{constructor(){super("toon"),this.nodeType="Toon",this.color=new gr(ns),this.specular=new gr(1118481),this.shininess=new Be(30),this.previousModelViewMatrix=new va,this.previouseProjectionMatrix=new va,this.shadingAlpha=new Be(1),this.shadingBlend=new Wt(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({resolution:Je.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(pd.merge([Le.fog,Le.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Je.penumbraSize}),e.mergeUniform({frameIndex:Je.frameIndex}),e.mergeUniform({aoMap:Je.aoRenderTarget}),e.mergeUniform({aoEnabled:Je.aoEnabled}),this.color===void 0&&(this.color=new gr(ns)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(id.dHdxy),e.include(id.perturbNormalArb);let d=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}u.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${a.result} );
				}
				`),o&&u.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},Pce=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},Dce=class extends Pce{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},m3;function Ice(e){return typeof e=="string"?e:(m3||(m3=new Dce),m3.load(e))}var Oce=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},Rce=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},$O=class extends Oce{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isVideo=e.type==="video",this.updateSrc(e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let n of i){let s=this[n];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=s=>{var a;i=(a=s.target)==null?void 0:a.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=Ice(e),this.img.onload=t}getTexture(e){let t=this[e];if(t)return t;{let r;return this.isVideo?r=new QQ(this.img,void 0,e,e):r=new Vr(this.img,void 0,e,e),this.loaded&&(r.needsUpdate=!0),this[e]=r,r}}disposeTextures(){var e,t,r;(e=this[1e3])==null||e.dispose(),this[1e3]=void 0,(t=this[1001])==null||t.dispose(),this[1001]=void 0,(r=this[1002])==null||r.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},gc=class extends $O{};function zi(e,t){return t.color(e)}function Bce(e,t){switch(e.type){case"fresnel":return zce(e,t);case"gradient":return Fce(e);case"depth":return jce(e);case"normal":return Uce(e);case"noise":return Vce(e,t);case"rainbow":return Hce(e);case"toon":return Gce(e,t);case"outline":return Wce(e,t);case"transmission":return qce(e);case"color":return Nce(e,t);case"pattern":return Xce(e,t)}}function kce(e){return{type:e.type}}function Os(e){let{alpha:t,mode:r,isMask:i}=e;return{...kce(e),alpha:t,mode:r,isMask:i}}function Nce(e,t){return{...Os(e),color:zi(e.color,t)}}function zce(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a,isMask:o}=e;return{...Os(e),color:zi(a,t),bias:r,scale:i,intensity:n,factor:s}}function Fce(e){let{gradientType:t,smooth:r,colors:i,steps:n,angle:s,offset:a,morph:o}=e;return{...Os(e),gradientType:t,smooth:r,colors:i.map(l=>new pt(l[0],l[1],l[2],l[3])),num:i.length,steps:n,offset:new W(...a),morph:new W(...o),angle:s}}function jce(e){let{gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:a,direction:o,colors:l,steps:c,smooth:u}=e;return{...Os(e),gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:new T(...a),direction:o?new T(...o):new T(1,0,0),colors:l.map(h=>h!==void 0?new pt(h[0],h[1],h[2],h[3]):new pt(0,0,0,0)),steps:c.slice(0,l.length),smooth:u}}function Uce(e){let{cnormal:t}=e;return{...Os(e),cnormal:new T(t[0],t[1],t[2])}}function Vce(e,t){return{...Os(e),scale:e.scale,move:e.move,fA:new W(...e.fA),fB:new W(...e.fB),size:new T(...e.size),distortion:new W(...e.distortion),colorA:zi(e.colorA,t),colorB:zi(e.colorB,t),colorC:zi(e.colorC,t),colorD:zi(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function Hce(e){return{...Os(e),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new T(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new T(...e.offset)}}function Gce(e,t){return{...Os(e),positioning:e.positioning,colors:e.colors.map(r=>new pt(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new T(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:zi(e.shadowColor,t),offset:new T(...e.offset)}}function Wce(e,t){return{...Os(e),outlineColor:zi(e.outlineColor,t),contourColor:zi(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new T(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function qce(e,t){return{...Os(e),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function Xce(e,t){return{...Os(e),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new W(...e.offset),colorA:zi(e.colorA,t),colorB:zi(e.colorB,t),frequency:new W(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new W(...e.vertical),horizontal:new W(...e.horizontal),sides:e.sides}}var ev=class extends on{},eR={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},tR={depth:["colors"]};function Yce(e,t,r){var s,a;if(t==="isMask")return!0;let i=eR[e.type],n=tR[e.type];if(n!==void 0){let o=e.color;if(n.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function rR(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=i;l.image instanceof gc||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=i;l.image instanceof gc||l.image.deref(),l.image=o}if("wrapping"in s){let a=i;a.wrap=s.wrapping}if("repeat"in s||"offset"in s){let a="mat",o=r.uniforms[`f${r.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),o.updateMatrix()}return n}function Qce(e,t,r,i){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(nR(s,r,i)){s==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let o=r.uniforms[`f${r.id}_${s}`];if(o&&!(o instanceof b8))switch(n=n||Yce(r,s,a),o.constructor){case gr:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof ev?o.value=new on(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case ja:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof ev?o.value=new on(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case hi:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case jn:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case qa:{rR(a,t,r);break}case rc:{o.value=a.map(l=>new pt(...l));break}default:{o.value=a;break}}}return n}var Tc=class{constructor(e,t,r,i){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let n in i)this.uniforms[`f${this.id}_${n}`]=i[n];for(let n in r)nR(n,this,r)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return Ua.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.image(r.texture.image):i.video(r.texture.video),s=new yx(n,r.texture.wrapping),a=new wce(n),o=new Cce(r.texture.repeat,r.texture.offset),l=new Be(r.crop?1:0),c=new Wt(r.projection??0),u=new Wt(["x","y","z"].indexOf(r.axis)??0),h=new Wt(r.side??0),d=new hi(r.size?new W(r.size[0],r.size[1]):new W(100,100)),p=new Be(r.blending??0),f=new Be(r.alpha??1),m=new Wt(r.mode??0),g=new ki(r.isMask??!1),v=new w8(s,a,l,c,u,h,d,p,o,f,m,g),y=new Zt(v.calpha,"f");return new ur(e,t,r,{texture:s,textureSize:a,crop:l,projection:c,axis:u,side:h,size:d,blending:p,mat:o,alpha:f,mode:m,isMask:g},v,m,y,g)}else if(r.type==="matcap"){let n=i.image(r.texture.image),s=new yx(n,r.texture.wrapping),a=new Be(r.alpha??1),o=new Wt(r.mode??0),l=new ki(r.isMask??!1),c=new FO(s,a,o,l),u=new Zt(c.calpha,"f");return new ur(e,t,r,{texture:s,alpha:a,mode:o,isMask:l},c,o,u,l)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new jn(new T(...r.offset)),s=new Be(r.scale??10),a=new Be(r.intensity??8),o=new Be(r.movement??1),l=new Wt(r.noiseType??0),c=new Wt(r.voronoiStyle??0),u=new Be(r.smoothness??.5),h=new Be(r.seed??0),d=new Be(r.highCut??1),p=new Be(r.lowCut??0),f=new Wt(r.quality??1),m=new ZO(a,o,n,c,u,h,d,p,f,s,l);return new iR(e,t,r,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:h,highCut:d,lowCut:p,quality:f},m)}else throw new Error;else return Jce(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):Qce(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?rR(i.props,r.shared,this):!0;return!1}dispose(){if(Kce(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof gc||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},ur=class extends Tc{constructor(e,t,r,i,n,s,a,o){super(e,t,r,i),this.params=i,this.color=n,this.mode=s,this.alpha=a,this.isMask=o}},iR=class extends Tc{constructor(e,t,r,i,n){super(e,t,r,i),this.position=n}},Ua=class extends Tc{constructor(e,t,r,i,n){super(e,t,r,n),this.node=i}static createLigherLayer(e,t,r,i){let n,s=new Be(r.alpha),a=new Wt(r.mode),o=new Be(r.bumpMapIntensity),l=new Be(r.alphaOverride),c;if(!r.visible)n=new JO,c={};else if(r.category==="lambert"){n=new Ece;let u=new gr(i.color(r.emissive)??0),h=new ki(r.occlusion??!0);c={emissive:u,occlusion:h},n.emissive=u,n.occlusion=h}else if(r.category==="toon"){n=new Lce;let u=new Be(r.shininess??30),h=new gr(i.color(r.specular)??1118481);c={shininess:u,specular:h},n.shininess=u,n.specular=h}else if(r.category==="physical"){n=new Tce;let u=new Be(r.roughness??.3),h=new Be(r.metalness??0),d=new Be(r.reflectivity??.5),p=new ki(r.occlusion??!0);c={roughness:u,metalness:h,reflectivity:d,occlusion:p},n.roughness=u,n.metalness=h,n.reflectivity=d,n.occlusion=p}else{n=new Mce;let u=new Be(r.shininess??30),h=new gr(r.specular!==void 0?i.color(r.specular)??1118481:1118481),d=new ki(r.occlusion??!0);c={shininess:u,specular:h,occlusion:d},n.shininess=u,n.specular=h,n.occlusion=d}return n.alpha=new Be(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new Ua(e,t,r,n,c)}get category(){return this.node.category}};function Kce(e){let t=e instanceof Tc?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function kn(e){return{alpha:new Be(e.alpha??1),mode:new Wt(e.mode??0),isMask:new ki(e.isMask??!1)}}function Zce(e,t,r,i){switch(e.type){case"color":{let n=new gr(i.color??ns),s=kn(i),a=new xx(n,s.alpha),o=new Zt(a.calpha,"f");return new ur(t,r,e,{color:n,...s},a,s.mode,o,s.isMask)}case"fresnel":{let n=new gr(i.color??16777215),s=new Be(i.bias??.1),a=new Be(i.scale??1),o=new Be(i.intensity??2),l=new Be(i.factor??1),c=kn(i),u=new Sce(n,s,a,o,l,c.alpha,c.mode,c.isMask),h=new Zt(u.calpha,"f");return new ur(t,r,e,{color:n,bias:s,scale:a,intensity:o,factor:l,...c},u,c.mode,h,c.isMask)}case"rainbow":{let n=new Be(i.filmThickness??30),s=new Be(i.movement??0),a=new jn(i.wavelengths??new T(0,0,0)),o=new Be(i.noiseStrength??0),l=new Be(i.noiseScale??1),c=new jn(i.offset??new T(0,0,0)),u=kn(i),h=new WO(n,s,a,o,l,c,u.alpha,u.isMask),d=new Zt(h.calpha,"f");return new ur(t,r,e,{filmThickness:n,movement:s,wavelengths:a,noiseStrength:o,noiseScale:l,offset:c,...u},h,u.mode,d,u.isMask)}case"transmission":{let n=new Be(i.thickness??10),s=new Be(i.ior??1.5),a=new Be(i.roughness??.5),o=Je.transmissionSize,l=Je.transmissionRenderTarget,c=Je.transmissionRenderTargetDepth,u=window.innerWidth,h=window.innerHeight,d=u>=h?new hi(h/u,1):new hi(1,u/h),p=kn(i),f=new QO(n,s,a,o,l,c,d,p.alpha),m=new Zt(f.calpha,"f");return new ur(t,r,e,{thickness:n,ior:s,roughness:a,aspectRatio:d,...p},f,p.mode,m,p.isMask)}case"toon":{let n=new Wt(i.positioning??0),s;i.colors?s=new rc(i.colors.length,i.colors):(s=new rc(10,new pt(0,0,0,1)),s.value[1]=new pt(1,1,1,1));let a;i.steps?a=new tc(i.steps.length,i.steps):(a=new tc(10,1),a.value[0]=0);let o=new jn(i.source??new T(0,0,0)),l=new ki(i.isWorldSpace??!0),c=new Be(i.noiseStrength??0),u=new Be(i.noiseScale??1),h=new ja(i.shadowColor),d=new jn(i.offset??new T(0,0,0)),p=kn(i),f=new XO(n,s,a,o,l,c,u,h,d,p.alpha),m=new Zt(f.calpha,"f");return new ur(t,r,e,{positioning:n,colors:s,steps:a,source:o,isWorldSpace:l,noiseStrength:c,noiseScale:u,shadowColor:h,offset:d,...p},f,p.mode,m,p.isMask)}case"outline":{let n=new gr(i.outlineColor??16777215),s=new gr(i.contourColor??16777215),a=new Be(i.outlineWidth??.1),o=new Be(i.contourWidth??.1),l=new Be(i.outlineThreshold??.1),c=new Be(i.contourThreshold??.1),u=new Be(i.outlineSmoothing??.1),h=new Be(i.contourFrequency??.1),d=new jn(i.contourDirection??new T(0,1,0)),p=new ki(i.positionalLines??!1),f=new ki(i.compensation??!0),m=Je.normalRenderTarget,g=Je.normalRenderTargetDepth,v=Je.pixelRatioNode,y=Je.resolution,x=kn(i),b=new VO(n,s,a,o,l,c,u,h,d,p,f,y,m,g,v,x.alpha),w=new Zt(b.calpha,"f");return new ur(t,r,e,{outlineColor:n,contourColor:s,outlineWidth:a,contourWidth:o,outlineThreshold:l,contourThreshold:c,outlineSmoothing:u,contourFrequency:h,contourDirection:d,positionalLines:p,compensation:f,...x},b,x.mode,w,x.isMask)}case"depth":{let n=new Wt(i.gradientType??0),s=new ki(i.smooth??!1),a=new Be(i.near??50),o=new Be(i.far??200),l=new Be(i.isVector??1),c=new Be(i.isWorldSpace??0),u=new jn(i.origin??new T),h=new jn(i.direction??new T),d;i.colors?d=new rc(i.colors.length,i.colors):(d=new rc(2,new pt(0,0,0,1)),d.value[1]=new pt(1,1,1,1));let p;i.steps?p=new tc(i.steps.length,i.steps):(p=new tc(2,1),p.value[0]=0);let f=kn(i),m=new BO(n,s,a,o,l,c,u,h,d,p,f.alpha,f.isMask),g=new Zt(m.calpha,"f");return new ur(t,r,e,{gradientType:n,smooth:s,near:a,far:o,isVector:l,isWorldSpace:c,origin:u,direction:h,colors:d,steps:p,...f},m,f.mode,g,f.isMask)}case"noise":{let n=new Be(i.scale??1),s=new jn(i.size??new T(100,100,100)),a=new Be(i.move??1),o=new hi(i.fA??new W(1.7,9.2)),l=new hi(i.fB??new W(8.3,2.8)),c=new hi(i.distortion??new W(1,1)),u=new ja(i.colorA),h=new ja(i.colorB),d=new ja(i.colorC),p=new ja(i.colorD),f=new Wt(i.noiseType??0),m=new Wt(i.voronoiStyle??0),g=new Be(i.highCut??1),v=new Be(i.lowCut??0),y=new Be(i.smoothness??.5),x=new Be(i.seed??.5),b=new Wt(i.quality??1),w=kn(i),C=new jO(n,s,a,o,l,c,u,h,d,p,w.alpha,f,w.isMask,m,g,v,y,x,b),_=new Zt(C.calpha,"f");return new ur(t,r,e,{scale:n,size:s,move:a,fA:o,fB:l,distortion:c,colorA:u,colorB:h,colorC:d,colorD:p,noiseType:f,...w,voronoiStyle:m,highCut:g,lowCut:v,smoothness:y,seed:x,quality:b},C,w.mode,_,w.isMask)}case"normal":{let n=new jn(i.cnormal??new T(1,1,1)),s=kn(i),a=new RO(n,s.alpha),o=new Zt(a.calpha,"f");return new ur(t,r,e,{cnormal:n,...s},a,s.mode,o,s.isMask)}case"gradient":{let n=new Wt(i.gradientType??0),s=new ki(i.smooth??!1),a;i.colors?a=new rc(i.colors.length,i.colors):(a=new rc(10,new pt(0,0,0,1)),a.value[1]=new pt(1,1,1,1));let o;i.steps?o=new tc(i.steps.length,i.steps):(o=new tc(10,1),o.value[0]=0);let l=new hi(i.offset??new W(0,0)),c=new hi(i.morph??new W(0,0)),u=new Be(i.angle??0),h=kn(i),d=new NO(n,s,a,o,l,c,u,h.alpha,h.isMask),p=new Zt(d.calpha,"f");return new ur(t,r,e,{gradientType:n,smooth:s,colors:a,steps:o,offset:l,morph:c,angle:u,...h},d,h.mode,p,h.isMask)}case"pattern":{let n=new Wt(i.style??0),s=new Wt(i.projection??0),a=new Wt(["x","y","z"].indexOf(i.axis)??0),o=new Be(i.blending??0),l=new hi(i.offset??new W(0,0)),c=new ja(i.colorA),u=new ja(i.colorB),h=new hi(i.frequency??new W(10,10)),d=new Be(i.size??.5),p=new Be(i.variation??0),f=new Be(i.smoothness??.5),m=new Be(i.zigzag??0),g=new Be(i.rotation??0),v=new hi(i.vertical??new W(0,1)),y=new hi(i.horizontal??new W(0,1)),x=new Wt(i.sides??6),b=kn(i),w=new HO(n,s,a,o,l,c,u,h,d,p,f,m,g,v,y,x,b.alpha,b.isMask),C=new Zt(w.calpha,"f");return new ur(t,r,e,{style:n,projection:s,axis:a,blending:o,offset:l,colorA:c,colorB:u,frequency:h,size:d,variation:p,smoothness:f,zigzag:m,rotation:g,vertical:v,horizontal:y,sides:x,...b},w,b.mode,C,b.isMask)}default:{let n=new gr(1,0,0,1),s=kn(i),a=new xx(n,s.alpha),o=new Zt(a.calpha,"f");return new ur(t,r,e,{color:n,...s},a,s.mode,o,s.isMask)}}}function Jce(e,t,r,i){let n=Bce(r,i);return Zce(r,e,t,n)}function nR(e,t,r){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let i=t.uniforms[`f${t.id}_intensity`];return i?(i.value=r.intensity*(r.visible?1:0),i):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let i=t.uniforms[`f${t.id}_alpha`];if(!i)return;if(i.value=r.alpha*(r.visible?1:0),r.type==="outline"&&e==="visible"){let n=t.uniforms[`f${t.id}_compensation`];n&&(n.value=r.compensation&&r.visible)}return i}}function tv(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i&&i.data.alphaOverride<1)return!0;for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,u=Math.min(a,Math.min(o,Math.min(l,c)));u<1&&(s=u)}r+=(1-r)*s}}return r<1}var _l=class extends Yt{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},$ce=class extends _l{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},S8=class extends _l{constructor(e,t){super(),this.data=e,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(e,t)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new $ce(e,t,r,this),this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t){this.data!==e&&this.reset0(e,t)}reset0(e,t){this.data=e;let r=e.layers??Si.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>Tc.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(),this.transparent=tv(e,t.shared)}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof Ua),this.lightLayer===void 0&&(this.lightLayer=new Ua(0,"",{...Yi.defaultData("light","phong"),visible:!1},new JO,{})),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let e=this.layers.find(n=>n instanceof Ua);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof ur&&s.color instanceof w8&&(s.uuid===r&&(e.node.bumpMap=s.color),s.uuid===i&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,r){if(t!==void 0?this.data=t:t=this.data,this.transparent=tv(t,r.shared),e.path[0]==="layers"){this.data=t;let i=r.shared,n=e.path[1];if(n===void 0){if(this.layers.reverse(),e.type===4){let s=Tc.create(this.layerIdGen++,e.id,e.data,r.shared);this.layers.splice(e.localIndex,0,s),r.scene.markNeedsUpdateRendererDirty()}else if(e.type===5)this.layers.splice(e.localIndex,1)[0].dispose(),r.scene.markNeedsUpdateRendererDirty();else if(e.type===6){let s=this.layers.findIndex(o=>o.uuid===e.id),a=this.layers[s];this.layers.splice(s,1),this.layers.splice(e.localIndex,0,a),r.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n);if(s.updateByOp({...e,path:e.path.slice(2)},a,r)){let o=Tc.create(this.layerIdGen++,n,a,i);this.layers.splice(this.layers.findIndex(l=>l.uuid===n),1,o),this.onUpdate()}}}}else this.reset(t,r)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof ur?t.color.mask=void 0:t instanceof Ua&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof ur&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof Ua?i.node.mask=new qi(t.color,t.alpha,qi.MUL):i instanceof ur&&(i.isMask.value||(i.color.mask=new qi(t.color,t.alpha,qi.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof ur),t=this.layers.findIndex(r=>r instanceof Ua);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof ur){if(n.isMask.value)continue;r=new mA(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new Zt("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof Ua);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof ur){if(i.isMask.value)continue;e=new mA(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof iR);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new qi(t,e[r].position,qi.ADD),t=new qi(t,new Be(.5).setReadonly(!0),qi.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}computeCacheKey(){let e="[";for(let{data:t}of this.data.layers)if(t.type==="light")e+=`"${t.visible?t.category.toUpperCase():"Basic"}"`;else{let r=(eR[t.type]??[]).map(o=>t[o]),i=(tR[t.type]??[]).map(o=>{var l;return((l=t[o])==null?void 0:l.length)??0}),n=[...r,...i],s="isMask"in t&&t.isMask,a=`"${t.type}-${t.visible}-${s}"`;n.length?e+=`[${a}, "${n.join('","')}"],`:e+=a}return e=e.slice(0,-1)+"]",e}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new bce;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof ur){let t=e.params.texture;if(t instanceof yx&&!t.image.loaded)return!1}return!0}getHash(){let e="{";return e+='"fragment":'+this.fragment.getHash(),e+="}",e}};Object.defineProperties(_l.prototype,{properties:{get:function(){return this.fragment.properties}}});var wx=class extends S8{},ehe=hd(FH()),gA=new Map;function the(e){if(typeof e=="string")return e;let t=gA.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},gA.set(e,t)),t.url}var Op=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:the(e),format:"wav"},this.sound=new ehe.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},rhe=class{constructor(){this.type="ShapePath",this.color=new $e,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new wg,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(p,f,m,g){let v=p.x,y=f.x,x=m.x,b=g.x,w=p.y,C=f.y,_=m.y,S=g.y,A=(b-x)*(w-_)-(S-_)*(v-x),E=(y-v)*(w-_)-(C-w)*(v-x),L=(S-_)*(y-v)-(b-x)*(C-w),P=A/L,D=E/L;if(L===0&&A!==0||P<=0||P>=1||D<0||D>1)return null;if(A===0&&L===0){for(let I=0;I<2;I++)if(i(I===0?m:g,p,f),t.loc===e.ORIGIN){let B=I===0?m:g;return{x:B.x,y:B.y,t:t.t}}else if(t.loc===e.BETWEEN){let B=+(v+t.t*(y-v)).toPrecision(10),X=+(w+t.t*(C-w)).toPrecision(10);return{x:B,y:X,t:t.t}}return null}else{for(let X=0;X<2;X++)if(i(X===0?m:g,p,f),t.loc===e.ORIGIN){let H=X===0?m:g;return{x:H.x,y:H.y,t:t.t}}let I=+(v+P*(y-v)).toPrecision(10),B=+(w+P*(C-w)).toPrecision(10);return{x:I,y:B,t:P}}}function i(p,f,m){let g=m.x-f.x,v=m.y-f.y,y=p.x-f.x,x=p.y-f.y,b=g*x-y*v;if(p.x===f.x&&p.y===f.y){t.loc=e.ORIGIN,t.t=0;return}if(p.x===m.x&&p.y===m.y){t.loc=e.DESTINATION,t.t=1;return}if(b<-Number.EPSILON){t.loc=e.LEFT;return}if(b>Number.EPSILON){t.loc=e.RIGHT;return}if(g*y<0||v*x<0){t.loc=e.BEHIND;return}if(Math.sqrt(g*g+v*v)<Math.sqrt(y*y+x*x)){t.loc=e.BEYOND;return}let w;g!==0?w=y/g:w=x/v,t.loc=e.BETWEEN,t.t=w}function n(p,f){let m=[],g=[];for(let v=1;v<p.length;v++){let y=p[v-1],x=p[v];for(let b=1;b<f.length;b++){let w=f[b-1],C=f[b],_=r(y,x,w,C);_!==null&&m.find(S=>S.t<=_.t+Number.EPSILON&&S.t>=_.t-Number.EPSILON)===void 0&&(m.push(_),g.push(new W(_.x,_.y)))}}return g}function s(p,f,m){let g=new W;f.getCenter(g);let v=[];return m.forEach(y=>{y.boundingBox.containsPoint(g)&&n(p,y.points).forEach(x=>{v.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),v.sort((y,x)=>y.point.x-x.point.x),v}function a(p,f,m,g,v){(v==null||v==="")&&(v="nonzero");let y=new W;p.boundingBox.getCenter(y);let x=[new W(m,y.y),new W(g,y.y)],b=s(x,p.boundingBox,f);b.sort((E,L)=>E.point.x-L.point.x);let w=[],C=[];b.forEach(E=>{E.identifier===p.identifier?w.push(E):C.push(E)});let _=w[0].point.x,S=[],A=0;for(;A<C.length&&C[A].point.x<_;)S.length>0&&S[S.length-1]===C[A].identifier?S.pop():S.push(C[A].identifier),A++;if(S.push(p.identifier),v==="evenodd"){let E=S.length%2===0,L=S[S.length-2];return{identifier:p.identifier,isHole:E,for:L}}else if(v==="nonzero"){let E=!0,L=null,P=null;for(let D=0;D<S.length;D++){let I=S[D];f[I]&&(E?(P=f[I].isCW,E=!1,L=I):P!==f[I].isCW&&(P=f[I].isCW,E=!0))}return{identifier:p.identifier,isHole:E,for:L}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(p=>{let f=p.getPoints(),m=-999999999,g=999999999,v=-999999999,y=999999999;for(let x=0;x<f.length;x++){let b=f[x];b.y>m&&(m=b.y),b.y<g&&(g=b.y),b.x>v&&(v=b.x),b.x<y&&(y=b.x)}c<=v&&(c=v+1),l>=y&&(l=y-1),f.length&&u.push({curves:p.curves,points:f,isCW:bD.isClockWise(f),identifier:o++,boundingBox:new eZ(new W(y,g),new W(v,m))})});let h=u.map(p=>{var f;return a(p,u,l,c,(f=this.userData)==null?void 0:f.style.fillRule)}),d=[];return u.forEach(p=>{let f=h[p.identifier];if(f&&!f.isHole){let m=new Cg;m.curves=p.curves,h.filter(g=>(g==null?void 0:g.isHole)&&g.for===p.identifier).forEach(g=>{if(g){let v=u[g.identifier],y=new wg;y.curves=v.curves,m.holes.push(y)}}),d.push(m)}}),d}},sR,vA=new Promise(e=>{sR=e}),yA=!1,qm;function ihe(){if(yA)return;if(qm)return qm;async function e(){let t=await c1(()=>import("./opentype-fc28cde9.js"),[]);sR(t),yA=!0}return qm=e(),qm}var nhe=class{async load(e,t,r=()=>{}){let{load:i}=await vA;i(e,(n,s)=>{n||!s?r(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:r}=await vA;try{let i=t(e),n=new r,s=a=>i.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function she(e){return await(await fetch(e)).arrayBuffer()}var ahe=new nhe;async function xA(e){let t,r,i=!1;if(e.url?(t=await she(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){let n=await ahe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}}function ohe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var lhe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=xA(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=xA(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,s=[],a=0,o=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,u=String.fromCharCode(r[l].unicode),h=n[a];if(ohe(c,h)||o)s.push({char:u,index:c,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let d=h.char,p="",f=[h.state.glyphIndex],m=[],g=!1;for(;!g;)a++,p=t.charAt(a),d+=p,f.push(e.charToGlyphIndex(p)),m=e.stringToGlyphs(d),m.length===1&&m[0].index===c&&(g=!0),a>t.length&&(g=!0);s.push({char:u,index:c,replacements:f,replacementChars:Array.from(d)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,s=e.map(v=>this.getTextWidth(v,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,c=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),h=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),d=[],p=e.map(v=>[]),f=e.map(v=>[]),m;for(let v=0;v<e.length;v++){let y=e[v],x={features:{liga:!0}},b=[];try{b=r.stringToGlyphs(y,x)}catch(C){console.warn(C)}u=this.getLineInitialOffsetX(s[v],a,t.horizontalAlign,y,o);let w=[];try{w=this.reverseLigaturesTable(r,y,b)}catch(C){console.warn(C)}c=this.computeSpaceWidthForLine(e,v,t);for(let C=0;C<b.length;C++){let _=b[C],S=_.index===0?`
`:_.unicode?String.fromCharCode(_.unicode):void 0,A=w[C],E=0,L=0;C===0&&t.horizontalAlign===2&&_.leftSideBearing!==void 0&&(L=-_.leftSideBearing*i),m&&(E=r.getKerningValue(_,m)*i),u+=L+E;let P=0;if(S===`
`)P=l;else if(S===" ")P=c;else{let D=this.createPath(_,i,u,h,t);D&&(P=D.offsetX-(E+L),d.push(D.path))}if(A.replacements.length===1)f[v].push([u,h]),p[v].push(P);else{let D=A.replacements.map(H=>(r.glyphs.get(H).advanceWidth??0)*i),I=D.reduce((H,R)=>H+=R,0),B=D.map(H=>H/I),X=u;for(let H=0;H<B.length;H++){let R=P*B[H];f[v].push([X,h]),p[v].push(R),X+=R}}u+=P,m=_}h-=n}let g=[];for(let v=0,y=d.length;v<y;v++)g.push(...d[v].toShapes());return{shapes:g,charWidths:p,lineWidths:s,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*i,o=e-a,l=-this.ascender*i-o/2;return n===3?-(r-s-l):n===2?-(r*.5-s*.5-l):l}createPath(e,t,r,i,n){var l;let s=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new rhe,o=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let u=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(u&&c.type!=="Z"&&u.x===c.x&&-u.y===c.y))switch(c.type){case"M":a.moveTo(c.x,-c.y);break;case"L":a.lineTo(c.x,-c.y);break;case"Q":a.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":a.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return a.subPaths.forEach(c=>{let u=che(c.curves);u!==void 0&&c.currentPoint.distanceTo(u)>0&&c.lineTo(u.x,u.y)}),{offsetX:o+n.fontSize*n.letterSpacing,path:a}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let s=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&s){let a=r.width,o=this.getTextWidth(n,r);return(a-(o-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function che(e){if(e.length){let t=e[0];if(t instanceof Ts)return t.v1;if(t instanceof ws||t instanceof Cl)return t.v0}}var hhe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t){let r=this.objects.get(e);return r===void 0?(r=this.createObject(e,t),this.objects.set(e,r)):r.isShared=!0,r}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},bA=class extends hhe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t){let r=$g(e,t,this.flatShading);return r.computeBoundingSphere(),r}},uhe={markNeedsUpdateRendererDirty:()=>{}},dhe=class extends Rce{constructor(e){super(),this.shared=e}create(e){return new $O(e,this.shared)}},_8=class{constructor(e,t={}){if(this.data=e,this.geometryCache=new bA(!0),this.geometryCache2=new bA(!1),this.imageHolderCache=new dhe(this),this.thisContext={scene:uhe,shared:this},this.deletedMaterial=new wx(Si.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new gc(Xg.emptyImage,this),this.deletedVideo=new gc(jg.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,i]of Object.entries(t.images))this.addImage(r,i);if(t.videos)for(let[r,i]of Object.entries(t.videos))this.addVideo(r,i);if(t.audios)for(let[r,i]of Object.entries(t.audios))this.addAudio(r,i);this.reset(e)}setRequestRender(e){this._requestRender=e}reset(e){this.resetLib(e.lib);for(let[t,r]of Object.entries(e.images))this.addImage(t,r);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new wx(t,this.thisContext);r.uuid=e,this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new S8(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new gc(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new gc(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new ev(t.r,t.g,t.b,t.a):this.colors[e]=new ev(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new on(0,0,0,0))}else return"a"in e?new on(e.r,e.g,e.b,e.a):new on(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Op)return t;{let r=new Op({src:t.data});return this.audios[e]=r,r}}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Op&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new lhe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Op&&e.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){this.data=t,e.path[0]==="images"?e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(Ni.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r}):e.path[0]==="fonts"?e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="lib"&&this.updateLibByOp(Ni.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}};new _8(Ha.emptyData());var Md=class extends cn{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),Yse(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let s=r.shared.material(n);this.material[Number(i)]=s}else if(Yn(e.path,["material"])&&this.material instanceof _l)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(Ni.drop(e,1),t.material,r);else if(Yn(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(Ni.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(s=>t.shared.material(s).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&dI(this.material).forEach(e=>{e instanceof _l&&(e instanceof wx||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},wA=new T,CA=new pt,SA=new pt,phe=new T,_A=new Ce,Fi=class extends Md{constructor(e,t,r){super(e,t),this.data=t,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=t.bindMode,this.bindMatrix=new Ce().fromArray(t.bindMatrix),this.bindMatrixInverse=new Ce)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof nt&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof _8){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return Hg.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return Hg.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),Yn(e.path,["geometry"])&&this.updateByPatchedOpGeometry(Ni.drop(e,1),t.geometry,r)}removeInteractionGeometry(){var e;(e=this.localGeometry)==null||e.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=$g(c,t,this.data.flatShading)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&gx(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=$g(n,t,this.data.flatShading)}}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&Z7(["scaleBaked"],Object.keys(e.props))&&this.geometryCreateDeleyed instanceof Bi&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new pt,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;CA.fromBufferAttribute(i.attributes.skinIndex,e),SA.fromBufferAttribute(i.attributes.skinWeight,e),wA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=SA.getComponent(n);if(s!==0){let a=CA.getComponent(n);_A.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(phe.copy(wA).applyMatrix4(_A),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function fhe(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=new T(n[l],n[l+1],n[l+2]);t.has(c)?(a=t.get(c))==null||a.normals.push(u):t.set(c,{normals:[u],result:new T})}t.forEach((l,c)=>{for(let u of l.normals)l.result.add(u);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=(o=t.get(c))==null?void 0:o.result;u&&(s[l]=u.x,s[l+1]=u.y,s[l+2]=u.z)}e.geometry.setAttribute("extrudeNormal",new ze(s,3))}function mhe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new T;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new ze(r,3))}function A8(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof _l)||e.material.getLayersOfType("outline").length===0)return;e instanceof Fi&&e.is2DAndNoDepth?mhe(e):fhe(e)}function E8(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[gt.seededRandom(i),gt.seededRandom(i+1e4),gt.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)r[s]=n[s%3];e.geometry.setAttribute("randomColor",new st(r,3))}v8.then(e=>{});var Us=new Er,cp=new T;function ghe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var Kf=class extends Fi{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new Ce,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=Bi.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=r),i!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,A8(this),E8(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){Bi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Bi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Bi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Bi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,cn.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Ln,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Us.setFromBufferAttribute(t),Us.getCenter(r),e.boundingSphere.radius=r.distanceTo(Us.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Us.getSize(cp),this.hasNonUniformScale&&cp.divide(this.scale);let i={width:cp.x,height:cp.y,depth:cp.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;Us.min.set(e[0],e[2],e[4]),Us.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Us.min.applyMatrix4(this.shearScaleInv),Us.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Ln);let r=t.boundingSphere.center;Us.getCenter(r),t.boundingSphere.radius=r.distanceTo(Us.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(Bi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},AA=-1,vhe=1,yhe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},xhe={polygon_center:0,edge:1,vertex:2},Xm=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,ut=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-AA)*(r-i)/(vhe-AA)+i};function bhe(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var s=JSON.stringify(e[i].pos.map(a=>Math.round(a*1e4)/1e4));r[s]||(t.push(e[i]),r[s]=!0)}return t}var whe=new T,Ym=new T,Che=new T,She=new T;function Pu(e,t){let r=Che.fromArray(e),i=She.fromArray(t);Ym.copy(i).sub(r);let n=Ym.length();return Ym.normalize().multiplyScalar(n*.5),whe.copy(r).add(Ym).toArray()}var qn=new wi,Qm=new T,rv=new T,oc=new T;function _he(e){let t=[];for(let r=0;r<=e.index.count;r++)if(Qm.fromArray(e.index.array,r*3),qn.setFromAttributeAndIndices(e.attributes.position,Qm.x,Qm.y,Qm.z),qn.getNormal(rv),qn.getMidpoint(oc),!(isNaN(oc.x)||isNaN(oc.y)||isNaN(oc.z))){let{a:i,b:n,c:s}=qn,a=i.toArray(),o=n.toArray(),l=s.toArray(),c=i.distanceTo(n),u=n.distanceTo(s),h=s.distanceTo(i),d=Pu(a,o),p=Pu(o,l),f=Pu(l,a),m=[c,u,h],g=Math.max(...m),v=m.filter(b=>Math.round(b)===Math.round(g)).length>1,y=[],x=qn.getMidpoint(oc).toArray();g===c&&!v&&(y=[p,f,f],x=d),g===u&&!v&&(y=[d,f,f],x=p),g===h&&!v&&(y=[d,p,p],x=f),v&&(y=[d,p,f]),t.push({vertices:[a,o,l],faceCenters:y,midpoint:x,norm:qn.getNormal(rv).toArray()})}return t}function Ahe(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){qn.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),qn.getNormal(rv),qn.getMidpoint(oc);let n=qn.a.toArray(),s=qn.b.toArray(),a=qn.c.toArray();t.push({vertices:[n,s,a],faceCenters:[Pu(n,s),Pu(s,a),Pu(a,n)],midpoint:oc.toArray(),norm:rv.toArray()})}return t}var Ehe=4,Mhe=.5,g3=e=>.5*(1-Math.cos(e*Math.PI)),The=class{constructor(){this.perlin=new Array(4095+1)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),s=Math.floor(r),a=e-i,o=t-n,l=r-s,c,u,h=0,d=.5,p,f,m;for(let g=0;g<Ehe;g++){let v=i+(n<<4)+(s<<8);c=g3(a),u=g3(o),p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),f=this.perlin[v+16&4095],f+=c*(this.perlin[v+16+1&4095]-f),p+=u*(f-p),v+=256,f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),m=this.perlin[v+16&4095],m+=c*(this.perlin[v+16+1&4095]-m),f+=u*(m-f),p+=g3(l)*(f-p),h+=p*d,d*=Mhe,i<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(i++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return h}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4095+1);for(let r=0;r<4095+1;r++)this.perlin[r]=t.rand()}},Lhe=The,EA=new T,MA=new Ce,TA=new dd;function LA(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var aR=class extends Fi{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(MA.copy(r).invert(),TA.copy(e.ray).applyMatrix4(MA),TA.intersectBox(this.singleBBox,EA))){let i=EA.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},Li=1e-4,Vs,oR,lR,cR,PA=new T,DA=new T;v8.then(e=>{Vs=e,oR=[Vs.get_face_center,Vs.get_edge_midpoint,Vs.get_vertex_position],lR=[Vs.get_face_normal,Vs.get_edge_normal,Vs.get_vertex_normal],cR=[Vs.face_count,Vs.edge_count,Vs.vertex_count]});var Phe=new Ce,Dhe=new Ce,Mo=new T,Wl=new T,hp=new T,v3=new T,Ihe=new T,Ohe=new T,La=new Lhe,_s=class extends c8(Vt){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof Ci&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof Ci&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let s=new Ci(this.object);s.expand(),this.add(s)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new Ci(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*gt.DEG2RAD,i=t.end*gt.DEG2RAD,n=r-i,s=new $r(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new T(0,0,1);break;case"y":a=new T(0,1,0);break;default:case"x":a=new T(1,0,0);break}let o=e.randomnessObject??Ko.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";La.noiseSeed(o.seed);let c=e3((0,ip.default)(o.seed)),u=Xm(o.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(o.freqScale/10)+o.movement,f=l?La.noise(p):c(p,p),m=h+1;d.scale.x=t.scale[0]+u(m,ut(f,o.scale[0]))||Li,d.scale.y=t.scale[1]+u(m,ut(f,o.scale[1]))||Li,d.scale.z=t.scale[2]+u(m,ut(f,o.scale[2]))||Li,d.position.setScalar(0);let g=n/e.count*h-r;switch(t.axis){case"x":d.rotation.set(0,g,0);break;case"y":d.rotation.set(0,0,g);break;case"z":d.rotation.set(g,0,0);break}d.translateOnAxis(a,t.radius),d.position.x+=t.position[0]+u(m,ut(f,o.position[0])),d.position.y+=t.position[1]+u(m,ut(f,o.position[1])),d.position.z+=t.position[2]+u(m,ut(f,o.position[2]));let v=u(m,ut(f,o.rotation[0])),y=u(m,ut(f,o.rotation[1])),x=u(m,ut(f,o.rotation[2]));t.alignment===!0?(d.rotation.x+=s.x+v,d.rotation.y+=s.y+y,d.rotation.z+=s.z+x):d.rotation.set(s.x+v,s.y+y,s.z+x)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new $r(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??Ko.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";La.noiseSeed(i.seed);let s=e3((0,ip.default)(i.seed)),a=Xm(i.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let c=o*(i.freqScale/10)+i.movement,u=n?La.noise(c):s(c,c),h=o+1,d=a(h,ut(u,i.rotation[0])),p=a(h,ut(u,i.rotation[1])),f=a(h,ut(u,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+a(h,ut(u,i.scale[0]))||Li,l.scale.y=1+(t.scale[1]-1)*o+a(h,ut(u,i.scale[1]))||Li,l.scale.z=1+(t.scale[2]-1)*o+a(h,ut(u,i.scale[2]))||Li,l.rotation.x=r.x*o+d,l.rotation.y=r.y*o+p,l.rotation.z=r.z*o+f,l.position.x=t.position[0]*o+a(h,ut(u,i.position[0])),l.position.y=t.position[1]*o+a(h,ut(u,i.position[1])),l.position.z=t.position[2]*o+a(h,ut(u,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??Ko.defaultData([1,1,1]).randomnessObject,n=Xm(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";La.noiseSeed(i.seed);let a=woe((0,ip.default)(i.seed));if(r.useCenter===!0){let o={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new T(r.size[0]*(r.count[0]-o.x)*.5,r.size[1]*(r.count[1]-o.y)*.5,r.size[2]*(r.count[2]-o.z)*.5);for(let c=0;c<r.count[0];c++)for(let u=0;u<r.count[1];u++)for(let h=0;h<r.count[2];h++){let d=[(c+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement,(h+1)*(i.freqScale/10)+i.movement],p=s?La.noise(...d):a(...d),f=this.children[t++];f.scale.x=1+n(t,ut(p,i.scale[0]))||Li,f.scale.y=1+n(t,ut(p,i.scale[1]))||Li,f.scale.z=1+n(t,ut(p,i.scale[2]))||Li;let m=n(t,ut(p,i.rotation[0])),g=n(t,ut(p,i.rotation[1])),v=n(t,ut(p,i.rotation[2]));f.rotation.set(m,g,v),f.position.x=r.size[0]*c-l.x+n(t,ut(p,i.position[0])),f.position.y=r.size[1]*u-l.y+n(t,ut(p,i.position[1])),f.position.z=r.size[2]*h-l.z+n(t,ut(p,i.position[2]))}}else for(let o=0;o<r.count[0];o++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let u=[(o+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],h=s?La.noise(...u):a(...u),d=this.children[t++];d.scale.x=1+n(t,ut(h,i.scale[0]))||Li,d.scale.y=1+n(t,ut(h,i.scale[1]))||Li,d.scale.z=1+n(t,ut(h,i.scale[2]))||Li;let p=n(t,ut(h,i.rotation[0])),f=n(t,ut(h,i.rotation[1])),m=n(t,ut(h,i.rotation[2]));d.rotation.set(p,f,m),d.position.x=r.size[0]*o+n(t,ut(h,i.position[0])),d.position.y=-r.size[1]*l+n(t,ut(h,i.position[1])),d.position.z=-r.size[2]*c+n(t,ut(h,i.position[2]))}}_updateToObject(e){var m;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new $r(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??Ko.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";La.noiseSeed(i.seed);let s=e3((0,ip.default)(i.seed)),a=Xm(i.strength,this.parameters.randomness);if(!t.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof aR)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let o=this.getSubdivData(),l=[],c=g=>{let v=g.length,y=g.map(w=>w[0]).reduce((w,C)=>w+C,0),x=g.map(w=>w[1]).reduce((w,C)=>w+C,0),b=g.map(w=>w[2]).reduce((w,C)=>w+C,0);return[y/v,x/v,b/v]},u=g=>Math.round(g*1e6)/1e6;o.forEach(g=>{let v=o.filter(y=>u(g.pos[0])===u(y.pos[0])&&u(g.pos[1])===u(y.pos[1])&&u(g.pos[2])===u(y.pos[2]));v.length>1?l.push({pos:g.pos,norm:c(v.map(y=>y.norm))}):l.push(g)});let h=bhe(l);if(o.length>0){let g=Math.round(h.length*t.count/100);this._updateCount(g)}else{console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}this.objectForSample.updateMatrixWorld();let d=new Coe(this.objectForSample).build(),p=yhe[t.axis],f=this.children;d.setRandomGenerator((0,ip.default)(this.object.uuid+t.seed));for(let[g,v]of f.entries()){let y=g*(i.freqScale/10)+i.movement,x=n?La.noise(y):s(y,y),b=g+1,w=a(b,ut(x,i.rotation[0])),C=a(b,ut(x,i.rotation[1])),_=a(b,ut(x,i.rotation[2]));t.spreadType==="random"?d.sample(hp,v3):(h.length&&(hp.fromArray(h[g].pos),v3.fromArray(h[g].norm)),this.objectForSample instanceof Kf&&hp.applyMatrix4(Phe.copy(this.objectForSample.matrixWorld).invert())),hp.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(hp),Mo.fromArray(p);let S=t.align==="normal"?v3:this.object.getWorldDirection(Ohe),A=Wl.fromArray(t.position);Wl.x+=Wl.x+a(b,ut(x,i.position[0])),Wl.y+=Wl.y+a(b,ut(x,i.position[1])),Wl.z+=Wl.z+a(b,ut(x,i.position[2]));let E=Math.acos(S.dot(Mo)),L=Ihe.crossVectors(Mo,S).normalize(),P=Dhe.makeRotationAxis(L,E),D=S.clone().cross(this.object.up).normalize(),I=D.clone().cross(S).normalize(),B=new Ce().makeBasis(D,S,I),X=new T(Mo.y,Mo.z,Mo.x).normalize(),H=X.clone().cross(Mo).normalize(),R=new Ce().makeBasis(X,Mo,H).invert(),q=new Ce().multiplyMatrices(B,R);v.rotation.setFromRotationMatrix(q),A.applyMatrix4(P),v.position.add(A),v.rotation.x=v.rotation.x+r.x+w,v.rotation.y=v.rotation.y+r.y+C,v.rotation.z=v.rotation.z+r.z+_,v.scale.setScalar(1),v.scale.x=v.scale.x+t.scale[0]+a(b,ut(x,i.scale[0]))||Li,v.scale.y=v.scale.y+t.scale[1]+a(b,ut(x,i.scale[1]))||Li,v.scale.z=v.scale.z+t.scale[2]+a(b,ut(x,i.scale[2]))||Li,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof Kf){let t=this.objectForSample,r=xhe[e],i=cR[r],n=oR[r],s=lR[r],a=[],o=i(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let c=n(t.subdivPointerNew,l),u=s(t.subdivPointerNew,l);PA.fromArray(c).applyMatrix4(t.matrixWorld),DA.fromArray(u),a.push({pos:PA.toArray(),norm:DA.toArray()})}return a}else return(this.objectForSample.geometry.index?_he(this.objectForSample.geometry):Ahe(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=Xv(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof cn?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new Ce,this.hiddenMatrix=new Ce,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},y1=e=>{var t;return t=class extends e{},t.geometryHelper=new fa(30,30,30),t},Km=new dd,y3=new Ln,IA=new Ce,x1=(e,t,r,i,n=!1)=>{let s=t,a=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),y3.copy(s.boundingSphere),y3.applyMatrix4(a),r.ray.intersectsSphere(y3)===!1||(IA.copy(a).invert(),Km.copy(r.ray).applyMatrix4(IA),s.boundingBox!==null&&Km.intersectsBox(s.boundingBox)===!1))return;let o,l,c,u,h=s.index,d=s.attributes.position,p=s.drawRange,f,m;if(n===!1){let v=Math.max(0,p.start),y=Math.min(h.count,p.start+p.count);for(f=v,m=y;f<m;f+=3)if(l=h.getX(f),c=h.getX(f+1),u=h.getX(f+2),o=g(e,r,Km,d,l,c,u),o){o.faceIndex=Math.floor(f/3),i.push(o);return}}else{let v=s.attributes.position,y=new T,x=new T,b=new T,w=new T,C=2,_=1/((e.scale.x+e.scale.y+e.scale.z)/3),S=_*_,A=Math.max(0,p.start),E=Math.min(v.count,p.start+p.count);for(let L=A,P=E-1;L<P;L+=C){if(y.fromBufferAttribute(v,L),x.fromBufferAttribute(v,L+1),Km.distanceSqToSegment(y,x,w,b)>S)continue;w.applyMatrix4(e.matrixWorld);let D=r.ray.origin.distanceTo(w);D<r.near||D>r.far||i.push({distance:D,point:b.clone().applyMatrix4(e.matrixWorld),object:e})}}function g(v,y,x,b,w,C,_){let S=new T,A=new T,E=new T,L=new T,P=new T;if(S.fromBufferAttribute(b,w),A.fromBufferAttribute(b,C),E.fromBufferAttribute(b,_),x.intersectTriangle(S,A,E,!1,L)===null)return null;P.copy(L),P.applyMatrix4(v.matrixWorld);let D=y.ray.origin.distanceTo(P);return D<y.near||D>y.far?null:{faceIndex:1,distance:D,point:P.clone(),object:v}}},Zm=new T,Nn=new fd,Rhe=class extends p1{constructor(e){let t=new nt,r=new Ol({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new $e(15711266),o=new $e(15711266),l=new $e(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(h,d,p){u(h,p),u(d,p)}function u(h,d){i.push(0,0,0),n.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(i.length/3-1)}t.setAttribute("position",new ze(i,3)),t.setAttribute("color",new ze(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;Nn.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;ds("n1",t,e,Nn,-r,-i,n),ds("n2",t,e,Nn,r,-i,n),ds("n3",t,e,Nn,-r,i,n),ds("n4",t,e,Nn,r,i,n);let s=n;ds("f1",t,e,Nn,-r,-i,s),ds("f2",t,e,Nn,r,-i,s),ds("f3",t,e,Nn,-r,i,s),ds("f4",t,e,Nn,r,i,s);let a=s,o=.5;ds("u1",t,e,Nn,r*.7*o,i*1.1,a),ds("u2",t,e,Nn,-r*.7*o,i*1.1,a),ds("u3",t,e,Nn,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ds(e,t,r,i,n,s,a){Zm.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],Zm.x,Zm.y,Zm.z)}}var Bhe=class extends y1(Rhe){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){x1(this.object,this.geometry,e,t,!0)}},Cx;(e=>e.is=t=>"objectHelper"in t)(Cx||(Cx={}));var b1=(e,t)=>class extends h8(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof Eg&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof fa?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof Eg&&(i.visible=!1)}}},Jm=790,Sh=new T,x3=new T,b3=new mt,w3=new T,up=new T,C3=new T,_i=class extends b1(fd,Bhe){constructor(e="",t={...Hf.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Ju.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new Ce,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new w7(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new bi(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new T(e,t,r)),super.lookAt(e),this.getWorldPosition(Sh),this.targetOffset=Sh.distanceTo(e)}getTarget(e=new T){return this.getWorldDirection(x3),this.getWorldPosition(Sh),x3.multiplyScalar(this.targetOffset),e.copy(Sh).add(x3),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Sh),Sh.distanceTo(e)}updateUp(){this.getWorldQuaternion(b3),w3.set(0,0,1).applyQuaternion(b3),up.copy(Vt.DEFAULT_UP),this.isUpVectorFlipped&&up.negate(),up.applyQuaternion(b3),C3.copy(Vt.DEFAULT_UP).projectOnPlane(w3),this.angleOffsetFromUp=C3.angleTo(up),this.angleOffsetFromUp*=C3.cross(up).dot(w3)>=0?1:-1}updateTransformState(e){let t=super.updateTransformState(e);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),t}getViewFrontToObject(e){let t=e.getWorldPosition(new T),r=e.getWorldDirection(new T).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new T).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new T;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-Jm*.5*i,this.right=Jm*.5*i,this.top=Jm*.5*(1/n),this.bottom=-Jm*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return E5(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},_h=new Ce,khe=new Ce;function OA(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var nd=class extends Md{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new nt,this.onAfterRender=(i,n,s,a,o,l)=>{super.onAfterRender(i,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof nd&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof cn&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(_h.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Fa.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Fa.transformMeshSet(s.booleanMeshSetAddress,_h),s.booleanMatrixInvOld.copy(_h).invert(),s.booleanWasTransformed=!1}else s instanceof nd&&s.needsTransformForDownstream===!0?(Fa.transformMeshSet(s.booleanMeshSetAddress,_h),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Fa.transformMeshSet(s.booleanMeshSetAddress,khe.multiplyMatrices(_h,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(_h).invert(),s.booleanWasTransformed=!1);Fa.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new ze([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Fa.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new nt,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=Fa.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,A8(this),E8(this)}dispose(){super.dispose(),this.geometry.dispose()}},Sx;(e=>{function t(r){return Mt.is(r)&&r instanceof m1}e.is=t})(Sx||(Sx={}));var M8=(e,t)=>class extends b1(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},bs=e=>e instanceof cn,sa=e=>e!==null&&e instanceof nd,Nhe=e=>e instanceof _i,zhe=e=>Sx.is(e),_x=e=>Cx.is(e),r2=class extends y1(nZ){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){x1(this.object,r2.geometryHelper,e,t)}update(){}},Zf=class extends b1(su,r2){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},hR={RED:0,GREEN:1,BLUE:2,ALPHA:3},w1="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Fhe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,$m=class extends Yt{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new be(null),kernel16:new be(null),inputBuffer:new be(null),cocBuffer:new be(null),texelSize:new be(new W),scale:new be(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:Fhe,vertexShader:w1}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),u=c*Math.cos(l),h=c*Math.sin(l);o%5===0?(r[n++]=u,r[n++]=h):(t[i++]=u,t[i++]=h)}let s=[],a=[];for(let o=0;o<128;)s.push(new pt(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new pt(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function RA(e,t,r){return e*(t-r)-t}function Ax(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var jhe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,Uhe=class extends Yt{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new be(null),focusDistance:new be(0),focusRange:new be(0),cameraNear:new be(.3),cameraFar:new be(1e3)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:jhe,vertexShader:w1}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-RA(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=Ax(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-RA(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=Ax(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof bi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Vhe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,Hhe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",BA=class extends Yt{constructor(e=new W){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new be(null),texelSize:new be(new W),halfTexelSize:new be(new W),kernel:new be(0),scale:new be(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:Vhe,vertexShader:Hhe}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},Ghe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,Whe=class extends Yt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new be(null),opacity:new be(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:Ghe,vertexShader:w1}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},qhe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,Xhe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,i2={DEPTH:0,LUMA:1,COLOR:2},Yhe={DISABLED:0,DEPTH:1,CUSTOM:2},Qhe=class extends Yt{constructor(e=new W,t=i2.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:ud.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new be(null),depthBuffer:new be(null),predicationBuffer:new be(null),texelSize:new be(e)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:qhe,vertexShader:Xhe}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Khe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,Zhe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",ps={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ex=class extends Yt{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:ud.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new be(null),depthBuffer:new be(null),resolution:new be(new W),texelSize:new be(new W),cameraNear:new be(.3),cameraFar:new be(1e3),aspect:new be(1),time:new be(0)},blending:Rr,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=vo){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=Khe.replace(ps.FRAGMENT_HEAD,e.get(ps.FRAGMENT_HEAD)).replace(ps.FRAGMENT_MAIN_UV,e.get(ps.FRAGMENT_MAIN_UV)).replace(ps.FRAGMENT_MAIN_IMAGE,e.get(ps.FRAGMENT_MAIN_IMAGE)),this.vertexShader=Zhe.replace(ps.VERTEX_HEAD,e.get(ps.VERTEX_HEAD)).replace(ps.VERTEX_MAIN_SUPPORT,e.get(ps.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof bi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return ps}},Jhe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,$he=class extends Yt{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:ud.replace(/\D+/g,"")},uniforms:{inputBuffer:new be(null),threshold:new be(0),smoothing:new be(1),range:new be(null)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:Jhe,vertexShader:w1}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},eue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,uR={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},tue=class extends Yt{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new be(e),inputBuffer:new be(null),strength:new be(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:eue,vertexShader:w1}),this.toneMapped=!1,this.setColorChannel(hR.RED),this.setMaskFunction(uR.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Ei&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},rue=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,iue="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",nue=class extends Yt{constructor(e=new W,t=new W){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new be(null),searchTexture:new be(null),areaTexture:new be(null),resolution:new be(t),texelSize:new be(e)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:rue,vertexShader:iue}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},sue=new fd,To=null;function aue(){if(To===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);To=new nt,To.setAttribute!==void 0?(To.setAttribute("position",new st(e,3)),To.setAttribute("uv",new st(t,2))):(To.addAttribute("position",new st(e,3)),To.addAttribute("uv",new st(t,2)))}return To}var Wi=class{constructor(e="Pass",t=new dl,r=sue){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new $i(aue(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new dl),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=vo){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof dl||t===this.renderer)continue;this[e].dispose()}}}},Mx=class extends Wi{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new Whe,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new jt(1,1,{minFilter:yt,magFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==Ei?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===dt&&(this.renderTarget.texture.encoding=dt))}},oue=class extends Wi{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},S3=new $e,T8=class extends Wi{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(S3.copy(e.getClearColor(S3)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(S3,o):c&&e.setClearAlpha(o)}},Lo=-1,tn=class extends pi{constructor(e,t=Lo,r=Lo,i=1){super(),this.resizable=e,this.base=new W(1,1),this.preferred=new W(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Lo?i=t.width:t.height!==Lo?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Lo?i=t.height:t.width!==Lo?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Lo),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Lo}},_3=!1,kA=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case wn:r=this.materialsFlatShadedDoubleSide;break;case ei:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case wn:r=this.materialsDoubleSide;break;case ei:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Ps;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=ei,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=wn,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=ei,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=wn,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,_3){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return _3}static set workaroundEnabled(e){_3=e}},lue=class extends Wi{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new T8,this.overrideMaterialManager=r===null?null:new kA(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new kA(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},NA=class extends Wi{constructor(e,t,{resolutionScale:r=1,width:i=tn.AUTO_SIZE,height:n=tn.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new lue(e,t,new lD({depthPacking:YP}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new $e(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new jt(1,1,{minFilter:Xt,magFilter:Xt,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new tn(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Et={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},cue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",hue="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",uue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",due="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",pue="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",fue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",mue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",gue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",vue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",yue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",xue="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",bue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",wue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",Cue="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Sue="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",_ue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",Aue="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Eue="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",Mue=new Map([[Et.SKIP,null],[Et.ADD,cue],[Et.ALPHA,hue],[Et.AVERAGE,uue],[Et.COLOR_BURN,due],[Et.COLOR_DODGE,pue],[Et.DARKEN,fue],[Et.DIFFERENCE,mue],[Et.EXCLUSION,gue],[Et.LIGHTEN,vue],[Et.MULTIPLY,yue],[Et.DIVIDE,xue],[Et.NEGATION,bue],[Et.NORMAL,wue],[Et.OVERLAY,Cue],[Et.REFLECT,Sue],[Et.SCREEN,_ue],[Et.SOFT_LIGHT,Aue],[Et.SUBTRACT,Eue]]),Tue=class extends pi{constructor(e,t=1){super(),this.f=e,this.opacity=new be(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Mue.get(this.blendFunction)}},da={NONE:0,DEPTH:1,CONVOLUTION:2},ba=class extends pi{constructor(e,t,{attributes:r=da.NONE,blendFunction:i=Et.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new Tue(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=vo){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof dl||t===this.renderer)continue;this[e].dispose()}}}};function zA(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function Lue(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],h=[],d=!1,p=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&a&da.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=Ex.Section;if(c){let v=`	${e}MainUv(UV);
`;r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+v),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+v),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),h=h.concat(u).concat([...o.get("vertex").matchAll(f)].map(y=>y[1]))}h=h.concat([...o.get("fragment").matchAll(f)].map(v=>v[1])),h=h.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),t.defines.forEach((v,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),zA(e,h,n),zA(e,h,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;a&da.DEPTH&&v.test(o.get("fragment"))&&(y+="depth, ",p=!0),y+=`color1);
	`;let x=e+"BlendOpacity";s.set(x,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${x});

	`,r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+y)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:d,readDepth:p}}var iv=class extends Wi{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new Ex(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=Ex.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Et.SKIP)l|=d.getAttributes()&da.DEPTH;else if(l&d.getAttributes()&da.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let p="e"+a++,f=Lue(p,d,t,r,i,n,l);if(o+=f.varyings.length,c=c||f.transformedUv,u=u||f.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let h=/\bblend\b/g;for(let d of r.values()){let p=d.getShaderCode().replace(h,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+p+`
`)}if(l&da.DEPTH){if(u){let d=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,d+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,d+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach((d,p,f)=>f.set(p,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=vo){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==Ei&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},Pue=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],dR=class extends Wi{constructor({resolutionScale:e=.5,width:t=tn.AUTO_SIZE,height:r=tn.AUTO_SIZE,kernelSize:i=L8.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new jt(1,1,{minFilter:yt,magFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new tn(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new BA,this.ditheredBlurMaterial=new BA,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=Pue[this.kernelSize],u=this.blurMaterial,h=t,d,p;for(this.fullscreenMaterial=u,d=0,p=c.length-1;d<p;++d){let f=d&1?l:o;u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(f),e.render(s,a),h=f}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==Ei?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===dt&&(this.renderTargetA.texture.encoding=dt,this.renderTargetB.texture.encoding=dt))}static get AUTO_SIZE(){return tn.AUTO_SIZE}},Due=class extends Wi{constructor({width:e=tn.AUTO_SIZE,height:t=tn.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new $he(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new jt(1,1,{minFilter:yt,magFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new tn(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==Ei&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Iue=class extends Wi{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new T8(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},ea=class extends Wi{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==Ei&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},A3=1/1e3,Oue=1e3,Rue=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*A3}getFixedDelta(){return this.fixedDelta*A3}setFixedDelta(e){return this.fixedDelta=e*Oue,this}getElapsed(){return this.elapsed*A3}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},L8={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Bue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,kue=class extends ba{constructor({blendFunction:e=Et.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=tn.AUTO_SIZE,height:a=tn.AUTO_SIZE,kernelSize:o=L8.LARGE}={}){super("BloomEffect",Bue,{blendFunction:e,uniforms:new Map([["map",new be(null)],["intensity",new be(n)]])}),this.renderTarget=new jt(1,1,{minFilter:yt,magFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new Due({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new dR({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===dt&&(this.renderTarget.texture.encoding=dt))}},Nue="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",zue=class extends ba{constructor({blendFunction:e=Et.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",Nue,{blendFunction:e,uniforms:new Map([["brightness",new be(t)],["contrast",new be(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},Fue="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",jue=class extends ba{constructor(e=Et.NORMAL){super("ColorAverageEffect",Fue,{blendFunction:e})}},Uue="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",Vue="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",Hue=class extends ba{constructor({blendFunction:e=Et.NORMAL,offset:t=new W(.001,5e-4)}={}){super("ChromaticAberrationEffect",Uue,{vertexShader:Vue,blendFunction:e,attributes:da.CONVOLUTION,uniforms:new Map([["offset",new be(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},Gue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,Wue=class extends ba{constructor(e,{blendFunction:t=Et.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=tn.AUTO_SIZE,height:c=tn.AUTO_SIZE}={}){super("DepthOfFieldEffect",Gue,{blendFunction:t,attributes:da.DEPTH,uniforms:new Map([["nearColorBuffer",new be(null)],["farColorBuffer",new be(null)],["nearCoCBuffer",new be(null)],["scale",new be(1)]])}),this.camera=e,this.renderTarget=new jt(1,1,{minFilter:yt,magFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new ea(new Uhe(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=a,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new dR({kernelSize:L8.MEDIUM,width:l,height:c});let h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new ea(new tue(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=uR.MULTIPLY,d.colorChannel=hR.GREEN,this.bokehNearBasePass=new ea(new $m(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new ea(new $m(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new ea(new $m(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new ea(new $m(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return Ax(-r,t.near,t.far)}setDepthTexture(e,t=vo){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,Ei),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===dt&&(this.renderTarget.texture.encoding=dt,this.renderTargetNear.texture.encoding=dt,this.renderTargetFar.texture.encoding=dt,this.renderTargetMasked.texture.encoding=dt))}};new T;new Ce;var que="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",Xue=class extends ba{constructor({blendFunction:e=Et.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",que,{blendFunction:e,uniforms:new Map([["hue",new be(new T)],["saturation",new be(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new $e;var Yue=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Que=class extends ba{constructor({blendFunction:e=Et.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",Yue,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},Kue="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",Zue=class extends ba{constructor(e=30){super("PixelationEffect",Kue,{uniforms:new Map([["active",new be(!1)],["d",new be(new W)]])}),this.resolution=new W,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new T;new T;var FA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",jA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",Jue="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",$ue="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",lc={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},pR=class extends ba{constructor({preset:e=lc.MEDIUM,edgeDetectionMode:t=i2.COLOR,predicationMode:r=Yhe.DISABLED}={}){super("SMAAEffect",Jue,{vertexShader:$ue,blendFunction:Et.NORMAL,attributes:da.CONVOLUTION|da.DEPTH,uniforms:new Map([["weightMap",new be(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new jt(1,1,{minFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new T8(!0,!1,!1),this.clearPass.overrideClearColor=new $e(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new ea(new Qhe),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new ea(new nue);let s=new MD;s.onLoad=()=>{let a=new Vr(i);a.name="SMAA.Search",a.magFilter=Xt,a.minFilter=Xt,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new Vr(n);o.name="SMAA.Area",o.magFilter=yt,o.minFilter=yt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=FA,n.src=jA),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case lc.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case lc.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case lc.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case lc.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=vo){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return FA}static get areaImageDataURL(){return jA}},ede=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,e0={DEFAULT:0,ESKIL:1},tde=class extends ba{constructor({blendFunction:e=Et.NORMAL,technique:t=e0.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",ede,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new be(i)],["darkness",new be(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===e0.ESKIL}set eskil(e){this.technique=e?e0.ESKIL:e0.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},yo=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Et.NORMAL}},rde=class extends yo{constructor(){super(kue),this.blendFunction=Et.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},ide=class extends yo{constructor(){super(zue)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},nde=class extends yo{constructor(){super(Hue),this.effect.offset=new W(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},sde=class extends yo{constructor(){super(jue)}},ade=class extends yo{constructor(){super(Xue),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},ode=class extends yo{constructor(){super(Que),this.blendFunction=Et.OVERLAY}},lde=class extends yo{constructor(){super(tde)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},cde=class extends yo{constructor(e){super(Wue,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},hde=class extends yo{constructor(){super(Zue)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},ude=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,dde=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,pde=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,fde=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,Tx=class extends Yt{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new be(null)},blending:Rr,depthWrite:!1,depthTest:!1,vertexShader:pde,fragmentShader:fde})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},mde=class extends Wi{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new Tx,this.resolutionVector=new W,this.resolveMaterial=new Yt({name:"TAAResolveMaterial",uniforms:{inputBuffer:new be(null),historyBuffer:new be(null),velocityBuffer:new be(null),depthBuffer:new be(null),resolution:new be(new W)},blending:Rr,depthWrite:!1,depthTest:!1,vertexShader:ude,fragmentShader:dde}),this.historyRenderTarget=new jt(1024,1024,{minFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new jt(1024,1024,{minFilter:yt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},gde=class extends Wi{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new NA(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new Tx,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new Tx,this.depthPass=new NA(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},UA=new dl,vde=new Yt({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),Lx=class extends Wi{constructor(e,t,r){super("OpaquePass",t??UA,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??UA}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof cn&&(this.originalMaterials.set(i.id,i.material),i.material=vde)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((i,n)=>{let s=this.scene.getObjectById(n);s&&(s.material=i)})}},yde=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new Mx,this.depthTexture=null,this.timer=new Rue,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new W),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===Ei&&e.outputEncoding===dt&&(this.inputBuffer.texture[0].encoding=dt,this.outputBuffer.texture[0].encoding=dt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let s of this.passes)s.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new Xu(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Nc,e.type=Cc):e.type=Xo,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,s){let a=this.renderer,o=a===null?new W:a.getDrawingBufferSize(new W),l={minFilter:yt,magFilter:yt,wrapS:Sr,wrapT:Sr,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new jt(o.width,o.height,l),c.samples=i):(n?(c=new ZG(o.width,o.height,2,l),c.texture[1].type=Wu):c=new jt(o.width,o.height,l),c.depthTexture=new Xu(2048,2048),c.depthTexture.type=Cn),r===Ei&&a!==null&&a.outputEncoding===dt&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=dt):c.texture.encoding=dt),Array.isArray(c.texture)?c.texture.forEach((u,h)=>{u.name=`EffectComposer.Buffer ${n} ${h}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var o;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new W),s=((o=i.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,u,h;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,i,n,e,o):d.render(t,s,a,e,o),d.needsSwap&&(o&&(r.renderToScreen=d.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,h=s,i=n,s=a,n=u,a=h),d instanceof Iue?o=!0:d instanceof oue&&(o=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=i.getSize(new W);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new W);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},xde=new Yt({name:"CombineMaterial",uniforms:{inputBufferA:new be(null),inputBufferB:new be(null)},blending:Rr,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),bde=class extends Wi{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=xde,this.helperPass=new Lx(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new Lx(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new pR({preset:lc.LOW,edgeDetectionMode:i2.COLOR});this.effectPass=new iv(this.camera,t),this.rt=new jt(10,10,{minFilter:yt,magFilter:yt,wrapS:Sr,wrapT:Sr,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},wde=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Cde=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Sde=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,_de=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,Ade=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,Ede=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,dp=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],Mde=new Yt({vertexShader:wde,fragmentShader:Cde}),t0=new Yt({vertexShader:Ade,fragmentShader:Ede,uniforms:{texture_ao_lrez:new be(null),texture_depth_lrez:new be(null),texture_depth_hrez:new be(null),near:new be(null),far:new be(null)}}),Tde=class extends Wi{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new jt(r,i,{type:Cn,depthTexture:new Xu(r,i),minFilter:yt,magFilter:yt}),this.depthBufferHighRes=new jt(r,i,{depthTexture:new Xu(r,i)}),this.aoBuffer=new jt(r,i,{minFilter:yt,magFilter:yt}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(dp.length*2);for(let a=0;a<dp.length;a++){let o=a*2;n[o+0]=dp[a][0],n[o+1]=dp[a][1]}this.blueNoiseInDiskTexture=new xg(n,dp.length,1,WP,Cn),this.blueNoiseInDiskTexture.wrapS=Ka,this.blueNoiseInDiskTexture.wrapT=Ka,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Yt({vertexShader:Sde,fragmentShader:_de,uniforms:{near:new be(null),far:new be(null),fov:new be(null),proj_info:new be(new pt),is_ortho:new be(!1),resolution:new be(new W),radius_of_influence:new be(8),radius_in_screen_space:new be(1),exponent:new be(1),ao_color:new be(new T),bias:new be(.5),texture_depth:new be(null),texture_normals:new be(null),texture_blue_noise:new be(null),texture_blue_noise_in_disk:new be(this.blueNoiseInDiskTexture),frame_index:new be(0),fog_enabled:new be(!1),fog_near:new be(1),fog_far:new be(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new jt(r,i,{minFilter:yt,magFilter:yt,wrapS:Sr,wrapT:Sr,depthBuffer:!1,type:Cn});let s=new pR({preset:lc.ULTRA,edgeDetectionMode:i2.COLOR});this.effectPass=new iv(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}render(e,t,r){this.splineScene.overrideMaterial=Mde;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=t0,t0.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,t0.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,t0.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Lde=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Pde=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Dde=class extends ea{constructor(){super(new Yt({vertexShader:Lde,fragmentShader:Pde,uniforms:{tInput:new be(null),tMap:new be(null),uResolution:new be(new W),uSize:new be(new W),uCoords:new be(new W),uScale:new be(1),uSceneColor:new be(new $e(16711680)),uDPR:new be(1),uCurrent:new be(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},Ide=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Ode=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,Rde=[],Bde=class extends ea{constructor(){super(new Yt({vertexShader:Ide,fragmentShader:Ode,uniforms:{toScene:new be(null),fromScene:new be(null),uResolution:new be(new W),uDPR:new be(1),mixRatio:new be(0),threshold:new be(.1),useTexture:new be(0),tMixTexture:{value:Rde[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}};function VA(e,t){return t&&t.enabled&&e.push(t.effect),e}var kde=e=>Object.values(Et).includes(e)?e:Et.NORMAL,Nde=class extends pi{constructor(e){super(),this.postprocessingState=Gg.defaultData,this._scene=new dl,this._camera=new _i,this.effects=new Map,this.blueNoiseTexture=new xg,this._renderToScreen=!0,this.clock=new jK,this.renderer=e,this.debug=!1,this.effects.set("bloom",new rde),this.effects.set("chromaticAberration",new nde),this.effects.set("vignette",new lde),this.effects.set("noise",new ode),this.effects.set("colorAverage",new sde),this.effects.set("hueSaturation",new ade),this.effects.set("brightnessContrast",new ide),this.effects.set("depthOfField",new cde),this.effects.set("pixelation",new hde),this.effectComposer=new yde(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new Lx(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new gde(this.scene,this.camera,this.renderer),this.aoPass=new Tde(this.scene,this.camera),this.taaPass=new mde,this.taaPass.renderToScreen=!1,this.helperPass=new bde(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new Dde,this.overlayPass.enabled=!1,this.sceneTransitionPass=new Bde,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.overlayPass.texture=e,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),this.aoPass.setCamera(e),this.helperPass.setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new xg(e,128,128),this.blueNoiseTexture.wrapS=Ka,this.blueNoiseTexture.wrapT=Ka,this.blueNoiseTexture.minFilter=Xt,this.blueNoiseTexture.magFilter=Xt,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let r=[this.effects.get("pixelation")].reduce(VA,[]);r.length>0&&(this.uvEffectPass=new iv(this.camera,...r),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let i=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(VA,[]);i.length>0&&(this.effectPass=new iv(this.camera,...i),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new W;this.renderer.getDrawingBufferSize(e),this._rt=new jt(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Ka,wrapT:Ka}),this._rt.samples=0,this._savePass=new Mx(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new Mx(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(i=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=kde(l):a[o]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof pt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof pt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},zde=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,Fde=ft.lights_fragment_begin,jde=ft.shadowmask_pars_fragment,HA=null,Ude=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},Vde=(e="medium")=>{if(HA===e)return!1;HA=e;let t=Ude(e);ft.shadowmap_pars_fragment=zde(t);let r=Fde.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),ft.lights_fragment_begin=r;let i=jde.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),ft.shadowmask_pars_fragment=i,!0},Hde=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,Gde=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,E3=new Yt({vertexShader:Hde,fragmentShader:Gde,uniforms:{depthContrast:{value:1}}}),GA=new Vr,Wde=class extends cD{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new W,this.pipeline=new Nde(this),this.dummyCamra=new _i,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=f7;let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{var o,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,r(n,s,a),(o=this.normalRenderTarget)==null||o.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new jt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:yt,magFilter:yt,wrapS:Sr,wrapT:Sr,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return Je.transmissionLod.value===1}set hdTransmission(e){Je.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new jt(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:Gu,magFilter:yt,wrapS:Sr,wrapT:Sr,depthBuffer:!1}),this.transmissionDepthTarget=new jt(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Xt,magFilter:Xt,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new jt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Xt,magFilter:Xt,type:Cn,depthTexture:new Xu(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof _i?E3.uniforms.depthContrast.value=(r.far-r.near)/1e4:E3.uniforms.depthContrast.value=1,t.overrideMaterial=E3,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?Ix:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamra.updateCameraState(t.dataPatched);let i=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<i?n=i*s:i=n/s,this.dummyCamra.setViewplaneSize(n,i);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamra)}renderSplineScene(e,t,{sceneHelpers:r=void 0,sceneHelpersOnTop:i=void 0,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){let a=e instanceof O8?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((d,p)=>{Je.penumbraSize.value[p]=d}),Je.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Je.resolution.value.set(this.resolution.x,this.resolution.y):Je.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(Je.normalRenderTarget.value=s,Je.normalRenderTargetDepth.value=GA):l.needsNormal()&&(this.createNormalRenderTarget(),Je.normalRenderTarget.value=this.normalRenderTarget.texture,Je.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,u=c.occlusion;u&&(this.createAORenderTarget(),Je.aoRenderTarget.value=this.aoRenderTarget.texture),Je.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let h=!1;if(n!==void 0)Je.transmissionRenderTarget.value=n,Je.transmissionRenderTargetDepth.value=GA,this.pipeline.setTransmissionPassEnabled(!1);else{let d=l.needsTransmission();d&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),Je.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Je.aspectRatio.value=Ace(this.viewportWidth,this.viewportHeight),Je.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(d)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),a.overrideMaterial=l.wireframeState?Ix:null,this.pipeline.render(),Je.frameIndex.value=(Je.frameIndex.value+1)%16,t instanceof _i&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},fR=class extends y1(iZ){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){x1(this.object,fR.geometryHelper,e,t)}},mR=class extends y1(rZ){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){x1(this.object,mR.geometryHelper,e,t)}},Px=class extends y1(tZ){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){x1(this.object,Px.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=Px._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},gR=Px;gR._vector=new T;function qde(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var vR=class extends M8(zK,fR){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new Ag(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Ag&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&qde(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},WA=new T,qA=new T,XA=new mt,yR=class extends M8(RK,gR){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=gt.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new Ag(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Ag&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),qA.setFromMatrixPosition(this.matrixWorld),XA.setFromRotationMatrix(this.matrixWorld),WA.copy(this.up).applyQuaternion(XA).negate().multiplyScalar(this.distance),this.target.position.copy(qA).add(WA),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},vl=class extends h8(dl){constructor(e,t){super(),this.data=t,this.bgColor=new on(1,1,1,1),this.fog=null,this.backupFog=new hD(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new $e,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new _i(_d,{...Hf.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new IK(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=zi(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof Md)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&Vde(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=zi(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=zi(e.aoColor,t))}updateByOp(e,t,r,i){super.updateByOp(e,t,r,i);let n=t;Yn(e.path,["fog"])?this.updateFog(n.fog,r.shared):Yn(e.path,["ao"])?this.updateAo(n.ao,r.shared):Yn(e.path,["ambient"])?this.updateAmbientLight(n.ambient,r.shared):Yn(e.path,["shadow"])&&this.updateShadow(n.shadow)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(zi(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof vR&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize,e+=1),r instanceof yR&&r.visible&&e<5-3&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Mt.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((bs(n)||_x(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),Dx(n,e,t,!0)),r(n))}};return r(this),t}},Xde=class extends M8(kK,mR){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new T(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new T(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new Er(n,s),o=new Eg(a,new $e(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof Eg){let r=this.shadow.camera,i=new T(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new T(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Yde=class extends Fi{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?y8(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},P8=class extends Fi{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e=this.data.geometry.extrusion.shape,t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),t=(i=s.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=yO;break;case"Ellipse":n=g8;break;case"Polygon":n=vO;break;case"Star":n=xO;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e){return super.updateTransformState(e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?y8(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},Du=class extends b1(su,r2){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=Qg.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let s of Zo.rootOverrideProps)e[s]===void 0?(i===void 0&&(i={...e}),i[s]=r.data[s]):(n===void 0&&(n={}),n[s]=e[s],i===void 0&&(i={...e}),i[s]=pl.apply(r.data[s],e[s]));return this.overrideData=n,i}else return{...Ui.defaultData,...e,...io(Ui.defaultData,Zo.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let s of Zo.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&Zo.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(Mt.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),D8(s),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};xR(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let s of this.children)if(Mt.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{if(o instanceof Fi&&o.isSkinnedMesh){let l=o.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(d=>e.scene.find(n[d])),u=l.boneInverses.map(d=>new Ce().fromArray(d)),h=new S7(c,u);o.bind(h,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function D8(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)Mt.is(r)&&D8(r)}}function YA(e,t,r,i){return e.component===t&&Z7(e.identity,i)?e.overrideData===r?2:1:0}function xR(e,t,r,i,n,s,a,o,l){if(a>50)return!1;if(i.component!==n){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}n.instances.push(i),i.component=n}n instanceof Du&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let u of n.children)if(Mt.is(u)){let h=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],d=Wg.resolve(r,h,1);d!=null&&!(d instanceof Hr)&&(Object.setPrototypeOf(d,Hr.prototype),console.error("wrong prototype"));let p=null,f;if(!o){let m=i.children[c];if(p=Mt.is(m)?m:null,p!==null){let g=YA(p,u,d,h);f=g>=1?p.stateSelection:void 0,g!==2&&(p=null)}if(p===null&&(p=e.scene.findInstance(h)??null,p!==null)){let g=YA(p,u,d,h);if(f=g>=1?p.stateSelection:void 0,g!==2)p=null;else{let v=p.parent.children.indexOf(p);p.parent.children.splice(v,1),i.children.splice(c,0,p),p.parent===i?v<=c&&console.error("not possible"):(p.parent=i,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(p===null){let m=d?pl.apply(u.data,d):u.data;jc.is(m.type)&&(m={...m,type:"Empty"}),p=Jo.createEntity(h,m,e),p.overrideData=d,i.add(p),i.children.splice(i.children.length-1,1),i.children.splice(c,0,p),p.updateState(p.data,e),f&&p.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let m=p.identity[p.identity.length-1];l[m]=p.uuid}c+=1,xR(e,t,r,p,u,s,a+1,o,l)}if(!o){let u=c;for(;;){let h=i.children[c];if(Mt.is(h))e.pendingDeletes.add(h);else break;c+=1}i.children.splice(u,c-u)}return!0}var Qde=class extends b1(uD,r2){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}};function Kde(e,t,r){let i;return t.geometry.type==="TextGeometry"?new aR(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new Kf(e,t,r):t.geometry.type==="PathGeometry"?i=new P8(e,t,r):t.geometry.type==="VectorGeometry"?i=new Yde(e,t,r):t.geometry.type==="BooleanGeometry"?i=new nd(e,t,r):i=new Fi(e,t,r),i)}function I8(e,t,r){return t.type==="Mesh"?Kde(e,t,r):t.type==="Empty"?new Zf(e,t):t.type==="Bone"?new Qde(e,t):t.type==="Page"?new vl(e,t):t.type==="PointLight"?new Xde(e,t,r):t.type==="SpotLight"?new yR(e,t,r):t.type==="DirectionalLight"?new vR(e,t,r):t.type==="Component"||t.type==="Instance"?new Du(e,t,r):jc.is(t.type)?new _i(e,t):(console.error(t),new Zf(e,t))}Jo.createEntity=I8;function Zde(e,t,r){let i=I8(e.identity,t,r),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let d of Object.keys(i))e[d]=i[d];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),h&&e.changeSelectedState(h,r),e.resetBBoxNeedsUpdate()}Jo.changeEntityProptotype=Zde;Jo.Cloner=_s;function Jde(e,t,r,i){e.updateByOp(t,r,i,!1)}function QA(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,E8(e),A8(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof Md&&e.needsAO&&e.layers.enable(5),r}function KA(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(s=>s.data.visible),n=t.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function $de(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof Md)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)QA(r,r.material[i])&&(t=!0);else QA(r,r.material)&&(t=!0)}),t}function epe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof Md)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)KA(r,r.material[i])&&(t=!0);else KA(r,r.material)&&(t=!0)}),t}var tpe=new LD,rpe=new Ce,ipe=new dd;function Dx(e,t,r,i=!1){let n=e.cloner;if(n)for(let s of n.children){let a=rpe.copy(s.matrixWorld).invert(),o=ipe.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=tpe;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&r.push({...u[0],object:i?s:e})}}var npe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],s=r;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||n.push(s);for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},Ix=new d1;Ix.wireframe=!0;var ZA=new T,O8=class extends dl{constructor(e,t){super(),this.data=e,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new npe,this.errorPage=new vl("fdasfa",{...rd.defaultData,name:""}),this.invisibleObjects=new Zf("jflkdsafjasdifjaslk",{...$5.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=epe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=$de(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof vl&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>Lse(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===_d)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(),n.resetBBoxNeedsUpdate(),bs(n)&&sa(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),sa(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),bs(i)&&(i.freeBooleanPointer(),n instanceof nd&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof P8&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid)}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),bs(i)&&(i.invalidateUpstreamBooleanData(),sa(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof nd&&n.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let t of this.children)t instanceof vl&&(t.visible=t.uuid===e,t.visible&&(this.activePage=t,this.activePage.onActive(this)))}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{Jde(n,t,r,{scene:this,shared:i}),n instanceof Fi&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{sa(i)&&i.recomputeBoolean(),i instanceof _i&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Mt.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Mt.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,s,a){if(e){let o=i.find(e);o&&o!==i&&n.forInstancesRec(l=>{l.data=Vf(l.data,c=>{let u=c.events.data(a.id),h=l.goUp(s);if(h){let d=[...dI(h.identity),e].join("-"),p=this.entityIdentityToEntity[d];if(p){let f=p.uuid,m=ua.zoom(u,t);m[r]=f}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Animation"&&this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof Du&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=Vf(s.data,a=>{s.isInstanceRoot||(a.events.delete(i.id),n=!0)}).data}),n===!1)for(let s of sx.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof Du&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(s=>{r.addClip(s)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),D8(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof Du&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)Mt.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;if(Mt.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(bs(s)||_x(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),Dx(s,e,r)),i(s)}};return i(this),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Mt.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((bs(n)||_x(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),Dx(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)Mt.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Mt.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Mt.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof Fi&&r.data.type==="Mesh"&&r.data.geometry.type==="TextGeometry"&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let s=r.invalidateDownstreamBooleanData();sa(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)Qf.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Mt.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,s){var l;let a={scene:this,shared:s},o=I8(e,t,a);return o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(n,0,i.children.pop()),r.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,o,s)),o.updateState(t,a),o instanceof Fi&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(c=>{if(c instanceof Fi&&c.isSkinnedMesh){let u=c.dataPatched;if(u.bones&&u.boneInverses){let h=u.bones.map(f=>this.find(f)),d=u.boneInverses.map(f=>new Ce().fromArray(f)),p=new S7(h,d);c.bind(p,c.bindMatrix)}}else c.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new Er;return r.setFromPoints(t),r.getCenter(ZA),ZA}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof cn)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof _l&&e(t.material[r]);else t.material instanceof _l&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof _i&&i.setViewplaneSize(e,t,r)})}},P0=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},spe=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return ope(Math.atan2(i,r))},ape=(e,t,r)=>{let i={x:0,y:0};return r=Ox(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},Ox=e=>e*(Math.PI/180),ope=e=>e*(180/Math.PI),lpe=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,M3=new Map,JA=e=>{M3.has(e)&&clearTimeout(M3.get(e)),M3.set(e,setTimeout(e,100))},nv=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},$A=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},bR=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),eE=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},Rx=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},R8=(e,t,r)=>{let i=wR(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+r+", ";i[n]=s.slice(0,-2)}return i},cpe=(e,t)=>{let r=wR(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},wR=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},T3=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},hpe=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},Bx=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},upe=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(CR="ontouchstart"in window,SR=!!window.PointerEvent,_R=!!window.MSPointerEvent);var CR,SR,_R,pp={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},cu,Jf={};SR?cu=pp.pointer:_R?cu=pp.MSPointer:CR?(cu=pp.touch,Jf=pp.mouse):cu=pp.mouse;function Zc(){}Zc.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};Zc.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};Zc.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(a){a.call(r,{type:n,target:r},t)})};Zc.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=hpe(t.options,e))};Zc.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},nv(e,cu[t],r._domHandlers_[t]),Jf[t]&&nv(e,Jf[t],r._domHandlers_[t]),r};Zc.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},$A(e,cu[t],r._domHandlers_[t]),Jf[t]&&$A(e,Jf[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var B8=Zc;function qr(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=qr.id,qr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}qr.prototype=new B8;qr.constructor=qr;qr.id=0;qr.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};qr.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=cpe("borderRadius","50%"),r=R8("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},T3(i.el,r),this.options.shape==="circle"&&T3(i.back,t),T3(i.front,t),this.applyStyles(i),this};qr.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};qr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};qr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};qr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};qr.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};qr.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};qr.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=R8("transition",["top","left"],i);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(s),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};qr.prototype.restCallback=function(){var e=this,t={};t.front=R8("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};qr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};qr.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,s,a;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var dpe=qr;function Ar(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=Ar.id,Ar.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}Ar.prototype=new B8;Ar.constructor=Ar;Ar.id=0;Ar.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};Ar.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};Ar.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};Ar.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},s=r.options,a={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new dpe(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(Rx(c.ui.el,n),Rx(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};Ar.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};Ar.prototype.bindNipple=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Ar.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),i.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(i),100)};Ar.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=bR(e),t.updateBox();var n=function(s){t.actives.length<r.maxNumberOfNipples?t.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(s))};return Bx(e,n),t.manager.bindDocument(),!1};Ar.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),s>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(o))>=0&&t.idles.splice(i,1),t.actives.push(o),t.ids.push(o.identifier),r.mode!=="semi")l(o);else{var c=P0(a,o.position);if(c<=r.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};Ar.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};Ar.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.scroll;if(!lpe(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=P0(l,n.position),u=spe(l,n.position),h=Ox(u),d=c/o,p={distance:c,position:l},f,m;if(n.options.shape==="circle"?(f=Math.min(c,o),m=ape(n.position,f,u)):(m=upe(l,n.position,o),f=P0(m,n.position)),r.follow){if(c>o){let x=l.x-m.x,b=l.y-m.y;n.position.x+=x,n.position.y+=b,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",c=P0(l,n.position)}}else l=m,c=f;var g=l.x-n.position.x,v=l.y-n.position.y;n.frontPosition={x:g,y:v},r.dataOnly||Rx(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:h,degree:u},vector:{x:g/o,y:-v/o},raw:p,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:Ox(180-u),degree:180-u},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};Ar.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))};Ar.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};Ar.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var ppe=Ar;function ni(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=eE(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;nv(window,"resize",function(){JA(r)});var i=function(){t.scroll=eE()};return nv(window,"scroll",function(){JA(i)}),t.collections}ni.prototype=new B8;ni.constructor=ni;ni.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};ni.prototype.create=function(e){return this.createCollection(e)};ni.prototype.createCollection=function(e){var t=this,r=new ppe(t,e);return t.bindCollection(r),t.collections.push(r),r};ni.prototype.bindCollection=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};ni.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};ni.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};ni.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};ni.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};ni.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};ni.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};ni.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};ni.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=bR(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[n](o),o._found_=!0)},a=function(o){i=r.getIdentifier(o),Bx(r.collections,s.bind(null,o,i)),o._found_||r.removeIdentifier(i)};return Bx(t,a),!1};ni.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};ni.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var fpe=ni,tE=new fpe,mpe={create:function(e){return tE.create(e)},factory:tE},AR=new Map,nf=new Map,vc=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new Op({src:l,volume:s,delay:a,loop:o}),nf.has(r.uuid)?nf.get(r.uuid).push(this):nf.set(r.uuid,[this]),AR.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},kx=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=AR.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=nf.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...nf.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},sf=class{constructor(e,t,r,i){if(this.data=t,t.interaction==="play")this.interaction=new vc(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new kx(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof vc?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof vc?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){this.interaction instanceof vc&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},gpe="text/plain",vpe="us-ascii",rE=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),ype=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:s}=r.groups,a=i.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(u=>{let[h,d=""]=u.split("=").map(p=>p.trim());return h==="charset"&&(d=d.toLowerCase(),d===vpe)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==gpe)&&c.unshift(l),`data:${c.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function xpe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return ype(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(i.pathname);if(!c)break;let u=c[0],h=c.index,d=i.pathname.slice(a,h);o+=d.replace(/\/{2,}/g,"/"),o+=u,a=h+u.length}let l=i.pathname.slice(a,i.pathname.length);o+=l.replace(/\/{2,}/g,"/"),i.pathname=o}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];rE(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])rE(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var bpe=class{constructor({url:e,context:t},r){if(this.eventManager=r,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:xpe(e,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=t??"tab"}dispatch(){var e;uI?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.eventManager.controlsManager.orbitControls)==null||e.onPointerUp(tt[0]),Pse())}},ER=class{constructor(e,t,r){this.data=e,this.page=t,this.eventManager=r,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=i=>{var o,l;this.timeoutIdQueue.shift();let n=this.page.scene.find(i);if(n===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,a=s?(o=n.dataPatched.physics)==null?void 0:o.fusedBody:!0;if(n.cloner){for(let c of n.cloner.children)a?(c.playModeVisible=!1,c.rigidBody&&((l=n.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(a||this.clone===void 0||this.clone===!1)&&(n.visible=!1,n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),s.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0))}else n.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(n.rigidBody.collider(0).handle),s.removeRigidBody(n.rigidBody),n.rigidBody=void 0),n.bvhGeometry&&(n.bvhGeometry=void 0),n.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.eventManager.requestRender()},this.objects=[...e.objects],this.controlsManager=r.controlsManager}dispatch(e){this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},MR=class{constructor(e,t,r,i){this.data=e,this.page=t,this.eventManager=i,this.sharedAssets=r}dispatch(){clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;W8(this.page,this.sharedAssets,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},TR={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},k8={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},wpe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],sv={CSS:{},springs:{}};function As(e,t,r){return Math.min(Math.max(e,t),r)}function af(e,t){return e.indexOf(t)>-1}function L3(e,t){return e.apply(null,t)}var it={arr:function(e){return Array.isArray(e)},obj:function(e){return af(Object.prototype.toString.call(e),"Object")},pth:function(e){return it.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||it.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return it.hex(e)||it.rgb(e)||it.hsl(e)},key:function(e){return!TR.hasOwnProperty(e)&&!k8.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function LR(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function PR(e,t){var r=LR(e),i=As(it.und(r[0])?1:r[0],.1,100),n=As(it.und(r[1])?100:r[1],.1,100),s=As(it.und(r[2])?10:r[2],.1,100),a=As(it.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?o*Math.sqrt(1-l*l):0,u=1,h=l<1?(l*o+-a)/c:-a+o;function d(f){var m=t?t*f/1e3:f;return l<1?m=Math.exp(-m*l*o)*(u*Math.cos(c*m)+h*Math.sin(c*m)):m=(u+h*m)*Math.exp(-m*o),f===0||f===1?f:1-m}function p(){var f=sv.springs[e];if(f)return f;for(var m=1/6,g=0,v=0;;)if(g+=m,d(g)===1){if(v++,v>=16)break}else v=0;var y=g*m*1e3;return sv.springs[e]=y,y}return t?d:p}function Cpe(e){return e===void 0&&(e=10),function(t){return Math.ceil(As(t,1e-6,1)*e)*(1/e)}}var Spe=function(){var e=11,t=1/(e-1);function r(u,h){return 1-3*h+3*u}function i(u,h){return 3*h-6*u}function n(u){return 3*u}function s(u,h,d){return((r(h,d)*u+i(h,d))*u+n(h))*u}function a(u,h,d){return 3*r(h,d)*u*u+2*i(h,d)*u+n(h)}function o(u,h,d,p,f){var m,g,v=0;do g=h+(d-h)/2,m=s(g,p,f)-u,m>0?d=g:h=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(u,h,d,p){for(var f=0;f<4;++f){var m=a(h,d,p);if(m===0)return h;var g=s(h,d,p)-u;h-=g/m}return h}function c(u,h,d,p){if(!(0<=u&&u<=1&&0<=d&&d<=1))return;var f=new Float32Array(e);if(u!==h||d!==p)for(var m=0;m<e;++m)f[m]=s(m*t,u,d);function g(v){for(var y=0,x=1,b=e-1;x!==b&&f[x]<=v;++x)y+=t;--x;var w=(v-f[x])/(f[x+1]-f[x]),C=y+w*t,_=a(C,u,d);return _>=.001?l(v,C,u,d):_===0?C:o(v,y,y+t,u,d)}return function(v){return u===h&&d===p||v===0||v===1?v:s(g(v),h,p)}}return c}(),DR=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=As(i,1,10),a=As(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function N8(e,t){if(it.fnc(e))return e;var r=e.split("(")[0],i=DR[r],n=LR(e);switch(r){case"spring":return PR(e,t);case"cubicBezier":return L3(Spe,n);case"steps":return L3(Cpe,n);default:return L3(i,n)}}function IR(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function n2(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function s2(e){return e.reduce(function(t,r){return t.concat(it.arr(r)?s2(r):r)},[])}function iE(e){return it.arr(e)?e:(it.str(e)&&(e=IR(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function z8(e,t){return e.some(function(r){return r===t})}function F8(e){var t={};for(var r in e)t[r]=e[r];return t}function Nx(e,t){var r=F8(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function a2(e,t){var r=F8(e);for(var i in t)r[i]=it.und(e[i])?t[i]:e[i];return r}function _pe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function Ape(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,c,u){return l+l+c+c+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function Epe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(d,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(p-d)*6*f:f<1/2?p:f<2/3?d+(p-d)*(2/3-f)*6:d}var o,l,c;if(i==0)o=l=c=n;else{var u=n<.5?n*(1+i):n+i-n*i,h=2*n-u;o=a(h,u,r+1/3),l=a(h,u,r),c=a(h,u,r-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function Mpe(e){if(it.rgb(e))return _pe(e);if(it.hex(e))return Ape(e);if(it.hsl(e))return Epe(e)}function so(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Tpe(e){if(af(e,"translate")||e==="perspective")return"px";if(af(e,"rotate")||af(e,"skew"))return"deg"}function zx(e,t){return it.fnc(e)?e(t.target,t.id,t.total):e}function oa(e,t){return e.getAttribute(t)}function j8(e,t,r){var i=so(t);if(z8([r,"deg","rad","turn"],i))return t;var n=sv.CSS[t+r];if(!it.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return sv.CSS[t+r]=c,c}function OR(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?j8(e,n,r):n}}function U8(e,t){if(it.dom(e)&&!it.inp(e)&&(oa(e,t)||it.svg(e)&&e[t]))return"attribute";if(it.dom(e)&&z8(wpe,t))return"transform";if(it.dom(e)&&t!=="transform"&&OR(e,t))return"css";if(e[t]!=null)return"object"}function RR(e){if(it.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function Lpe(e,t,r,i){var n=af(t,"scale")?1:0+Tpe(t),s=RR(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?j8(e,s,i):s}function V8(e,t,r,i){switch(U8(e,t)){case"transform":return Lpe(e,t,i,r);case"css":return OR(e,t,r);case"attribute":return oa(e,t);default:return e[t]||0}}function H8(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=so(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function BR(e,t){if(it.col(e))return Mpe(e);if(/\s/g.test(e))return e;var r=so(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function G8(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Ppe(e){return Math.PI*2*oa(e,"r")}function Dpe(e){return oa(e,"width")*2+oa(e,"height")*2}function Ipe(e){return G8({x:oa(e,"x1"),y:oa(e,"y1")},{x:oa(e,"x2"),y:oa(e,"y2")})}function kR(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=G8(i,s)),i=s}return r}function Ope(e){var t=e.points;return kR(e)+G8(t.getItem(t.numberOfItems-1),t.getItem(0))}function NR(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return Ppe(e);case"rect":return Dpe(e);case"line":return Ipe(e);case"polyline":return kR(e);case"polygon":return Ope(e)}}function Rpe(e){var t=NR(e);return e.setAttribute("stroke-dasharray",t),t}function Bpe(e){for(var t=e.parentNode;it.svg(t)&&it.svg(t.parentNode);)t=t.parentNode;return t}function zR(e,t){var r=t||{},i=r.el||Bpe(e),n=i.getBoundingClientRect(),s=oa(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function kpe(e,t){var r=it.str(e)?IR(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:zR(r),totalLength:NR(r)*(i/100)}}}function Npe(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=zR(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function nE(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=BR(it.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:it.str(e)||t?i.split(r):[]}}function FR(e){var t=e?s2(it.arr(e)?e.map(iE):iE(e)):[];return n2(t,function(r,i,n){return n.indexOf(r)===i})}function jR(e){var t=FR(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:RR(r)}}})}function zpe(e,t){var r=F8(t);if(/^spring/.test(r.easing)&&(r.duration=PR(r.easing)),it.arr(e)){var i=e.length,n=i===2&&!it.obj(e[0]);n?e={value:e}:it.fnc(t.duration)||(r.duration=t.duration/i)}var s=it.arr(e)?e:[e];return s.map(function(a,o){var l=it.obj(a)&&!it.pth(a)?a:{value:a};return it.und(l.delay)&&(l.delay=o?0:t.delay),it.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return a2(a,r)})}function Fpe(e){for(var t=n2(s2(e.map(function(s){return Object.keys(s)})),function(s){return it.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var c in o)it.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},n=0;n<t.length;n++)i(n);return r}function jpe(e,t){var r=[],i=t.keyframes;i&&(t=a2(Fpe(i),t));for(var n in t)it.key(n)&&r.push({name:n,tweens:zpe(t[n],e)});return r}function Upe(e,t){var r={};for(var i in e){var n=zx(e[i],t);it.arr(n)&&(n=n.map(function(s){return zx(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function Vpe(e,t){var r;return e.tweens.map(function(i){var n=Upe(i,t),s=n.value,a=it.arr(s)?s[1]:s,o=so(a),l=V8(t.target,e.name,o,t),c=r?r.to.original:l,u=it.arr(s)?s[0]:c,h=so(u)||so(l),d=o||h;return it.und(a)&&(a=c),n.from=nE(u,d),n.to=nE(H8(a,u),d),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=N8(n.easing,n.duration),n.isPath=it.pth(s),n.isColor=it.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var UR={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function VR(e,t){var r=jR(e);r.forEach(function(i){for(var n in t){var s=zx(t[n],i),a=i.target,o=so(s),l=V8(a,n,o,i),c=o||so(l),u=H8(BR(s,c),l),h=U8(a,n);UR[h](a,n,u,i.transforms,!0)}})}function Hpe(e,t){var r=U8(e.target,t.name);if(r){var i=Vpe(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function Gpe(e,t){return n2(s2(e.map(function(r){return t.map(function(i){return Hpe(r,i)})})),function(r){return!it.und(r)})}function HR(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return i(s)+a+o+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var sE=0;function Wpe(e){var t=Nx(TR,e),r=Nx(k8,e),i=jpe(r,e),n=jR(e.targets),s=Gpe(n,i),a=HR(s,r),o=sE;return sE++,a2(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var es=[],aE=[],D0,qpe=function(){function e(){D0=requestAnimationFrame(t)}function t(r){var i=es.length;if(i){for(var n=0;n<i;){var s=es[n];s.paused?(es.splice(n,1),i-=1):(s.tick(r),n++)}e()}else D0=cancelAnimationFrame(D0)}return e}();function Xpe(e){document.hidden?(es.forEach(function(t){return t.pause(e.timeStamp)}),aE=es.slice(0),_r.running=es=[]):aE.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",Xpe);function _r(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s,a=0,o=null;function l(C){var _=window.Promise&&new Promise(function(S){return o=S});return C.finished=_,_}var c=Wpe(e);l(c);function u(){var C=c.direction;C!=="alternate"&&(c.direction=C!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(_){(_.loop===1||_.loop%2===0)&&(_.reversed=c.reversed)})}function h(){c.direction="normal",c.reversed=!1,s.forEach(function(C){return C.reversed=!1})}function d(C){return c.reversed?c.duration-C:C}function p(){t=0,r=d(c.currentTime)*(1/_r.speed)}function f(C,_,S=!1){_&&(c.reversed?_.seek(_.duration*_.loop-(C-_.timelineOffset-_.pingPongDelayCorrection),S):_.seek(C-_.timelineOffset-_.startOnceDelay-_.pingPongDelayCorrection,S))}function m(C,_=!1){if(c.reversed)for(var S=a;S--;)f(C,s[S],_);else for(var A=0;A<a;A++)f(C,s[A],_)}function g(C){var ie,$,ee,ne,ce,ue,ye,Re,Se,Ne;var _=0,S=c.animations,A=S.length;for(c.direction!=="alternate"&&((ie=c.parent)==null?void 0:ie.direction)==="alternate"?(($=c.parent)==null?void 0:$.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((ee=c.parent)!=null&&ee.reversed&&c.direction==="alternate"?C=c.duration-c.delay+c.endDelay-C:C=c.duration+c.delay-c.endDelay-C):b(!1,(ne=c.parent)==null?void 0:ne.rewind,c.rewind,(ce=c.parent)==null?void 0:ce.reversePlayback,c.reversePlayback)&&((ue=c.parent)!=null&&ue.reversed&&c.direction==="alternate"?C=c.duration-c.delay+c.endDelay-C:C=c.duration+c.delay-c.endDelay-C);_<A;){var E=S[_],L=E.animatable,P=E.tweens,D=P.length-1,I=P[D];D&&(I=n2(P,function(Ae){return C<Ae.end})[0]||I);let Oe;(ye=c.parent)!=null&&ye.reversed&&c.direction==="alternate"?Oe=As(C-I.start-I.endDelay,0,I.duration)/I.duration:Oe=As(C-I.start-I.delay,0,I.duration)/I.duration;for(var B=isNaN(Oe)?1:I.easing(Oe),X=I.to.strings,H=I.round,R=[],q=I.to.numbers.length,F=void 0,z=0;z<q;z++){var U=void 0;let Ae,_e;c.direction!=="alternate"?((Re=c.parent)==null?void 0:Re.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ae=I.to.numbers[z],_e=I.from.numbers[z]||0):(_e=I.to.numbers[z],Ae=I.from.numbers[z]||0):b(!0,(Se=c.parent)==null?void 0:Se.rewind,c.rewind,(Ne=c.parent)==null?void 0:Ne.reversePlayback,c.reversePlayback)?(Ae=I.to.numbers[z],_e=I.from.numbers[z]||0):(_e=I.to.numbers[z],Ae=I.from.numbers[z]||0),I.isPath?U=Npe(I.value,B*_e):U=Ae+B*(_e-Ae),H&&(I.isColor&&z>2||(U=Math.round(U*H)/H)),R.push(U)}var K=X.length;if(!K)F=R[0];else{F=X[0];for(var j=0;j<K;j++){X[j];var Y=X[j+1],V=R[j];isNaN(V)||(Y?F+=V+Y:F+=V+" ")}}UR[E.type](L.target,E.property,F,L.transforms),E.currentValue=F,_++}}function v(C){c[C]&&!c.passThrough&&c[C](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(C,_,S,A,E){return x[C<<4|_<<3|S<<2|A<<1|E]}function w(C,_=!1){var P;var S=c.duration;let A=c.delay,E=S-c.endDelay;(P=c.parent)!=null&&P.reversed&&c.direction==="alternate"&&(A=c.endDelay,E=S-c.delay);var L=d(C);if(c.progress=As(L/S*100,0,100),_||(c.reversePlayback=L<c.currentTime),a&&m(L,_),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||L>=0)&&L<=A&&c.currentTime!==0&&(g(0),v("change")),(L>=E&&c.currentTime!==S+c.pingPongDelayCorrection||!S)&&(g(S),v("change")),L>A&&L<E?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),g(L),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),a&&v("timelineChangeComplete")):c.began&&L>E&&v("changeComplete"),c.currentTime=As(L,0,S+c.pingPongDelayCorrection),c.began&&v("update"),C>=S)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/_r.speed:t+=c.duration;for(let D of s)D.setStartTime(0),D.remaining=D.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():a&&h()}}return c.reset=function(){var C=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=C==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var _=a;_--;)c.children[_].reset();(c.reversed&&c.loop!==!0||C==="alternate"&&c.loop===1)&&c.remaining++,g(c.reversed?c.duration:0)},c.setStartTime=function(C){t=C},c.set=function(C,_){return VR(C,_),c},c.tick=function(C){i=C,t||(t=i),w((i+(r-t))*_r.speed)},c.seek=function(C,_=!1){w(C-t,_)},c.pause=function(C){c.paused=!0,a&&(n=C??performance.now())},c.play=function(C){!c.paused||(c.completed&&c.reset(),c.paused=!1,es.push(c),a&&n!==void 0&&(t+=(C??performance.now())-n),D0||qpe())},c.reverse=function(){u(),c.completed=!c.reversed,p()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function oE(e,t){for(var r=t.length;r--;)z8(e,t[r].animatable.target)&&t.splice(r,1)}function Ype(e){for(var t=FR(e),r=es.length;r--;){var i=es[r],n=i.animations,s=i.children;oE(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;oE(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function Qpe(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?N8(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",u=it.arr(e),h=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,p=so(u?e[1]:e)||0,f=t.start||0+(u?h:0),m=[],g=0;return function(v,y,x){if(o&&(a=0),l&&(a=(x-1)/2),c&&(a=x-1),!m.length){for(var b=0;b<x;b++){if(!n)m.push(Math.abs(a-b));else{var w=l?(n[0]-1)/2:a%n[0],C=l?(n[1]-1)/2:Math.floor(a/n[0]),_=b%n[0],S=Math.floor(b/n[0]),A=w-_,E=C-S,L=Math.sqrt(A*A+E*E);s==="x"&&(L=-A),s==="y"&&(L=-E),m.push(L)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(D){return i(D/g)*g})),r==="reverse"&&(m=m.map(function(D){return s?D<0?D*-1:-D:Math.abs(g-D)}))}var P=u?(d-h)/g:h;return f+P*(Math.round(m[y]*100)/100)+p}}function Kpe(e){e===void 0&&(e={});var t=_r(e);return t.duration=0,t.add=function(r,i){var n=es.indexOf(t),s=t.children;n>-1&&es.splice(n,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=a2(r,Nx(k8,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=it.und(i)?c:H8(i,c),a(t);var u=_r(l);a(u),s.push(u),u.parent=t;var h=HR(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}_r.version="3.2.0";_r.speed=1;_r.running=es;_r.remove=Ype;_r.get=V8;_r.set=VR;_r.convertPx=j8;_r.path=kpe;_r.setDashoffset=Rpe;_r.stagger=Qpe;_r.timeline=Kpe;_r.easing=N8;_r.penner=DR;_r.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var GR=_r,lE=new T,cE=new T,hE=new mt;function Zpe(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function Uc(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(a==null)return;let o=s??t[e],l=a;if(o!==l)return{update:c=>{let u=gt.lerp(o,l,c);n?t[e]=Math.trunc(u):t[e]=u},start:()=>{t[e]=o},end:()=>{t[e]=l}}}function WR(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=[...s??o],c=[...a];if(!(l.length!==c.length||Z7(l,c)))return{update:u=>{l.forEach((h,d)=>{let p=gt.lerp(h,c[d],u);t[e][d]=n?Math.trunc(p):p})},start:()=>{Object.assign(t[e],l)},end:()=>{Object.assign(t[e],c)}}}function uE(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new T().fromArray(n):a.clone(),l=new T().fromArray(s);if(!o.equals(l))return{update:c=>{a.lerpVectors(o,l,c)},start:()=>{a.copy(o)},end:()=>{a.copy(l)}}}function Jpe(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new Ce().fromArray(n):a.clone(),l=new T,c=new mt,u=new T;o.decompose(l,c,u);let h=new Ce().fromArray(s),d=new T,p=new mt,f=new T;if(h.decompose(d,p,f),!o.equals(h))return{update:m=>{hE.slerpQuaternions(c,p,m),lE.lerpVectors(l,d,m),cE.lerpVectors(u,f,m),a.compose(lE,hE,cE)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(d,p,f)}}}function $pe(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new $e().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return t[e]=u,{update:h=>{u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Bl(e,t,r,i){if(typeof t[e]=="number")return Uc(e,t,r??{},i);if(Array.isArray(t[e]))return WR(e,t,r??{},i)}function efe(e,t,r){var a,o,l,c;let i=[],n=e.cameraType==="OrthographicCamera"?(a=t.orthographic)==null?void 0:a.zoom:(o=t.perspective)==null?void 0:o.zoom,s=e.cameraType==="OrthographicCamera"?(l=r.orthographic)==null?void 0:l.zoom:(c=r.perspective)==null?void 0:c.zoom;if(s!==void 0){let u=n??e.zoom,h=s;u!==h&&i.push({update:d=>{e.zoom=gt.lerp(u,h,d),e.updateProjectionMatrix()},start:()=>{e.zoom=u,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let u=Uc("targetOffset",e,t,r);u&&i.push(u)}return i}function tfe(e,t,r,i){if(r.scaleBaked===void 0)return;let n=t.scaleBaked??e.data.geometry.scaleBaked,s=r.scaleBaked;if(Ac.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[gt.lerp(n[0],s[0],o),gt.lerp(n[1],s[1],o),gt.lerp(n[2],s[2],o)]},i),e.invalidateDownstreamBooleanData()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData()}}),a}function rfe(e,t,r){if(!r.extrusion)return;let i=e.extrusion,n=t.extrusion??{},s=r.extrusion,a=[];return XI.forEach(o=>{let l=Bl(o,i,n,s);l&&a.push(l)}),a}function ife(e,t,r,i){let n=[];if(!("geometry"in r))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof Kf){let l=tfe(e,a,o,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,io(s,v_)),v_.forEach(c=>{let u=Bl(c,l,a,o);u&&n.push(u)}),e instanceof P8){Object.assign(l,{extrusion:{...s.extrusion}});let c=rfe(l,a,o);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()}})}return n}function nfe(e,t,r,i){let n=[];if(r.intensity!==void 0){let s=Uc("intensity",e,t,r);s&&n.push(s)}if(r.color!==void 0){let s=$pe("color",e,t,r,i);s&&n.push(s)}return n}function sfe(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},u=a[l];typeof c=="string"||typeof u=="string"||n.push(...dE(o,c,u,i))})}else{if(!("material"in r&&r.material))return n;let s="material"in t&&t.material?t.material:{},a=r.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...dE(e.material,s,a,i))}return n}function dE(e,t,r,i){var a;let n=[],s=tv(r,i)||!!t.layers&&tv(t,i);n.push(ffe(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),c=r.layers.data(o.uuid);if(!c||!(o.visible??!0)||!(c.visible??!0))continue;let u=o.getNames().filter(h=>!GI.some(d=>h.includes(d)));for(let h of u)try{let d=o.getValue(h),p;if(h==="colors")p=dfe(o,l,c,h);else if(Array.isArray(d))h==="steps"&&(p=ufe(o,l,c,h));else if(typeof d=="number")p=afe(o,l,c,h);else{if(typeof d=="boolean")continue;d instanceof W?p=ofe(o,l,c,h):d instanceof T?p=lfe(o,l,c,h):d instanceof on?p=hfe(o,l,c,h,i):d instanceof $e?p=cfe(o,l,c,h,i):"isTexture"in d&&(p=pfe(o,l,c,h))}p&&(Array.isArray(p)?n.push(...p):n.push(p))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return n}function afe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=t?t[i]:e.getValue(i),s=r[i];if(n!==s)return{update:a=>{e.setValue(i,gt.lerp(n,s,a))},start:()=>{e.setValue(i,n)},end:()=>{e.setValue(i,s)}}}function ofe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new W().fromArray(t[i]):n.clone(),a=new W().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function lfe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new T().fromArray(t[i]):n.clone(),a=new T().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function cfe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new $e().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function hfe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new $e().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new on(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function ufe(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s,o=r[i];for(let l=0;l<s.length;++l){let c=a[l],u=o[l];c!==u&&n.push({update:h=>{s[l]=gt.lerp(c,u,h)},start:()=>{s[l]=c},end:()=>{s[l]=u}})}return n.length?n:void 0}function dfe(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s.map(l=>l.toArray()),o=r[i];for(let l=0;l<s.length;++l){let c=[...a[l]],u=[...o[l]];Fg.isEqual(c,u)||n.push({update:h=>{s[l].fromArray(Fg.lerp(c,u,h))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(u)}})}return n.length?n:void 0}function pfe(e,t,r,i="texture"){if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("mat");if(!n)return;let s=t?t[i]:n,a=r[i],o=[...s.repeat],l=[...s.offset],c=[...a.repeat],u=[...a.offset];if(!ou.isEqual(o,c)||!ou.isEqual(l,u))return{update:h=>{n.repeat=ou.lerp(o,c,h),n.offset=ou.lerp(l,u,h),n.updateMatrix()},start:()=>{n.repeat=[...o],n.offset=[...l],n.updateMatrix()},end:()=>{n.repeat=[...c],n.offset=[...u],n.updateMatrix()}}}function ffe(e,t){return{update:()=>{e.transparent=t}}}var P3=new T,pE=new $r;function mfe(e,t,r,i){let n=[],s,a,o,l,c,u,h={slide:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).slide,offset:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).offset};if(c=Uc("slide",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping),c&&n.push(c),u=Uc("offset",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping),u&&n.push(u),!c&&!u&&(s=uE("position",e,t,r),s&&n.push(s),a=uE("scale",e,t,r),a&&n.push(a),o=gfe(e,t,r,i),o&&n.push(o),l=Jpe("hiddenMatrix",e,t,r),l&&n.push(l)),s||a||o||l||c||u){let d=()=>{var p;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(p=e.parent)!=null&&p.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),bs(e)&&sa(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,h))};n.push({update:d,start:d,end:d})}return n}function gfe(e,t,r,i){let n=t!=null&&t.rotation?t.rotation:void 0,s=r.rotation;if(!s)return;let a=n?new T().fromArray(n):new T().setFromEuler(e.rotation),o=new T().fromArray(s);if(a.equals(o))return;let l=P3.subVectors(o,a);if(i&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new mt().setFromEuler(pE.setFromVector3(a)),u=new mt().setFromEuler(pE.setFromVector3(o));return{update:h=>{Zpe(c,u,e.quaternion,h)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}else return{update:c=>{P3.lerpVectors(a,o,c),e.rotation.setFromVector3(P3)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}function vfe(e,t,r){let i=[];if(!("cloner"in r)||!e.cloner)return i;let n=e.cloner,s="cloner"in t?t.cloner:{},a=r.cloner;zI.forEach(d=>{let p;d==="count"?p=Uc("count",n.parameters,s,a,!0):p=Bl(d,n.parameters,s??{},a),p&&i.push(p)});let o=yfe(n,s,a);o!=null&&o.length&&i.push(...o);let l=xfe(n,s,a);l!=null&&l.length&&i.push(...l);let c=bfe(n,s,a);c!=null&&c.length&&i.push(...c);let u=wfe(n,s,a);u!=null&&u.length&&i.push(...u);let h=Cfe(n,s,a);return h!=null&&h.length&&i.push(...h),i.length&&i.push({update:()=>{n.update()}}),i}function yfe(e,t,r){if(e.parameters.type!=="radial")return;let i=t.radial,n=r.radial;if(!n)return;let s=e.parameters.radial,a=[];return FI.forEach(o=>{let l=Bl(o,s,i??{},n);l&&a.push(l)}),a}function xfe(e,t,r){if(e.parameters.type!=="linear")return;let i=t.linear,n=r.linear;if(!n)return;let s=[],a=e.parameters.linear;return jI.forEach(o=>{let l=Bl(o,a,i??{},n);l&&s.push(l)}),s}function bfe(e,t,r){if(e.parameters.type!=="grid")return;let i=t.grid,n=r.grid;if(!n)return;let s=[],a=e.parameters.grid;return UI.forEach(o=>{let l;o==="count"?l=WR(o,a,i??{},n,!0):l=Bl(o,a,i??{},n),l&&s.push(l)}),s}function wfe(e,t,r){if(e.parameters.type!=="toObject")return;let i=t.toObject,n=r.toObject;if(!n)return;let s=[],a=e.parameters.toObject;return VI.forEach(o=>{let l;o==="count"?l=Uc(o,a,i??{},n,!0):l=Bl(o,a,i??{},n),l&&s.push(l)}),s}function Cfe(e,t,r){if(!e.parameters.randomness)return;let i=t.randomnessObject,n=r.randomnessObject;if(!n)return;let s=[],a=e.parameters.randomnessObject;return HI.forEach(o=>{let l=Bl(o,a,i??{},n);l&&s.push(l)}),s}function fE(e,t,r,i,n){let s=[];return e.data.visible&&s.push(...mfe(e,t,r,n)),e.data.visible&&s.push(...vfe(e,t,r)),bs(e)?(e instanceof Fi&&e.data.visible&&s.push(...ife(e,t,r,i)),e.data.visible&&s.push(...sfe(e,t,r,i))):zhe(e)?e.data.visible&&s.push(...nfe(e,t,r,i)):Nhe(e)&&s.push(...efe(e,t,r)),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var mE=new T;function W8(e,t,r=!1){let i=[];e.traverseChildren(n=>{var l,c,u,h,d;if(r&&((l=n.rigidBody)==null||l.setTranslation(n.position0,!0),(c=n.rigidBody)==null||c.setRotation(n.rotation0,!0),(u=n.rigidBody)==null||u.setLinvel(mE,!0),(h=n.rigidBody)==null||h.setAngvel(mE,!0)),!Mt.is(n))return;let s=n.uuid,a=n.data;if(delete n.states,n.uuid===_d)return;let o=!1;i.some(p=>{var f;return(f=e.scene.find(s))==null?void 0:f.isDescendantOf(p)})?o=!0:((d=a.physics)==null?void 0:d.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&i.push(s),n.data=a,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let p of a.states){let f={...p.data};e.data.globalPhysics.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||o)&&(p.data.position!==void 0&&delete f.position,p.data.rotation!==void 0&&delete f.rotation,p.data.hiddenMatrix!==void 0&&delete f.hiddenMatrix),n.states||(n.states={}),n.states[p.id]=fc.patch(a,f)}_fe(e.scene,n,null,t,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0),Sfe(e)})}function Sfe(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function _fe(e,t,r,i,n=!1){if(t instanceof Fi&&t.removeInteractionGeometry(),t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof Fi&&t.updateGeometryGroupsIfNeeded(),t instanceof _i&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}function qR(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:s}=e;t=`spring( ${r}, ${i}, ${n}, ${s} )`}else{let r;switch(e.easing){case 0:r=zo.linear;break;case 1:r=zo.ease;break;case 2:r=zo.easeIn;break;case 3:r=zo.easeOut;break;case 4:r=zo.easeInOut;break;default:r=zo.linear}let[i,n,s,a]=r;t=`cubicBezier( ${i}, ${n}, ${s}, ${a} )`}return{duration:e.duration,easing:t}}function XR(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var Afe={type:"beginState"},Efe={type:"completeState",isfromEntity:!1},gE=class{constructor(e,t,r,i,n,s){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof _i&&o.dispatchEvent(Afe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof _i&&o.dispatchEvent(Efe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=fE(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=I0(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=I0(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(r===void 0)throw new Error("Missing property");{let a=I0(this.object,r);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...XR(i),...qR(i),change:this.onChange},this.callback=fE(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},of=class extends pi{constructor(e,t,r){if(super(),this.data=e,this.page=t,this.sharedAssets=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var n;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((n=this.timeline)==null||n.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!e.object)throw new Error("Missing property");let i=this.page.scene.find(e.object);if(!i)throw new Error("Missing property");if(!i.states)throw new Error("Missing property");if(this.object=i,e.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=e.tweens[0].data.delayDirection==="start-once"?e.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=I0(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,isRebuild:t=!1}={}){var r,i,n,s;try{let a=XR(this.data.tweens[0].data),o=a.loop;t&&typeof a.loop=="number"&&a.loop--,(r=this.timeline)==null||r.pause(),this.timeline=GR.timeline({autoplay:!1,...a,...o===!0||o>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(o===!0||o>1),a.pingPongDelayCorrection&&t===!1&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let u=c;u<this.data.tweens.length-1;u++){let h=this.data.tweens[u],d=this.data.tweens[u+1],p;u===c&&(this.object.wasMovedByUser===!0||((i=this.object.previousAction)==null?void 0:i.playing)===!0)?(p=void 0,this.object instanceof _i&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new gE(this.object,p,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.delay:0)+(u===c&&!t?a.pingPongDelayCorrection:0))}this.timeline.duration+=a.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let u=c;u>0;u--){let h=this.data.tweens[u],d=this.data.tweens[u-1],p;u===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(p=void 0,this.object instanceof _i&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new gE(this.object,p,d.data.state===void 0?this.currentState:d.data.state,h.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u-1]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.endDelay:0))}this.timeline.duration+=a.delay+(t?0:a.pingPongDelayCorrection)}}catch(a){a instanceof Error&&console.error(a.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(e){e instanceof Error&&console.error(e.message)}},this.startOnceDelay)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.sharedAssets}),this.object.currentState=e}seek(e){var t;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function I0(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var Mfe={type:"beginState"},vE={type:"completeState",isfromEntity:!1},yE={type:"requestRender"},YR=class extends pi{constructor(e,t){super(),this.data=e,this.page=t,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new T,this.posEnd=new T,this.qStart=new mt,this.qEnd=new mt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=GR({targets:r,t:1,...qR(this.data),update:()=>{r.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(Mfe));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(yE),r.t===1&&i.dispatchEvent(vE)}})}switchCamera(e){let t=this.page.scene.find(e);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(t),this.page.activeCamera.dispatchEvent({type:"cameraChange",camera:t})}play(){if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward;try{this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(vE),this.page.activeCamera.dispatchEvent(yE))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},lf=class extends pi{constructor(e,t,r){var o,l,c;super(),this.page=t,this.animationControls=r,this.startOnceDelay=0,this.toggleIsForward=!1;let i=e.object,n=t.scene.find(e.object);n&&Array.isArray(n.identity)&&(i=n.identity[0]),this.data={...e,object:i};let s=this.animationControls.clipIdToAction[e.clipId+"/"+i];this.duration=((o=s==null?void 0:s.getClip())==null?void 0:o.duration)??1;let a=((c=(l=s==null?void 0:s.getClip())==null?void 0:l.tracks[0])==null?void 0:c.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/a*this.duration,this.rightFrameTime=this.data.crop[1]/a*this.duration,this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let s=i.split("/")[1];this.threeAnimAction!==n&&s===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=gt.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let a=n.split("/")[1];this.threeAnimAction!==s&&a===i&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},QR=class{constructor(e,t,r,i){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.timeOutId=-1,this.scene=t.scene}dispatch(){this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),W8(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}};function Pn(e,t,r,i,n,s){let a={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[]};return t.forEach(({id:o,data:l})=>{try{l.type==="Audio"?Ns[e.type].includes("Audio")&&a.Audio.push(new sf(o,l,s,i)):l.type==="Video"?Ns[e.type].includes("Video")&&a.Video.push(new q8(o,l,s)):l.type==="Link"?Ns[e.type].includes("Link")&&a.Link.push(new bpe(l,n)):l.type==="Create"?Ns[e.type].includes("Create")&&a.Create.push(new hf(l,r,n.controlsManager)):l.type==="Destroy"?Ns[e.type].includes("Destroy")&&a.Destroy.push(new ER(l,r,n)):l.type==="Reset"?Ns[e.type].includes("Reset")&&a.Reset.push(new MR(l,r,i,n)):l.type==="Transition"?Ns[e.type].includes("Transition")&&a.Transition.push(new of(l,r,i)):l.type==="SwitchCamera"?Ns[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new YR(l,r)):l.type==="SceneTransition"?Ns[e.type].includes("SceneTransition")&&a.SceneTransition.push(new QR(l,r,n,i)):l.type==="Animation"&&Ns[e.type].includes("Animation")&&a.Animation.push(new lf(l,r,n.animationControls))}catch{}}),a}function hn(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof sf||r instanceof q8||r instanceof lf||r instanceof of||r instanceof hf||r instanceof ER||r instanceof YR||r instanceof QR||r instanceof MR)&&r.dispose()})})}function Tfe(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var KR=new Map,cf=new Map,Iu=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:s,delay:a}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let o=Tfe(r,i);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),cf.has(r.uuid)?cf.get(r.uuid).push(this):cf.set(r.uuid,[this]),KR.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},Fx=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=KR.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=cf.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...cf.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},q8=class{constructor(e,t,r){if(this.data=t,t.interaction==="play")this.interaction=new Iu(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new Fx(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Iu?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Iu?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},xE=(()=>{let e,t,r,i;function n(o){!e&&!bE()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,i=o.requestRender)}function s(o){let l=r?o-r:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,h=c.length,d=0;for(;d<h;){let p=c[d];p.userData.createdTime===void 0&&(p.userData.createdTime=o),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&o-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&u[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),i()),d++):(u[p.userData.actionId]>p.userData.quantity&&u[p.userData.actionId]--,c.splice(d,1),p.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),h--,i())}e=d>0?requestAnimationFrame(s):void 0,r=d>0?o:void 0}function a(){bE()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function bE(){return!!document&&document.hidden}var wE=new mt,Lfe=new T,Pfe=new T,hf=class{constructor(e,t,r){this.data=e,this.page=t,this.controlsManager=r,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=gt.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=vse(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let n=new Ci(this.object);if(n.playModeVisible=!0,n.expand(),this.data.coordinateSystem!=="world"){let a=this.data.coordinateSystem,o=this.page.scene.find(a);o&&(o.updateMatrixWorldSVD(),n.hiddenMatrix.copy(o.matrixWorldRigid))}n.position.fromArray(this.data.position),n.rotation.fromArray(this.data.rotation),n.updateMatrix(),this.page.add(n);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(n),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,n.updateWorldMatrix(!0,!0),n.traverseObject(this.traverseObjectCB),xE(),this.controlsManager.requestRender()},this.traverseObjectCB=n=>{var l,c,u,h;n.hasNonUniformScale&&n.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(n instanceof _s)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof Ci)s=n.object;else if(s=n,(l=s.dataPatched.cloner)==null?void 0:l.hideBase)return!0}else{if(n instanceof _s)return;n instanceof Ci?s=n.object:s=n}this.data.destroy==="Time"?n.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(n.userData.quantity=this.data.destroyAfterQuantity,n.userData.actionId=this.uniqueId);let a=new T().fromArray(this.data.velocity),o=s.dataPatched;if(!(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(n,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((c=n.rigidBody)==null||c.collider(0).setActiveEvents(1),n.userData.hasCollisionDestroy=!0),n.matrixWorld.decompose(Lfe,wE,Pfe),a.applyQuaternion(wE),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&((u=n.rigidBody)==null||u.setLinvel(a.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in n.object&&this.controlsManager.addBoundsTree(n),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&(n.userData.velocity=a)),((h=s.dataPatched.physics)==null?void 0:h.fusedBody)===!0))return!0};let i=this.page.scene.find(this.data.object);if(!i)throw new Error("Missing Property");if(this.object=i,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");xE(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},ZR=200,D3=.02,I3=.3,Dfe=65;new T;var CE=new T,SE=new T,Ife=new T,oi=new T,Pi=new T,Po=new T,r0=new Ce,O3=new Ce,Ofe=new Ce;new Ce;var gn=new mt,Pa=new mt,Hs=new $r(0,0,0,"YXZ"),Rfe=new T(1,0,0),fs=new T(0,1,0),Bfe=new T(0,0,1),R3=new T(1,1,1),B3=new Ln,kfe=1,Nfe=.025,zfe=16e-6,_E=12,Ffe=20,Qr=new $n,zn=new Er,jfe={type:"requestRender"},Ufe={type:"updateMatrix"},AE=Math.PI/6,jx=class extends pi{constructor(e,t,r,i,n,s,a,o,l){var f;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new Ce,this.target0=new T,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=ZR,this.euler0=new $r(0,0,0,"YXZ"),this.position0Cam=new T,this.quat0Cam=new mt,this.scale0Cam=new T,this.hiddenMatrix0Cam=new Ce,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new $n(new T(0,-40,0),new T(0,40,0)),matrix:new Ce,position:new T,rotation:new mt},this.euler=new $r(0,0,0,"YXZ"),this.eulerDelta=new T,this.lastPosition=new T,this.lastCameraQuaternion=new mt,this.lastCameraPosition=new T,this.PI_2=Math.PI/2,this.prevMouse=new W,this.velocityTarget=new T,this.velocity=new T,this.directionXZ=new T,this.rotVelocityStick=new T,this.rotVelocityTarget=new T,this.rotVelocity=new T,this.rotDirection=new T,this.nonColliderRotOffset=new Ce,this.nonColliderPosOffset=new Ce,this.firstPointerId=-1,this.rot=new T,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Ce,this.objectToTarget=new T,this.objectToTarget0=new T,this.objectToCamXZ=new T,this.objectToCamXZ0=new T,this.targetToCamera=new T,this.targetToCamera0=new T,this.cameraPolarAxis0=new T,this.targetPos=new T,this.targetQuat=new mt,this.lerpFactorPos=new T().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new mt,this.objXZQuatInv=new mt,this.objXZRotMat=new Ce,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new T,this.pushedVelocity=new T,this.groundYRotation=0,this.objectRealQuat=new mt,this.colliderWorldQuat=new mt,this.groundNormal=new T,this.groundTilt=new mt,this.groundTiltInv=new mt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new T,this.quaternion=new mt,this.scale=new T,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!Sn&&(!HS||GS>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,v=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(HS&&GS<15.5&&!Sn?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?jx.isLocked=!0:jx.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let v=2;v<4;v++){let y=m.axes[v];g===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new T(0,0,-1).applyQuaternion(this.camera.quaternion),g=new T().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,y=g.projectOnVector(m)):g.y/m.y>0?y=m.multiplyScalar(g.y/m.y):y=m.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let x=new $r().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof _i&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*kfe,this.speedOrbit=(r.speedRotate??100)*Nfe,this.mouseOrbitSensitivity=(r.speedRotate??100)*zfe,this.keyAssignments=r.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]==="▲"?g[1]="ArrowUp":g[1]==="◀"?g[1]="ArrowLeft":g[1]==="▼"?g[1]="ArrowDown":g[1]==="▶"?g[1]="ArrowRight":g[1]==="⇧"?g[1]="Shift":g[1]==="↵"?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]==="⌘"?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),r.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??ed.defaultData.gravity)*_E,this.usePhysics=this.gloabalPhysics.usePhysics??ed.defaultData.usePhysics,this.jumpPower=r.jumpPower*Ffe,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??Yg.defaultDataThirdPerson.orientWith,this.slopeThresh=Dfe*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*D3/this.pixelsPerMeter,this.stepThresh=r.collider.height*I3/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*D3/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*I3/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*D3/this.pixelsPerMeter,this.stepThresh=r.collider.height*I3/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let h=new T().fromArray(r.collider.position),d=new mt().setFromEuler(new $r().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,R3),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.runMultiplier=r.runMultiplier??2;let p=r.navmesh.destinationHelperRadius*2;if(p>0){let m=new at;m.push({fi:0,data:{...Yi.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...Yi.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let g=new S8({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new $i(eO.create({parameters:{width:p,height:p/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new $r().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof _i?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.page,r=this.sharedAssets,i=this.object;e.gameActions!==void 0&&Object.entries(e.gameActions).forEach(([n,s],a)=>{s.forEach(({id:o,data:l})=>{try{this.actions[n]===void 0&&(this.actions[n]=[]),l.type==="Transition"?this.actions[n].push(new of(l,t,r)):l.type==="Animation"?this.actions[n].push(new lf(l,t,this.controlsManager.eventManager.animationControls)):l.type==="Audio"?this.actions[n].push(new sf(o,l,i,r)):l.type==="Video"?this.actions[n].push(new q8(o,l,i)):l.type==="Create"&&this.actions[n].push(new hf(l,t,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),hn(this.actions)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].forEach(t=>{t instanceof of?t.play():t instanceof lf?t.play(this.initialAction===!1):t instanceof hf?t.dispatchStart():t instanceof sf&&t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].forEach(t=>{t instanceof of?(t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})):t instanceof lf||(t instanceof hf?t.dispatchStop():t instanceof sf&&t.dispatchGameControl("stop"))})))}get colliderWorldPosition(){return oi.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var o,l,c,u,h,d,p,f,m,g,v;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=Pi.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*_E),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let b=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let w of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(w.rigidBody===b&&w.userData.isFollowingObj!==this.object.uuid){(w.hasNonUniformScale?w.matrixWorldRigid:w.matrixWorld).decompose(oi,Pa,Pi),this.groundVelocity.subVectors(oi,w.prevT),this.object.getWorldPosition(Pi).add(this.collider.position).sub(oi),this.groundYRotation=Hs.setFromQuaternion(Pa).y-w.prevR.y,Po.copy(Pi).applyAxisAngle(fs,this.groundYRotation),this.groundVelocity.add(Po.sub(Pi)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=oi.subVectors(this.path[1],this.position),b=Pi.subVectors(this.path[1],this.path[0]);x.dot(b)<0?this.path.shift():(this.directionXZ.x=b.x,this.directionXZ.z=b.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=Ife.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=Pi.copy(a);y.y=0,a.set(0,a.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let y=oi;this.camera.getWorldDirection(y);let x=Po.copy(fs).multiplyScalar(y.dot(fs));y.sub(x);let b=Pi.copy(this.directionXZ);b.x*=-1,this.rot.y=y.angleTo(b)*(y.cross(b).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Hs.setFromVector3(this.rot),this.moveMode==="walk"&&(Hs.x=0),a.applyEuler(Hs),s&&(Pa.setFromUnitVectors(fs,this.groundNormal),a.applyQuaternion(Pa)),r){let y=Hs.set(0,this.vrEulerYOffset*AE,0);r.applyEuler(y),a.x+=r.x,a.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let y=Pi;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let b=Po.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),w=x.rigidBody.collider(0).castCollider(b,this.object.rigidBody.collider(0),oi.copy(a).divideScalar(this.pixelsPerMeter),i,!1);b.multiplyScalar(this.pixelsPerMeter);let C=Mt.is(x)?x:x.object;if(w!==null&&this.lastHitObj!==C){let _;x instanceof Ci&&(_=x);let S=this.sharedGameControlGlobals.entityToCollisionEvents[C.uuid];if(S)for(let A of S)A.data.target==="character"&&(A.dispatch(_),C.dispatchEvent(Hx));this.lastHitObj=C}if(w!==null){this.pushedVelocity.copy(b),y.copy(w.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(a);x<0&&a.addScaledVector(y,-x),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(fs,this.euler.y-this.euler0.y);let y=Pi.copy(this.objectToCamXZ).normalize(),x=Po.copy(a).multiplyScalar(i);x.y=0;let b=x.sub(oi.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(b,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=gt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=gt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=gt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Hs.copy(t),Hs.y=0):(Hs.copy(this.euler),Hs.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Hs)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*AE),gn.setFromAxisAngle(Rfe,this.rot.x),Pa.setFromAxisAngle(fs,this.rot.y),Pa.multiply(gn),gn.setFromAxisAngle(Bfe,this.rot.z),Pa.multiply(gn),this.quaternion.copy(Pa),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=Pi.copy(a).multiplyScalar(i/this.pixelsPerMeter),x=null;this.didHit=!1;let b=new T;for(let w=0;w<5;w++){let C=y.length(),_=Po.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),this.colliderWorldQuat,_,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,C,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(S!==this.lastHitObj&&w===0){this.lastHitObj=S;let P=this.sharedGameControlGlobals.entityToCollisionEvents[S==null?void 0:S.uuid];if(P){for(let D of P)if(D.data.target==="character"){let I=((u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.getCollider(x.collider.handle))._parent,B;if(S.cloner){for(let X of S.cloner.children)if(X.rigidBody===I){B=X;break}}D.dispatch(B),S.dispatchEvent(Hx)}}}let A=CE.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),E=SE.copy(_).multiplyScalar(x.toi).dot(A),L=x.toi;if(L===0&&(this.position.y+=this.offset*this.pixelsPerMeter),E>this.offset&&(L=x.toi*(E-this.offset)/E,b.addScaledVector(_,L)),y.copy(_).multiplyScalar(C-L),Math.acos(-A.y)>this.slopeThresh){let P=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),D=Po.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);D.y=0;let I=P.add(D);I.y+=this.stepThresh;let B=this.sharedGameControlGlobals.rapierWorld.castShape(I,this.colliderWorldQuat,y,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);B!==null&&B.toi===0&&(A.y=0,A.normalize())}y.addScaledVector(A,-y.dot(A))}else{w===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),b.add(y);break}}this.position.addScaledVector(b,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(oi.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(gn.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=a.multiplyScalar(i/y);for(let b=0;b<y;b++)this.position.add(x),b===0&&this.checkTrigger(),this.collisionAdjustment(i/y)}else this.position.addScaledVector(a,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);r0.lookAt(x,y,fs).setPosition(x),r0.decompose(this.targetPos,this.targetQuat,oi),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=gt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=gt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(Ufe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((m=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:m.opacity)<-.04*((v=(g=this.navMeshPathDest)==null?void 0:g.material)==null?void 0:v.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(jfe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=gn.setFromAxisAngle(fs,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?gt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=gt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=gt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=oi.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=Pa.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){fs.angleTo(e)*180/Math.PI<15||fs.angleTo(e)*180/Math.PI>85?gn.identity():gn.setFromUnitVectors(fs,e),this.groundTilt.slerp(gn,.06),this.groundTiltInv.copy(this.groundTilt).invert()}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(Mt.is(o)?o:o.object)===!1)continue;let l=O3.copy(n.matrixWorld).decompose(oi,gn,Pi).compose(oi,gn,R3).multiply(i),c=r0.copy(o.matrixWorld).invert().multiply(l);r instanceof Er?e=o.bvhGeometry.boundsTree.intersectsBox(r,c):(B3.radius=r,B3.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(B3)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(Q1e)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(u=>u!==o)}}}collisionAdjustment(e){var n;let t=SE.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=r0.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(oi,gn,Pi).compose(oi,gn,R3);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;zn.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=O3.copy(a).invert(),l=Ofe.copy(O3).multiply(r);Qr.copy(this.collider.segment),Qr.start.applyMatrix4(l),Qr.end.applyMatrix4(l);let c=CE.copy(this.position).applyMatrix4(o);zn.expandByPoint(Qr.start),zn.expandByPoint(Qr.end),zn.min.addScalar(-this.collider.radius),zn.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(u){return u.distanceToPoint(Qr.end)},intersectsBounds:u=>u.intersectsBox(zn),intersectsTriangle:u=>{let h=oi,d=Pi,p=u.closestPointToSegment(Qr,h,d);if(p<this.collider.radius){let f=this.collider.radius-p,m=d.sub(h).normalize(),g=Po.copy(c);g.addScaledVector(m,f);let v=g.applyMatrix4(a).sub(this.position);t.add(v),Qr.start.addScaledVector(m,f),Qr.end.addScaledVector(m,f)}}})}),zn.makeEmpty(),Qr.copy(this.collider.segment),Qr.start.applyMatrix4(r),Qr.end.applyMatrix4(r),zn.expandByPoint(Qr.start),zn.expandByPoint(Qr.end),zn.min.addScalar(-this.collider.radius),zn.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(Qr.end)},intersectsBounds:s=>s.intersectsBox(zn),intersectsTriangle:s=>{let a=oi,o=Pi,l=s.closestPointToSegment(Qr,a,o);if(l<this.collider.radius){let c=this.collider.radius-l,u=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(u),t.addScaledVector(u,c),Qr.start.addScaledVector(u,c),Qr.end.addScaledVector(u,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},JR=jx;JR.isLocked=!1;var Vfe=hd(FP());function Wa(e,t){let r=new nt;if(!e.getAttribute("position"))return r.setAttribute("position",new ze([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=t2(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new ze(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var Hfe=new Ce,Gfe=new Ce,Gs=[[0,0,0],[0,0,0],[0,0,0]];function $R(e){let t=e.elements;Gs[0][0]=t[0],Gs[0][1]=t[4],Gs[0][2]=t[8],Gs[1][0]=t[1],Gs[1][1]=t[5],Gs[1][2]=t[9],Gs[2][0]=t[2],Gs[2][1]=t[6],Gs[2][2]=t[10];let{u:r,v:i}=(0,Vfe.SVD)(Gs),n=Hfe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=Gfe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var Wfe=class extends LD{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new Ol({color:65280,linewidth:10}),t=new T(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new T(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new T().addVectors(t,r.multiplyScalar(i)),s=new nt;return s.setFromPoints([t,n]),new bg(s,e)}},eB=e=>e instanceof Zf||e instanceof Du;function qfe(e,t){return e.distance-t.distance}function tB(e,t,r){if(!(!Ga(t)||!t.visible)){bs(t)&&t.raycast(e,r);for(let i of t.children)tB(e,i,r)}}function Ux(e,t,r){if(!r.some(n=>av(e,n)!==void 0))return[];let i=[];return t.children.forEach(n=>tB(e,n,i)),i.sort(qfe),i}function Vx(e){let t=[];if(e.length){let r=e[0].object;Ga(r)&&t.push(r);let i=r.parent;for(;i;)eB(i)&&t.push(i),i=i.parent}return t}function av(e,t){if(bs(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(eB(t))return rB(e,t)}function rB(e,t){if(!(!Ga(t)||!t.visible)){if(bs(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=rB(e,r);if(i)return i}}}function Xfe(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}var Yfe=class{constructor(e,t,r,i,n,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new Wfe,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(e){var n;if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:t,pageY:r}=((n=e.touches)==null?void 0:n.length)>0?e.touches[0]:e,i=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(Xfe(t,r,i),this.getCamera())}},iB=(e=>(e[e.keydown=0]="keydown",e[e.keyup=1]="keyup",e[e.pointerdown=2]="pointerdown",e[e.pointerup=3]="pointerup",e[e.pointermove=4]="pointermove",e[e.wheel=5]="wheel",e[e.scroll=6]="scroll",e))(iB||{}),wa=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},X8=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],nB=e=>{var t;return(t=X8.find(([r,i])=>i===e))==null?void 0:t[0]},C1=e=>{var t;return(t=X8.find(([r])=>r===e))==null?void 0:t[1]},Qfe=(e,t)=>{let r=nB(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},Kfe=class extends wa{constructor(e){super(e),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=r=>{var s;if(!r.eventName||!r.target||r.eventName==="Scroll")return;let i=(s=this.splineEvents[nB(r.eventName)])==null?void 0:s[r.target.uuid];if(!i)return;r.eventName==="Scroll"&&r.deltaY!==void 0&&Object.assign(i,{deltaY:r.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(i)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var i,n;if((i=r.data)!=null&&i.events.length){for(let[s,a]of X8)if(r.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(s)?(n=this.objectsPerEvents.get(s))==null||n.push(r):this.objectsPerEvents.set(s,[r]);let o={id:r.uuid,name:r.name},l=Qfe(a,o),c=this.splineEvents[s];c?c[r.uuid]=l:this.splineEvents[s]={[r.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},Zfe=class{constructor(e,t,r,i,n,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=t.toggle,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Pn(t,t.actions,i,n,s,r)}disconnect(){hn(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.useToggle===!1&&this.alreadyPlayedNonTogglingActions.add(t)}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing)||this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.SwitchCamera.some(t=>t.playing)||this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}},Jfe=class extends wa{constructor(e,t){super(e),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=n=>{(n.target===this.eventContext.domElement||n.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=n=>{(n.target===this.eventContext.domElement||n.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseEvent("MouseDown"))},this.onMouseUp=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMousePressEvent())},this.onMousePressRelease=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMousePressEvent(!0))},this.onKeyDown=n=>{this.heldKeys[n.key]||(this.handleKeyEvent(n,"KeyDown"),this.handleKeyEventHeld(n,"KeyDown",!0)),this.heldKeys[n.key]=!0},this.onKeyUp=n=>{this.handleKeyEvent(n,"KeyUp"),this.handleKeyEventHeld(n,"KeyUp",!0)},this.onKeyPressDown=n=>{this.heldKeysPress[n.key]?this.handleKeyEventHeld(n,"KeyPress"):(this.handleKeyEvent(n,"KeyPress"),this.handleKeyEventHeld(n,"KeyPress",!0)),this.heldKeysPress[n.key]=!0},this.onKeyPressUp=n=>{this.handleKeyEvent(n,"KeyPress",!0)},this.releaseHeldKey=n=>{delete this.heldKeys[n.key]},this.releaseHeldKeyPress=n=>{delete this.heldKeysPress[n.key]},this._onUserEvent=({eventName:n,target:s,reverse:a})=>{var l,c,u,h;if(!n||!s)return;let o=C1(n);o&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:o}),(c=(l=this.eventsPerObjects[o])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(a)})):(o==="KeyDown"||o==="KeyUp"||o==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:o}),(h=(u=this.eventsPerObjects[o])==null?void 0:u[s.uuid])==null||h.forEach(d=>{d.dispatchUserEvent()})))};let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var a,o;if(!((a=n.data)!=null&&a.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];n.data.events.filter(({data:u})=>u.type===l&&u.disabled!==!0).forEach(({id:u,data:h})=>{try{let d=new Zfe(u,h,n,r,i,t);d.actions.Video.length&&(this.hasVideoAction=!0),(h.type==="MouseDown"||h.type==="MouseUp"||h.type==="MousePress")&&(h.mode==="Canvas"||h.mode==="Window")?h.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[n.uuid]?c[n.uuid].push(d):c[n.uuid]=[d]}catch{}}),(o=c[n.uuid])!=null&&o.length&&this.objectsPerTypes[l].push(n)}})}connect(){var t,r,i,n,s,a;let{domElement:e}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(t=this.objectsPerTypes.MouseDown)!=null&&t.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown)),(r=this.objectsPerTypes.MouseUp)!=null&&r.length&&(this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),(i=this.objectsPerTypes.MousePress)!=null&&i.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMousePressRelease)),(n=this.objectsPerTypes.KeyDown)!=null&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(a=this.objectsPerTypes.KeyPress)!=null&&a.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([o,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:r,page:i}=this.eventContext,n=this.objectsPerTypes[e];if(n.length)if(t){let s=Ux(r,i,n);Vx(s).forEach(a=>{this.eventsPerObjects[e][a.uuid]&&this.handleObjectMouseEventDispatch(a,e)})}else n.forEach(s=>{av(r,s)&&this.handleObjectMouseEventDispatch(s,e)})}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=[];if(r.length){if(!e){let{stopRaycast:n,raycaster:s,page:a}=this.eventContext;if(n){let o=Ux(s,a,r);i=Vx(o)}else r.forEach(o=>{av(s,o)&&i.push(o)})}this._prevObjects.length&&this._prevObjects.forEach(n=>{i.includes(n)||this.handleObjectMouseEventDispatchRelease(n,t)}),i.length&&i.forEach(n=>{this.handleObjectMouseEventDispatch(n,t)}),this._prevObjects=i}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(r?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},$fe=new T,e1e=new T,sB=class{constructor(e,t,r,i,n){this.actionsIn=Pn(e,e.inActions,r,i,n,t),this.actionsOut=Pn(e,e.outActions,r,i,n,t)}disconnect(){hn(this.actionsIn),hn(this.actionsOut)}},t1e=class extends sB{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{for(let d of this.objects)if(!d.visible)return;let c=$fe.setFromMatrixPosition(this.objects[0].matrixWorld),u=e1e.setFromMatrixPosition(this.objects[1].matrixWorld),h=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(p=>p.dispatchConditional()),d.Video.forEach(p=>p.dispatchConditional()),d.Link.forEach(p=>p.dispatch()),d.Create.forEach(p=>p.dispatch()),d.Destroy.forEach(p=>p.dispatch()),d.Reset.forEach(p=>p.dispatch()),d.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),d.Transition.forEach(p=>p.play()),d.Animation.forEach(p=>p.play()),d.SwitchCamera.forEach(p=>p.play()),d.SceneTransition.forEach(p=>p.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let u=i.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},r1e=class extends sB{constructor(e,t,r,i,n,s){var l;super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:u})=>{this.toState!==u&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()))},this.onComplete=({target:c,state:u})=>{this.toState===u&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},i1e=class extends wa{constructor(e,t){super(e),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var s;if((s=n.data)!=null&&s.events.length){for(let{id:a,data:o}of n.data.events)if(!o.disabled&&o.type==="Conditional")try{let l;o.condition.type==="Comparison"||(o.condition.type==="Distance"?l=new t1e(a,o,n,r,i,t):o.condition.type==="State"&&(l=new r1e(a,o,n,r,i,t))),l&&(this.eventsPerConditions[o.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},fp=new T,Do=new T,ql=new T,EE=new xn,n1e=.01,Rt=new T,zr=new T,ME=new T,yc=new mt,k3=new $r,s1e=new Ce,N3=new ti,Ah=new T,Ws=new T,Eh=.2;function z3(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var a1e=function(){let e=new Ce;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&z3(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?z3(n.position,t.limits):t.reference==="local"&&(yc.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(yc),z3(n.position,t.limits),yc.invert(),n.position.applyQuaternion(yc),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(Rt,n.quaternion,zr),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof cn&&sa(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),o1e=class{constructor(e,t,r,i,n,s){this.object=e,this.data=t,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Pn(t,t.dragDropActions.drag,r,i,n,this.object),this.actionsDrop=Pn(t,t.dragDropActions.drop,r,i,n,this.object);let a=[];this.data.objects.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(a.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=r.find(c);!u||u.data.visible!==!1&&a.push(u)}))}),this.data.dropDestinations.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=r.find(c);!u||u.data.visible!==!1&&this.dropDestIds.push(u.uuid)}))}),this.dragItems=a.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new T().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new T().setFromMatrixPosition(o.matrixWorld),pointStart:new T,pointEnd:new T,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new T().copy(o.position),quat0:new mt().copy(o.quaternion),snapped:!1,orientationMatrix:new Ce,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){hn(this.actionsDrag),hn(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},l1e=class extends wa{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var o;if(tt.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:u,pointEnd:h,pointStart:d}of l.dragItems){if(u===a[0].object||u===a[0].object.object||Mt.is(u)&&u.isAncestorOf(a[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let p=l.activeDragItem.obj;u.hasNonUniformScale&&u.updateMatrixWorldSVD(),(p.hasNonUniformScale?p.matrixWorldRigid:p.matrixWorld).decompose(Rt,yc,zr),k3.setFromQuaternion(yc),p.prevR===void 0?(p.prevR=k3.clone(),p.prevT=Rt.clone()):(p.prevR.copy(k3),p.prevT.copy(Rt)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(u,d,l.data.plane,l.data.referenceFrame),h.copy(d),(this.eventManager.controlsManager.usePhysics&&((o=u.data.physics)==null?void 0:o.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=i=>{var o,l,c,u;if(tt.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(tt.length===0){let h=!1;for(let d of this.events){for(let{obj:p}of d.dragItems)if(p===((o=a[0])==null?void 0:o.object)||p===((c=(l=a[0])==null?void 0:l.object)==null?void 0:c.object)||Mt.is(p)&&p.isAncestorOf((u=a[0])==null?void 0:u.object.uuid)){switch(h=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(p=>h.obj!==p.object&&!h.obj.isAncestorOf(p.object.uuid)&&!(p.object instanceof Zf)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===p.object.uuid||s.scene.find(f).isAncestorOf(p.object.uuid))))[0]),d){let p=ME.copy(d.face.normal).applyMatrix3(N3.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Rt.copy(p).applyMatrix3(N3.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;Rt.x>Eh?zr.x=-f.recursiveBBox.min.x:Rt.x<-Eh&&(zr.x=-f.recursiveBBox.max.x),Rt.y>Eh?zr.y=-f.recursiveBBox.min.y:Rt.y<-Eh&&(zr.y=-f.recursiveBBox.max.y),Rt.z>Eh?zr.z=-f.recursiveBBox.min.z:Rt.z<-Eh&&(zr.z=-f.recursiveBBox.max.z),zr.applyMatrix3(N3.invert())}else zr.copy(p).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(zr)}this.activeEvent.data.autoOrient&&(Rt.set(0,1,0).cross(p),Rt.length()<1e-4&&Rt.set(-1,0,0).cross(p),zr.crossVectors(ME,Rt),h.orientationMatrix.makeBasis(Rt,zr,p)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.stop()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(p=>{p.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.stop()}))},500),this.updateDragItem(h),h.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var n;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((n=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:n.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")})),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let r={};e.page.traverseEntity(i=>{i.component&&(r[i.component.uuid]?r[i.component.uuid].push(i.uuid):r[i.component.uuid]=[i.uuid])}),e.page.traverseEntity(i=>{var n;(n=i.data)==null||n.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new o1e(i,s.data,e.page,e.sharedAssets,t,r))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let e=this.eventContext.domElement;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(Do),Do.negate();let a=yc.identity();switch(i==="parent"?s1e.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Rt,a,zr):i==="local"&&e.matrixWorld.decompose(Rt,a,zr),r){case"x":Rt.set(1,0,0).applyQuaternion(a),Ah.copy(Do).cross(Rt),Ws.copy(Rt).cross(Ah);break;case"y":Rt.set(0,1,0).applyQuaternion(a),Ah.copy(Do).cross(Rt),Ws.copy(Rt).cross(Ah);break;case"z":Rt.set(0,0,1).applyQuaternion(a),Ah.copy(Do).cross(Rt),Ws.copy(Rt).cross(Ah);break;case"xy":Ws.set(0,0,1).applyQuaternion(a);break;case"yz":Ws.set(1,0,0).applyQuaternion(a);break;case"xz":Ws.set(0,1,0).applyQuaternion(a);break;case"adaptive":Do.angleTo(zr.set(0,1,0))>Math.PI/6?(Rt.crossVectors(zr.set(0,1,0),Do),Ws.crossVectors(Rt,zr)):Ws.set(0,1,0);break;default:Ws.copy(Do);break}ql.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:ql;if(EE.setFromNormalAndCoplanarPoint(Ws,o),!!s.ray.intersectPlane(EE,t)&&(r==="x"||r==="y"||r==="z")){let l=zr.subVectors(t,o).dot(Rt);t.copy(o).addScaledVector(Rt,l)}}updateDragItem(e,t=!1){var r,i;ql.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?fp.subVectors(e.fromPosition,ql).divideScalar(e.currentDampingFactor):e.reset==="original"?(fp.subVectors(e.obj.userData.worldPosition0,ql).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):fp.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(ql).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?fp.length()<n1e:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&a1e(e,fp.add(ql),(r=this.activeEvent)!=null&&r.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Mh=new T,F3=new T,Da=new T,Ia=new T,TE=new xn,c1e=.01,h1e={type:"requestRender"},u1e=function(){let e=new T,t=new T;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),LE=function(){let e=new Ce;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof cn&&sa(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),d1e=class{constructor(e,t,r,i,n){this.data=e,this.object=t,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new T,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...B5.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Pn(e,e.actions,r,i,n,t)}},p1e=class extends wa{constructor(e,t){super(e),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(tt.length>1)){this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)};let{page:r}=this.eventContext;r.traverseEntity(i=>{var s,a;let n=(s=i.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);n&&(!r.data.globalPhysics.usePhysics||((a=i.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new d1e(n.data,i,r,e.sharedAssets,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Sn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events)if(r.target!==void 0){let i=r.target,n=this.onTargetChange(r);this.pairOfEventListeners.push([i,n]),i.addEventListener("requestRender",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Sn&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,hn(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(Da),e.isReset)Ia.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Ia);else{let{getCamera:o,raycaster:l}=this.eventContext;if(r==="custom"?(o().getWorldDirection(F3),F3.negate(),Mh.copy(F3)):r==="xy"?Mh.set(0,0,1):r==="xz"?Mh.set(0,1,0):r==="yz"&&Mh.set(1,0,0),TE.setFromNormalAndCoplanarPoint(Mh,Da),!l.ray.intersectPlane(TE,Ia))return}if(!e.isReset){if(Ia.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Ia.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Ia.x=Da.x),e.data.enabledTranslation[1]===!1&&(Ia.y=Da.y),e.data.enabledTranslation[2]===!1&&(Ia.z=Da.z);let s=u1e(Da,Ia,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=Mh.subVectors(s,Da).divideScalar(e.currentDampingFactor);Da.add(o),t&&LE(e.object,Da),e.paused=o.length()<c1e}else LE(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(h1e)}},mp=new T,i0=new T,gp=new Ce,Th=new mt,Io=new mt,vp=new T,yp=new T,Xl=new T,Oa=new T,j3=new xn,f1e=1e-6,m1e={type:"requestRender"},g1e={type:"changeRotation"},PE=function(){let e=new Ce;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply($R(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof cn&&sa(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),v1e=class{constructor(e,t,r){this.object=t,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new mt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...k5.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},y1e=class extends wa{constructor(e){super(e),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=r=>{if(!(tt.length>1)){this._lastMouseEvent=r,this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onScroll=r=>{if(this._lastMouseEvent){let i=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(i)}},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)},this.createUserEventListener=r=>({eventName:i,target:n})=>{if(!i||!n)return;let s=C1(i);s&&s==="LookAt"&&this.updateSingleEvent(r)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var n,s;let i=(n=r.data)==null?void 0:n.events.find(a=>a.data.type==="LookAt"&&!a.data.disabled);i&&(!t.data.globalPhysics.usePhysics||((s=r.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new v1e(i.data,r,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Sn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?t.addEventListener("scroll",this.onScroll):(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events){if(r.target!==void 0){let s=this.onTargetChange(r),a=r.target;this.pairOfEventListeners.push([a,s]),a.addEventListener("requestRender",s)}let i=this.createUserEventListener(r),n=r.object;this.pairOfUserEventListeners.push([n,i]),n.addEventListener("userEvent",i)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Sn&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:h}=e;if(u.getWorldPosition(vp),!e.isReset)if(e.target)e.target.getWorldPosition(yp);else{if(n==="custom"?(l().getWorldDirection(i0),i0.negate(),j3.setFromNormalAndCoplanarPoint(i0,vp)):(n==="xy"?mp.set(0,0,1):n==="xz"?mp.set(0,1,0):n==="yz"&&mp.set(1,0,0),j3.setFromNormalAndCoplanarPoint(mp,vp)),!c.ray.intersectPlane(j3,yp))return;i>0&&(n==="custom"||n===void 0)&&yp.addScaledVector(i0,i)}if(e.isReset||(h?t==="target"?Xl.copy(h.up).applyMatrix4(gp.extractRotation(h.matrixWorld)).normalize():a.some(p=>p===!1)?(r==="x"?(Oa.set(0,0,1),a[2]===!1&&Oa.set(0,1,0)):r==="y"?(Oa.set(1,0,0),a[0]===!1&&Oa.set(0,0,1)):(Oa.set(0,1,0),a[1]===!1&&Oa.set(1,0,0)),Xl.copy(Oa).applyQuaternion(e.worldQuaternion0).normalize()):Xl.set(0,1,0):n==="custom"?Xl.set(0,1,0):Xl.copy(mp)),e.isReset)Io.copy(e.worldQuaternion0);else if(vp.distanceTo(yp)>s&&o&&h)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Io.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;x1e(gp,yp,vp,Xl,r,Oa),Io.setFromRotationMatrix(gp),Th.setFromUnitVectors(Oa.applyQuaternion(Io),Xl),a.some(p=>p===!1)&&t!=="target"&&Io.premultiply(Th).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Th.setFromRotationMatrix($R(u.matrixWorld)),Th.slerp(Io,1/e.currentDampingFactor),PE(u,gp.makeRotationFromQuaternion(Th)),e.paused=8*(1-Th.dot(Io))<f1e):(PE(u,gp.makeRotationFromQuaternion(Io)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(m1e),u.dispatchEvent(g1e)}},Fn=new T,Nr=new T,xr=new T;function x1e(e,t,r,i,n,s){let a=e.elements;xr.subVectors(t,r),xr.lengthSq()===0&&(xr.z=1),xr.normalize(),Nr.crossVectors(i,xr),Nr.lengthSq()===0&&(Math.abs(i.z)===1?xr.x+=1e-4:xr.z+=1e-4,xr.normalize(),Nr.crossVectors(i,xr)),Nr.normalize(),Fn.crossVectors(xr,Nr),n==="x"?s.z===1?[Nr,Fn,xr]=[xr,Nr,Fn]:(Nr.negate(),[Nr,xr]=[xr,Nr]):n==="y"?s.x===1?[Nr,Fn,xr]=[Fn,xr,Nr]:(Nr.negate(),[Fn,xr]=[xr,Fn]):s.x===1&&(Nr.negate(),[Nr,Fn]=[Fn,Nr]),a[0]=Nr.x,a[4]=Fn.x,a[8]=xr.x,a[1]=Nr.y,a[5]=Fn.y,a[9]=xr.y,a[2]=Nr.z,a[6]=Fn.z,a[10]=xr.z}var b1e=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=Pn(t,t.actions,i,n,s,r)}disconnect(){hn(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch())}},w1e=class extends wa{constructor(e,t){super(e),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseHoverEvent())},this.onMouseUp=n=>{tt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=n=>{tt.length>1||(this.eventContext.updateRaycaster(n),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:n,target:s,reverse:a})=>{var l;if(!n||!s)return;let o=C1(n);o&&o==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(a)))};let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var s,a;if(!(!n.visible||!((s=n.data)!=null&&s.events.length))){for(let{id:o,data:l}of n.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new b1e(o,l,n,r,i,t);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(c):this.eventsPerObjects[n.uuid]=[c]}catch{}(a=this.eventsPerObjects[n.uuid])!=null&&a.length&&this.objects.push(n)}})}connect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),Sn&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(t=>{t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),Sn&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n}=this.eventContext;if(r){let s=Ux(i,n,this.objects);t=Vx(s)}else this.objects.forEach(s=>{av(i,s)&&t.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},C1e=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=Pn(t,t.actions,i,n,s,r)}connect(){this.scrollCounter=0}disconnect(){hn(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},S1e=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=Pn(t,t.actions,i,n,a,r)}computeScrollBounds(){let e=this.domElement.getBoundingClientRect(),t=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||t.scrollTop,n=r.clientTop||t.clientTop||0,s=Math.round(e.top+i-n);if(this.data.startFrom==="enter"){let a=window.innerHeight,o=e.height,l=this.data.enterAnchor,c=l==="top"?a:l==="bottom"?a-o:a-o*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=e,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){hn(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},_1e=class extends wa{constructor(e,t){super(e),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(l=>l.handleResize())})},this.onScroll=a=>{if(!this.isInview)return;let o={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:o}),c.forEach(u=>u.dispatch(o))})},this.onWheel=a=>{!this.isInview||a.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([o,l])=>{o.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:a.deltaY}),l.forEach(c=>c.dispatch(a.deltaY))})},this.onUserEvent=({eventName:a,target:o,reverse:l})=>{var u;if(!a||!o)return;let c=C1(a);c&&c==="Scroll"&&(o.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(u=this.wheelEventsPerObject.get(o))==null||u.forEach(h=>{h.dispatchUserEvent(l)}))};let{page:r,sharedAssets:i,domElement:n,isExport:s}=this.eventContext;r.traverseEntity(a=>{var o,l,c;if((o=a.data)!=null&&o.events.length){for(let{id:u,data:h}of a.data.events)if(!h.disabled&&h.type==="Scroll")if(h.trigger==="load"||!s){let d=new C1e(u,h,a,r,i,t);this.wheelEventsPerObject.has(a)?(l=this.wheelEventsPerObject.get(a))==null||l.push(d):this.wheelEventsPerObject.set(a,[d])}else{let d=new S1e(u,h,a,r,i,n,t);this.scrollEventsPerObject.has(a)?(c=this.scrollEventsPerObject.get(a))==null||c.push(d):this.scrollEventsPerObject.set(a,[d])}}}),this.intersectionObserver=new IntersectionObserver(a=>{let o=a[0];o&&(this.isInview=o.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},A1e=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=Pn(t,t.actions,i,n,s,r)}disconnect(){hn(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof vc?t.interaction.audioPlayer.play():t.interaction instanceof kx&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof Iu?t.interaction.play(r==="autoplay"):t.interaction instanceof Fx&&t.interaction.dispatch())})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof vc?t.interaction.audioPlayer.play():t.interaction instanceof kx&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof Iu?t.interaction.play():t.interaction instanceof Fx&&t.interaction.dispatch()})}},E1e=class extends wa{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext;(i?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(a=>{a.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof vc&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof Iu&&s.interaction.play(a==="autoplay")})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a,o;if(!r||!i)return;let s=C1(r);s&&s==="Start"&&(i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(i))==null||a.forEach(l=>{l.dispatchUserEvent(n)}),(o=this.eventsAfterPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext;if(t.traverseEntity(r=>{var i,n,s,a;if((i=r.data)!=null&&i.events.length)for(let{id:o,data:l}of r.data.events){if(l.disabled||l.type!=="Start")continue;let c=new A1e(o,l,r,t,e,this.eventManager);(c.actions.Transition.length||c.actions.Animation.length||c.actions.SwitchCamera.length||c.actions.Create.length||c.actions.Destroy.length||c.actions.SceneTransition.length)&&(this.eventsPerObject.has(r)?(n=this.eventsPerObject.get(r))==null||n.push(c):this.eventsPerObject.set(r,[c])),c.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(s=this.eventsAfterPerObject.get(r))==null||s.push(c):this.eventsAfterPerObject.set(r,[c])),c.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(c):this.eventsAfterPerObject.set(r,[c]))}}),[...this.eventsAfterPerObject.values()].some(r=>r.length)){if(this.eventManager.activateCount===0){let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),n.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),n.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>n.dispatch()),r.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},M1e=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.disabled=!1,this.actions=Pn(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.toggle}disconnect(){hn(this.actions)}dispatch(e){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}))}},T1e="https://unpkg.com/@splinetool/runtime@0.9.452/build/",L1e="https://unpkg.com/@splinetool/navmesh-wasm@0.9.452/build/",P1e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${T1e}' + 'navmesh.js'),
		fetch('${L1e}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,D1e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,I1e=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,O1e=.001,R1e={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},aB,St,li;Ose.then(e=>{aB=e,St=new e.Vec3,li=new e.Vec3});var B1e=new T,k1e=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(tt.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let s=n.raycastWithClones(i);if(s.length!==0){if(this.gameControl){let a=B1e.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var d,p,f,m,g,v,y;let s;if(n instanceof _s)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof Ci)s=n.object;else if(s=n,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((p=s.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=s.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(i&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((m=a.physics)==null?void 0:m.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let o=ov(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,u=!1,h=!1;for(let x of a.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?u=!0:x.data.type==="Follow"&&(h=!0));if(u||o||h||l||c)return!0;if(this.usePhysics&&((g=a.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((v=a.physics)!=null&&v.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(Wa(n.geometry,n.matrixWorld)),this.usePhysics&&((y=a.physics)==null?void 0:y.fusedBody))return n.traverseObject((x,b)=>{var _,S;if(b===0)return;let w;if(x instanceof _s)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;w=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof Ci)w=x.object;else if(w=x,(_=x.dataPatched.cloner)==null?void 0:_.hideBase)return!0;let C=w.dataPatched;if(!C.visible&&((S=C.physics)==null?void 0:S.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&r.push(Wa(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let s;if(n instanceof _s)return;n instanceof Ci?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(i&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(ov(a)||l||c||s.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;o&&r.push(Wa(o,n.matrixWorld))},this.navmeshWasm=aB,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?P1e:D1e)+I1e])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.resolution=e.ch,this.setDefaultQueryExtent(new T().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=!0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=void 0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=void 0})}),i.length===0)return!1;let s=mc(i),{positions:a,triIndices:o}=t2(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...R1e,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),s=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let o=r.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new nt;return a.setIndex(new st(n,1)),a.setAttribute("position",new st(s,3)),a}getClosestPoint(e){return St.x=e.x,St.y=e.y,St.z=e.z,this.navMesh.getClosestPoint(St)}getClosestPointToRef(e,t){St.x=e.x,St.y=e.y,St.z=e.z;let r=this.navMesh.getClosestPoint(St);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return St.x=e.x,St.y=e.y,St.z=e.z,this.navMesh.getRandomPointAround(St,t)}getRandomPointAroundToRef(e,t,r){St.x=e.x,St.y=e.y,St.z=e.z;let i=this.navMesh.getRandomPointAround(St,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return St.x=e.x,St.y=e.y,St.z=e.z,li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.moveAlong(St,li)}moveAlongToRef(e,t,r){return St.x=e.x,St.y=e.y,St.z=e.z,li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.moveAlong(St,li)}computePath(e,t){let r=this.getClosestPoint(t);li.x=r.x,li.y=r.y,li.z=r.z,this.getClosestPoint(e);let i=this.navMesh.computePath(St,li),n=i.getPointCount(),s=[];for(let a=0;a<n;a++){let o=i.getPoint(a);s.push(new T(o.x,o.y,o.z))}return s}createCrowd(e,t){return new N1e(this,e,t)}setDefaultQueryExtent(e){St.x=e.x,St.y=e.y,St.z=e.z,this.navMesh.setDefaultQueryExtent(St)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return St.x=e.x,St.y=e.y,St.z=e.z,this.navMesh.addCylinderObstacle(St,t,r)}addBoxObstacle(e,t,r){return St.x=e.x,St.y=e.y,St.z=e.z,li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.addBoxObstacle(St,li,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},N1e=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new T(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=O1e)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let s=0;s<i;s++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],s=this.getAgentPosition(n);if(this.transforms[i].copy(s),this._agentDestinationArmed[i]){let a=s.x-this._agentDestination[i].x,o=s.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],u=this._agentDestination[i].y+this.reachRadii[i],h=a*a+o*o;s.y>c&&s.y<u&&h<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let s=r.getPoint(t);n.push(new T(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function z1e(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&Gf.traverseModuleInstances(e,r.id,(i,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var F1e={type:"change"},DE={type:"changeZoom"},j1e={type:"changePan"},Lh={type:"start"},Ph={type:"end",changed:!0},U1e={type:"end",changed:!1},U3=new mt,IE=new W,V1e=2*Math.PI,H1e=1e-8,G1e=.01,V3=new T,n0=new W,H3=new T,s0=new mt,OE=new Ce,W1e={type:"requestRender"},oB=class extends pi{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Rn.DOLLY_ROTATE,Rn.PAN],this.offset=new T,this.eye=new T,this.lastPosition=new T,this.lastQuaternion=new mt,this.current=new W,this.overShoot=new W,this.overRatio=new W,this.spherical=new tS,this.sphericalDelta=new tS,this.panOffset=new T,this.panLeftV=new T,this.panUpV=new T,this.panV=new T,this.rotateStart=new W,this.rotateEnd=new W,this.rotateDelta=new W,this.panStart=new W,this.panEnd=new W,this.panDelta=new W,this.dollyStart=new W,this.dollyEnd=new W,this.dollyDelta=new W,this.rotationRangeFactor=new W,this.panRangeFactor=new W,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(H3,s0,V3),this.offset.copy(H3).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(U3.copy(s0).invert()),this.panOffset.applyQuaternion(U3),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(s0),this.panOffset.applyQuaternion(s0)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),H3.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(OE.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(OE));let i=this.spherical.phi%V1e;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Vt.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>G1e||8*(1-this.lastQuaternion.dot(this.object.quaternion))>H1e?(this.dispatchEvent(F1e),this.object.dispatchEvent(W1e),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&Sn?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(Lh),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&Sn||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,V3.subVectors(this.position0,this.target0),this.spherical.setFromVector3(V3),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?n0.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):n0.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(n0).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(IE,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(n0).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&Sn?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,tt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),tt.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(Ph):this.dispatchEvent(U1e),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&Sn||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!Cm(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(Cm(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(Cm(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(tt.length>1&&i.preventDefault(),this.touches[tt.length-1]){case Rn.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Rn.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Rn.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Rn.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(tt.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=K7(()=>this.dispatchEvent(Ph),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(Lh),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!uI)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(Lh),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(Ph)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(Lh))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(tt[0]),i.key===" "&&this.dispatchEvent(Ph))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(U3.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=qs(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=qs(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=qs(qs(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=qs(qs(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Rn.ROTATE),e.panTouches===1&&(this.touches[0]=Rn.PAN),e.orbitTouches===2&&(this.touches[1]=Rn.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Rn.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Rn.ROTATE),e.panTouches===3&&(this.touches[2]=Rn.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,c,u;e instanceof T?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(qs(this.spherical.theta),qs(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=qs(this.overShoot.x),this.overShoot.y=qs(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=RE(Math.abs(this.overRatio.x)),this.overRatio.y=RE(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof T?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(j1e)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(DE)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(DE)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(Lh),this.dollyOut(e),this.dispatchEvent(Ph)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(Lh),this.dollyIn(e),this.dispatchEvent(Ph)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(IE,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(Tse===!1&&Cm(e)===!1&&q1e(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(tt.length===2){let e=.5*(tt[0].pageX+tt[1].pageX),t=.5*(tt[0].pageY+tt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(tt[0].pageX,tt[0].pageY)}handleTouchStartPan(){if(tt.length===2){let e=.5*(tt[0].pageX+tt[1].pageX),t=.5*(tt[0].pageY+tt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(tt[0].pageX,tt[0].pageY)}handleTouchStartDolly(){let e=tt[0].pageX-tt[1].pageX,t=tt[0].pageY-tt[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(tt.length===2){let r=Hy(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==tt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(tt.length===2){let t=Hy(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==tt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=Hy(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function qs(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function RE(e){return 1-Math.pow(1-e,4)}function q1e(e){return e.wheelDeltaY===0||e.deltaY===0?Yv&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:e.deltaMode===0}var BE=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.currentIntersectedObjects=[],this.disabled=!1,this.actions=Pn(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.toggle,this.triggeringObjects=t.triggeringObjects.map(a=>i.scene.find(a))}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){hn(this.actions)}dispatch(){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}))}},At;Bse.then(e=>At=e);var Lr=new T,ms=new mt,Oo=new T,G3=new $r(0,0,0,"YXZ"),kE=new $r(0,0,0,"XYZ"),Ra=new T,NE=new T,zE=new T(1,1,1),Dh=new mt,W3=new Ce,X1e=new Ce,Y1e={type:"updateMatrix"},Hx={type:"beginEvent",eventName:"Collision"},Q1e={type:"beginEvent",eventName:"Trigger"};function K1e(e){if(Gf.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var ov=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),Z1e=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==At.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(Lr.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),ms.copy(t.rotation()),r.matrixWorld.compose(Lr,ms,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(Y1e),n){let s=r.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(r.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of r.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var a,o,l,c;if(i===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let u=this.sharedGameControlGlobals.createdObjects.length-1;u>=0;u--){let h=this.sharedGameControlGlobals.createdObjects[u];if(h.userData.hasCollisionDestroy&&(((a=h.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=h.rigidBody)==null?void 0:o.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(u,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(t)){let u=this.sharedGameControlGlobals.colliderToEntity.get(r),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,r)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(r)){let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,t)}else{let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h!==void 0)for(let f of h)f.data.target==="scene"&&this.dispatchCollisionEvent(f,u,t);let d=this.sharedGameControlGlobals.colliderToEntity.get(r),p=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,d,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=ZR,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let s=(i=(r=n.data.actions)==null?void 0:r.find(a=>a.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var o,l;let r;if(t instanceof _s)return;t instanceof Ci?r=t.object:r=t;let i=r.dataPatched;if(((o=i.physics)==null?void 0:o.enabled)==="visibility"?!i.visible:!((l=i.physics)!=null&&l.enabled))return!0;let n=t.geometry,s=r.userData.hasDestroy===!0,a=r.userData.hasDrag===!0;if(ov(i)||s||a||r.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;n&&e.push(Wa(n,t.matrixWorld))}),e.length>0){let t=mc(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new tf(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(Wa(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,i);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let a,o=!r.fromCreate&&s.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;o?(a=At.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(a=At.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=At.RigidBodyDesc.fixed();let l=mc(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Lr,ms,Oo),e.position0=Lr.clone().divideScalar(this.pixelsPerMeter),e.rotation0=ms.clone(),Lr.divideScalar(this.pixelsPerMeter),a.setTranslation(Lr.x,Lr.y,Lr.z).setRotation(ms),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Oo.x/this.pixelsPerMeter,Oo.y/this.pixelsPerMeter,Oo.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,Oo.clone(),s.physics.fusedBody]);let u=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,u)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(h){console.error(h)}}e.rigidBody=c}}addBoundsTree(e){var r;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&t.push(Wa(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(i=>i.updateMatrixWorld(!0)),t.length>0){let i=mc(t,!1);e.bvhGeometry=i,e.bvhGeometry.boundsTree=new tf(i),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)}}addCollider(e,t,r,i,n=!0){var o,l;if((r==null?void 0:r.getAttribute("position").count)===0||((o=r==null?void 0:r.getIndex())==null?void 0:o.count)===0)return;let s;r&&(t.colliderType==="trimesh"?s=At.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):s=At.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),s.setFrictionCombineRule(At.CoefficientCombineRule.Average).setRestitutionCombineRule(At.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&a.setActiveEvents(At.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var o;if(i===0)return;let n;if(r instanceof _s)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof Ci)n=r.object;else if(n=r,(o=n.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let a=r.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(Wa(a,r.matrixWorld))}}activate(e){var d,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null&&!((p=m.data.physics)!=null&&p.fusedBody););f.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=f.data)}if(l&&c){r=r||c.camera===t.uuid||l.uuid===t.uuid;let f=new JR(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,c.keyAssignments,i=c.joystickPosLoc,n=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,Sn&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new k1e(this.usePhysics,this.isExport);let m;f.collider.type==="sphere"?m=f.collider.radius*2:m=f.collider.height,m=Math.floor(m/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:f,enablePan:m,enableZoom:g,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(f||m||g||v||y!==0)&&(this.orbitControls=new oB(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,m)=>{let g=document.body.appendChild(document.createElement("div")),[v,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],b=(u-5*v)/4+v,w={},C=f==="jmp",_=C?0:v;m<10?(m<5?w.top=_/2:w.bottom=_/2,w.left=_/2+m%5*b):m===10?(w.left=_/2,w.top=h/2):(w.right=_/2,w.top=h/2),w.top?w.top-=y[1]:w.bottom+=y[1],w.left?w.left+=y[0]:w.right-=y[0];for(let E in w)w[E]+="px";if(C){let E=g.appendChild(document.createElement("div"));Object.assign(E.style,w,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let L=v/16*16*.4;x==="show"&&(E.innerHTML=`
						<svg width="${L}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),E.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),E.addEventListener("touchend",P=>P.preventDefault()),this.joysticks[m]=[void 0,g];return}let S={zone:g,mode:"static",position:w,size:v};x==="hide"&&(S.restOpacity=0);let A=mpe.create(S);A.on("move",(E,L)=>{let P=this.gameControl;f==="pos"?L.force<.2?P.moveForce=0:(P.movementState.movePosZ=Math.sin(-L.angle.radian),P.movementState.movePosX=Math.cos(-L.angle.radian),L.force>1.2?P.movementState.run=1:P.movementState.run=0,L.force<.3?P.moveForce=(L.force-.2)/.1:P.moveForce=1):f==="rot"&&(L.force<.2?P.rotForce=0:(P.movementState.rotPosX=L.vector.y,P.movementState.rotPosY=-L.vector.x,L.force<.3?P.rotForce=(L.force-.2)/.1:P.rotForce=1)),this.requestRender()}),A.on("end",(E,L)=>{let P=this.gameControl;f==="pos"?(P.movementState.movePosZ=0,P.movementState.movePosX=0,P.moveForce=1):f==="rot"&&(P.movementState.rotPosX=0,P.movementState.rotPosY=0,P.rotForce=1)}),this.joysticks[m]=[A,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.disabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new At.World(new At.Vector3(0,this.gravity,0)),this.events=new At.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var v,y,x,b;let l;if(o instanceof _s)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof Ci)l=o.object;else if(l=o,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0;let c=l.dataPatched,u;for(let w of c.events)w.data.disabled!==!0&&w.data.type==="GameControl"&&(u=w.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;o.updateMatrixWorldSVD();let h=ov(c),d=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,m=!1;for(let w of c.events)if(w.data.disabled!==!0){if(w.data.type==="Collision"){d=!0;let C=new M1e(w.id,w.data,l,this.page,this.sharedAssets,this.eventManager);C.disabled=!0,this.collisionEvents.push(C),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(_=>_.id!==w.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(C):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[C]}else if(w.data.type==="Follow"){m=!0;let C=w.data.target;o.traverseVisible(_=>{_.userData.isFollowingObj=C})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let g=o.geometry;if(u!==void 0){let w=At.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(Lr,ms,Oo),o.position0=Lr.clone().divideScalar(this.pixelsPerMeter),o.rotation0=ms.clone(),Lr.divideScalar(this.pixelsPerMeter),w.setTranslation(Lr.x,Lr.y,Lr.z).setRotation(ms);let C=this.sharedGameControlGlobals.rapierWorld.createRigidBody(w);o.rigidBody=C;let _;u.collider.type==="sphere"?_=At.ColliderDesc.ball(u.collider.radius/this.pixelsPerMeter):u.collider.type==="capsule"?_=At.ColliderDesc.capsule((u.collider.height/2-u.collider.radius)/this.pixelsPerMeter,u.collider.radius/this.pixelsPerMeter):_=At.ColliderDesc.cuboid(u.collider.width/this.pixelsPerMeter/2,u.collider.height/this.pixelsPerMeter/2,u.collider.depth/this.pixelsPerMeter/2),_.setFrictionCombineRule(At.CoefficientCombineRule.Average).setRestitutionCombineRule(At.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(_,C);this.sharedGameControlGlobals.colliderToEntity.set(S.handle,l),Lr.fromArray(u.collider.position).multiply(Oo.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(Lr);let A=new mt().setFromEuler(new $r().setFromVector3(new T().fromArray(u.collider.rotation)));S.setRotationWrtParent(A),S.setActiveEvents(At.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||h||m||p||f||d?(this.addRigidBody(o,l,{hasFollow:m,hasTransformAnim:h,hasDrag:f}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(g&&e.push(Wa(g,o.matrixWorld)),c.physics.fusedBody&&o.traverseObject((w,C)=>{var E;if(C===0)return;let _;if(w instanceof _s)if(w.objectForSample){if(w.objectForSample.dataPatched.physics.fusedBody)return;_=w.object}else return w.object.dataPatched.physics.fusedBody===!0&&w.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(w instanceof Ci)_=w.object;else if(_=w,(E=_.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let S=_.dataPatched;if(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)return!0;let A=w.geometry;(A==null?void 0:A.getAttribute("position"))!==void 0&&e.push(Wa(A,w.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((b=c.physics)==null?void 0:b.fusedBody)===!0||u)return!0}),e.length===0)return;let r=mc(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=At.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=At.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(At.CoefficientCombineRule.Multiply).setRestitutionCombineRule(At.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[o,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(o,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?(this.gameControl===null||this.needsCollisionDetection)&&this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new BE(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new Ce().compose(Ra.fromArray(t.data.position),Dh.setFromEuler(kE.fromArray(t.data.rotation)),zE);if(t.data.triggerZone==="box"){let n=new Er;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Lr,ms,Oo),G3.setFromQuaternion(ms);let r=t;r.prevR===void 0?(r.prevR=G3.clone(),r.prevT=Lr.clone()):(r.prevR.copy(G3),r.prevT.copy(Lr)),t.rigidBody.setNextKinematicTranslation(Lr.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(ms)}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(r))._parent,n;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===i){n=a;break}}e.dispatch(n),t.dispatchEvent(Hx)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=X1e.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new BE(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=At.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=At.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(At.ActiveEvents.COLLISION_EVENTS),Ra.fromArray(a.data.position),Dh.setFromEuler(kE.fromArray(a.data.rotation)),W3.compose(Ra,Dh,zE).premultiply(n.matrixWorld),r?(W3.decompose(Ra,Dh,NE),l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_FIXED|At.ActiveCollisionTypes.DYNAMIC_FIXED)):(W3.premultiply(i).decompose(Ra,Dh,NE),e.rigidBody.bodyType()===At.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===At.RigidBodyType.Fixed?l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_FIXED|At.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(At.ActiveCollisionTypes.KINEMATIC_KINEMATIC|At.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Ra.divideScalar(this.pixelsPerMeter),l.setTranslation(Ra.x,Ra.y,Ra.z),l.setRotation(Dh),r)r.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}};function J1e(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,s=this._loopCount,a=i===m7;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-r):n;if(i===qP){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<r){let o=Math.floor((n-r)/(t-r));n-=(t-r)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-r)}return n}var FE=!1,$1e=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=g5.parse(JSON.parse(s[2]));n.animations[a]=l;let c=this.mixer.clipAction(l,n);FE===!1&&(Object.getPrototypeOf(c)._updateTime=J1e,FE=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new $K(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(s=>s.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=XP}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=m7)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var e,t;return((t=(e=this.activeClip)==null?void 0:e.tracks[0])==null?void 0:t.times.length)??0}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?e/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},q3=new WeakMap,eme=class extends L7{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new v5(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(q3.has(e)){let o=q3.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),q3.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new nt;e.index&&t.setIndex(new st(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new st(s,a))}return t}_loadLibrary(e,t){let r=new v5(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=tme.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function tme(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(u=>{let h=u.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=r(h,d,p,c),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:o.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function r(a,o,l,c){let u=c.attributeIDs,h=c.attributeTypes,d,p,f=o.GetEncodedGeometryType(l);if(f===a.TRIANGULAR_MESH)d=new a.Mesh,p=o.DecodeBufferToMesh(l,d);else if(f===a.POINT_CLOUD)d=new a.PointCloud,p=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let m={index:null,attributes:[]};for(let g in u){let v=self[h[g]],y,x;if(c.useUniqueIDs)x=u[g],y=o.GetAttributeByUniqueId(d,x);else{if(x=o.GetAttributeId(d,a[u[g]]),x===-1)continue;y=o.GetAttribute(d,x)}m.attributes.push(n(a,o,d,g,v,y))}return f===a.TRIANGULAR_MESH&&(m.index=i(a,o,d)),a.destroy(d),m}function i(a,o,l){let c=l.num_faces()*3,u=c*4,h=a._malloc(u);o.GetTrianglesUInt32Array(l,u,h);let d=new Uint32Array(a.HEAPF32.buffer,h,c).slice();return a._free(h),{array:d,itemSize:1}}function n(a,o,l,c,u,h){let d=h.num_components(),p=l.num_points()*d,f=p*u.BYTES_PER_ELEMENT,m=s(a,u),g=a._malloc(f);o.GetAttributeDataArrayForAllPoints(l,h,m,f,g);let v=new u(a.HEAPF32.buffer,g,p).slice();return a._free(g),{name:c,array:v,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var el;function rme(){return el||(el=new eme,el.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),el.decoderPending}async function ime(e){if(el){let t={attributeIDs:el.defaultAttributeIDs,attributeTypes:el.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await el.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function nme(e,t){let[r,i]=AI(O5.deserialize(new Uint8Array(e)));YI(r);let n=[];r.scene.objects.traverse((s,a)=>{a.type==="Mesh"&&a.geometry.type==="NonParametricGeometry"&&a.geometry.data.draco!==void 0&&n.push(a)}),n.length&&await rme();for(let s of n){let a=await ime(ii(s.geometry.data.draco));if(a){a.index&&(s.geometry.data.index={array:a.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let o={};a.attributes.forEach(({name:l,array:c,itemSize:u})=>{o[l]={array:c,itemSize:u,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=o,s.geometry.data.draco=void 0}}return t&&t(r),i.result().data}var sme=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.dataEvent=r,this.object=i,this.stage=!1,this.actions=Pn(r,t.actions,n,s,a,i)}disconnect(){hn(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},ame=class extends wa{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.helperResize=(r,i)=>{this.breakpoints.forEach(n=>{let s=N5.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?r:i,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResize=()=>{let{innerWidth:r,innerHeight:i}=window;this.helperResize(r,i)},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:s}=i.contentRect;this.helperResize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i,frame:n}=this.eventContext;i?window.addEventListener("resize",this.onResize):n.preset==="fullscreen"?this.onResizeObserver.observe(r):window.addEventListener("resize",this.onResize),e.traverseEntity(s=>{var a;if(!(!s.visible||!((a=s.data)!=null&&a.events.length)))for(let{data:o}of s.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:l,id:c})=>{try{let u=new sme(c,l,o,s,e,t,this.eventManager);this.breakpoints.push(u)}catch{}})})}disconnect(){let{isExport:e,frame:t}=this.eventContext;e?window.removeEventListener("resize",this.onResize):t.preset==="fullscreen"?this.onResizeObserver.disconnect():window.removeEventListener("resize",this.onResize),this.breakpoints.forEach(r=>{r.disconnect()}),this.breakpoints=[]}},jE=Object.keys(iB).filter(e=>isNaN(Number(e))),ome=class{constructor(e,t,r,i){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.isEnabled=!1,this.activateCount=0,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=n=>{(n.touches.length>1||this.preventTouchScroll)&&n.preventDefault()},this.onMouseWheelPreventScroll=n=>{this.preventScroll&&n.preventDefault()},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.handlers={Spline:new Kfe(this.eventContext),Conditional:new i1e(this.eventContext,this),Start:new E1e(this.eventContext,this),Basic:new Jfe(this.eventContext,this),MouseHover:new w1e(this.eventContext,this),Scroll:new _1e(this.eventContext,this),Follow:new p1e(this.eventContext,this),DragDrop:new l1e(this.eventContext,this),LookAt:new y1e(this.eventContext),Resize:new ame(this.eventContext,this)};let{page:e,domElement:t,eventElement:r}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),jE.forEach(i=>{(Object.values(this.handlers).some(n=>n.domEventsNeeded.has(i))||i==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(t.addEventListener(i,this.onResetRaycaster),r.addEventListener(i,this.onResetRaycaster))}),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender)}),jE.forEach(i=>{t.removeEventListener(i,this.onResetRaycaster)}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}},lme=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new W().copy(r),this._editorSize=new W().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=cme(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function cme(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var hme=class{get sharedAssets(){return this.shared}constructor(e,t={}){this.shared=new _8(e.shared,t),this.scene=new O8(e.scene,this.sharedAssets)}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof vl&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof Fi&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},ume=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function dme(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function uf(e){return e instanceof Kf?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function pme(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof cn)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof cn&&i.states&&Object.keys(i.states).length)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!Si.isMergable(a))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!Si.isMergable(c.material))return;s=Si.getHash(c.material)}}r[s]||(r[s]={});let o=r[s][uf(i)];if(o){if(o.push(i),i.cloner)for(let c of i.cloner.children)o.push(c)}else if(r[s][uf(i)]=[i],i.cloner)for(let c of i.cloner.children)r[s][uf(i)].push(c)}),r}function fme(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function mme(e,t){let r=pme(t,e),i=fme(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,u=new Array(i),h=0;for(let[d,p]of Object.entries(r))for(let f of Object.values(p)){if(o=0,c=0,f.forEach(g=>{g instanceof cn&&(a[o++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),a[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&dme(a[g]);let m=mc(a.slice(0,o),!1);if(m){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new $i(m,l[0].material);break}default:{g=new $i(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,t.add(g);let v=y=>{h=0;for(let x of y)x.children&&v(x.children),x instanceof cn&&(Array.isArray(x.material)||r[x.material.uuid]&&r[x.material.uuid][uf(x)]&&r[x.material.uuid][uf(x)].length>1||(u[h++]=x));for(let x=0;x<h;x++)t.attach(u[x])};for(let y=0;y<c;y++){let x=l[y];v(x.children),n[s++]=x}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var gme=hd(jH(),1),vme=new W;function yme(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var xme=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,s,a,o,l,c,u,h,d,p,f,m;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(u=this._animationControls)==null||u.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((d=this._eventManager.handlers)==null?void 0:d.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let g=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=g,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(m=this._perfs)==null||m.end()},this._resize=()=>{var i,n,s,a,o,l,c,u,h,d;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=vme.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(i=this._scene)==null?void 0:i.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((s=(n=this._frameView)==null?void 0:n.frameSize)==null?void 0:s.x)??this._viewportWidth,((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let p=Object.values(((u=this._data)==null?void 0:u.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(d=this._frameView)==null||d.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this._requestRenderAutoMode()}},this._debouncedResize=K7(this._resize,10),this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new ume({x:10,y:10})),Dse(e)}async load(e,t){yme(e),this.disposed=!1;let r=await(await fetch(e,t)).arrayBuffer();await this.start(r)}async start(e,{interactive:t=!0}={}){var a,o,l;if(this.disposed)return;let r=await nme(e);this._data=r,r.version&&(0,gme.default)(r.version,"0.9.452")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([OA(r)&&Qle(),ghe(r)&&qle(),Gf.physicsEnabled(r.scene.objects)&&kse(),LA(r)&&ihe(),z1e(r)&&Rse()].filter(Boolean)),(a=this._eventManager)==null||a.deactivate(),(o=this._controls)==null||o.deactivate(),(l=this._scene)==null||l.dispose();let i=new hme(r);if(i.resetPersonalCameraFromDocumentData(),this._scene=i.scene,this._sharedAssetsManager=i.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let c=performance.now();mme(r,i.scene);let u=performance.now();console.log("Merged geometries in ",u-c," ms")}OA(r)&&this._scene.traverse(c=>{sa(c)&&c.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var c;this._requestRenderAutoMode(),(c=this._scene)==null||c.traverse(u=>{u instanceof _s&&u.pendingMediaLoad&&u.update()})});let n=Object.keys(r.shared.fonts).map(c=>this._sharedAssetsManager.getFont(c).loadingPromise);Promise.all(n).then(()=>{i.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),LA(r)&&K1e(r)&&await Promise.all(n),this._scene.rewriteEventsBeforeGoToPlayMode(),W8(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new Wde({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=r.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),r.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(r.scene.blueNoiseTextureData);let s=Object.values(r.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new lme(this._renderer,this._camera,new W(this._viewportWidth,this._viewportHeight),new W(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(s.allowResponsive??!1)&&s.preset==="fullscreen"),t){let c=new Yfe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,s);this._scene.updateMatrixWorld(!0),this._controls=new Z1e(c),this._animationControls=new $1e(this._scene,this._requestRenderAutoMode),this._eventManager=new ome(r.scene.publish,this._controls,this._animationControls,c),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var c;(c=this._renderer)==null||c.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==_d&&!this._scene.isInvisibleObjects(r)&&!(r instanceof vl)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof oB&&((r=this._controls)==null||r.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},s=new on(t,r,i,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(o=>{uS.unsubscribe(o)}),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),Ise(this.canvas)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof vl&&(t=s.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof vl||e instanceof O8||(n=e.parent)==null?void 0:n.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},i=uS(r,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}},a0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Gx={},bme={get exports(){return Gx},set exports(e){Gx=e}},xp={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UE;function wme(){if(UE)return xp;UE=1;var e=Kn,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var u,h={},d=null,p=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(u in l)i.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(o&&o.defaultProps)for(u in l=o.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:t,type:o,key:d,ref:p,props:h,_owner:n.current}}return xp.Fragment=r,xp.jsx=a,xp.jsxs=a,xp}(function(e){e.exports=wme()})(bme);const Wx=Gx.jsx;var Cme="Expected a function",VE=0/0,Sme="[object Symbol]",_me=/^\s+|\s+$/g,Ame=/^[-+]0x[0-9a-f]+$/i,Eme=/^0b[01]+$/i,Mme=/^0o[0-7]+$/i,Tme=parseInt,Lme=typeof a0=="object"&&a0&&a0.Object===Object&&a0,Pme=typeof self=="object"&&self&&self.Object===Object&&self,Dme=Lme||Pme||Function("return this")(),Ime=Object.prototype,Ome=Ime.toString,Rme=Math.max,Bme=Math.min,X3=function(){return Dme.Date.now()};function kme(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Cme);t=HE(t)||0,qx(r)&&(u=!!r.leading,h="maxWait"in r,s=h?Rme(HE(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(C){var _=i,S=n;return i=n=void 0,c=C,a=e.apply(S,_),a}function f(C){return c=C,o=setTimeout(v,t),u?p(C):a}function m(C){var _=C-l,S=C-c,A=t-_;return h?Bme(A,s-S):A}function g(C){var _=C-l,S=C-c;return l===void 0||_>=t||_<0||h&&S>=s}function v(){var C=X3();if(g(C))return y(C);o=setTimeout(v,m(C))}function y(C){return o=void 0,d&&i?p(C):(i=n=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function b(){return o===void 0?a:y(X3())}function w(){var C=X3(),_=g(C);if(i=arguments,n=this,l=C,_){if(o===void 0)return f(l);if(h)return o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return w.cancel=x,w.flush=b,w}function qx(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Nme(e){return!!e&&typeof e=="object"}function zme(e){return typeof e=="symbol"||Nme(e)&&Ome.call(e)==Sme}function HE(e){if(typeof e=="number")return e;if(zme(e))return VE;if(qx(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=qx(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(_me,"");var r=Eme.test(e);return r||Mme.test(e)?Tme(e.slice(2),r?2:8):Ame.test(e)?VE:+e}var Fme=kme;function jme(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}const Ume=[],Vme={width:"100%",height:"100%"},Hme=oe.forwardRef(function({className:e,children:t,debounceTime:r=300,ignoreDimensions:i=Ume,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=oe.useRef(null),u=oe.useRef(0),[h,d]=oe.useState({width:0,height:0,top:0,left:0}),p=oe.useMemo(()=>{const f=Array.isArray(i)?i:[i];return Fme(m=>{d(g=>Object.keys(g).filter(v=>g[v]!==m[v]).every(v=>f.includes(v))?g:m)},r,{leading:s})},[r,s,i]);return oe.useEffect(()=>{const f=a||window.ResizeObserver,m=new f(g=>{g.forEach(v=>{const{left:y,top:x,width:b,height:w}=(v==null?void 0:v.contentRect)??{};u.current=window.requestAnimationFrame(()=>{p({width:b,height:w,top:x,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(u.current),m.disconnect(),p.cancel()}},[p,a]),Wx("div",{style:{...Vme,...n},ref:jme([l,c]),className:e,...o,children:t({...h,ref:c.current,resize:p})})});oe.forwardRef(({scene:e,style:t,onMouseDown:r,onMouseUp:i,onMouseHover:n,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:c,onWheel:u,onLoad:h,renderOnDemand:d=!0,...p},f)=>{const m=oe.useRef(null),[g,v]=oe.useState(!0);return oe.useEffect(()=>{v(!0);let y;const x=[{name:"mouseDown",cb:r},{name:"mouseUp",cb:i},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:u}];if(m.current){y=new xme(m.current,{renderOnDemand:d});async function b(){await y.load(e);for(let w of x)w.cb&&y.addEventListener(w.name,w.cb);v(!1),h==null||h(y)}b()}return()=>{for(let b of x)b.cb&&y.removeEventListener(b.name,b.cb);y.dispose()}},[e]),Wx(Hme,{ref:f,parentSizeStyles:t,debounceTime:50,...p,children:()=>Wx("canvas",{ref:m,style:{display:g?"none":"block"}})})});function Gme(e){return Dl({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"}}]})(e)}function Wme(e){return Dl({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"}}]})(e)}const qme=({width:e,height:t})=>M.jsxs("svg",{width:e,height:t,viewBox:"0 0 107 107",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.4315 90.5H82.5V98.3368C81.3175 98.8985 80.5 100.104 80.5 101.5C80.5 103.433 82.067 105 84 105C85.933 105 87.5 103.433 87.5 101.5C87.5 100.104 86.6825 98.8985 85.5 98.3368V90.5H91H92.5V89V83H100.337C100.899 84.1825 102.104 85 103.5 85C105.433 85 107 83.433 107 81.5C107 79.567 105.433 78 103.5 78C102.104 78 100.899 78.8175 100.337 80H91H89.5V81.5V87.5H85.5H84H83H66.875C67.5387 88.4047 68.0674 89.4146 68.4315 90.5ZM61.5179 81H85.5H86.3125L86.7564 80.3194L93.8125 69.5H97.5H98.6273C99.2598 70.4067 100.311 71 101.5 71C103.433 71 105 69.433 105 67.5C105 65.567 103.433 64 101.5 64C99.9145 64 98.5752 65.0543 98.1449 66.5H97.5H93H92.1875L91.7436 67.1806L90.2309 69.5H85.5V65.8551C86.9457 65.4248 88 64.0855 88 62.5C88 60.567 86.433 59 84.5 59C82.567 59 81 60.567 81 62.5C81 63.6894 81.5933 64.7402 82.5 65.3727V71V72.5H84H88.2744L84.6875 78H62.5894C62.3382 79.0498 61.9765 80.0545 61.5179 81ZM59.7147 55.5H72V63V64.3368C70.8175 64.8985 70 66.1038 70 67.5C70 69.433 71.567 71 73.5 71C75.433 71 77 69.433 77 67.5C77 66.1038 76.1825 64.8985 75 64.3368V63V54V52.5H73.5H64.1218C62.8144 53.6641 61.2971 54.5825 59.6367 55.1859C59.6642 55.29 59.6902 55.3947 59.7147 55.5ZM67.2635 48.5H84V52.5V54H85.5H99.3368C99.8985 55.1825 101.104 56 102.5 56C104.433 56 106 54.433 106 52.5C106 50.567 104.433 49 102.5 49C101.104 49 99.8985 49.8175 99.3368 51H87V47V45.5H85.5H68.4605C68.1691 46.5541 67.7653 47.559 67.2635 48.5ZM68.9672 42.5H75.5C75.5417 42.5 75.583 42.4983 75.6238 42.495C76.2559 43.4045 77.3084 44 78.5 44C80.433 44 82 42.433 82 40.5C82 38.567 80.433 37 78.5 37C76.9145 37 75.5752 38.0543 75.1449 39.5H68.8679C68.955 40.1538 69 40.8214 69 41.5C69 41.8361 68.989 42.1696 68.9672 42.5ZM68.3997 33.5H82.9898L89.0854 38.1889L89.4898 38.5H90H97.6273C98.2598 39.4067 99.3106 40 100.5 40C102.433 40 104 38.433 104 36.5C104 34.567 102.433 33 100.5 33C98.9145 33 97.5752 34.0543 97.1449 35.5H90.5102L84.4146 30.8111L84.0102 30.5H83.5H69.7738C69.3953 31.542 68.9346 32.5446 68.3997 33.5ZM70.5045 28H89.5H91V26.5V15.6632C92.1825 15.1015 93 13.8962 93 12.5C93 10.567 91.433 9 89.5 9C87.567 9 86 10.567 86 12.5C86 13.8962 86.8175 15.1015 88 15.6632V25H70.946C70.872 26.0226 70.723 27.0244 70.5045 28ZM69.9481 17H75.3368C75.8985 18.1825 77.1038 19 78.5 19C80.433 19 82 17.433 82 15.5C82 13.567 80.433 12 78.5 12C77.1038 12 75.8985 12.8175 75.3368 14H68.6706C69.1725 14.9579 69.6008 15.9604 69.9481 17Z",fill:"black",className:"fill-inherit"}),M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.0469 85.76L25.5587 83.6608C26.9621 82.1881 29.2128 81.0148 32.2466 81.5204C34.19 81.8443 35.4337 82.8584 36.1525 84.0264C36.8344 85.1344 37 86.3012 37 87C37 87.8284 36.3284 88.5 35.5 88.5C34.6716 88.5 34 87.8284 34 87C34 86.6988 33.9156 86.1156 33.5975 85.5986C33.3163 85.1416 32.81 84.6557 31.7534 84.4796C29.5273 84.1086 28.0841 85.1449 27.3169 86.2317L26.4682 89.1681C26.1645 90.2186 26 91.3363 26 92.5C26 98.9514 31.0232 104 37 104C40.8875 104 44.3475 101.887 46.3174 98.6154L47.5678 96.5391C47.8981 95.0705 47.4152 93.5365 46.5018 92.6231C46.0494 92.1707 45.5116 91.8882 44.9241 91.8057C44.3425 91.724 43.6064 91.8234 42.7285 92.3112C42.0043 92.7135 41.0911 92.4526 40.6888 91.7284C40.2864 91.0042 40.5474 90.091 41.2715 89.6887C42.6436 88.9265 44.0325 88.651 45.3415 88.8349C46.6447 89.018 47.7631 89.6417 48.6232 90.5018C50.2755 92.1542 51.0448 94.7385 50.4964 97.1898L51.3708 98.4802C52.8144 100.61 55.2454 102 58 102C62.4183 102 66 98.4183 66 94C66 90.1301 63.2492 86.896 59.5946 86.1583L57.2659 85.6883C53.5461 87.8054 48.892 88.0764 45.205 85.772C43.0502 84.4253 41.7266 83.003 40.9511 81.6126C40.1708 80.2135 40 78.9439 40 78C40 77.1716 40.6716 76.5 41.5 76.5C42.3284 76.5 43 77.1716 43 78C43 78.5561 43.0941 79.2958 43.5712 80.1514C44.0532 81.0156 44.9795 82.0933 46.795 83.228C49.9228 85.1829 54.3323 84.6082 57.4191 81.9245L57.7623 81.4527C59.1623 79.5285 60 77.1249 60 74.5C60 71.0779 58.5752 68.028 56.3348 65.9304L54.7452 64.4421C53.4708 63.4344 51.6399 62.6381 49.2121 62.9849C47.8021 63.1863 46.4207 63.9093 45.312 64.7963C44.7646 65.2342 44.3108 65.6909 43.9767 66.1021C43.6261 66.5336 43.4675 66.8408 43.423 66.9743C43.1611 67.7602 42.3116 68.185 41.5257 67.923C40.7398 67.6611 40.315 66.8116 40.577 66.0257C40.7824 65.4091 41.1864 64.7789 41.6483 64.2104C42.1266 63.6216 42.7354 63.0157 43.4379 62.4537C44.8292 61.3406 46.6979 60.3136 48.7879 60.015C51.8893 59.572 54.3339 60.4845 56.0912 61.7083C56.6714 60.602 57 59.3429 57 58C57 57.3374 56.9201 56.6975 56.7707 56.0876C55.6445 56.1572 54.2152 56.0729 52.7529 55.6715C50.806 55.137 48.7039 54.01 47.2519 51.8321C46.7924 51.1428 46.9787 50.2115 47.6679 49.7519C48.3572 49.2924 49.2885 49.4787 49.7481 50.1679C50.6961 51.59 52.094 52.3796 53.5471 52.7785C54.6852 53.0909 55.7979 53.1451 56.6164 53.0915L58.612 52.3663C62.866 50.8203 66 46.5776 66 41.5C66 40.0606 65.7482 38.6892 65.2909 37.4273L65.2463 37.4557C64.3197 38.0409 63.19 38.4597 62.0045 38.6127C59.5967 38.9234 56.7998 38.1283 55.1888 35.2285C54.7864 34.5043 55.0474 33.5911 55.7715 33.1888C56.4957 32.7864 57.4089 33.0474 57.8112 33.7715C58.7002 35.3717 60.1533 35.8266 61.6205 35.6373C62.3725 35.5403 63.0865 35.2716 63.6443 34.9193C63.8671 34.7786 64.047 34.6364 64.1895 34.5014L64.7302 33.7009C64.7481 33.6725 64.7668 33.6448 64.7863 33.6179L65.0132 33.282C66.899 30.4906 68 27.1284 68 23.5C68 13.835 60.165 6 50.5 6C49.3664 6 48.2607 6.10739 47.1917 6.31171L46.3757 6.46768C44.4282 7.29859 43.3936 8.60994 42.9552 10.3638C42.7032 11.3715 42.6041 12.4365 42.713 13.3719C42.8227 14.3146 43.1265 15.0051 43.5607 15.4393C44.1464 16.0251 44.1464 16.9749 43.5607 17.5607C42.9749 18.1464 42.0251 18.1464 41.4393 17.5607C40.3735 16.4949 39.8914 15.0791 39.7331 13.7186C39.5739 12.3509 39.7248 10.9159 40.0447 9.63621C40.5678 7.54398 41.7079 5.84024 43.5016 4.62614C42.0973 3.60185 40.3708 3 38.5 3C33.8056 3 30 6.80557 30 11.5C30 11.876 30.0242 12.2448 30.0709 12.6054L30.7301 17.6986L25.9697 15.7711C24.7407 15.2735 23.4038 15 22 15C16.0232 15 11 20.0486 11 26.5C11 29.7097 12.2532 32.5914 14.2573 34.6678L15.1975 35.6419C17.7198 38.0878 20.7161 38.8998 24.1363 38.0447C25.9685 37.5867 27.2303 36.9446 28.1918 36.0911C29.1579 35.2336 29.9213 34.0739 30.6172 32.4186C30.9383 31.655 31.8176 31.2961 32.5813 31.6172C33.345 31.9382 33.7038 32.8176 33.3828 33.5813C32.5787 35.494 31.5921 37.0843 30.1833 38.3348C28.7698 39.5893 27.0316 40.4132 24.8639 40.9551C21.0315 41.9132 17.4849 41.2166 14.4912 38.9775L13.3044 39.4983C7.1919 42.1809 3 48.1404 3 55C3 60.825 6.01713 65.9924 10.6724 69.0683L11.0011 69.2855C12.2937 68.26 14.0068 67.5 16 67.5C19.0382 67.5 20.8972 68.7759 22.5607 70.4393C23.1465 71.0251 23.1464 71.9749 22.5607 72.5607C21.9749 73.1464 21.0251 73.1464 20.4393 72.5607C19.1029 71.2242 17.9619 70.5 16 70.5C15.0988 70.5 14.27 70.7614 13.5641 71.1626L11.1851 73.6464C9.81146 75.0805 9 76.9574 9 79C9 83.294 12.6785 87 17.5 87C19.1842 87 20.7395 86.5415 22.0469 85.76ZM63.1137 84.2584C62.24 83.7988 61.2969 83.4533 60.3042 83.2417C60.3793 83.1097 60.4329 82.9688 60.4647 82.824C60.9571 82.0979 61.3868 81.3229 61.7457 80.5075C62.5512 78.6771 63 76.6428 63 74.5C63 70.2316 61.2192 66.3939 58.3852 63.7404C59.4095 62.0694 60 60.1036 60 58C60 57.0273 59.8737 56.0841 59.6367 55.1859C65.0899 53.2041 69 47.825 69 41.5C69 39.1476 68.4591 36.926 67.4991 34.9614C69.7094 31.6896 71 27.7455 71 23.5C71 12.1782 61.8218 3 50.5 3C49.1765 3 47.8822 3.12543 46.6285 3.36505C44.5477 1.28586 41.674 0 38.5 0C32.723 0 27.941 4.25966 27.1234 9.80945C27.0421 10.3612 27 10.9257 27 11.5C27 12.0051 27.0326 12.5025 27.0957 12.9904C26.1173 12.5943 25.0854 12.3088 24.0143 12.149C23.3566 12.0508 22.684 12 22 12C14.268 12 8 18.4919 8 26.5C8 29.3792 8.81022 32.0623 10.2074 34.3183C10.7528 35.1989 11.3877 36.0145 12.0988 36.7512C11.1459 37.1694 10.2316 37.6566 9.36274 38.2062C3.72789 41.7703 0 47.9604 0 55C0 60.8284 2.55549 66.0746 6.63296 69.7301C7.37928 70.3992 8.17658 71.015 9.01854 71.5713C8.32246 72.298 7.72713 73.1145 7.2537 74.0005C6.45213 75.5005 6 77.1997 6 79C6 85.0751 11.1487 90 17.5 90C18.4364 90 19.3467 89.8929 20.2183 89.6909C21.4267 89.4108 22.5606 88.9481 23.5861 88.335C23.253 89.4874 23.0546 90.7 23.0098 91.9533C23.0033 92.1347 23 92.317 23 92.5C23 100.508 29.268 107 37 107C40.9145 107 44.4538 105.336 46.9944 102.654C47.709 101.899 48.3446 101.064 48.8874 100.163C49.4721 101.026 50.1762 101.801 50.976 102.466C52.8813 104.048 55.3295 105 58 105C64.0751 105 69 100.075 69 94C69 89.771 66.6135 86.0993 63.1137 84.2584ZM27.6293 46.8908C27.9657 46.1338 28.8522 45.7928 29.6092 46.1293L29 47.5C29.6092 46.1293 29.61 46.1296 29.6108 46.13L29.6124 46.1307L29.616 46.1323L29.6245 46.1362L29.6464 46.1463L29.6753 46.1599L29.7094 46.1763C29.7595 46.2009 29.8257 46.2344 29.9058 46.2776C30.0657 46.3639 30.2818 46.4892 30.5352 46.6582C31.0406 46.9951 31.7036 47.5118 32.3649 48.2466C32.9572 48.9046 33.5405 49.7302 34.0071 50.7414L34.0419 50.6854C34.6197 49.7645 35.4237 48.9152 36.5148 48.3913C37.6246 47.8584 38.9101 47.7212 40.3254 48.0357C41.1341 48.2154 41.644 49.0167 41.4643 49.8254C41.2846 50.6341 40.4833 51.144 39.6746 50.9643C38.8399 50.7788 38.2504 50.8858 37.8133 51.0957C37.3576 51.3145 36.9428 51.7065 36.5831 52.2798C35.8406 53.4633 35.5 55.1599 35.5 56.5C35.5 57.6584 35.8541 59.5 38.1708 60.6584C38.9118 61.0288 39.2121 61.9299 38.8416 62.6708C38.4712 63.4118 37.5701 63.7121 36.8292 63.3416C35.34 62.597 34.3473 61.6372 33.6931 60.6361C33.2642 61.3389 32.764 61.9111 32.2465 62.3711C31.5458 62.994 30.8446 63.3841 30.3123 63.6207C30.0452 63.7394 29.817 63.8211 29.6472 63.875C29.5622 63.902 29.4913 63.9222 29.437 63.9366C29.4099 63.9439 29.3868 63.9497 29.3681 63.9543L29.3434 63.9602L29.3335 63.9624L29.3292 63.9634L29.3273 63.9639C29.3263 63.9641 29.3254 63.9643 29 62.5L29.3254 63.9643C28.5167 64.144 27.7154 63.6341 27.5357 62.8254C27.3572 62.0218 27.8594 61.2256 28.6592 61.0392L28.664 61.0379C28.6757 61.0348 28.7015 61.0277 28.7395 61.0156C28.8158 60.9914 28.9392 60.9481 29.0939 60.8793C29.4054 60.7408 29.8292 60.506 30.2535 60.1289C31.0595 59.4124 32 58.0698 32 55.5C32 52.9162 31.0445 51.2639 30.1351 50.2534C29.6714 49.7382 29.2094 49.3799 28.8711 49.1543C28.7026 49.042 28.5672 48.9642 28.481 48.9177C28.438 48.8945 28.4075 48.8792 28.3917 48.8715L28.3802 48.866C27.6306 48.526 27.2944 47.6443 27.6293 46.8908ZM42.5 23.5C42.5 22.6716 41.8284 22 41 22C40.1716 22 39.5 22.6716 39.5 23.5C39.5 25.7312 40.0588 28.6801 42.4394 31.0607C43.618 32.2393 45.1463 32.9413 46.4113 33.4005C46.4794 33.4253 46.5472 33.4494 46.6145 33.473C45.9328 34.1432 45.3251 35.0152 45.0448 36.1362C44.7426 37.345 44.7204 38.5042 45.0664 39.6286C45.4089 40.7417 46.0736 41.6949 46.9394 42.5607C47.5252 43.1464 48.4749 43.1464 49.0607 42.5607C49.6465 41.9749 49.6465 41.0251 49.0607 40.4393C48.4265 39.8051 48.0912 39.2583 47.9337 38.7464C47.7797 38.2458 47.7575 37.655 47.9553 36.8638C48.2426 35.7146 49.4049 34.9805 50.498 34.4284C51.5936 33.875 51.7846 32.0923 50.3772 31.5274C50.0288 31.3875 49.5686 31.2515 49.1374 31.1241L49.1374 31.1241L49.0218 31.0899C48.5225 30.942 47.9857 30.7805 47.435 30.5806C46.3113 30.1727 45.2749 29.6535 44.5607 28.9393C42.9412 27.3199 42.5 25.2688 42.5 23.5Z",fill:"black",className:"fill-inherit"})]}),Xme=({width:e,height:t})=>M.jsxs("svg",{width:e,height:t,viewBox:"0 0 125 107",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M102.792 3H15C8.37258 3 3 8.37259 3 15V67.7053C3 74.3328 8.37258 79.7053 15 79.7053H91.7009C91.6677 80.7351 91.8982 81.7717 92.3923 82.7053L70.6679 82.7053V92.7302C70.6679 93.134 70.9511 94.0547 71.813 95.4418C72.604 96.7149 73.6307 97.9872 74.5056 98.981C76.6857 101.458 75.1319 105.755 71.4757 105.755H47.5698C43.9136 105.755 42.3597 101.458 44.5399 98.981C45.4147 97.9872 46.4414 96.7149 47.2324 95.4418C48.0943 94.0547 48.3775 93.134 48.3775 92.7302V82.7059L15 82.7053C6.71572 82.7053 0 75.9896 0 67.7053V15C0 6.71573 6.71573 0 15 0H102.792C111.077 0 117.792 6.71573 117.792 15V67.7053C117.792 73.4957 114.512 78.5198 109.707 81.0199L107.454 78.7664C111.766 76.947 114.792 72.6796 114.792 67.7053V15C114.792 8.37258 109.42 3 102.792 3ZM51.3775 82.7053H67.6679V92.7302C67.6679 94.8681 69.5363 97.6605 71.2326 99.7551L71.2431 99.7681C71.3211 99.8643 71.3987 99.959 71.4757 100.052C71.7448 100.377 72.007 100.683 72.2537 100.963C72.8463 101.637 72.3727 102.755 71.4757 102.755H47.5698C46.6728 102.755 46.1991 101.637 46.7918 100.963C47.0385 100.683 47.3006 100.377 47.5698 100.052C47.6468 99.959 47.7244 99.8643 47.8023 99.7681L47.8129 99.7551C49.5091 97.6605 51.3775 94.8681 51.3775 92.7302V82.7053Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M62.8037 52.4116H72.979L76.0533 47.6978H78.0287C78.2888 48.0629 78.7156 48.3009 79.198 48.3009C79.9903 48.3009 80.6326 47.6586 80.6326 46.8663C80.6326 46.074 79.9903 45.4316 79.198 45.4316C78.5523 45.4316 78.0063 45.8581 77.8263 46.4447H75.3745L74.5725 47.6744H72.6513V46.1885C73.2379 46.0084 73.6644 45.4624 73.6644 44.8168C73.6644 44.0245 73.0221 43.3822 72.2298 43.3822C71.4374 43.3822 70.7951 44.0245 70.7951 44.8168C70.7951 45.2992 71.0332 45.7259 71.3982 45.986V48.9275H73.7553L72.3002 51.1585H63.2514C63.1473 51.5974 62.9961 52.0171 62.8037 52.4116Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M65.6471 56.3056H71.3982V59.5119C70.9199 59.7445 70.5902 60.2351 70.5902 60.8028C70.5902 61.5951 71.2325 62.2374 72.0248 62.2374C72.8172 62.2374 73.4595 61.5951 73.4595 60.8028C73.4595 60.2351 73.1297 59.7444 72.6514 59.5118V56.3056H75.5207V53.2314H78.7268C78.9594 53.7097 79.4501 54.0395 80.0178 54.0395C80.8101 54.0395 81.4524 53.3971 81.4524 52.6048C81.4524 51.8125 80.8101 51.1702 80.0178 51.1702C79.4501 51.1702 78.9594 51.4999 78.7268 51.9783H74.2675V55.0525H71.6149L71.6082 55.0525H64.9966C65.275 55.4296 65.4962 55.8516 65.6471 56.3056Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M91.4771 55.4913L91.4772 55.4338C91.4772 45.7448 83.6227 37.8902 73.9337 37.8902C64.2463 37.8902 56.3929 45.742 56.3901 55.4286L56.39 55.4862C56.39 65.1752 64.2445 73.0297 73.9336 73.0297C83.6209 73.0297 91.4743 65.178 91.4771 55.4913ZM59.6346 58.1033L59.6385 54.8194L61.8684 55.2695C63.014 55.5007 63.876 56.5163 63.876 57.7287C63.876 59.1143 62.7528 60.2375 61.3672 60.2375C60.8988 60.2375 60.46 60.1096 60.084 59.8854C59.8981 59.3064 59.7474 58.7115 59.6346 58.1033ZM61.0713 62.228C61.1691 62.2343 61.2678 62.2375 61.3672 62.2375C63.8574 62.2375 65.876 60.2188 65.876 57.7287C65.876 56.2713 65.1846 54.9754 64.1119 54.1512C63.5777 53.7407 62.9491 53.4473 62.2641 53.309C62.6617 52.7625 62.9703 52.1427 63.1677 51.4726C63.3296 50.9232 63.4167 50.34 63.4167 49.7357C63.4167 48.7625 63.1908 47.844 62.7905 47.0332C62.7006 46.851 62.6018 46.6743 62.4948 46.5036C63.7393 44.9209 65.3053 43.6028 67.0943 42.6478V45.5753C66.6159 45.8079 66.2862 46.2986 66.2862 46.8663C66.2862 47.6586 66.9285 48.3009 67.7209 48.3009C68.5132 48.3009 69.1555 47.6586 69.1555 46.8663C69.1555 46.2986 68.8258 45.8079 68.3474 45.5753V42.0541C70.0673 41.338 71.9543 40.9426 73.9336 40.9426C81.9657 40.9426 88.477 47.4539 88.4771 55.486C88.449 63.4942 81.9484 69.9774 73.9337 69.9774C68.3556 69.9774 63.511 66.8371 61.0713 62.228ZM60.0469 51.1517C59.8813 51.6826 59.7454 52.2265 59.641 52.7816L59.6401 53.5162L60.6468 52.1324C61.1269 51.4726 61.4167 50.6454 61.4167 49.7357C61.4167 49.5382 61.403 49.3445 61.3767 49.1555L60.0469 51.1517Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M112.78 62.9336C112.78 68.7612 108.248 73.5304 102.516 73.9093C100.918 72.699 98.8521 72.3955 97.0192 72.9987L94.9541 70.9336H101.78C106.198 70.9336 109.78 67.3518 109.78 62.9336V16.0124C109.78 11.5942 106.198 8.01245 101.78 8.01245H16.0124C11.5941 8.01245 8.01238 11.5942 8.01238 16.0124V62.9336C8.01238 67.3518 11.5941 70.9336 16.0124 70.9336H57.6557C53.7683 66.8991 51.3777 61.4123 51.3777 55.3673C51.3777 46.217 56.8552 38.346 64.7101 34.8543C64.655 34.6432 64.5869 34.4378 64.5066 34.2392C64.4326 34.2976 64.3553 34.3519 64.2763 34.4018C63.9106 34.6328 63.4635 34.7987 62.9941 34.8593C62.0432 34.982 60.9482 34.6691 60.3155 33.5302C60.1814 33.2888 60.2683 32.9844 60.5097 32.8503C60.7511 32.7162 61.0555 32.8032 61.1896 33.0446C61.5817 33.7502 62.2287 33.9497 62.8661 33.8675C63.191 33.8256 63.4996 33.7097 63.7423 33.5563C63.9922 33.3985 64.1319 33.2278 64.1823 33.1017C64.2414 32.9541 64.3629 32.8501 64.5043 32.808C65.2581 31.6489 65.6959 30.2663 65.6959 28.7786C65.6959 24.6901 62.3815 21.3757 58.293 21.3757C57.8138 21.3757 57.3462 21.4211 56.8938 21.5075L56.829 21.5199C56.7781 21.5798 56.7123 21.6284 56.6342 21.6596C55.7545 22.0115 55.2835 22.5885 55.0891 23.3661C54.9832 23.7896 54.9406 24.2403 54.9871 24.6403C55.034 25.0427 55.1653 25.3535 55.3675 25.5556C55.5627 25.7509 55.5627 26.0675 55.3675 26.2627C55.1722 26.458 54.8556 26.458 54.6603 26.2627C54.2477 25.8501 54.0569 25.2975 53.9938 24.7559C53.9305 24.2118 53.9904 23.6377 54.1189 23.1236C54.3486 22.2046 54.8766 21.4754 55.729 20.9877C55.0876 20.461 54.2684 20.146 53.3743 20.146C51.3232 20.146 49.6605 21.8087 49.6605 23.8598C49.6605 24.0238 49.671 24.1848 49.6914 24.3424L49.9111 26.0401L48.3244 25.3976C47.7938 25.1828 47.2166 25.0648 46.611 25.0648C44.0267 25.0648 41.8724 27.2447 41.8724 30.0082C41.8724 31.3846 42.4101 32.6227 43.272 33.5157L43.3904 33.6384C43.4982 33.651 43.6027 33.6987 43.6854 33.7814C44.759 34.855 46.0475 35.2184 47.5145 34.8517C48.2784 34.6607 48.8138 34.3906 49.2252 34.0254C49.6382 33.6589 49.9597 33.167 50.249 32.4787C50.3561 32.2241 50.6492 32.1045 50.9037 32.2115C51.1583 32.3186 51.2779 32.6117 51.1709 32.8662C50.8454 33.6404 50.4496 34.2758 49.8891 34.7733C49.327 35.2722 48.6327 35.6029 47.757 35.8218C46.1534 36.2227 44.6785 35.9027 43.4465 34.9099L42.9544 35.1259C40.3708 36.2597 38.5933 38.7817 38.5933 41.6903C38.5933 44.1599 39.8728 46.3478 41.8412 47.6485L42.0192 47.7661C42.5457 47.2956 43.2822 46.9288 44.1517 46.9288C45.3558 46.9288 46.0903 47.4306 46.7597 48.1C46.9549 48.2952 46.9549 48.6118 46.7597 48.8071C46.5644 49.0023 46.2478 49.0023 46.0526 48.8071C45.4922 48.2467 44.9971 47.9288 44.1517 47.9288C43.3295 47.9288 42.6519 48.4278 42.3133 48.9358C42.2481 49.0337 42.1543 49.1011 42.0504 49.1345L42.0121 49.1745C41.4107 49.8024 41.0526 50.6277 41.0526 51.5278C41.0526 53.4243 42.673 55.0367 44.7664 55.0367C45.4989 55.0367 46.1771 54.8371 46.7481 54.4958L47.9176 53.7968C48.4359 53.0977 49.4051 52.443 50.7921 52.6742C51.0671 52.72 51.3055 52.8007 51.511 52.9063C51.468 53.3008 51.4352 53.6983 51.4129 54.0986C51.2734 53.9094 51.0412 53.7295 50.6277 53.6606C49.6332 53.4948 48.9925 53.9806 48.6666 54.4695C48.6258 54.5306 48.5739 54.5799 48.5153 54.6164L48.2218 55.6319C48.0914 56.083 48.0209 56.5627 48.0209 57.0614C48.0209 59.6851 49.9626 61.7827 52.3705 61.9883C52.4761 62.3307 52.5896 62.6695 52.711 63.0047C49.564 62.9777 47.0209 60.3272 47.0209 57.0614C47.0209 56.9005 47.0271 56.7411 47.0392 56.5835C47.0717 56.1596 47.1472 55.7483 47.2611 55.3542C46.9103 55.5639 46.5284 55.7307 46.1237 55.8469C45.6939 55.9703 45.2383 56.0367 44.7664 56.0367C42.1631 56.0367 40.0526 54.018 40.0526 51.5278C40.0526 50.7086 40.2811 49.9404 40.6803 49.2783C40.8531 48.9917 41.0578 48.7251 41.2899 48.4828C41.0091 48.2973 40.7404 48.0956 40.4852 47.8791C38.7134 46.3761 37.5933 44.1608 37.5933 41.6903C37.5933 38.7228 39.2094 36.1236 41.6297 34.6847C41.9258 34.5087 42.2339 34.35 42.5525 34.2102C42.3141 33.9632 42.0966 33.6946 41.903 33.4075C41.2534 32.4442 40.8724 31.2723 40.8724 30.0082C40.8724 26.7257 43.4417 24.0648 46.611 24.0648C46.9723 24.0648 47.3257 24.0993 47.6685 24.1655C48.0249 24.2342 48.3697 24.3371 48.6997 24.4707C48.6738 24.2707 48.6605 24.0668 48.6605 23.8598C48.6605 23.7044 48.668 23.5508 48.6827 23.3993C48.9141 21.0121 50.9263 19.146 53.3743 19.146C54.6753 19.146 55.8532 19.6731 56.7061 20.5253C57.22 20.4271 57.7505 20.3757 58.293 20.3757C61.5238 20.3757 64.3288 22.199 65.735 24.8729H68.4793C68.7119 24.3945 69.2026 24.0648 69.7702 24.0648C70.5626 24.0648 71.2049 24.7071 71.2049 25.4994C71.2049 26.2917 70.5626 26.9341 69.7702 26.9341C69.2026 26.9341 68.7119 26.6043 68.4793 26.126H66.2687C66.248 26.064 66.2267 26.0023 66.2047 25.9409C66.5227 26.8273 66.6959 27.7827 66.6959 28.7786C66.6959 30.5188 66.1669 32.1355 65.2609 33.4765C65.4147 33.7912 65.5422 34.122 65.6405 34.4657C67.5706 33.7103 69.6309 33.2146 71.7784 33.0214L71.6066 32.8893H65.6236C65.8476 32.4905 66.0401 32.0717 66.1976 31.6361H72.0328L73.7154 32.9304C73.7485 32.9303 73.7816 32.9302 73.8148 32.9302C75.1169 32.9302 76.3932 33.0411 77.6346 33.2541C77.8959 32.9013 78.3153 32.6726 78.788 32.6726C79.4932 32.6726 80.0795 33.1814 80.2 33.8518C89.4811 36.602 96.2519 45.1939 96.2519 55.3673C96.2519 60.8865 94.2591 65.9402 90.9538 69.8483L96.1069 75.0013C97.9131 74.1166 100.156 74.425 101.658 75.9267L123.583 97.8515C125.473 99.7414 125.473 102.806 123.583 104.695C121.693 106.585 118.629 106.585 116.739 104.695L94.8139 82.7706C93.4816 81.4383 93.0885 79.5224 93.6347 77.8457L88.2955 72.5065C87.7879 72.9358 87.261 73.343 86.7162 73.7265L86.9232 73.9336H86.417C82.8248 76.3766 78.4865 77.8044 73.8148 77.8044C69.143 77.8044 64.8048 76.3766 61.2126 73.9336H16.0124C9.93725 73.9336 5.01238 69.0087 5.01238 62.9336V16.0124C5.01238 9.93731 9.93725 5.01245 16.0124 5.01245H101.78C107.855 5.01245 112.78 9.93731 112.78 16.0124V62.9336ZM93.2519 55.3673C93.2519 66.1021 84.5496 74.8044 73.8148 74.8044C63.08 74.8044 54.3777 66.1021 54.3777 55.3673C54.3777 44.6325 63.08 35.9302 73.8148 35.9302C84.5496 35.9302 93.2519 44.6325 93.2519 55.3673Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M58.8963 78.2394C59.9344 78.2394 60.7759 77.4158 60.7759 76.3997C60.7759 75.3837 59.9344 74.5601 58.8963 74.5601C57.8582 74.5601 57.0166 75.3837 57.0166 76.3997C57.0166 77.4158 57.8582 78.2394 58.8963 78.2394Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M57.7895 39.6632C57.6239 39.528 57.3832 39.5099 57.196 39.6347C56.9662 39.7878 56.9041 40.0983 57.0573 40.328L57.0798 40.3613L57.1032 40.3953C57.3266 40.1462 57.5554 39.9021 57.7895 39.6632Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M52.4915 40.5143C52.1722 41.0231 52.0299 41.7418 52.0299 42.3051C52.0299 42.8061 52.1862 43.6114 53.1882 44.1123C53.4352 44.2358 53.5353 44.5362 53.4118 44.7832C53.2883 45.0302 52.9879 45.1303 52.741 45.0068C52.0701 44.6714 51.6544 44.2268 51.4009 43.7735C51.212 44.1303 50.9774 44.4099 50.7347 44.6257C50.458 44.8716 50.1812 45.0256 49.9715 45.1188C49.8663 45.1656 49.7768 45.1976 49.7108 45.2186C49.6777 45.229 49.6504 45.2368 49.6298 45.2423C49.6195 45.2451 49.6108 45.2473 49.6039 45.2489L49.5949 45.2511L49.5915 45.2519L49.59 45.2522L49.5887 45.2525C49.3191 45.3124 49.052 45.1424 48.9921 44.8729C48.9325 44.6047 49.1004 44.3391 49.3674 44.2773L49.3721 44.2761C49.3785 44.2744 49.3908 44.2709 49.4082 44.2654C49.4431 44.2544 49.4976 44.2351 49.5654 44.205C49.7015 44.1445 49.8858 44.0423 50.0703 43.8783C50.4251 43.5629 50.8248 42.9814 50.8248 41.8951C50.8248 40.8042 50.4201 40.1003 50.0308 39.6678C49.8332 39.4482 49.6362 39.2952 49.4911 39.1985C49.4188 39.1503 49.3602 39.1166 49.322 39.096C49.3105 39.0898 49.3009 39.0848 49.2934 39.081L49.2813 39.075L49.2744 39.0716C49.024 38.9586 48.9116 38.6643 49.0233 38.4129C49.1355 38.1606 49.431 38.0469 49.6833 38.1591L49.4802 38.616C49.6833 38.1591 49.6844 38.1595 49.6844 38.1595L49.6856 38.1601L49.6886 38.1615L49.6967 38.1652L49.7205 38.1766C49.7336 38.183 49.7498 38.1911 49.7686 38.2009L49.7969 38.216C49.8597 38.2498 49.9452 38.2994 50.0458 38.3665C50.2466 38.5003 50.5106 38.706 50.7741 38.9988C51.0493 39.3045 51.3204 39.7018 51.5182 40.2029C51.5575 40.1278 51.5995 40.0543 51.6444 39.9828C51.8729 39.6186 52.1875 39.288 52.6104 39.0849C53.0396 38.8788 53.5399 38.8238 54.0978 38.9478C54.3673 39.0077 54.5373 39.2747 54.4774 39.5443C54.4175 39.8139 54.1504 39.9838 53.8808 39.9239C53.5165 39.843 53.2482 39.888 53.0433 39.9864C52.8321 40.0878 52.6472 40.266 52.4915 40.5143Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M54.3992 28.2785C54.6753 28.2785 54.8992 28.5023 54.8992 28.7785C54.8992 29.5212 55.0845 30.3963 55.7775 31.0892C56.066 31.3778 56.4708 31.589 56.9044 31.7541C57.1178 31.8353 57.3293 31.9021 57.5272 31.9616C57.5783 31.977 57.6301 31.9924 57.6814 32.0075C57.8196 32.0484 57.9544 32.0883 58.0636 32.1254C58.3035 32.2068 58.4544 32.4228 58.4628 32.6587C58.471 32.8861 58.3472 33.0985 58.1423 33.206C57.712 33.4315 57.2591 33.7466 57.1387 34.2284C57.0536 34.5687 57.061 34.8326 57.1315 35.0617C57.2032 35.2945 57.3532 35.5342 57.622 35.803C57.8173 35.9983 57.8173 36.3149 57.622 36.5102C57.4268 36.7054 57.1102 36.7054 56.9149 36.5102C56.5689 36.1641 56.309 35.789 56.1757 35.3558C56.0413 34.9188 56.0487 34.4653 56.1685 33.9859C56.2964 33.4743 56.5998 33.0958 56.9208 32.8197C56.8012 32.7806 56.676 32.7371 56.5486 32.6886C56.0621 32.5034 55.5048 32.2308 55.0704 31.7964C54.1237 30.8497 53.8992 29.6753 53.8992 28.7785C53.8992 28.5023 54.123 28.2785 54.3992 28.2785Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{d:"M74.9057 30.6348H66.4902C66.5821 30.2275 66.6443 29.809 66.6746 29.3817H73.6526V25.5607C73.1742 25.3281 72.8445 24.8374 72.8445 24.2697C72.8445 23.4774 73.4868 22.8351 74.2791 22.8351C75.0715 22.8351 75.7138 23.4774 75.7138 24.2697C75.7138 24.8374 75.3841 25.328 74.9057 25.5606V30.6348Z",fill:"#100F13",className:"fill-inherit"})]}),Yme=({width:e,height:t})=>M.jsxs("svg",{width:e,height:t,viewBox:"0 0 94 94",fill:"none",className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",children:[M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.7078 49.995C68.7651 50.3024 69.0347 50.5243 69.3474 50.5243H82.2508C83.1966 50.5243 83.8138 51.5172 83.3952 52.3654C83.3312 52.5 82.3538 54.4187 79.5706 56.7526C76.9815 58.9274 72.8324 61.4511 66.456 63.2512C66.1974 63.3242 66.0163 63.5597 66.0163 63.8284C66.0163 63.9719 65.9645 64.1106 65.8704 64.2189L60.3842 70.5405C60.0887 70.881 59.6885 71.1115 59.2451 71.1928C57.4635 71.5195 52.7804 72.3554 52.3199 72.2024C51.9481 72.0793 49.7312 69.9553 48.2236 68.4822C47.435 67.7118 46.1727 67.7118 45.3842 68.4823C43.8766 69.9555 41.6598 72.0796 41.288 72.2027C40.8256 72.3557 36.1441 71.5199 34.3629 71.1931C33.9194 71.1118 33.5191 70.8812 33.2236 70.5406L27.7397 64.2193C27.6457 64.1109 27.5939 63.9722 27.5939 63.8286C27.5939 63.5599 27.4139 63.3247 27.1553 63.2517C25.3444 62.7403 23.7113 62.1753 22.2449 61.5712C16.6922 59.2898 13.4993 56.5156 11.8216 54.6082C10.7189 53.3537 10.2676 52.4771 10.2122 52.3694L10.2103 52.3657C9.79247 51.5171 10.4101 50.5246 11.3559 50.5246H24.2596C24.5722 50.5246 24.842 50.3027 24.8991 49.9953C25.1967 48.4029 25.9108 44.6067 26.6707 40.5731C27.4168 36.6035 28.2134 32.4057 28.7077 29.8619C28.8703 29.0155 29.0007 28.3516 29.0877 27.9341C29.2182 27.2818 29.4563 26.6658 29.7744 26.1045C30.0949 25.5478 30.4932 25.0412 30.9555 24.5987C31.8756 23.7136 33.0337 23.0748 34.3064 22.7005C35.1532 22.4519 36.055 22.3218 36.9797 22.3218C38.6597 22.3218 40.4221 22.7552 42.0427 23.7134C42.9446 24.2472 43.6518 24.5826 44.2125 24.7948C44.7711 25.0047 45.1808 25.096 45.5218 25.137C45.7508 25.1643 45.9475 25.1735 46.1581 25.1735C46.2532 25.1735 46.3504 25.1714 46.452 25.1692C46.563 25.1668 46.6792 25.1643 46.8035 25.1643C47.053 25.1643 47.3414 25.1598 47.671 25.1324C47.9983 25.1004 48.369 25.048 48.7673 24.9544C49.5684 24.7673 50.4977 24.4205 51.5048 23.7498C52.3012 23.2227 53.1435 22.8372 53.995 22.5862C54.8511 22.3376 55.7186 22.2212 56.5677 22.2212C57.9617 22.2212 59.3076 22.5337 60.4954 23.1018C61.6856 23.6698 62.7293 24.4979 63.4755 25.552C63.9768 26.2524 64.3452 27.0578 64.5238 27.9339C64.6061 28.3513 64.7366 29.0152 64.9014 29.8616C65.0662 30.7102 65.2631 31.7437 65.4804 32.889C65.9177 35.1795 66.4373 37.9287 66.9362 40.5728V40.5774C67.6962 44.6064 68.4103 48.4026 68.7078 49.995ZM30.6448 33.3659C30.2099 35.654 29.688 38.4009 29.1891 41.0474C29.0371 41.8575 29.6578 42.6059 30.482 42.6059H63.1262C63.9502 42.6059 64.5741 41.8569 64.4187 41.0477C63.668 37.0781 62.8738 32.8803 62.3839 30.3479C62.2215 29.5038 62.0909 28.842 62.0108 28.4429V28.4405C61.9329 28.0618 61.7933 27.7013 61.5988 27.3613C61.4066 27.0214 61.1548 26.702 60.8504 26.4054C60.2439 25.8167 59.429 25.3445 58.509 25.0639C57.8956 24.8768 57.2386 24.7764 56.568 24.7764C55.9547 24.7764 55.3322 24.8609 54.7187 25.0411C54.1075 25.2191 53.5056 25.4929 52.9311 25.8761C51.9721 26.5149 51.0383 26.9369 50.18 27.213C49.3261 27.489 48.5457 27.6191 47.9003 27.6738C47.47 27.7148 47.097 27.7217 46.804 27.7217C46.7137 27.7205 46.6123 27.7224 46.4998 27.7245C46.3956 27.7264 46.2818 27.7286 46.1586 27.7286C45.8886 27.7286 45.5635 27.7194 45.2019 27.6738C44.8402 27.6283 44.4419 27.5484 43.9979 27.4183C43.1143 27.1581 42.0661 26.6973 40.7363 25.9125C39.5231 25.1962 38.2209 24.8767 36.9803 24.8767C35.9594 24.8767 34.9845 25.0957 34.1605 25.479C33.332 25.8623 32.6636 26.4053 32.2127 27.0417C31.9106 27.466 31.7023 27.9292 31.597 28.4402V28.4426C31.5374 28.7394 31.4513 29.1814 31.3432 29.7356C31.306 29.9267 31.2662 30.1311 31.2239 30.3476C31.1185 30.8954 30.9985 31.5211 30.8673 32.2059C30.7963 32.5762 30.722 32.9639 30.6448 33.3659ZM69.6714 59.4926C74.8373 57.4873 77.8196 55.0781 79.4378 53.3807C79.548 53.2657 79.4656 53.0795 79.3063 53.0795H16.3798C15.4237 53.0795 14.9557 54.184 15.6873 54.7997C18.1661 56.878 22.3683 59.4377 29.2371 61.1625C33.8171 62.31 39.5802 63.0858 46.8038 63.0858C57.1515 63.0858 64.5054 61.4934 69.6714 59.4926Z",fill:"#100F13",className:"fill-inherit"}),M.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M93.3038 46.7212C93.3038 72.4024 72.4851 93.2212 46.8038 93.2212C21.1226 93.2212 0.303833 72.4024 0.303833 46.7212C0.303833 21.04 21.1226 0.221191 46.8038 0.221191C72.4851 0.221191 93.3038 21.04 93.3038 46.7212ZM90.3038 46.7212C90.3038 70.7456 70.8282 90.2212 46.8038 90.2212C22.7794 90.2212 3.30383 70.7456 3.30383 46.7212C3.30383 22.6968 22.7794 3.22119 46.8038 3.22119C70.8282 3.22119 90.3038 22.6968 90.3038 46.7212Z",fill:"#100F13",className:"fill-inherit"})]}),Qme=()=>M.jsxs("svg",{width:"1000",height:"1000",viewBox:"0 0 1991 1991",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[M.jsxs("g",{clipPath:"url(#clip0_759_511)",children:[M.jsx("path",{d:"M1599.29 788.928C1599.84 790.5 1600.36 792.081 1600.85 793.673L1600.37 793.821C1600.62 794.615 1600.86 795.41 1601.1 796.209C1601.33 797.007 1601.56 797.806 1601.78 798.606L1602.27 798.472C1602.71 800.078 1603.13 801.688 1603.53 803.303L1603.05 803.422C1603.44 805.031 1603.81 806.645 1604.16 808.262L1604.65 808.158C1604.99 809.781 1605.31 811.409 1605.61 813.04L1605.12 813.13C1605.42 814.76 1605.69 816.394 1605.94 818.032L1606.43 817.957C1606.68 819.6 1606.9 821.247 1607.1 822.897L1606.61 822.957C1606.8 824.602 1606.98 826.251 1607.13 827.904L1607.62 827.859C1607.77 829.509 1607.9 831.162 1608 832.819L1607.5 832.849C1607.6 834.499 1607.68 836.153 1607.73 837.81L1608.23 837.795C1608.28 839.456 1608.31 841.121 1608.32 842.789L1607.82 842.791C1607.82 844.443 1607.8 846.098 1607.76 847.756L1608.26 847.768C1608.22 849.421 1608.16 851.077 1608.07 852.735L1607.57 852.709C1607.48 854.363 1607.37 856.019 1607.24 857.678L1607.74 857.718C1607.61 859.376 1607.45 861.037 1607.28 862.7L1606.78 862.647C1606.6 864.28 1606.41 865.915 1606.19 867.553L1606.69 867.619C1606.47 869.261 1606.23 870.905 1605.97 872.551L1605.47 872.472C1605.21 874.114 1604.93 875.758 1604.63 877.404L1605.12 877.495C1604.82 879.116 1604.5 880.739 1604.16 882.364L1603.67 882.262C1603.34 883.873 1602.98 885.485 1602.6 887.1L1603.09 887.213C1602.71 888.831 1602.32 890.451 1601.9 892.072L1601.41 891.947C1601 893.555 1600.57 895.164 1600.11 896.774L1600.59 896.91C1600.15 898.489 1599.68 900.071 1599.2 901.653L1598.72 901.507C1598.24 903.086 1597.74 904.666 1597.22 906.247L1597.7 906.403C1597.18 907.987 1596.64 909.573 1596.08 911.159L1595.61 910.994C1595.07 912.548 1594.51 914.103 1593.92 915.659L1594.39 915.834C1593.82 917.375 1593.23 918.916 1592.62 920.459L1592.15 920.275C1591.54 921.814 1590.92 923.355 1590.28 924.895L1590.74 925.088C1590.09 926.631 1589.43 928.176 1588.76 929.72L1588.3 929.52C1587.64 931.018 1586.97 932.518 1586.28 934.018L1586.73 934.226C1586.05 935.723 1585.34 937.22 1584.62 938.718L1584.17 938.502C1583.46 939.997 1582.72 941.492 1581.97 942.988L1582.42 943.212C1581.67 944.708 1580.91 946.204 1580.13 947.7L1579.68 947.469C1578.93 948.917 1578.16 950.364 1577.37 951.812L1577.81 952.05C1577.03 953.5 1576.23 954.95 1575.42 956.399L1574.98 956.155C1574.17 957.602 1573.34 959.05 1572.5 960.498L1572.93 960.749C1572.09 962.195 1571.24 963.642 1570.37 965.088L1569.94 964.83C1569.1 966.23 1568.25 967.63 1567.38 969.029L1567.8 969.293C1566.94 970.694 1566.05 972.095 1565.16 973.495L1564.74 973.226C1563.85 974.625 1562.94 976.024 1562.02 977.422L1562.44 977.696C1561.52 979.096 1560.58 980.496 1559.64 981.895L1559.22 981.615C1558.31 982.968 1557.38 984.321 1556.44 985.674L1556.85 985.959C1555.91 987.312 1554.96 988.664 1554 990.015L1553.59 989.724C1552.63 991.074 1551.65 992.423 1550.67 993.771L1551.07 994.066C1550.08 995.416 1549.08 996.765 1548.07 998.114L1547.67 997.814C1546.68 999.13 1545.69 1000.45 1544.68 1001.76L1545.07 1002.07C1544.07 1003.37 1543.06 1004.67 1542.04 1005.97L1541.64 1005.67C1540.62 1006.97 1539.59 1008.27 1538.55 1009.57L1538.94 1009.88C1537.89 1011.18 1536.84 1012.48 1535.77 1013.78L1535.38 1013.46C1534.33 1014.74 1533.26 1016.03 1532.19 1017.31L1532.57 1017.63C1531.52 1018.89 1530.46 1020.14 1529.38 1021.4L1529 1021.07C1528.51 1021.65 1528.02 1022.22 1527.52 1022.79C1526.94 1023.47 1526.35 1024.15 1525.76 1024.83L1526.13 1025.16C1525.04 1026.41 1523.94 1027.66 1522.82 1028.91L1522.45 1028.58C1521.34 1029.83 1520.22 1031.07 1519.08 1032.32L1519.45 1032.66C1518.35 1033.88 1517.23 1035.09 1516.11 1036.31L1515.74 1035.97C1514.62 1037.18 1513.5 1038.38 1512.37 1039.59L1512.73 1039.93C1511.59 1041.13 1510.45 1042.34 1509.3 1043.54L1508.94 1043.19C1507.78 1044.4 1506.62 1045.6 1505.45 1046.8L1505.81 1047.15C1504.64 1048.34 1503.46 1049.54 1502.28 1050.73L1501.92 1050.38C1500.77 1051.54 1499.61 1052.7 1498.44 1053.86L1498.79 1054.22C1497.62 1055.38 1496.44 1056.53 1495.25 1057.69L1494.9 1057.33C1493.71 1058.49 1492.52 1059.64 1491.31 1060.8L1491.66 1061.16C1490.46 1062.31 1489.24 1063.47 1488.02 1064.62L1487.68 1064.26C1486.47 1065.4 1485.25 1066.54 1484.02 1067.68L1484.36 1068.04C1483.16 1069.16 1481.95 1070.27 1480.73 1071.39L1480.39 1071.02C1479.18 1072.13 1477.95 1073.24 1476.72 1074.35L1477.05 1074.72C1475.82 1075.83 1474.58 1076.94 1473.33 1078.05L1473 1077.68C1471.75 1078.78 1470.49 1079.89 1469.23 1080.99L1469.56 1081.37C1468.31 1082.47 1467.05 1083.56 1465.78 1084.65L1465.45 1084.27C1464.21 1085.34 1462.96 1086.41 1461.7 1087.48L1462.03 1087.86C1460.77 1088.93 1459.5 1090 1458.23 1091.06L1457.91 1090.68C1456.64 1091.74 1455.36 1092.81 1454.07 1093.87L1454.39 1094.25C1453.1 1095.32 1451.81 1096.38 1450.51 1097.44L1450.19 1097.05C1449.59 1097.54 1448.99 1098.03 1448.38 1098.52C1447.69 1099.08 1446.99 1099.64 1446.3 1100.2L1446.61 1100.59C1445.33 1101.62 1444.04 1102.64 1442.75 1103.67L1442.44 1103.28C1441.14 1104.3 1439.85 1105.32 1438.54 1106.34L1438.85 1106.74C1437.54 1107.76 1436.23 1108.78 1434.91 1109.8L1434.6 1109.4C1433.28 1110.42 1431.96 1111.43 1430.63 1112.45L1430.93 1112.85C1429.6 1113.86 1428.26 1114.87 1426.91 1115.88L1426.61 1115.48C1425.3 1116.47 1423.99 1117.45 1422.66 1118.44L1422.96 1118.84C1421.64 1119.82 1420.3 1120.8 1418.97 1121.78L1418.67 1121.38C1417.34 1122.36 1416 1123.33 1414.65 1124.31L1414.94 1124.71C1413.59 1125.69 1412.24 1126.66 1410.88 1127.63L1410.59 1127.23C1409.23 1128.2 1407.86 1129.17 1406.49 1130.14L1406.78 1130.54C1405.43 1131.5 1404.07 1132.45 1402.71 1133.4L1402.42 1132.99C1401.07 1133.93 1399.72 1134.87 1398.36 1135.81L1398.64 1136.22C1397.28 1137.16 1395.91 1138.09 1394.54 1139.03L1394.26 1138.62C1392.88 1139.55 1391.51 1140.48 1390.12 1141.41L1390.4 1141.83C1389.02 1142.76 1387.63 1143.69 1386.23 1144.61L1385.95 1144.2C1384.57 1145.12 1383.17 1146.04 1381.77 1146.96L1382.04 1147.38C1380.67 1148.28 1379.29 1149.18 1377.9 1150.08L1377.63 1149.66C1376.25 1150.56 1374.86 1151.45 1373.46 1152.35L1373.73 1152.77C1372.34 1153.66 1370.94 1154.55 1369.53 1155.45L1369.26 1155.02C1367.86 1155.91 1366.45 1156.8 1365.03 1157.69L1365.3 1158.11C1363.88 1159 1362.46 1159.88 1361.04 1160.77L1360.77 1160.34C1359.37 1161.21 1357.95 1162.08 1356.53 1162.95L1356.8 1163.38C1355.39 1164.24 1353.98 1165.09 1352.56 1165.95L1352.31 1165.52C1350.89 1166.38 1349.47 1167.23 1348.05 1168.08L1348.31 1168.51C1346.88 1169.36 1345.45 1170.21 1344.02 1171.06L1343.76 1170.63C1342.33 1171.48 1340.89 1172.32 1339.45 1173.17L1339.7 1173.6C1338.26 1174.44 1336.81 1175.29 1335.36 1176.12L1335.11 1175.69C1333.68 1176.52 1332.25 1177.34 1330.81 1178.16L1331.06 1178.6C1329.63 1179.41 1328.19 1180.23 1326.75 1181.05L1326.5 1180.61C1325.06 1181.42 1323.62 1182.24 1322.17 1183.05L1322.41 1183.48C1320.96 1184.29 1319.51 1185.1 1318.05 1185.91L1317.8 1185.47C1316.35 1186.27 1314.88 1187.08 1313.42 1187.88L1313.66 1188.32C1312.19 1189.12 1310.72 1189.92 1309.24 1190.72L1309 1190.28C1307.56 1191.06 1306.1 1191.84 1304.65 1192.62L1304.88 1193.06C1303.43 1193.84 1301.97 1194.61 1300.5 1195.39L1300.27 1194.94C1298.8 1195.72 1297.33 1196.49 1295.86 1197.26L1296.09 1197.7C1294.62 1198.47 1293.14 1199.24 1291.66 1200L1291.43 1199.56C1289.95 1200.32 1288.47 1201.09 1286.98 1201.85L1287.21 1202.29C1285.72 1203.05 1284.23 1203.81 1282.73 1204.57L1282.51 1204.12C1281.04 1204.86 1279.56 1205.6 1278.09 1206.34L1278.31 1206.79C1276.83 1207.52 1275.35 1208.26 1273.86 1208.99L1273.64 1208.55C1272.16 1209.28 1270.67 1210.01 1269.18 1210.74L1269.4 1211.19C1267.9 1211.92 1266.41 1212.65 1264.91 1213.37L1264.69 1212.92C1263.19 1213.64 1261.69 1214.37 1260.18 1215.09L1260.39 1215.54C1258.89 1216.26 1257.37 1216.98 1255.86 1217.69L1255.65 1217.24C1254.15 1217.94 1252.66 1218.65 1251.16 1219.35L1251.37 1219.8C1249.88 1220.5 1248.38 1221.19 1246.87 1221.89L1246.66 1221.43C1245.16 1222.13 1243.65 1222.82 1242.14 1223.51L1242.35 1223.97C1240.84 1224.66 1239.33 1225.34 1237.81 1226.03L1237.6 1225.57C1236.08 1226.26 1234.56 1226.94 1233.04 1227.62L1233.24 1228.08C1231.72 1228.76 1230.19 1229.44 1228.66 1230.11L1228.46 1229.66C1226.94 1230.32 1225.43 1230.99 1223.91 1231.65L1224.11 1232.11C1222.59 1232.77 1221.08 1233.43 1219.56 1234.08L1219.36 1233.62C1217.84 1234.28 1216.32 1234.93 1214.79 1235.58L1214.99 1236.04C1213.46 1236.7 1211.93 1237.34 1210.39 1237.99L1210.2 1237.53C1208.67 1238.18 1207.13 1238.82 1205.59 1239.46L1205.78 1239.92C1204.24 1240.56 1202.7 1241.2 1201.15 1241.84L1200.96 1241.38C1199.43 1242.01 1197.89 1242.64 1196.35 1243.27L1196.54 1243.73C1195.01 1244.35 1193.48 1244.97 1191.94 1245.59L1191.76 1245.13C1190.22 1245.75 1188.68 1246.36 1187.14 1246.97L1187.33 1247.44C1185.78 1248.05 1184.24 1248.66 1182.69 1249.27L1182.51 1248.8C1180.96 1249.41 1179.41 1250.02 1177.86 1250.62L1178.04 1251.09C1176.49 1251.69 1174.93 1252.29 1173.37 1252.89L1173.19 1252.42C1171.64 1253.02 1170.08 1253.61 1168.51 1254.21L1168.69 1254.67C1167.15 1255.26 1165.6 1255.84 1164.05 1256.42L1163.88 1255.95C1162.33 1256.53 1160.78 1257.11 1159.22 1257.69L1159.4 1258.16C1157.84 1258.73 1156.29 1259.3 1154.72 1259.88L1154.55 1259.41C1152.99 1259.98 1151.43 1260.54 1149.87 1261.11L1150.04 1261.58C1148.47 1262.14 1146.9 1262.71 1145.33 1263.27L1145.16 1262.8C1143.59 1263.36 1142.02 1263.92 1140.44 1264.47L1140.61 1264.94C1139.04 1265.49 1137.48 1266.04 1135.91 1266.59L1135.75 1266.11C1134.19 1266.66 1132.62 1267.2 1131.06 1267.74L1131.22 1268.21C1129.65 1268.75 1128.08 1269.28 1126.51 1269.81L1126.35 1269.34C1124.78 1269.87 1123.21 1270.4 1121.63 1270.93L1121.79 1271.41C1120.21 1271.93 1118.63 1272.46 1117.05 1272.98L1116.89 1272.51C1115.31 1273.03 1113.73 1273.55 1112.14 1274.07L1112.3 1274.54C1110.71 1275.06 1109.12 1275.58 1107.53 1276.09L1107.38 1275.61C1105.81 1276.12 1104.23 1276.62 1102.66 1277.12L1102.81 1277.6C1101.23 1278.1 1099.65 1278.6 1098.07 1279.09L1097.92 1278.62C1096.34 1279.11 1094.76 1279.61 1093.17 1280.1L1093.32 1280.57C1091.73 1281.07 1090.14 1281.55 1088.55 1282.04L1088.4 1281.56C1086.81 1282.05 1085.22 1282.53 1083.62 1283.01L1083.77 1283.49C1082.17 1283.97 1080.57 1284.45 1078.97 1284.92L1078.83 1284.44C1078.03 1284.68 1077.23 1284.92 1076.42 1285.15C1075.98 1285.29 1075.53 1285.42 1075.08 1285.55C1074.73 1285.65 1074.37 1285.76 1074.02 1285.86L1074.16 1286.34C1072.56 1286.81 1070.96 1287.27 1069.35 1287.74L1069.22 1287.26C1068.6 1287.43 1067.98 1287.61 1067.37 1287.79C1066.38 1288.07 1065.4 1288.35 1064.41 1288.63L1064.55 1289.11C1062.95 1289.57 1061.35 1290.02 1059.75 1290.47L1059.62 1289.99C1058.02 1290.43 1056.42 1290.88 1054.82 1291.32L1054.95 1291.8C1053.36 1292.24 1051.76 1292.68 1050.16 1293.12L1050.03 1292.63C1048.43 1293.07 1046.84 1293.5 1045.24 1293.93L1045.37 1294.41C1043.76 1294.84 1042.15 1295.27 1040.53 1295.69L1040.41 1295.21C1038.79 1295.64 1037.18 1296.06 1035.57 1296.48L1035.69 1296.96C1034.08 1297.38 1032.47 1297.79 1030.86 1298.21L1030.73 1297.72C1029.12 1298.13 1027.51 1298.54 1025.9 1298.95L1026.03 1299.43C1024.42 1299.84 1022.81 1300.24 1021.2 1300.63L1021.08 1300.15C1019.47 1300.55 1017.87 1300.94 1016.26 1301.33L1016.38 1301.82C1014.77 1302.21 1013.15 1302.6 1011.54 1302.98L1011.42 1302.5C1009.8 1302.88 1008.17 1303.27 1006.55 1303.65L1006.67 1304.14C1005.04 1304.52 1003.42 1304.9 1001.8 1305.27L1001.68 1304.78C1000.06 1305.16 998.441 1305.53 996.821 1305.89L996.932 1306.38C995.312 1306.75 993.692 1307.11 992.074 1307.47L991.965 1306.98C990.348 1307.34 988.731 1307.7 987.116 1308.05L987.222 1308.54C985.606 1308.89 983.991 1309.24 982.377 1309.59L982.272 1309.1C980.639 1309.45 979.006 1309.79 977.375 1310.14L977.478 1310.63C975.843 1310.97 974.209 1311.31 972.577 1311.64L972.476 1311.15C970.844 1311.49 969.213 1311.82 967.584 1312.15L967.683 1312.64C966.052 1312.97 964.423 1313.29 962.796 1313.61L962.699 1313.12C961.072 1313.44 959.446 1313.76 957.821 1314.08L957.916 1314.57C956.291 1314.88 954.667 1315.19 953.044 1315.5L952.951 1315.01C951.317 1315.31 949.684 1315.62 948.052 1315.92L948.143 1316.41C946.498 1316.72 944.855 1317.02 943.213 1317.31L943.125 1316.82C942.261 1316.97 941.398 1317.13 940.535 1317.28C939.758 1317.42 938.981 1317.56 938.205 1317.7L938.292 1318.19C936.653 1318.48 935.015 1318.76 933.379 1319.04L933.294 1318.55C931.658 1318.83 930.024 1319.11 928.392 1319.38L928.474 1319.87C926.841 1320.15 925.209 1320.42 923.579 1320.68L923.498 1320.19C921.863 1320.46 920.228 1320.72 918.596 1320.98L918.674 1321.47C917.021 1321.74 915.369 1322 913.719 1322.25L913.642 1321.76C911.993 1322.01 910.345 1322.26 908.698 1322.51L908.773 1323.01C907.126 1323.25 905.48 1323.5 903.837 1323.74L903.764 1323.24C902.121 1323.48 900.48 1323.72 898.841 1323.95L898.911 1324.44C897.27 1324.68 895.632 1324.9 893.995 1325.13L893.927 1324.63C892.289 1324.86 890.653 1325.08 889.019 1325.3L889.085 1325.79C887.424 1326.01 885.765 1326.23 884.107 1326.44L884.043 1325.95C882.387 1326.16 880.732 1326.37 879.079 1326.57L879.14 1327.07C877.486 1327.27 875.834 1327.47 874.185 1327.67L874.125 1327.17C872.476 1327.37 870.829 1327.56 869.184 1327.75L869.241 1328.25C867.595 1328.44 865.951 1328.62 864.309 1328.81L864.254 1328.31C862.612 1328.49 860.973 1328.67 859.336 1328.84L859.389 1329.34C857.721 1329.51 856.056 1329.69 854.393 1329.86L854.343 1329.36C852.68 1329.53 851.02 1329.69 849.361 1329.85L849.409 1330.35C847.75 1330.51 846.093 1330.67 844.439 1330.82L844.393 1330.32C842.739 1330.47 841.087 1330.62 839.438 1330.77L839.481 1331.26C837.831 1331.41 836.183 1331.55 834.537 1331.68L834.496 1331.19C832.85 1331.32 831.207 1331.45 829.566 1331.58L829.605 1332.08C827.932 1332.21 826.262 1332.34 824.594 1332.46L824.558 1331.96C822.891 1332.08 821.226 1332.2 819.564 1332.32L819.599 1332.82C817.936 1332.93 816.275 1333.04 814.618 1333.15L814.586 1332.65C812.929 1332.75 811.274 1332.85 809.622 1332.95L809.652 1333.45C807.999 1333.55 806.349 1333.64 804.701 1333.73L804.674 1333.23C803.022 1333.32 801.372 1333.41 799.724 1333.49L799.749 1333.99C798.073 1334.07 796.4 1334.15 794.73 1334.22L794.708 1333.72C793.039 1333.79 791.372 1333.86 789.709 1333.93L789.728 1334.43C788.064 1334.49 786.402 1334.56 784.743 1334.61L784.726 1334.11C783.068 1334.17 781.413 1334.22 779.76 1334.27L779.775 1334.77C778.122 1334.82 776.472 1334.86 774.824 1334.9L774.812 1334.4C773.15 1334.44 771.491 1334.48 769.835 1334.51L769.844 1335.01C768.168 1335.04 766.494 1335.07 764.824 1335.09L764.817 1334.59C763.148 1334.61 761.481 1334.63 759.818 1334.65L759.822 1335.15C758.158 1335.16 756.497 1335.17 754.84 1335.18L754.838 1334.68C753.182 1334.68 751.528 1334.68 749.878 1334.68L749.877 1335.18C748.226 1335.17 746.578 1335.17 744.934 1335.15L744.937 1334.65C743.263 1334.64 741.592 1334.62 739.924 1334.6L739.917 1335.1C738.243 1335.08 736.571 1335.05 734.903 1335.02L734.913 1334.52C733.246 1334.49 731.583 1334.46 729.923 1334.42L729.911 1334.92C728.25 1334.88 726.593 1334.83 724.94 1334.78L724.955 1334.28C723.302 1334.23 721.653 1334.18 720.008 1334.12L719.991 1334.62C718.331 1334.56 716.675 1334.5 715.023 1334.43L715.044 1333.93C713.367 1333.86 711.694 1333.79 710.025 1333.71L710.002 1334.21C708.332 1334.13 706.666 1334.04 705.004 1333.95L705.031 1333.46C703.37 1333.37 701.713 1333.27 700.06 1333.18L700.03 1333.68C698.377 1333.58 696.727 1333.47 695.081 1333.37L695.114 1332.87C693.469 1332.76 691.829 1332.65 690.192 1332.53L690.157 1333.03C688.479 1332.91 686.805 1332.79 685.136 1332.66L685.174 1332.16C683.506 1332.03 681.841 1331.89 680.181 1331.75L680.139 1332.25C678.478 1332.11 676.822 1331.97 675.17 1331.82L675.215 1331.32C673.564 1331.17 671.918 1331.02 670.276 1330.86L670.228 1331.35C668.585 1331.19 666.947 1331.03 665.313 1330.86L665.365 1330.36C663.699 1330.19 662.039 1330.01 660.383 1329.83L660.328 1330.33C658.661 1330.14 656.999 1329.95 655.342 1329.76L655.4 1329.26C653.744 1329.07 652.093 1328.87 650.447 1328.66L650.385 1329.16C648.738 1328.95 647.096 1328.74 645.459 1328.53L645.524 1328.03C643.888 1327.82 642.257 1327.6 640.631 1327.37L640.563 1327.87C638.906 1327.64 637.255 1327.4 635.609 1327.16L635.681 1326.67C634.021 1326.43 632.367 1326.18 630.718 1325.92L630.642 1326.42C628.992 1326.17 627.347 1325.91 625.709 1325.64L625.788 1325.15C624.151 1324.89 622.519 1324.62 620.892 1324.34L620.809 1324.83C619.181 1324.56 617.56 1324.28 615.944 1323.99L616.031 1323.5C614.383 1323.21 612.741 1322.91 611.105 1322.61L611.014 1323.1C609.363 1322.8 607.718 1322.49 606.08 1322.17L606.175 1321.68C604.537 1321.36 602.907 1321.04 601.282 1320.71L601.183 1321.2C599.557 1320.87 597.937 1320.54 596.324 1320.2L596.427 1319.71C594.815 1319.37 593.209 1319.03 591.61 1318.68L591.503 1319.17C589.859 1318.81 588.223 1318.44 586.592 1318.07L586.704 1317.58C585.07 1317.21 583.443 1316.83 581.823 1316.44L581.707 1316.93C580.086 1316.55 578.471 1316.15 576.864 1315.76L576.984 1315.27C575.378 1314.88 573.779 1314.47 572.187 1314.06L572.063 1314.55C570.458 1314.14 568.861 1313.72 567.272 1313.3L567.4 1312.81C565.773 1312.38 564.154 1311.94 562.542 1311.49L562.409 1311.98C560.796 1311.53 559.19 1311.08 557.593 1310.62L557.731 1310.14C556.135 1309.68 554.546 1309.21 552.966 1308.74L552.823 1309.22C551.241 1308.75 549.667 1308.27 548.101 1307.79L548.248 1307.31C546.649 1306.82 545.058 1306.31 543.476 1305.81L543.323 1306.28C541.723 1305.77 540.131 1305.25 538.549 1304.73L538.706 1304.25C537.125 1303.73 535.553 1303.19 533.989 1302.65L533.826 1303.13C532.261 1302.59 530.704 1302.04 529.156 1301.49L529.324 1301.02C527.763 1300.46 526.211 1299.9 524.667 1299.33L524.494 1299.8C522.913 1299.21 521.342 1298.62 519.78 1298.02L519.959 1297.55C518.399 1296.96 516.849 1296.35 515.309 1295.74L515.124 1296.2C513.582 1295.59 512.049 1294.97 510.526 1294.34L510.716 1293.88C509.193 1293.26 507.68 1292.62 506.176 1291.98L505.98 1292.44C504.426 1291.78 502.883 1291.11 501.351 1290.43L501.553 1289.98C500.022 1289.3 498.502 1288.62 496.993 1287.93L496.785 1288.38C495.274 1287.69 493.773 1286.99 492.284 1286.28L492.498 1285.83C491.011 1285.13 489.534 1284.41 488.069 1283.69L487.849 1284.14C486.334 1283.4 484.832 1282.65 483.342 1281.89L483.569 1281.44C482.077 1280.68 480.597 1279.91 479.13 1279.14L478.896 1279.58C477.426 1278.8 475.969 1278.02 474.523 1277.23L474.763 1276.79C473.32 1276 471.888 1275.2 470.469 1274.39L470.222 1274.82C468.755 1273.99 467.301 1273.15 465.86 1272.3L466.114 1271.87C464.674 1271.02 463.246 1270.16 461.832 1269.29L461.571 1269.72C460.155 1268.85 458.752 1267.97 457.362 1267.09L457.631 1266.67C456.238 1265.78 454.86 1264.89 453.495 1263.98L453.219 1264.4C451.812 1263.47 450.42 1262.53 449.042 1261.58L449.325 1261.17C447.95 1260.22 446.59 1259.27 445.244 1258.31L444.953 1258.71C443.605 1257.75 442.271 1256.77 440.952 1255.79L441.251 1255.39C439.919 1254.4 438.603 1253.4 437.302 1252.39L436.995 1252.78C435.667 1251.75 434.355 1250.71 433.06 1249.66L433.374 1249.27C432.081 1248.22 430.804 1247.17 429.543 1246.1L429.221 1246.48C427.957 1245.42 426.71 1244.34 425.48 1243.25L425.811 1242.88C424.556 1241.77 423.319 1240.66 422.099 1239.53L421.76 1239.9C420.53 1238.76 419.317 1237.62 418.122 1236.46L418.47 1236.1C417.277 1234.95 416.103 1233.79 414.946 1232.62L414.591 1232.97C413.424 1231.79 412.276 1230.6 411.146 1229.4L411.51 1229.06C410.362 1227.84 409.234 1226.61 408.125 1225.37L407.752 1225.7C406.64 1224.46 405.548 1223.21 404.474 1221.95L404.855 1221.63C403.784 1220.37 402.733 1219.1 401.701 1217.82L401.312 1218.14C400.261 1216.84 399.23 1215.52 398.22 1214.2L398.617 1213.9C397.606 1212.58 396.615 1211.25 395.645 1209.9L395.24 1210.2C394.267 1208.85 393.315 1207.49 392.384 1206.13L392.797 1205.85C391.864 1204.48 390.951 1203.09 390.059 1201.7L389.638 1201.97C388.738 1200.57 387.859 1199.16 387.002 1197.73L387.431 1197.47C386.576 1196.05 385.744 1194.62 384.933 1193.18L384.497 1193.42C383.683 1191.98 382.892 1190.52 382.122 1189.05L382.565 1188.82C381.794 1187.35 381.046 1185.87 380.32 1184.38L379.871 1184.6C379.143 1183.11 378.438 1181.6 377.755 1180.09L378.211 1179.88C377.531 1178.37 376.873 1176.85 376.238 1175.32L375.776 1175.51C375.141 1173.98 374.529 1172.44 373.94 1170.89L374.407 1170.71C373.82 1169.16 373.257 1167.61 372.716 1166.04L372.243 1166.2C371.701 1164.63 371.182 1163.05 370.686 1161.46L371.164 1161.31C370.917 1160.52 370.675 1159.72 370.44 1158.92C370.205 1158.13 369.976 1157.33 369.753 1156.53L369.272 1156.66C368.825 1155.05 368.403 1153.44 368.007 1151.83L368.492 1151.71C368.097 1150.1 367.726 1148.49 367.381 1146.87L366.892 1146.97C366.545 1145.35 366.223 1143.72 365.926 1142.09L366.418 1142C366.121 1140.37 365.849 1138.74 365.601 1137.1L365.107 1137.17C364.859 1135.53 364.635 1133.89 364.436 1132.23L364.933 1132.18C364.734 1130.53 364.561 1128.88 364.411 1127.23L363.913 1127.27C363.764 1125.62 363.639 1123.97 363.538 1122.31L364.037 1122.28C363.937 1120.63 363.86 1118.98 363.808 1117.32L363.308 1117.34C363.255 1115.68 363.226 1114.01 363.221 1112.34L363.721 1112.34C363.716 1110.69 363.734 1109.03 363.775 1107.38L363.275 1107.36C363.317 1105.71 363.381 1104.06 363.468 1102.4L363.967 1102.42C364.054 1100.77 364.164 1099.11 364.296 1097.45L363.798 1097.41C363.93 1095.76 364.085 1094.1 364.262 1092.43L364.759 1092.49C364.934 1090.85 365.129 1089.22 365.347 1087.58L364.851 1087.51C365.069 1085.87 365.308 1084.23 365.569 1082.58L366.063 1082.66C366.324 1081.02 366.605 1079.37 366.908 1077.73L366.417 1077.64C366.715 1076.02 367.034 1074.39 367.374 1072.77L367.863 1072.87C368.2 1071.26 368.557 1069.65 368.934 1068.03L368.447 1067.92C368.825 1066.3 369.222 1064.68 369.64 1063.06L370.124 1063.18C370.539 1061.58 370.973 1059.97 371.426 1058.36L370.945 1058.22C371.39 1056.64 371.854 1055.06 372.336 1053.48L372.814 1053.63C373.295 1052.05 373.795 1050.47 374.314 1048.89L373.839 1048.73C374.358 1047.15 374.896 1045.56 375.453 1043.97L375.925 1044.14C376.47 1042.58 377.033 1041.03 377.613 1039.47L377.145 1039.3C377.72 1037.76 378.312 1036.22 378.921 1034.67L379.386 1034.86C379.994 1033.32 380.619 1031.78 381.262 1030.24L380.8 1030.04C381.443 1028.5 382.104 1026.96 382.781 1025.41L383.239 1025.61C383.896 1024.11 384.569 1022.61 385.258 1021.11L384.804 1020.91C385.492 1019.41 386.195 1017.91 386.914 1016.41L387.365 1016.63C388.083 1015.14 388.816 1013.64 389.565 1012.14L389.118 1011.92C389.868 1010.42 390.632 1008.93 391.413 1007.43L391.856 1007.66C392.611 1006.22 393.38 1004.77 394.164 1003.32L393.724 1003.08C394.509 1001.63 395.308 1000.18 396.122 998.733L396.558 998.978C397.37 997.53 398.197 996.082 399.038 994.635L398.605 994.384C399.446 992.937 400.3 991.491 401.169 990.044L401.597 990.302C402.438 988.902 403.292 987.502 404.159 986.103L403.734 985.84C404.602 984.438 405.483 983.037 406.378 981.637L406.799 981.906C407.693 980.507 408.599 979.109 409.518 977.711L409.1 977.436C410.021 976.036 410.954 974.637 411.901 973.238L412.315 973.518C413.231 972.164 414.158 970.811 415.098 969.458L414.688 969.173C415.627 967.82 416.579 966.469 417.543 965.118L417.95 965.408C418.912 964.058 419.887 962.709 420.873 961.361L420.469 961.066C421.457 959.716 422.456 958.367 423.467 957.018L423.867 957.318C424.854 956.002 425.852 954.686 426.862 953.371L426.465 953.066C427.466 951.763 428.478 950.46 429.5 949.158L429.894 949.466C430.915 948.166 431.948 946.866 432.991 945.567L432.601 945.254C433.646 943.953 434.701 942.653 435.767 941.355L436.154 941.672C437.208 940.388 438.273 939.104 439.349 937.821L438.966 937.5C440.019 936.244 441.082 934.989 442.156 933.734L442.535 934.06C443.608 932.807 444.69 931.555 445.782 930.304L445.406 929.975C446.499 928.723 447.602 927.472 448.715 926.221L449.089 926.554C450.201 925.305 451.323 924.057 452.455 922.811L452.084 922.475C453.19 921.257 454.306 920.04 455.43 918.824L455.797 919.163C456.913 917.957 458.038 916.751 459.172 915.547L458.808 915.204C459.944 913.999 461.088 912.795 462.241 911.592L462.602 911.938C463.755 910.736 464.916 909.536 466.087 908.336L465.729 907.987C466.897 906.791 468.074 905.595 469.259 904.401L469.614 904.754C470.768 903.592 471.93 902.432 473.1 901.272L472.748 900.917C473.92 899.757 475.1 898.598 476.288 897.441L476.637 897.799C477.824 896.643 479.019 895.488 480.223 894.334L479.877 893.973C481.082 892.818 482.295 891.665 483.516 890.513L483.86 890.877C485.07 889.735 486.288 888.595 487.515 887.457L487.175 887.09C488.378 885.974 489.588 884.859 490.806 883.745L491.144 884.114C492.361 883.001 493.586 881.89 494.819 880.78L494.484 880.408C495.718 879.297 496.959 878.188 498.208 877.08L498.54 877.454C499.788 876.347 501.043 875.242 502.306 874.138L501.977 873.762C503.23 872.667 504.49 871.574 505.757 870.482L506.083 870.861C507.327 869.79 508.578 868.721 509.835 867.653L509.512 867.272C510.77 866.203 512.036 865.136 513.309 864.07L513.63 864.454C514.902 863.389 516.181 862.326 517.467 861.264L517.148 860.879C518.435 859.816 519.729 858.756 521.03 857.697L521.345 858.085C522.637 857.033 523.936 855.983 525.241 854.935L524.928 854.545C526.209 853.517 527.496 852.49 528.79 851.465L529.1 851.857C530.393 850.833 531.692 849.81 532.998 848.789L532.69 848.395C533.997 847.373 535.31 846.353 536.63 845.335L536.935 845.731C538.254 844.713 539.58 843.698 540.911 842.683L540.608 842.286C541.94 841.271 543.279 840.259 544.624 839.248L544.924 839.648C546.235 838.662 547.553 837.678 548.876 836.696L548.578 836.294C549.903 835.312 551.233 834.331 552.569 833.351L552.865 833.755C554.2 832.776 555.542 831.799 556.889 830.824L556.596 830.419C557.945 829.443 559.299 828.469 560.659 827.498L560.95 827.904C562.309 826.933 563.674 825.963 565.045 824.996L564.757 824.587C566.108 823.634 567.465 822.682 568.827 821.733L569.113 822.143C570.463 821.201 571.819 820.262 573.181 819.324L572.897 818.912C574.26 817.974 575.627 817.038 577.001 816.103L577.282 816.517C578.655 815.583 580.033 814.651 581.416 813.721L581.137 813.306C582.522 812.375 583.911 811.446 585.307 810.52L585.583 810.936C586.973 810.013 588.367 809.093 589.767 808.174L589.493 807.756C590.868 806.853 592.248 805.953 593.633 805.054L593.905 805.474C595.29 804.576 596.679 803.68 598.074 802.786L597.804 802.365C599.199 801.47 600.6 800.577 602.006 799.687L602.273 800.109C603.678 799.219 605.088 798.331 606.503 797.444L606.238 797.021C607.653 796.134 609.074 795.249 610.5 794.367L610.763 794.792C612.172 793.92 613.585 793.05 615.003 792.182L614.742 791.756C616.148 790.896 617.558 790.038 618.973 789.182L619.232 789.61C620.646 788.754 622.065 787.9 623.489 787.049L623.232 786.62C624.657 785.768 626.086 784.918 627.52 784.07L627.775 784.5C629.208 783.653 630.646 782.807 632.088 781.964L631.836 781.532C633.279 780.689 634.727 779.847 636.18 779.008L636.43 779.441C637.858 778.615 639.29 777.792 640.727 776.971L640.479 776.537C641.912 775.718 643.349 774.902 644.79 774.087L645.036 774.522C646.477 773.708 647.922 772.896 649.371 772.086L649.128 771.65C650.578 770.84 652.032 770.032 653.491 769.226L653.733 769.663C655.191 768.858 656.654 768.054 658.12 767.253L657.881 766.814C659.348 766.012 660.82 765.213 662.296 764.415L662.534 764.855C663.982 764.073 665.434 763.293 666.891 762.515L666.655 762.074C668.112 761.296 669.573 760.52 671.037 759.746L671.271 760.188C672.735 759.415 674.203 758.644 675.675 757.874L675.444 757.431C676.916 756.662 678.393 755.895 679.874 755.13L680.104 755.574C681.584 754.809 683.068 754.047 684.556 753.287L684.329 752.841C685.817 752.081 687.31 751.323 688.806 750.567L689.032 751.013C690.501 750.271 691.975 749.531 693.452 748.793L693.229 748.346C694.706 747.607 696.188 746.871 697.674 746.138L697.895 746.586C699.38 745.852 700.868 745.121 702.361 744.392L702.141 743.943C703.634 743.213 705.131 742.486 706.631 741.762L706.849 742.212C708.349 741.487 709.852 740.765 711.36 740.045L711.144 739.594C712.652 738.874 714.164 738.156 715.679 737.44L715.892 737.892C717.383 737.188 718.877 736.487 720.375 735.787L720.163 735.334C721.66 734.635 723.161 733.938 724.665 733.244L724.874 733.697C726.378 733.003 727.885 732.311 729.395 731.622L729.187 731.167C730.698 730.477 732.213 729.789 733.731 729.104L733.937 729.559C735.454 728.874 736.975 728.192 738.499 727.511L738.295 727.055C739.82 726.374 741.348 725.696 742.88 725.02L743.082 725.477C744.594 724.81 746.11 724.145 747.629 723.482L747.429 723.024C748.943 722.363 750.46 721.705 751.981 721.049L752.179 721.508C753.699 720.852 755.222 720.199 756.749 719.548L756.553 719.088C758.08 718.437 759.61 717.788 761.144 717.141L761.338 717.602C762.871 716.956 764.407 716.312 765.946 715.671L765.754 715.209C767.294 714.567 768.837 713.928 770.384 713.291L770.574 713.753C772.108 713.121 773.646 712.492 775.186 711.865L774.998 711.402C776.527 710.779 778.06 710.159 779.595 709.541L779.782 710.005C781.317 709.387 782.855 708.772 784.396 708.159L784.211 707.694C785.753 707.081 787.298 706.471 788.845 705.862L789.028 706.328C790.575 705.72 792.125 705.114 793.678 704.511L793.497 704.045C795.051 703.442 796.608 702.841 798.167 702.242L798.346 702.709C799.902 702.112 801.461 701.517 803.023 700.925L802.846 700.458C804.389 699.872 805.936 699.29 807.485 698.709L807.66 699.178C809.209 698.598 810.76 698.02 812.314 697.445L812.141 696.976C813.695 696.4 815.253 695.827 816.813 695.257L816.985 695.727C818.545 695.156 820.107 694.589 821.672 694.023L821.503 693.553C823.068 692.988 824.637 692.425 826.209 691.864L826.377 692.335C827.947 691.775 829.521 691.217 831.097 690.662L830.931 690.19C832.494 689.64 834.059 689.092 835.628 688.546L835.792 689.018C837.353 688.476 838.916 687.935 840.482 687.397L840.319 686.924C841.886 686.386 843.455 685.851 845.027 685.318L845.188 685.791C846.759 685.258 848.332 684.728 849.909 684.2L849.75 683.726C851.327 683.198 852.907 682.672 854.489 682.149L854.646 682.624C856.227 682.101 857.811 681.581 859.398 681.064L859.243 680.588C860.827 680.071 862.414 679.557 864.004 679.045L864.157 679.521C865.729 679.015 867.303 678.511 868.88 678.01L868.729 677.534C870.306 677.033 871.886 676.534 873.468 676.038L873.617 676.515C875.199 676.019 876.783 675.526 878.369 675.035L878.221 674.558C879.808 674.067 881.398 673.578 882.989 673.093L883.135 673.571C884.726 673.085 886.32 672.603 887.916 672.122L887.772 671.643C889.368 671.163 890.967 670.685 892.568 670.21L892.71 670.689C893.511 670.452 894.311 670.215 895.113 669.978C895.914 669.742 896.715 669.507 897.516 669.273L897.376 668.793C898.979 668.324 900.581 667.858 902.183 667.396L902.322 667.876C903.923 667.414 905.524 666.956 907.124 666.501L906.987 666.02C908.588 665.565 910.188 665.113 911.787 664.665L911.922 665.146C913.521 664.698 915.119 664.253 916.717 663.812L916.584 663.33C918.182 662.889 919.78 662.451 921.377 662.017L921.508 662.499C923.104 662.065 924.7 661.634 926.295 661.207L926.166 660.724C927.779 660.292 929.391 659.863 931.003 659.438L931.131 659.922C932.744 659.496 934.357 659.074 935.969 658.655L935.844 658.171C937.457 657.753 939.069 657.337 940.68 656.926L940.804 657.41C942.414 656.999 944.024 656.591 945.633 656.186L945.511 655.701C947.121 655.297 948.73 654.896 950.338 654.498L950.458 654.984C952.065 654.586 953.672 654.192 955.277 653.802L955.159 653.316C956.773 652.924 958.385 652.535 959.997 652.15L960.113 652.637C961.738 652.248 963.363 651.863 964.987 651.482L964.872 650.995C966.496 650.614 968.12 650.236 969.742 649.862L969.854 650.349C971.476 649.975 973.097 649.605 974.716 649.238L974.606 648.75C976.226 648.383 977.846 648.02 979.464 647.66L979.572 648.148C981.19 647.789 982.807 647.433 984.422 647.08L984.316 646.592C985.932 646.239 987.547 645.89 989.161 645.544L989.266 646.033C990.899 645.684 992.532 645.338 994.163 644.996L994.06 644.506C995.695 644.163 997.329 643.824 998.961 643.488L999.062 643.978C1000.69 643.642 1002.32 643.31 1003.95 642.982L1003.86 642.492C1005.49 642.164 1007.11 641.839 1008.74 641.518L1008.84 642.008C1010.47 641.688 1012.09 641.37 1013.72 641.057L1013.62 640.566C1015.25 640.252 1016.87 639.942 1018.49 639.636L1018.59 640.127C1020.22 639.818 1021.85 639.513 1023.49 639.212L1023.39 638.721C1025.04 638.417 1026.68 638.117 1028.32 637.821L1028.41 638.313C1030.05 638.017 1031.69 637.725 1033.33 637.436L1033.25 636.944C1034.89 636.655 1036.52 636.371 1038.16 636.089L1038.24 636.582C1039.88 636.301 1041.51 636.024 1043.15 635.751L1043.06 635.257C1044.7 634.984 1046.33 634.714 1047.96 634.448L1048.04 634.941C1049.68 634.674 1051.31 634.411 1052.94 634.151L1052.86 633.658C1054.52 633.395 1056.17 633.136 1057.82 632.881L1057.9 633.375C1059.55 633.12 1061.19 632.869 1062.84 632.621L1062.77 632.127C1064.41 631.879 1066.06 631.636 1067.7 631.396L1067.77 631.891C1069.42 631.651 1071.06 631.415 1072.7 631.183L1072.63 630.688C1074.27 630.456 1075.91 630.227 1077.54 630.003L1077.61 630.498C1079.25 630.274 1080.88 630.053 1082.52 629.836L1082.45 629.34C1084.11 629.119 1085.77 628.903 1087.43 628.69L1087.49 629.186C1089.15 628.973 1090.81 628.765 1092.46 628.56L1092.4 628.064C1094.05 627.859 1095.7 627.658 1097.35 627.461L1097.41 627.958C1099.06 627.761 1100.71 627.568 1102.35 627.379L1102.3 626.882C1103.94 626.693 1105.59 626.508 1107.23 626.326L1107.28 626.823C1108.93 626.642 1110.56 626.465 1112.2 626.291L1112.15 625.794C1113.82 625.618 1115.48 625.445 1117.14 625.277L1117.2 625.774C1118.86 625.606 1120.52 625.441 1122.18 625.281L1122.13 624.783C1123.79 624.623 1125.44 624.466 1127.1 624.314L1127.14 624.812C1128.8 624.659 1130.45 624.511 1132.1 624.367L1132.06 623.869C1133.71 623.725 1135.35 623.584 1137 623.448L1137.04 623.946C1138.69 623.81 1140.33 623.678 1141.97 623.549L1141.93 623.051C1143.61 622.92 1145.28 622.794 1146.94 622.671L1146.98 623.17C1148.65 623.048 1150.31 622.93 1151.97 622.816L1151.94 622.317C1153.6 622.203 1155.26 622.093 1156.92 621.987L1156.95 622.486C1158.61 622.38 1160.26 622.279 1161.92 622.182L1161.89 621.682C1163.54 621.585 1165.19 621.492 1166.84 621.402L1166.86 621.902C1168.52 621.812 1170.17 621.727 1171.81 621.646L1171.79 621.146C1173.46 621.064 1175.14 620.986 1176.81 620.912L1176.83 621.411C1178.5 621.337 1180.17 621.268 1181.83 621.203L1181.81 620.703C1183.47 620.638 1185.14 620.577 1186.79 620.52L1186.81 621.019C1188.47 620.963 1190.13 620.91 1191.78 620.862L1191.76 620.362C1193.42 620.314 1195.07 620.27 1196.71 620.23L1196.73 620.73C1198.39 620.69 1200.05 620.654 1201.7 620.623L1201.69 620.123C1203.37 620.091 1205.04 620.064 1206.71 620.041L1206.72 620.541C1208.39 620.518 1210.06 620.5 1211.72 620.486L1211.72 619.986C1213.38 619.972 1215.04 619.962 1216.7 619.957L1216.7 620.457C1218.36 620.451 1220.01 620.451 1221.66 620.454L1221.66 619.954C1223.31 619.958 1224.96 619.966 1226.6 619.978L1226.6 620.478C1228.28 620.491 1229.95 620.508 1231.61 620.53L1231.62 620.03C1233.3 620.052 1234.97 620.079 1236.63 620.11L1236.63 620.61C1238.29 620.641 1239.96 620.676 1241.61 620.717L1241.63 620.217C1243.29 620.257 1244.94 620.302 1246.6 620.351L1246.58 620.851C1248.24 620.9 1249.88 620.954 1251.53 621.013L1251.55 620.513C1253.21 620.572 1254.86 620.636 1256.51 620.704L1256.49 621.204C1258.17 621.273 1259.84 621.347 1261.51 621.426L1261.54 620.927C1263.21 621.005 1264.87 621.089 1266.53 621.178L1266.51 621.677C1268.17 621.765 1269.83 621.858 1271.48 621.956L1271.51 621.457C1273.16 621.555 1274.81 621.658 1276.46 621.765L1276.42 622.264C1278.07 622.372 1279.71 622.484 1281.35 622.601L1281.38 622.102C1283.06 622.222 1284.73 622.347 1286.4 622.476L1286.36 622.975C1288.03 623.105 1289.7 623.239 1291.36 623.379L1291.4 622.881C1293.06 623.02 1294.72 623.165 1296.37 623.315L1296.32 623.813C1297.97 623.962 1299.62 624.117 1301.26 624.276L1301.31 623.779C1302.95 623.938 1304.59 624.103 1306.22 624.272L1306.17 624.769C1307.84 624.942 1309.5 625.12 1311.15 625.303L1311.21 624.806C1312.88 624.99 1314.54 625.179 1316.2 625.374L1316.14 625.87C1317.79 626.065 1319.44 626.264 1321.09 626.469L1321.15 625.973C1322.8 626.178 1324.44 626.388 1326.08 626.603L1326.01 627.099C1327.65 627.314 1329.28 627.534 1330.91 627.76L1330.97 627.264C1332.63 627.494 1334.28 627.729 1335.93 627.969L1335.86 628.464C1337.52 628.706 1339.17 628.954 1340.82 629.207L1340.9 628.713C1342.55 628.966 1344.19 629.225 1345.83 629.489L1345.75 629.983C1347.39 630.247 1349.02 630.516 1350.65 630.791L1350.73 630.298C1352.36 630.573 1353.98 630.853 1355.59 631.139L1355.51 631.632C1357.16 631.923 1358.8 632.22 1360.43 632.522L1360.52 632.031C1362.18 632.336 1363.82 632.647 1365.46 632.964L1365.36 633.455C1367 633.771 1368.63 634.093 1370.26 634.421L1370.35 633.931C1371.98 634.259 1373.6 634.592 1375.21 634.932L1375.11 635.421C1376.72 635.76 1378.33 636.105 1379.93 636.455L1380.03 635.967C1381.68 636.327 1383.32 636.693 1384.95 637.065L1384.83 637.552C1386.47 637.925 1388.1 638.304 1389.72 638.688L1389.83 638.202C1391.45 638.587 1393.07 638.978 1394.67 639.375L1394.55 639.86C1396.16 640.257 1397.76 640.659 1399.35 641.068L1399.48 640.583C1401.08 640.995 1402.68 641.413 1404.27 641.836L1404.14 642.319C1405.76 642.753 1407.38 643.193 1409 643.639L1409.13 643.157C1410.74 643.603 1412.35 644.056 1413.95 644.515L1413.81 644.996C1415.4 645.454 1416.99 645.919 1418.57 646.39L1418.71 645.911C1420.3 646.383 1421.87 646.861 1423.44 647.345L1423.29 647.822C1424.89 648.317 1426.48 648.817 1428.06 649.325L1428.21 648.849C1429.81 649.361 1431.41 649.881 1432.99 650.407L1432.83 650.882C1434.41 651.407 1435.99 651.939 1437.55 652.478L1437.71 652.005C1439.28 652.545 1440.83 653.091 1442.38 653.643L1442.21 654.114C1443.78 654.671 1445.33 655.235 1446.87 655.806L1447.04 655.337C1448.62 655.922 1450.2 656.513 1451.76 657.112L1451.58 657.579C1453.14 658.177 1454.69 658.782 1456.23 659.394L1456.41 658.929C1457.96 659.541 1459.49 660.161 1461.01 660.788L1460.82 661.25C1462.34 661.877 1463.86 662.51 1465.36 663.151L1465.56 662.691C1467.11 663.353 1468.65 664.022 1470.19 664.699L1469.99 665.157C1471.52 665.833 1473.04 666.516 1474.54 667.207L1474.75 666.752C1476.26 667.444 1477.76 668.143 1479.25 668.849L1479.04 669.301C1480.53 670.006 1482 670.719 1483.47 671.439L1483.69 670.991C1485.2 671.735 1486.71 672.486 1488.2 673.246L1487.97 673.691C1489.46 674.451 1490.94 675.219 1492.41 675.995L1492.64 675.553C1494.11 676.33 1495.57 677.114 1497.02 677.907L1496.77 678.345C1498.22 679.137 1499.65 679.936 1501.07 680.742L1501.32 680.308C1502.78 681.142 1504.24 681.984 1505.68 682.834L1505.42 683.265C1506.86 684.115 1508.29 684.974 1509.71 685.84L1509.97 685.414C1511.38 686.282 1512.79 687.159 1514.18 688.043L1513.91 688.465C1515.3 689.351 1516.68 690.246 1518.04 691.149L1518.32 690.732C1519.73 691.662 1521.12 692.602 1522.5 693.55L1522.21 693.961C1523.59 694.908 1524.95 695.863 1526.29 696.826L1526.58 696.42C1527.93 697.385 1529.27 698.359 1530.59 699.342L1530.29 699.743C1531.62 700.735 1532.93 701.737 1534.24 702.747L1534.54 702.352C1535.87 703.383 1537.18 704.423 1538.48 705.472L1538.16 705.861C1539.46 706.908 1540.73 707.964 1541.99 709.03L1542.32 708.648C1543.58 709.716 1544.83 710.792 1546.06 711.878L1545.73 712.253C1546.98 713.36 1548.22 714.477 1549.44 715.602L1549.78 715.235C1551.01 716.37 1552.22 717.515 1553.42 718.67L1553.07 719.03C1554.26 720.181 1555.43 721.343 1556.59 722.514L1556.95 722.162C1558.11 723.343 1559.26 724.534 1560.39 725.734L1560.03 726.077C1561.18 727.295 1562.3 728.523 1563.41 729.762L1563.79 729.428C1564.9 730.67 1565.99 731.921 1567.06 733.182L1566.68 733.506C1567.75 734.764 1568.81 736.032 1569.84 737.309L1570.23 736.995C1571.28 738.296 1572.31 739.608 1573.32 740.929L1572.92 741.233C1573.93 742.555 1574.92 743.887 1575.89 745.229L1576.3 744.936C1577.27 746.282 1578.22 747.639 1579.15 749.005L1578.74 749.286C1579.67 750.657 1580.59 752.037 1581.48 753.428L1581.9 753.158C1582.8 754.562 1583.68 755.977 1584.54 757.402L1584.11 757.66C1584.96 759.08 1585.79 760.511 1586.6 761.953L1587.04 761.707C1587.85 763.154 1588.65 764.611 1589.42 766.078L1588.97 766.31C1589.74 767.779 1590.49 769.259 1591.22 770.749L1591.67 770.53C1592.39 772.024 1593.1 773.529 1593.78 775.044L1593.33 775.249C1594.01 776.759 1594.67 778.28 1595.3 779.811L1595.76 779.619C1596.4 781.151 1597.01 782.693 1597.6 784.245L1597.13 784.422C1597.72 785.968 1598.28 787.525 1598.82 789.091L1599.29 788.928Z",stroke:"black",strokeDasharray:"5 5"}),M.jsx("path",{d:"M1968.7 731.766C1969.22 733.351 1969.72 734.942 1970.21 736.54L1969.73 736.686C1969.98 737.484 1970.22 738.283 1970.45 739.084C1970.69 739.885 1970.92 740.687 1971.15 741.49L1971.63 741.353C1972.09 742.961 1972.53 744.572 1972.95 746.186L1972.46 746.312C1972.89 747.923 1973.29 749.536 1973.68 751.152L1974.16 751.035C1974.55 752.655 1974.92 754.277 1975.28 755.902L1974.79 756.008C1975.14 757.63 1975.48 759.254 1975.8 760.882L1976.29 760.785C1976.62 762.417 1976.92 764.052 1977.21 765.689L1976.72 765.776C1976.85 766.513 1976.97 767.251 1977.1 767.99C1977.25 768.89 1977.39 769.791 1977.53 770.693L1978.03 770.617C1978.28 772.262 1978.52 773.909 1978.74 775.56L1978.25 775.626C1978.47 777.273 1978.67 778.923 1978.86 780.575L1979.36 780.518C1979.55 782.173 1979.72 783.831 1979.88 785.491L1979.38 785.538C1979.54 787.191 1979.68 788.847 1979.8 790.505L1980.3 790.468C1980.42 792.122 1980.53 793.779 1980.62 795.438L1980.12 795.466C1980.21 797.121 1980.28 798.779 1980.34 800.44L1980.84 800.422C1980.9 802.086 1980.94 803.751 1980.97 805.419L1980.47 805.427C1980.49 807.092 1980.51 808.759 1980.5 810.428L1981 810.429C1980.99 812.096 1980.97 813.764 1980.94 815.435L1980.44 815.424C1980.4 817.074 1980.35 818.725 1980.28 820.379L1980.78 820.399C1980.71 822.056 1980.63 823.714 1980.53 825.375L1980.03 825.345C1979.94 827.003 1979.82 828.662 1979.7 830.323L1980.19 830.362C1980.07 832.026 1979.92 833.692 1979.76 835.359L1979.27 835.312C1979.11 836.974 1978.93 838.639 1978.75 840.305L1979.24 840.361C1979.06 841.998 1978.86 843.637 1978.64 845.277L1978.15 845.212C1977.93 846.849 1977.71 848.488 1977.46 850.129L1977.96 850.202C1977.72 851.845 1977.46 853.49 1977.19 855.136L1976.7 855.054C1976.42 856.698 1976.14 858.343 1975.84 859.989L1976.33 860.078C1976.03 861.727 1975.72 863.378 1975.39 865.03L1974.9 864.932C1974.58 866.549 1974.24 868.167 1973.89 869.786L1974.38 869.891C1974.04 871.504 1973.68 873.117 1973.3 874.732L1972.82 874.619C1972.44 876.231 1972.06 877.845 1971.66 879.459L1972.14 879.579C1971.74 881.196 1971.33 882.814 1970.9 884.433L1970.42 884.306C1969.99 885.923 1969.55 887.541 1969.1 889.159L1969.58 889.294C1969.13 890.899 1968.67 892.505 1968.19 894.111L1967.72 893.97C1967.5 894.709 1967.28 895.448 1967.05 896.187C1966.8 897.022 1966.54 897.858 1966.28 898.694L1966.76 898.842C1966.27 900.42 1965.77 901.998 1965.25 903.577L1964.78 903.423C1964.26 905 1963.74 906.578 1963.2 908.157L1963.67 908.318C1963.13 909.899 1962.58 911.481 1962.02 913.064L1961.55 912.896C1960.98 914.476 1960.41 916.057 1959.82 917.639L1960.29 917.813C1959.72 919.359 1959.13 920.905 1958.54 922.452L1958.07 922.272C1957.48 923.805 1956.87 925.339 1956.26 926.873L1956.72 927.059C1956.11 928.595 1955.48 930.132 1954.85 931.669L1954.38 931.477C1953.75 933.013 1953.1 934.549 1952.44 936.085L1952.9 936.282C1952.24 937.82 1951.57 939.359 1950.89 940.898L1950.43 940.696C1949.75 942.233 1949.06 943.771 1948.35 945.309L1948.81 945.517C1948.13 947.006 1947.44 948.495 1946.73 949.985L1946.28 949.772C1945.58 951.26 1944.87 952.748 1944.15 954.236L1944.6 954.454C1943.88 955.944 1943.14 957.434 1942.4 958.925L1941.95 958.702C1941.21 960.191 1940.46 961.68 1939.7 963.17L1940.14 963.397C1939.38 964.888 1938.61 966.38 1937.82 967.871L1937.38 967.639C1936.6 969.127 1935.81 970.616 1935 972.105L1935.44 972.342C1934.67 973.783 1933.88 975.224 1933.09 976.665L1932.65 976.424C1932.39 976.896 1932.13 977.368 1931.86 977.84C1931.33 978.808 1930.78 979.775 1930.24 980.743L1930.67 980.989C1929.86 982.43 1929.03 983.872 1928.2 985.313L1927.77 985.063C1926.94 986.503 1926.1 987.943 1925.24 989.383L1925.68 989.637C1924.82 991.079 1923.96 992.52 1923.09 993.962L1922.67 993.703C1921.8 995.143 1920.92 996.583 1920.03 998.023L1920.46 998.286C1919.59 999.685 1918.72 1001.08 1917.84 1002.48L1917.42 1002.22C1916.54 1003.61 1915.66 1005 1914.77 1006.39L1915.19 1006.66C1914.3 1008.05 1913.4 1009.44 1912.49 1010.83L1912.07 1010.56C1911.16 1011.95 1910.24 1013.34 1909.32 1014.73L1909.73 1015.01C1908.81 1016.4 1907.87 1017.79 1906.93 1019.18L1906.52 1018.9C1905.57 1020.29 1904.62 1021.68 1903.66 1023.07L1904.08 1023.35C1903.13 1024.72 1902.18 1026.09 1901.21 1027.46L1900.81 1027.17C1900.48 1027.64 1900.15 1028.1 1899.82 1028.57C1899.2 1029.44 1898.58 1030.32 1897.95 1031.19L1898.36 1031.48C1897.4 1032.82 1896.44 1034.16 1895.46 1035.51L1895.06 1035.21C1894.08 1036.55 1893.1 1037.89 1892.11 1039.23L1892.51 1039.53C1891.52 1040.87 1890.53 1042.21 1889.52 1043.55L1889.12 1043.25C1888.64 1043.89 1888.16 1044.53 1887.68 1045.16C1887.15 1045.86 1886.62 1046.56 1886.08 1047.26L1886.48 1047.57C1885.46 1048.91 1884.43 1050.24 1883.4 1051.58L1883 1051.28C1881.99 1052.58 1880.98 1053.88 1879.96 1055.18L1880.35 1055.49C1879.34 1056.78 1878.31 1058.07 1877.28 1059.36L1876.89 1059.05C1875.86 1060.34 1874.83 1061.63 1873.78 1062.92L1874.17 1063.24C1873.13 1064.53 1872.08 1065.82 1871.02 1067.11L1870.63 1066.79C1869.58 1068.08 1868.51 1069.37 1867.44 1070.66L1867.83 1070.98C1866.75 1072.27 1865.67 1073.56 1864.59 1074.84L1864.21 1074.52C1863.12 1075.81 1862.03 1077.1 1860.93 1078.38L1861.31 1078.71C1860.24 1079.95 1859.17 1081.2 1858.09 1082.44L1857.72 1082.12C1856.64 1083.36 1855.56 1084.6 1854.47 1085.85L1854.84 1086.17C1853.75 1087.42 1852.66 1088.66 1851.55 1089.9L1851.18 1089.57C1850.08 1090.81 1848.97 1092.05 1847.85 1093.29L1848.22 1093.63C1847.11 1094.87 1845.99 1096.11 1844.86 1097.35L1844.49 1097.01C1843.36 1098.25 1842.23 1099.48 1841.09 1100.72L1841.45 1101.06C1840.31 1102.3 1839.16 1103.54 1838.01 1104.77L1837.64 1104.43C1836.52 1105.63 1835.4 1106.83 1834.26 1108.03L1834.63 1108.38C1833.5 1109.57 1832.36 1110.77 1831.22 1111.97L1830.86 1111.62C1829.72 1112.81 1828.57 1114.01 1827.42 1115.2L1827.78 1115.55C1826.63 1116.74 1825.47 1117.94 1824.3 1119.13L1823.94 1118.78C1823.41 1119.32 1822.88 1119.86 1822.35 1120.4C1821.71 1121.05 1821.07 1121.7 1820.43 1122.35L1820.79 1122.7C1819.61 1123.89 1818.43 1125.08 1817.24 1126.27L1816.89 1125.92C1815.7 1127.11 1814.51 1128.3 1813.31 1129.48L1813.66 1129.84C1812.48 1131.01 1811.3 1132.17 1810.11 1133.34L1809.76 1132.98C1808.58 1134.13 1807.4 1135.28 1806.22 1136.43L1806.57 1136.79C1805.38 1137.94 1804.19 1139.08 1803 1140.23L1802.65 1139.87C1801.45 1141.02 1800.25 1142.16 1799.05 1143.31L1799.39 1143.67C1798.19 1144.82 1796.97 1145.96 1795.76 1147.11L1795.41 1146.74C1794.2 1147.88 1792.97 1149.03 1791.75 1150.17L1792.09 1150.53C1790.86 1151.68 1789.63 1152.82 1788.39 1153.96L1788.05 1153.59C1786.81 1154.73 1785.57 1155.87 1784.32 1157.01L1784.66 1157.38C1783.45 1158.48 1782.23 1159.59 1781.01 1160.69L1780.67 1160.32C1780.14 1160.8 1779.61 1161.28 1779.08 1161.76C1778.38 1162.38 1777.69 1163 1776.99 1163.63L1777.32 1164C1776.09 1165.1 1774.85 1166.21 1773.61 1167.31L1773.28 1166.93C1772.95 1167.22 1772.62 1167.52 1772.29 1167.81C1771.37 1168.62 1770.46 1169.42 1769.54 1170.23L1769.87 1170.61C1768.62 1171.7 1767.36 1172.8 1766.1 1173.9L1765.77 1173.52C1764.51 1174.62 1763.24 1175.71 1761.97 1176.81L1762.29 1177.19C1761.02 1178.28 1759.75 1179.38 1758.46 1180.47L1758.14 1180.09C1756.87 1181.18 1755.59 1182.26 1754.31 1183.34L1754.63 1183.72C1753.38 1184.79 1752.12 1185.85 1750.85 1186.91L1750.53 1186.52C1749.27 1187.58 1748 1188.64 1746.73 1189.7L1747.05 1190.08C1745.77 1191.14 1744.5 1192.19 1743.21 1193.25L1742.9 1192.86C1741.61 1193.92 1740.33 1194.97 1739.04 1196.03L1739.35 1196.41C1738.06 1197.47 1736.76 1198.52 1735.46 1199.57L1735.15 1199.18C1733.85 1200.23 1732.55 1201.28 1731.24 1202.33L1731.55 1202.72C1730.24 1203.77 1728.93 1204.82 1727.61 1205.87L1727.3 1205.48C1725.99 1206.52 1724.68 1207.56 1723.36 1208.59L1723.67 1208.99C1722.38 1210 1721.08 1211.02 1719.78 1212.04L1719.47 1211.64C1718.85 1212.13 1718.22 1212.62 1717.59 1213.11C1716.92 1213.63 1716.24 1214.16 1715.56 1214.69L1715.87 1215.08C1714.56 1216.1 1713.24 1217.11 1711.93 1218.12L1711.62 1217.72C1710.31 1218.74 1708.99 1219.75 1707.66 1220.76L1707.96 1221.15C1706.64 1222.16 1705.31 1223.17 1703.98 1224.18L1703.67 1223.78C1702.34 1224.79 1701 1225.79 1699.66 1226.8L1699.96 1227.2C1698.62 1228.2 1697.28 1229.21 1695.93 1230.21L1695.63 1229.81C1694.28 1230.81 1692.93 1231.81 1691.57 1232.81L1691.87 1233.21C1690.55 1234.19 1689.22 1235.17 1687.89 1236.14L1687.59 1235.74C1686.26 1236.71 1684.93 1237.68 1683.59 1238.65L1683.88 1239.06C1682.54 1240.03 1681.2 1241 1679.85 1241.97L1679.56 1241.56C1678.21 1242.53 1676.86 1243.5 1675.51 1244.47L1675.8 1244.88C1674.45 1245.84 1673.09 1246.81 1671.72 1247.77L1671.44 1247.37C1670.07 1248.33 1668.71 1249.3 1667.34 1250.26L1667.63 1250.67C1666.26 1251.63 1664.88 1252.59 1663.51 1253.55L1663.22 1253.14C1661.84 1254.1 1660.46 1255.06 1659.08 1256.02L1659.36 1256.43C1658 1257.38 1656.63 1258.32 1655.26 1259.26L1654.98 1258.85C1653.62 1259.78 1652.26 1260.71 1650.89 1261.64L1651.18 1262.06C1649.81 1262.99 1648.44 1263.92 1647.07 1264.85L1646.79 1264.43C1645.41 1265.36 1644.04 1266.29 1642.66 1267.21L1642.94 1267.63C1641.56 1268.56 1640.17 1269.48 1638.79 1270.4L1638.51 1269.99C1637.12 1270.91 1635.73 1271.84 1634.34 1272.76L1634.62 1273.17C1633.22 1274.1 1631.82 1275.02 1630.42 1275.94L1630.15 1275.52C1629.62 1275.87 1629.09 1276.22 1628.55 1276.56C1627.68 1277.13 1626.81 1277.7 1625.94 1278.27L1626.21 1278.69C1624.8 1279.61 1623.39 1280.52 1621.98 1281.44L1621.71 1281.02C1620.32 1281.91 1618.94 1282.8 1617.55 1283.7L1617.82 1284.12C1616.43 1285.01 1615.04 1285.9 1613.64 1286.79L1613.37 1286.37C1611.98 1287.25 1610.58 1288.14 1609.18 1289.03L1609.44 1289.45C1608.04 1290.34 1606.64 1291.22 1605.23 1292.11L1604.96 1291.69C1603.55 1292.57 1602.14 1293.45 1600.73 1294.34L1600.99 1294.76C1599.58 1295.64 1598.16 1296.52 1596.74 1297.4L1596.47 1296.98C1595.05 1297.86 1593.63 1298.74 1592.2 1299.61L1592.46 1300.04C1591.03 1300.92 1589.6 1301.79 1588.17 1302.67L1587.91 1302.24C1586.48 1303.11 1585.05 1303.98 1583.61 1304.85L1583.87 1305.28C1582.46 1306.13 1581.05 1306.98 1579.63 1307.83L1579.37 1307.4C1577.96 1308.26 1576.54 1309.1 1575.12 1309.95L1575.37 1310.38C1573.95 1311.23 1572.53 1312.08 1571.1 1312.93L1570.84 1312.49C1569.42 1313.34 1567.98 1314.19 1566.55 1315.03L1566.8 1315.46C1565.37 1316.3 1563.93 1317.15 1562.49 1317.99L1562.24 1317.56C1560.8 1318.4 1559.36 1319.24 1557.91 1320.08L1558.16 1320.51C1556.72 1321.35 1555.27 1322.18 1553.82 1323.02L1553.57 1322.59C1552.11 1323.42 1550.66 1324.26 1549.2 1325.09L1549.45 1325.52C1548 1326.36 1546.54 1327.18 1545.08 1328.01L1544.84 1327.58C1543.4 1328.39 1541.97 1329.2 1540.53 1330.02L1540.77 1330.45C1539.33 1331.26 1537.89 1332.07 1536.45 1332.88L1536.2 1332.45C1534.76 1333.25 1533.31 1334.06 1531.86 1334.87L1532.1 1335.31C1530.65 1336.11 1529.2 1336.92 1527.74 1337.72L1527.5 1337.28C1526.04 1338.09 1524.58 1338.89 1523.12 1339.69L1523.36 1340.13C1521.9 1340.93 1520.43 1341.73 1518.97 1342.53L1518.73 1342.09C1517.26 1342.89 1515.79 1343.69 1514.32 1344.48L1514.56 1344.92C1513.08 1345.72 1511.61 1346.51 1510.13 1347.31L1509.89 1346.87C1508.41 1347.66 1506.93 1348.45 1505.45 1349.24L1505.68 1349.68C1504.23 1350.46 1502.77 1351.23 1501.31 1352.01L1501.07 1351.56C1500.45 1351.89 1499.83 1352.22 1499.2 1352.55C1498.36 1353 1497.52 1353.44 1496.68 1353.88L1496.92 1354.32C1495.45 1355.09 1493.98 1355.86 1492.51 1356.63L1492.28 1356.19C1490.81 1356.95 1489.34 1357.72 1487.86 1358.48L1488.09 1358.93C1486.61 1359.69 1485.13 1360.46 1483.65 1361.22L1483.42 1360.78C1481.94 1361.54 1480.46 1362.3 1478.97 1363.06L1479.2 1363.5C1477.71 1364.26 1476.23 1365.02 1474.73 1365.78L1474.51 1365.33C1473.81 1365.69 1473.11 1366.04 1472.41 1366.39C1471.62 1366.8 1470.82 1367.2 1470.03 1367.6L1470.25 1368.05C1468.75 1368.8 1467.25 1369.55 1465.75 1370.3L1465.53 1369.86C1464.04 1370.6 1462.56 1371.34 1461.07 1372.08L1461.29 1372.53C1459.81 1373.27 1458.33 1374 1456.84 1374.73L1456.62 1374.28C1455.14 1375.02 1453.65 1375.75 1452.16 1376.48L1452.38 1376.93C1450.89 1377.66 1449.4 1378.39 1447.91 1379.11L1447.69 1378.66C1446.97 1379.01 1446.25 1379.36 1445.53 1379.71C1444.76 1380.09 1443.98 1380.46 1443.2 1380.84L1443.42 1381.29C1441.92 1382.01 1440.42 1382.74 1438.92 1383.46L1438.7 1383.01C1437.86 1383.41 1437.02 1383.81 1436.18 1384.22C1435.51 1384.53 1434.85 1384.85 1434.18 1385.17L1434.4 1385.62C1432.89 1386.34 1431.38 1387.06 1429.87 1387.77L1429.65 1387.32C1428.14 1388.04 1426.62 1388.75 1425.11 1389.46L1425.32 1389.92C1423.8 1390.63 1422.28 1391.34 1420.76 1392.05L1420.55 1391.6C1419.06 1392.3 1417.56 1392.99 1416.06 1393.69L1416.27 1394.14C1414.77 1394.84 1413.26 1395.53 1411.76 1396.22L1411.55 1395.77C1410.04 1396.46 1408.54 1397.15 1407.03 1397.84L1407.24 1398.3C1405.73 1398.99 1404.21 1399.68 1402.7 1400.36L1402.49 1399.91C1400.98 1400.6 1399.46 1401.28 1397.94 1401.97L1398.15 1402.42C1396.63 1403.11 1395.11 1403.79 1393.59 1404.47L1393.38 1404.01C1391.86 1404.7 1390.34 1405.38 1388.81 1406.05L1389.01 1406.51C1387.48 1407.19 1385.95 1407.87 1384.42 1408.54L1384.22 1408.09C1382.69 1408.76 1381.16 1409.44 1379.62 1410.11L1379.82 1410.57C1378.29 1411.24 1376.76 1411.9 1375.23 1412.57L1375.03 1412.11C1373.52 1412.77 1372 1413.43 1370.48 1414.08L1370.68 1414.54C1369.16 1415.2 1367.64 1415.86 1366.11 1416.51L1365.91 1416.05C1364.39 1416.7 1362.86 1417.35 1361.34 1418.01L1361.53 1418.47C1360 1419.12 1358.47 1419.77 1356.94 1420.41L1356.75 1419.95C1355.22 1420.6 1353.68 1421.25 1352.15 1421.89L1352.34 1422.35C1350.8 1423 1349.26 1423.64 1347.72 1424.28L1347.53 1423.82C1345.99 1424.46 1344.45 1425.1 1342.91 1425.74L1343.1 1426.2C1341.55 1426.84 1340.01 1427.48 1338.46 1428.12L1338.27 1427.65C1336.72 1428.29 1335.17 1428.93 1333.62 1429.56L1333.81 1430.02C1332.26 1430.65 1330.72 1431.28 1329.17 1431.9L1328.99 1431.44C1327.45 1432.06 1325.92 1432.68 1324.38 1433.3L1324.57 1433.76C1323.03 1434.38 1321.49 1435 1319.95 1435.61L1319.77 1435.15C1318.23 1435.76 1316.68 1436.37 1315.14 1436.99L1315.32 1437.45C1313.78 1438.06 1312.23 1438.67 1310.68 1439.28L1310.5 1438.82C1308.95 1439.42 1307.4 1440.03 1305.85 1440.64L1306.03 1441.1C1304.48 1441.71 1302.93 1442.31 1301.37 1442.92L1301.19 1442.45C1299.64 1443.05 1298.08 1443.66 1296.52 1444.25L1296.7 1444.72C1295.14 1445.32 1293.58 1445.92 1292.01 1446.52L1291.83 1446.05C1290.27 1446.65 1288.71 1447.24 1287.14 1447.84L1287.32 1448.3C1285.76 1448.89 1284.2 1449.48 1282.64 1450.07L1282.46 1449.6C1280.91 1450.18 1279.36 1450.77 1277.81 1451.34L1277.99 1451.81C1276.44 1452.39 1274.88 1452.97 1273.33 1453.55L1273.15 1453.08C1271.6 1453.65 1270.04 1454.23 1268.48 1454.8L1268.65 1455.27C1267.09 1455.85 1265.53 1456.42 1263.97 1456.99L1263.8 1456.52C1262.24 1457.09 1260.67 1457.66 1259.11 1458.22L1259.28 1458.69C1257.71 1459.26 1256.14 1459.83 1254.57 1460.39L1254.4 1459.92C1252.83 1460.49 1251.26 1461.05 1249.69 1461.61L1249.86 1462.08C1248.28 1462.64 1246.71 1463.2 1245.13 1463.76L1244.96 1463.29C1244.24 1463.54 1243.52 1463.8 1242.8 1464.05C1241.94 1464.36 1241.09 1464.66 1240.23 1464.96L1240.4 1465.43C1238.82 1465.98 1237.24 1466.54 1235.67 1467.09L1235.5 1466.61C1233.94 1467.16 1232.37 1467.7 1230.81 1468.24L1230.97 1468.71C1229.41 1469.26 1227.84 1469.8 1226.27 1470.33L1226.11 1469.86C1224.54 1470.4 1222.97 1470.94 1221.4 1471.47L1221.56 1471.95C1219.98 1472.48 1218.41 1473.01 1216.83 1473.55L1216.67 1473.07C1215.1 1473.61 1213.52 1474.14 1211.94 1474.67L1212.1 1475.14C1210.52 1475.67 1208.94 1476.2 1207.36 1476.72L1207.2 1476.25C1206.09 1476.62 1204.97 1476.99 1203.85 1477.36C1203.39 1477.51 1202.92 1477.67 1202.45 1477.82L1202.61 1478.3C1201.02 1478.82 1199.44 1479.34 1197.85 1479.86L1197.69 1479.39C1196.1 1479.9 1194.51 1480.42 1192.92 1480.94L1193.08 1481.42C1191.48 1481.93 1189.89 1482.45 1188.3 1482.96L1188.14 1482.48C1186.57 1482.99 1184.99 1483.5 1183.41 1484L1183.56 1484.48C1181.98 1484.98 1180.4 1485.48 1178.82 1485.98L1178.67 1485.51C1178.11 1485.68 1177.56 1485.86 1177 1486.04C1175.97 1486.36 1174.95 1486.68 1173.92 1487.01L1174.07 1487.48C1172.49 1487.98 1170.9 1488.48 1169.32 1488.97L1169.17 1488.49C1167.58 1488.99 1165.99 1489.48 1164.4 1489.97L1164.55 1490.45C1162.96 1490.94 1161.37 1491.43 1159.77 1491.92L1159.63 1491.44C1158.03 1491.93 1156.44 1492.41 1154.84 1492.9L1154.99 1493.38C1153.39 1493.86 1151.79 1494.35 1150.19 1494.83L1150.05 1494.35C1148.45 1494.83 1146.85 1495.31 1145.25 1495.79L1145.39 1496.27C1143.79 1496.75 1142.18 1497.22 1140.58 1497.7L1140.44 1497.22C1139.63 1497.46 1138.83 1497.69 1138.03 1497.93C1137.22 1498.17 1136.42 1498.4 1135.62 1498.64L1135.76 1499.12C1134.15 1499.59 1132.54 1500.06 1130.94 1500.53L1130.8 1500.05C1129.19 1500.51 1127.59 1500.98 1125.98 1501.44L1126.12 1501.92C1124.52 1502.39 1122.91 1502.85 1121.31 1503.3L1121.17 1502.82C1119.57 1503.28 1117.96 1503.74 1116.36 1504.19L1116.5 1504.67C1114.89 1505.13 1113.29 1505.58 1111.69 1506.03L1111.55 1505.55C1110.92 1505.73 1110.28 1505.9 1109.65 1506.08C1108.68 1506.35 1107.71 1506.62 1106.75 1506.89L1106.88 1507.37C1105.28 1507.82 1103.68 1508.26 1102.08 1508.7L1101.94 1508.22C1100.34 1508.66 1098.74 1509.1 1097.14 1509.54L1097.27 1510.02C1095.67 1510.46 1094.07 1510.89 1092.47 1511.32L1092.34 1510.84C1090.74 1511.27 1089.14 1511.7 1087.54 1512.13L1087.67 1512.62C1086.06 1513.05 1084.44 1513.48 1082.82 1513.91L1082.69 1513.43C1081.07 1513.86 1079.46 1514.28 1077.84 1514.71L1077.97 1515.19C1076.35 1515.62 1074.73 1516.04 1073.12 1516.46L1072.99 1515.98C1071.38 1516.4 1069.76 1516.82 1068.15 1517.23L1068.27 1517.72C1066.66 1518.13 1065.04 1518.55 1063.43 1518.96L1063.31 1518.47C1061.69 1518.89 1060.08 1519.29 1058.47 1519.7L1058.59 1520.19C1056.98 1520.59 1055.37 1521 1053.76 1521.4L1053.63 1520.92C1052.02 1521.32 1050.41 1521.72 1048.8 1522.12L1048.92 1522.6C1047.31 1523 1045.7 1523.4 1044.09 1523.79L1043.97 1523.31C1043.4 1523.45 1042.82 1523.59 1042.24 1523.73C1041.21 1523.98 1040.18 1524.23 1039.15 1524.48L1039.27 1524.97C1037.64 1525.36 1036.02 1525.76 1034.39 1526.15L1034.28 1525.66C1032.65 1526.05 1031.02 1526.44 1029.39 1526.82L1029.51 1527.31C1027.88 1527.7 1026.26 1528.08 1024.63 1528.46L1024.52 1527.98L1023.46 1528.22C1022.19 1528.52 1020.91 1528.82 1019.64 1529.11L1019.75 1529.6C1018.13 1529.98 1016.5 1530.35 1014.88 1530.73L1014.77 1530.24L1014.34 1530.34C1012.86 1530.68 1011.38 1531.01 1009.9 1531.35L1010.01 1531.84C1008.39 1532.21 1006.77 1532.57 1005.14 1532.94L1005.04 1532.45C1003.41 1532.81 1001.79 1533.17 1000.18 1533.53L1000.28 1534.02C998.664 1534.38 997.045 1534.74 995.426 1535.09L995.319 1534.6C993.701 1534.96 992.084 1535.31 990.467 1535.66L990.573 1536.15C988.943 1536.5 987.313 1536.86 985.684 1537.2L985.58 1536.72C983.941 1537.07 982.304 1537.41 980.667 1537.76L980.77 1538.25C979.133 1538.6 977.496 1538.94 975.861 1539.28L975.758 1538.79C974.582 1539.04 973.405 1539.28 972.229 1539.53C971.771 1539.62 971.313 1539.72 970.854 1539.81L970.955 1540.3C969.321 1540.64 967.688 1540.97 966.055 1541.31L965.955 1540.82C964.323 1541.15 962.691 1541.48 961.06 1541.81L961.159 1542.3C959.528 1542.63 957.898 1542.95 956.268 1543.28L956.171 1542.79C954.541 1543.11 952.913 1543.43 951.286 1543.75L951.382 1544.24C949.754 1544.56 948.127 1544.88 946.5 1545.19L946.405 1544.7C944.78 1545.01 943.155 1545.33 941.53 1545.64L941.624 1546.13C939.986 1546.44 938.348 1546.75 936.712 1547.06L936.619 1546.57C934.972 1546.88 933.326 1547.18 931.68 1547.49L931.771 1547.98C930.125 1548.29 928.48 1548.59 926.836 1548.89L926.746 1548.4C925.102 1548.7 923.459 1549 921.817 1549.29L921.906 1549.78C920.263 1550.08 918.622 1550.37 916.981 1550.67L916.894 1550.17C915.254 1550.47 913.615 1550.75 911.976 1551.04L912.063 1551.53C910.424 1551.82 908.786 1552.1 907.149 1552.39L907.064 1551.89C905.428 1552.18 903.792 1552.46 902.158 1552.73L902.242 1553.23C900.607 1553.5 898.973 1553.78 897.34 1554.05L897.257 1553.56C895.625 1553.83 893.993 1554.1 892.363 1554.37L892.444 1554.86C890.795 1555.13 889.147 1555.4 887.5 1555.67L887.421 1555.18C885.765 1555.44 884.111 1555.71 882.458 1555.97L882.537 1556.46C880.883 1556.73 879.231 1556.99 877.58 1557.25L877.502 1556.75C875.851 1557.01 874.202 1557.27 872.553 1557.52L872.629 1558.01C870.979 1558.27 869.331 1558.52 867.684 1558.77L867.61 1558.27C865.963 1558.52 864.317 1558.77 862.673 1559.01L862.746 1559.51C861.101 1559.75 859.457 1559.99 857.815 1560.23L857.743 1559.74C856.1 1559.97 854.459 1560.21 852.819 1560.45L852.89 1560.94C851.249 1561.17 849.61 1561.41 847.972 1561.64L847.902 1561.14C846.264 1561.37 844.628 1561.6 842.992 1561.82L843.06 1562.32C841.397 1562.55 839.736 1562.77 838.075 1563L838.009 1562.5C836.347 1562.72 834.687 1562.95 833.028 1563.16L833.093 1563.66C831.434 1563.88 829.775 1564.1 828.118 1564.31L828.054 1563.81C826.398 1564.03 824.742 1564.24 823.088 1564.45L823.151 1564.94C821.496 1565.15 819.843 1565.36 818.191 1565.56L818.129 1565.07C816.478 1565.27 814.827 1565.47 813.178 1565.67L813.238 1566.17C811.589 1566.37 809.94 1566.57 808.293 1566.76L808.235 1566.26C807.537 1566.35 806.841 1566.43 806.144 1566.51C805.195 1566.62 804.247 1566.73 803.299 1566.84L803.356 1567.34C801.711 1567.53 800.068 1567.71 798.426 1567.9L798.37 1567.4C796.717 1567.59 795.065 1567.77 793.414 1567.95L793.469 1568.45C791.799 1568.63 790.131 1568.81 788.465 1568.99L788.412 1568.49C786.745 1568.67 785.081 1568.85 783.417 1569.02L783.469 1569.52C781.805 1569.69 780.143 1569.86 778.482 1570.03L778.431 1569.53C776.771 1569.7 775.112 1569.86 773.454 1570.03L773.503 1570.52C771.844 1570.69 770.188 1570.85 768.532 1571.01L768.485 1570.51C766.83 1570.67 765.176 1570.82 763.524 1570.97L763.571 1571.47C761.918 1571.62 760.267 1571.77 758.618 1571.92L758.573 1571.42C756.924 1571.57 755.276 1571.72 753.63 1571.86L753.673 1572.36C752.026 1572.5 750.381 1572.64 748.737 1572.78L748.695 1572.28C747.02 1572.42 745.346 1572.56 743.674 1572.69L743.714 1573.19C742.042 1573.33 740.371 1573.46 738.701 1573.59L738.662 1573.09C736.993 1573.22 735.326 1573.35 733.66 1573.47L733.698 1573.97C732.031 1574.1 730.367 1574.22 728.704 1574.34L728.668 1573.84C727.005 1573.96 725.344 1574.08 723.685 1574.19L723.719 1574.69C722.06 1574.81 720.401 1574.92 718.745 1575.03L718.712 1574.53C717.056 1574.64 715.402 1574.74 713.749 1574.85L713.78 1575.35C712.127 1575.45 710.476 1575.55 708.826 1575.65L708.796 1575.15C707.146 1575.25 705.499 1575.35 703.853 1575.44L703.881 1575.94C702.207 1576.04 700.534 1576.13 698.864 1576.22L698.837 1575.72C697.16 1575.81 695.486 1575.9 693.813 1575.98L693.838 1576.48C692.164 1576.57 690.493 1576.65 688.823 1576.73L688.799 1576.23C687.13 1576.31 685.462 1576.39 683.796 1576.46L683.819 1576.96C682.152 1577.04 680.488 1577.11 678.825 1577.18L678.805 1576.68C677.142 1576.75 675.482 1576.81 673.824 1576.88L673.843 1577.37C672.184 1577.44 670.527 1577.5 668.872 1577.56L668.854 1577.06C667.199 1577.12 665.547 1577.17 663.896 1577.22L663.912 1577.72C662.26 1577.78 660.611 1577.83 658.963 1577.88L658.949 1577.38C657.273 1577.42 655.599 1577.47 653.927 1577.51L653.94 1578.01C652.26 1578.06 650.582 1578.1 648.907 1578.13L648.895 1577.63C647.22 1577.67 645.547 1577.71 643.876 1577.74L643.885 1578.24C642.214 1578.27 640.544 1578.3 638.876 1578.33L638.868 1577.83C637.201 1577.85 635.536 1577.88 633.874 1577.9L633.88 1578.4C632.216 1578.42 630.555 1578.44 628.896 1578.45L628.891 1577.95C627.232 1577.97 625.576 1577.98 623.921 1577.99L623.924 1578.49C622.269 1578.5 620.616 1578.51 618.965 1578.51L618.964 1578.01C617.313 1578.01 615.665 1578.02 614.019 1578.02L614.019 1578.52C612.335 1578.51 610.653 1578.51 608.974 1578.5L608.976 1578C607.296 1578 605.619 1577.99 603.944 1577.97L603.94 1578.47C602.264 1578.46 600.591 1578.45 598.919 1578.43L598.925 1577.93C597.254 1577.91 595.586 1577.89 593.92 1577.86L593.913 1578.36C592.246 1578.34 590.582 1578.31 588.92 1578.28L588.929 1577.78C587.268 1577.75 585.609 1577.72 583.952 1577.68L583.941 1578.18C582.284 1578.15 580.629 1578.11 578.976 1578.07L578.989 1577.57C577.337 1577.53 575.687 1577.48 574.04 1577.43L574.026 1577.93C572.364 1577.89 570.704 1577.84 569.047 1577.78L569.063 1577.28C567.381 1577.23 565.701 1577.17 564.023 1577.11L564.005 1577.61C562.327 1577.55 560.651 1577.49 558.978 1577.42L558.998 1576.92C557.326 1576.86 555.656 1576.79 553.989 1576.71L553.967 1577.21C552.299 1577.14 550.634 1577.07 548.971 1576.99L548.995 1576.49C547.333 1576.41 545.673 1576.33 544.016 1576.25L543.991 1576.74C542.334 1576.66 540.679 1576.57 539.026 1576.48L539.054 1575.98C537.402 1575.89 535.753 1575.8 534.107 1575.7L534.078 1576.2C532.431 1576.11 530.786 1576.01 529.145 1575.91L529.176 1575.41C527.495 1575.3 525.818 1575.2 524.143 1575.09L524.11 1575.58C522.431 1575.47 520.756 1575.36 519.083 1575.24L519.118 1574.74C517.446 1574.63 515.777 1574.51 514.111 1574.38L514.074 1574.88C512.407 1574.76 510.743 1574.63 509.082 1574.5L509.121 1574C507.461 1573.87 505.803 1573.74 504.149 1573.61L504.108 1574.1C502.453 1573.97 500.8 1573.83 499.151 1573.69L499.194 1573.19C497.545 1573.05 495.899 1572.9 494.256 1572.75L494.211 1573.25C492.568 1573.1 490.927 1572.95 489.29 1572.8L489.337 1572.3C488.566 1572.23 487.797 1572.15 487.028 1572.08C486.13 1571.99 485.234 1571.91 484.338 1571.82L484.289 1572.31C482.614 1572.15 480.941 1571.98 479.272 1571.81L479.323 1571.31C477.654 1571.14 475.989 1570.97 474.327 1570.79L474.273 1571.28C472.61 1571.11 470.951 1570.92 469.294 1570.74L469.35 1570.24C467.694 1570.06 466.041 1569.87 464.392 1569.68L464.334 1570.18C462.684 1569.98 461.038 1569.79 459.394 1569.59L459.454 1569.1C457.811 1568.9 456.172 1568.7 454.536 1568.49L454.474 1568.99C452.837 1568.79 451.203 1568.58 449.573 1568.37L449.637 1567.87C447.973 1567.66 446.313 1567.44 444.656 1567.22L444.59 1567.71C442.92 1567.49 441.254 1567.26 439.591 1567.03L439.66 1566.54C437.998 1566.31 436.34 1566.07 434.685 1565.83L434.614 1566.33C432.959 1566.09 431.307 1565.85 429.659 1565.61L429.732 1565.11C428.085 1564.87 426.441 1564.62 424.801 1564.37L424.725 1564.87C423.085 1564.61 421.447 1564.36 419.814 1564.1L419.892 1563.61C418.259 1563.35 416.63 1563.09 415.004 1562.83L414.924 1563.32C413.298 1563.05 411.675 1562.79 410.057 1562.52L410.139 1562.02C408.474 1561.74 406.813 1561.46 405.156 1561.17L405.071 1561.67C403.412 1561.38 401.756 1561.09 400.105 1560.8L400.193 1560.3C398.542 1560.01 396.896 1559.71 395.254 1559.41L395.163 1559.9C393.52 1559.6 391.881 1559.3 390.246 1558.99L390.339 1558.5C388.704 1558.19 387.074 1557.88 385.448 1557.57L385.353 1558.06C383.726 1557.74 382.103 1557.42 380.484 1557.1L380.582 1556.61C378.964 1556.29 377.35 1555.96 375.74 1555.63L375.64 1556.12C374.008 1555.79 372.38 1555.45 370.756 1555.11L370.859 1554.62C369.208 1554.27 367.561 1553.92 365.919 1553.57L365.813 1554.06C364.17 1553.7 362.531 1553.34 360.897 1552.98L361.005 1552.49C359.372 1552.13 357.743 1551.76 356.118 1551.39L356.007 1551.88C354.382 1551.51 352.761 1551.14 351.145 1550.76L351.259 1550.27C349.643 1549.9 348.033 1549.51 346.427 1549.13L346.31 1549.62C344.703 1549.23 343.1 1548.84 341.503 1548.45L341.622 1547.96C340.019 1547.57 338.42 1547.17 336.827 1546.77L336.705 1547.26C335.064 1546.84 333.429 1546.43 331.799 1546L331.924 1545.52C330.295 1545.1 328.67 1544.67 327.051 1544.25L326.923 1544.73C325.303 1544.3 323.687 1543.87 322.077 1543.43L322.208 1542.95C320.599 1542.51 318.995 1542.07 317.396 1541.62L317.262 1542.11C315.661 1541.66 314.066 1541.21 312.477 1540.76L312.614 1540.28C311.025 1539.83 309.441 1539.37 307.862 1538.91L307.722 1539.39C306.141 1538.93 304.564 1538.46 302.993 1537.99L303.136 1537.51C301.515 1537.03 299.9 1536.54 298.29 1536.05L298.143 1536.53C296.532 1536.03 294.927 1535.53 293.327 1535.03L293.477 1534.56C291.878 1534.06 290.285 1533.55 288.697 1533.04L288.545 1533.52C286.956 1533.01 285.373 1532.49 283.796 1531.97L283.952 1531.5C282.376 1530.98 280.805 1530.46 279.24 1529.93L279.081 1530.41C277.515 1529.88 275.955 1529.35 274.4 1528.81L274.563 1528.34C273 1527.8 271.443 1527.26 269.891 1526.71L269.725 1527.18C268.129 1526.62 266.539 1526.05 264.955 1525.48L265.125 1525.01C263.542 1524.44 261.966 1523.87 260.396 1523.29L260.223 1523.76C258.651 1523.17 257.086 1522.59 255.528 1522L255.704 1521.53C254.147 1520.94 252.596 1520.35 251.051 1519.75L250.87 1520.22C249.324 1519.62 247.785 1519.02 246.251 1518.41L246.435 1517.95C244.903 1517.34 243.377 1516.73 241.858 1516.11L241.67 1516.58C240.12 1515.95 238.577 1515.32 237.04 1514.68L237.231 1514.22C235.672 1513.57 234.12 1512.92 232.575 1512.26L232.379 1512.72C230.833 1512.07 229.293 1511.4 227.76 1510.74L227.96 1510.28C226.428 1509.61 224.904 1508.94 223.387 1508.27L223.184 1508.72C221.665 1508.05 220.154 1507.37 218.649 1506.68L218.857 1506.23C217.354 1505.54 215.858 1504.85 214.369 1504.16L214.158 1504.61C212.659 1503.92 211.168 1503.21 209.684 1502.5L209.9 1502.05C208.373 1501.32 206.854 1500.59 205.343 1499.85L205.123 1500.3C203.611 1499.56 202.106 1498.82 200.609 1498.07L200.833 1497.62C199.337 1496.87 197.849 1496.12 196.369 1495.36L196.141 1495.81C194.66 1495.05 193.186 1494.28 191.721 1493.51L191.953 1493.07C190.489 1492.3 189.033 1491.53 187.584 1490.75L187.348 1491.19C185.898 1490.41 184.456 1489.63 183.022 1488.84L183.264 1488.4C181.782 1487.58 180.309 1486.76 178.844 1485.93L178.599 1486.37C177.131 1485.54 175.673 1484.71 174.223 1483.87L174.473 1483.44C173.025 1482.6 171.585 1481.76 170.155 1480.91L169.9 1481.34C168.467 1480.49 167.043 1479.63 165.629 1478.77L165.888 1478.35C164.475 1477.49 163.071 1476.62 161.675 1475.75L161.411 1476.18C160.013 1475.31 158.624 1474.43 157.245 1473.55L157.514 1473.13C156.089 1472.22 154.673 1471.3 153.267 1470.38L152.992 1470.8C151.585 1469.87 150.186 1468.94 148.798 1468.01L149.077 1467.59C147.69 1466.66 146.313 1465.72 144.945 1464.78L144.661 1465.19C143.292 1464.24 141.933 1463.29 140.583 1462.33L140.872 1461.93C139.524 1460.97 138.186 1460.01 136.858 1459.04L136.563 1459.45C135.223 1458.47 133.893 1457.49 132.572 1456.5L132.872 1456.1C131.52 1455.09 130.18 1454.07 128.85 1453.05L128.545 1453.45C127.213 1452.42 125.892 1451.39 124.581 1450.36L124.891 1449.96C123.583 1448.93 122.285 1447.89 120.997 1446.84L120.682 1447.23C119.393 1446.18 118.115 1445.13 116.847 1444.07L117.168 1443.69C115.902 1442.63 114.647 1441.56 113.403 1440.49L113.077 1440.87C111.807 1439.78 110.548 1438.68 109.301 1437.58L109.633 1437.2C108.374 1436.09 107.128 1434.97 105.893 1433.84L105.556 1434.21C104.319 1433.08 103.094 1431.95 101.88 1430.8L102.223 1430.44C101.011 1429.3 99.8118 1428.15 98.6239 1427L98.2758 1427.36C97.0861 1426.21 95.9083 1425.05 94.7424 1423.88L95.0961 1423.53C93.9251 1422.36 92.7662 1421.18 91.6194 1419.99L91.2603 1420.34C90.0887 1419.13 88.9297 1417.92 87.7834 1416.69L88.1482 1416.35C87.0039 1415.13 85.8722 1413.9 84.7534 1412.67L84.383 1413.01C83.2622 1411.77 82.1543 1410.53 81.0593 1409.28L81.4352 1408.95C80.342 1407.7 79.2617 1406.45 78.1943 1405.19L77.8128 1405.51C76.7436 1404.25 75.6874 1402.98 74.6442 1401.71L75.0311 1401.39C73.9693 1400.09 72.921 1398.79 71.8863 1397.48L71.4938 1397.79C70.4561 1396.47 69.4321 1395.15 68.4218 1393.82L68.8197 1393.52C67.8113 1392.19 66.8165 1390.86 65.8356 1389.52L65.4322 1389.82C64.4495 1388.47 63.4806 1387.13 62.5257 1385.77L62.9344 1385.48C61.9812 1384.13 61.0419 1382.77 60.1166 1381.4L59.7026 1381.68C58.7655 1380.3 57.8427 1378.91 56.9343 1377.51L57.3535 1377.24C56.4439 1375.84 55.5487 1374.43 54.6681 1373.02L54.2438 1373.29C53.3614 1371.87 52.4937 1370.45 51.6406 1369.02L52.07 1368.76C51.2185 1367.34 50.3817 1365.9 49.5597 1364.46L49.1254 1364.71C48.3018 1363.27 47.4929 1361.82 46.6988 1360.36L47.1378 1360.12C46.342 1358.66 45.5611 1357.19 44.7953 1355.72L44.3516 1355.95C43.5826 1354.47 42.8287 1352.99 42.09 1351.49L42.5382 1351.27C41.801 1349.78 41.079 1348.28 40.3722 1346.78L39.9197 1346.99C39.2115 1345.48 38.5186 1343.97 37.8411 1342.45L38.2978 1342.25C37.6216 1340.73 36.9608 1339.2 36.3155 1337.67L35.8547 1337.87C35.209 1336.34 34.5787 1334.8 33.964 1333.25L34.4286 1333.07C33.8157 1331.52 33.2182 1329.98 32.6363 1328.42L32.1681 1328.6C31.585 1327.04 31.0175 1325.48 30.4656 1323.9L30.9374 1323.74C30.3866 1322.17 29.8515 1320.6 29.3321 1319.01L28.8571 1319.17C28.3367 1317.59 27.832 1315.99 27.3431 1314.4L27.8212 1314.25C27.5773 1313.45 27.3373 1312.65 27.1013 1311.85C26.8651 1311.05 26.6332 1310.25 26.4055 1309.45L25.9245 1309.58C25.4684 1307.97 25.0294 1306.36 24.6072 1304.75L25.0909 1304.62C24.6695 1303.01 24.2651 1301.4 23.8773 1299.78L23.3912 1299.9C23.0027 1298.28 22.631 1296.66 22.276 1295.03L22.7645 1294.93C22.4103 1293.31 22.0728 1291.68 21.752 1290.05L21.2614 1290.15C20.9396 1288.52 20.6345 1286.88 20.346 1285.25L20.8384 1285.16C20.5501 1283.52 20.2785 1281.88 20.0234 1280.24L19.5294 1280.32C19.2738 1278.67 19.0349 1277.03 18.8125 1275.38L19.3081 1275.31C19.0861 1273.66 18.8808 1272.01 18.6919 1270.36L18.1951 1270.42C18.0058 1268.76 17.833 1267.11 17.6767 1265.45L18.1745 1265.4C18.0187 1263.74 17.8794 1262.09 17.7562 1260.43L17.2576 1260.47C17.1348 1258.81 17.0281 1257.16 16.9375 1255.5L17.4367 1255.47C17.3463 1253.81 17.272 1252.16 17.2136 1250.5L16.7139 1250.51C16.6554 1248.85 16.613 1247.18 16.5865 1245.52L17.0865 1245.51C17.06 1243.84 17.0496 1242.18 17.0549 1240.51L16.5549 1240.51C16.5603 1238.84 16.5815 1237.17 16.6184 1235.5L17.1183 1235.51C17.1547 1233.86 17.2065 1232.21 17.2736 1230.56L16.774 1230.54C16.8413 1228.88 16.9238 1227.22 17.0216 1225.56L17.5208 1225.59C17.6184 1223.93 17.7313 1222.27 17.8594 1220.61L17.3609 1220.57C17.4892 1218.91 17.6327 1217.24 17.7914 1215.58L18.2891 1215.62C18.4473 1213.96 18.6206 1212.3 18.8089 1210.63L18.3121 1210.57C18.4971 1208.94 18.6965 1207.3 18.9104 1205.66L19.4062 1205.72C19.6197 1204.09 19.8476 1202.45 20.0899 1200.81L19.5953 1200.73C19.8379 1199.09 20.0949 1197.45 20.3662 1195.8L20.8596 1195.88C21.1304 1194.24 21.4155 1192.59 21.7149 1190.95L21.2229 1190.86C21.5228 1189.21 21.8369 1187.56 22.1651 1185.91L22.6555 1186C22.9768 1184.39 23.3117 1182.77 23.6601 1181.15L23.1713 1181.04C23.5183 1179.43 23.8786 1177.82 24.2523 1176.2L24.7394 1176.32C25.1126 1174.7 25.499 1173.09 25.8988 1171.48L25.4134 1171.36C25.8138 1169.74 26.2274 1168.12 26.6543 1166.5L27.1378 1166.63C27.5641 1165.01 28.0036 1163.4 28.4563 1161.78L27.9747 1161.64C28.4235 1160.04 28.8851 1158.43 29.3597 1156.82L29.8392 1156.97C30.304 1155.39 30.7811 1153.82 31.2705 1152.24L30.793 1152.09C31.2832 1150.52 31.7856 1148.94 32.3004 1147.36L32.7758 1147.51C33.2898 1145.94 33.8161 1144.36 34.3546 1142.78L33.8814 1142.62C34.4207 1141.04 34.9722 1139.46 35.5359 1137.87L36.0069 1138.04C36.5698 1136.46 37.1449 1134.88 37.7321 1133.3L37.2634 1133.12C37.8371 1131.58 38.4224 1130.03 39.0193 1128.48L39.4857 1128.66C40.0772 1127.13 40.6799 1125.6 41.294 1124.06L40.8298 1123.88C41.4446 1122.34 42.0707 1120.8 42.708 1119.27L43.1699 1119.46C43.8065 1117.92 44.4542 1116.39 45.1132 1114.85L44.6537 1114.65C45.3134 1113.12 45.9844 1111.58 46.6665 1110.04L47.1236 1110.24C47.8049 1108.7 48.4973 1107.17 49.2009 1105.63L48.7462 1105.42C49.4272 1103.93 50.1186 1102.44 50.8203 1100.95L51.2727 1101.16C51.9734 1099.68 52.6845 1098.19 53.4059 1096.7L52.956 1096.48C53.6782 1094.99 54.4106 1093.5 55.1534 1092.01L55.6009 1092.23C56.3428 1090.75 57.095 1089.26 57.8574 1087.77L57.4123 1087.54C58.1755 1086.05 58.9489 1084.56 59.7324 1083.06L60.1751 1083.3C60.9572 1081.81 61.7494 1080.32 62.5518 1078.83L62.1116 1078.59C62.888 1077.15 63.6738 1075.71 64.4691 1074.27L64.9068 1074.51C65.7013 1073.07 66.5051 1071.63 67.3184 1070.19L66.883 1069.95C67.697 1068.51 68.5205 1067.06 69.3532 1065.62L69.7861 1065.87C70.6181 1064.43 71.4593 1062.99 72.3099 1061.55L71.8794 1061.3C72.7308 1059.86 73.5915 1058.42 74.4614 1056.97L74.8895 1057.23C75.7586 1055.79 76.637 1054.35 77.5246 1052.91L77.099 1052.65C77.9616 1051.25 78.833 1049.85 79.713 1048.45L80.1363 1048.72C81.0107 1047.33 81.8937 1045.94 82.7852 1044.55L82.3643 1044.28C83.2566 1042.89 84.1574 1041.49 85.0668 1040.1L85.4853 1040.38C86.3938 1038.99 87.3109 1037.6 88.2364 1036.21L87.8203 1035.93C88.7466 1034.54 89.6814 1033.15 90.6246 1031.76L91.0384 1032.04C91.9808 1030.65 92.9316 1029.26 93.8909 1027.87L93.4795 1027.59C94.425 1026.22 95.3787 1024.85 96.3404 1023.48L96.7495 1023.77C97.6921 1022.43 98.6425 1021.09 99.6006 1019.75L99.1938 1019.45C100.153 1018.11 101.119 1016.77 102.094 1015.43L102.498 1015.72C103.472 1014.38 104.454 1013.04 105.443 1011.7L105.041 1011.41C106.03 1010.07 107.028 1008.73 108.033 1007.39L108.433 1007.69C109.438 1006.35 110.45 1005.01 111.47 1003.67L111.072 1003.37C112.093 1002.03 113.122 1000.69 114.158 999.353L114.553 999.659C115.56 998.358 116.574 997.058 117.595 995.758L117.202 995.449C118.218 994.157 119.24 992.864 120.27 991.572L120.661 991.884C121.69 990.593 122.727 989.302 123.77 988.012L123.381 987.698C124.425 986.407 125.476 985.116 126.534 983.826L126.921 984.143C127.978 982.854 129.043 981.565 130.114 980.277L129.73 979.957C130.802 978.668 131.881 977.38 132.967 976.092L133.349 976.414C134.434 975.127 135.527 973.84 136.626 972.554L136.246 972.229C137.311 970.983 138.383 969.737 139.461 968.492L139.839 968.819C140.916 967.576 141.999 966.333 143.088 965.091L142.712 964.761C143.802 963.518 144.899 962.276 146.002 961.034L146.376 961.366C147.478 960.125 148.587 958.885 149.702 957.645L149.33 957.311C150.446 956.07 151.568 954.83 152.697 953.591L153.066 953.928C154.194 952.689 155.328 951.451 156.469 950.214L156.101 949.875C157.243 948.637 158.39 947.4 159.544 946.163L159.91 946.504C161.031 945.303 162.158 944.102 163.292 942.901L162.928 942.558C164.058 941.362 165.193 940.166 166.334 938.971L166.696 939.316C167.837 938.122 168.983 936.928 170.136 935.735L169.776 935.387C170.929 934.194 172.088 933.001 173.253 931.808L173.611 932.158C174.775 930.966 175.945 929.775 177.121 928.585L176.765 928.234C177.942 927.043 179.124 925.853 180.312 924.663L180.666 925.017C181.853 923.828 183.046 922.64 184.245 921.453L183.894 921.097C185.073 919.93 186.257 918.764 187.447 917.598L187.797 917.955C188.971 916.805 190.15 915.656 191.335 914.508L190.987 914.149C192.172 913 193.363 911.852 194.559 910.705L194.905 911.066C196.1 909.919 197.301 908.773 198.507 907.628L198.162 907.265C199.369 906.12 200.581 904.975 201.798 903.831L202.141 904.195C203.358 903.052 204.58 901.909 205.807 900.767L205.467 900.401C206.695 899.259 207.928 898.117 209.166 896.977L209.505 897.345C210.742 896.205 211.984 895.067 213.232 893.93L212.895 893.56C214.108 892.454 215.326 891.349 216.549 890.245L216.884 890.616C218.106 889.513 219.333 888.41 220.565 887.308L220.232 886.935C221.465 885.833 222.702 884.731 223.945 883.63L224.276 884.005C225.518 882.905 226.765 881.805 228.017 880.707L227.687 880.331C228.94 879.232 230.197 878.134 231.459 877.037L231.787 877.414C233.048 876.318 234.315 875.222 235.586 874.127L235.26 873.748C236.532 872.653 237.808 871.559 239.09 870.466L239.415 870.846C240.686 869.761 241.963 868.677 243.244 867.594L242.921 867.212C244.177 866.151 245.436 865.09 246.701 864.031L247.022 864.414C248.286 863.356 249.554 862.298 250.827 861.241L250.508 860.856C251.781 859.798 253.059 858.742 254.342 857.686L254.66 858.072C255.942 857.017 257.228 855.963 258.519 854.91L258.203 854.523C259.494 853.469 260.79 852.416 262.091 851.365L262.405 851.754C263.705 850.702 265.01 849.652 266.318 848.603L266.006 848.213C267.315 847.163 268.629 846.115 269.947 845.067L270.258 845.458C271.567 844.419 272.879 843.38 274.196 842.343L273.887 841.95C275.179 840.932 276.475 839.915 277.775 838.899L278.083 839.293C279.383 838.278 280.687 837.263 281.995 836.25L281.689 835.854C282.998 834.84 284.311 833.828 285.628 832.816L285.932 833.212C287.249 832.201 288.569 831.19 289.894 830.181L289.591 829.783C290.916 828.773 292.246 827.765 293.579 826.757L293.881 827.156C295.214 826.149 296.551 825.142 297.892 824.137L297.592 823.737C298.934 822.732 300.279 821.727 301.629 820.724L301.928 821.125C303.275 820.124 304.626 819.123 305.981 818.124L305.684 817.722C307.008 816.746 308.336 815.771 309.668 814.797L309.963 815.2C311.294 814.227 312.629 813.254 313.967 812.283L313.674 811.878C315.013 810.906 316.356 809.936 317.703 808.966L317.995 809.372C319.342 808.403 320.692 807.434 322.046 806.467L321.755 806.06C323.11 805.093 324.468 804.127 325.83 803.161L326.119 803.569C327.481 802.604 328.846 801.641 330.215 800.678L329.928 800.269C331.297 799.306 332.671 798.344 334.048 797.383L334.334 797.793C335.711 796.833 337.091 795.874 338.476 794.916L338.191 794.505C339.554 793.561 340.921 792.619 342.292 791.677L342.575 792.089C343.933 791.156 345.295 790.225 346.66 789.294L346.379 788.881C347.745 787.95 349.114 787.02 350.487 786.091L350.767 786.505C352.14 785.576 353.516 784.649 354.895 783.723L354.617 783.308C355.997 782.381 357.38 781.456 358.767 780.532L359.045 780.948C360.431 780.024 361.821 779.101 363.215 778.179L362.939 777.762C364.333 776.84 365.731 775.92 367.132 775L367.406 775.418C368.806 774.499 370.21 773.581 371.618 772.664L371.345 772.245C372.752 771.328 374.163 770.413 375.576 769.499L375.848 769.919C377.23 769.025 378.616 768.132 380.005 767.241L379.735 766.82C381.124 765.928 382.517 765.038 383.913 764.149L384.181 764.57C385.577 763.681 386.976 762.793 388.378 761.907L388.11 761.484C389.513 760.597 390.918 759.711 392.327 758.827L392.593 759.25C394.002 758.366 395.413 757.483 396.828 756.601L396.564 756.176C397.979 755.294 399.398 754.413 400.82 753.533L401.083 753.959C402.504 753.079 403.929 752.201 405.356 751.324L405.095 750.898C406.523 750.021 407.954 749.145 409.389 748.27L409.649 748.697C411.077 747.826 412.508 746.957 413.943 746.088L413.684 745.661C415.094 744.807 416.507 743.955 417.923 743.103L418.181 743.532C419.597 742.681 421.015 741.831 422.437 740.983L422.181 740.554C423.603 739.705 425.028 738.857 426.457 738.011L426.711 738.441C428.139 737.595 429.57 736.75 431.004 735.907L430.75 735.476C432.185 734.632 433.622 733.79 435.062 732.948L435.314 733.38C436.754 732.539 438.197 731.699 439.643 730.861L439.392 730.428C440.838 729.59 442.287 728.752 443.739 727.916L443.989 728.349C445.44 727.514 446.895 726.679 448.353 725.846L448.104 725.411C449.557 724.581 451.012 723.752 452.471 722.924L452.717 723.359C454.151 722.545 455.588 721.732 457.027 720.921L456.782 720.485C458.222 719.674 459.664 718.863 461.11 718.054L461.354 718.491C462.799 717.682 464.247 716.874 465.697 716.068L465.454 715.631C466.905 714.824 468.359 714.019 469.816 713.215L470.057 713.653C471.514 712.849 472.972 712.046 474.434 711.245L474.194 710.807C475.656 710.005 477.121 709.205 478.588 708.407L478.827 708.846C480.295 708.047 481.765 707.25 483.237 706.454L483 706.014C484.473 705.218 485.949 704.423 487.427 703.63L487.664 704.07C489.142 703.277 490.623 702.485 492.106 701.695L491.871 701.254C493.327 700.478 494.786 699.703 496.247 698.93L496.481 699.372C497.941 698.599 499.404 697.827 500.87 697.057L500.637 696.615C502.103 695.844 503.572 695.075 505.043 694.307L505.275 694.75C506.745 693.983 508.219 693.217 509.695 692.452L509.465 692.008C510.941 691.243 512.42 690.479 513.901 689.716L514.13 690.161C515.611 689.399 517.095 688.638 518.581 687.878L518.354 687.433C519.84 686.673 521.329 685.915 522.821 685.158L523.047 685.603C524.539 684.847 526.033 684.091 527.529 683.337L527.304 682.89C528.801 682.136 530.3 681.383 531.802 680.632L532.026 681.079C533.511 680.336 534.998 679.594 536.488 678.853L536.265 678.405C537.745 677.67 539.227 676.936 540.712 676.204L540.933 676.652C542.417 675.919 543.903 675.188 545.392 674.459L545.172 674.01C546.661 673.28 548.153 672.551 549.647 671.824L549.866 672.274C551.359 671.547 552.855 670.821 554.354 670.097L554.136 669.646C555.635 668.922 557.136 668.199 558.64 667.477L558.856 667.928C560.359 667.206 561.864 666.486 563.372 665.768L563.157 665.316C564.665 664.597 566.176 663.88 567.689 663.164L567.903 663.616C569.416 662.9 570.93 662.185 572.448 661.472L572.235 661.02C573.751 660.307 575.27 659.596 576.791 658.886L577.002 659.339C578.498 658.641 579.997 657.944 581.497 657.248L581.287 656.795C582.788 656.099 584.291 655.405 585.796 654.712L586.005 655.166C587.51 654.474 589.018 653.782 590.527 653.093L590.319 652.638C591.829 651.948 593.341 651.259 594.855 650.572L595.062 651.027C596.576 650.34 598.092 649.654 599.61 648.97L599.405 648.514C600.923 647.83 602.444 647.147 603.967 646.465L604.171 646.922C605.694 646.24 607.219 645.56 608.746 644.882L608.543 644.425C610.07 643.746 611.6 643.069 613.132 642.393L613.334 642.851C614.865 642.175 616.399 641.501 617.934 640.828L617.734 640.37C619.262 639.701 620.792 639.033 622.324 638.366L622.523 638.825C624.039 638.166 625.556 637.508 627.076 636.852L626.877 636.393C628.397 635.736 629.919 635.081 631.443 634.427L631.64 634.887C633.164 634.234 634.69 633.582 636.218 632.931L636.022 632.471C637.55 631.82 639.08 631.171 640.612 630.523L640.807 630.984C642.339 630.336 643.873 629.69 645.409 629.045L645.215 628.584C646.752 627.939 648.29 627.295 649.831 626.653L650.023 627.115C651.563 626.473 653.105 625.833 654.649 625.194L654.458 624.732C656.002 624.093 657.549 623.455 659.097 622.819L659.288 623.281C660.836 622.645 662.386 622.011 663.938 621.378L663.749 620.915C665.291 620.286 666.835 619.659 668.381 619.033L668.569 619.496C670.101 618.876 671.636 618.257 673.172 617.639L672.986 617.175C674.523 616.557 676.062 615.941 677.602 615.326L677.788 615.791C679.328 615.176 680.87 614.563 682.414 613.951L682.23 613.486C683.775 612.874 685.321 612.264 686.87 611.655L687.053 612.12C688.601 611.511 690.151 610.904 691.703 610.298L691.521 609.832C693.073 609.226 694.627 608.622 696.183 608.019L696.364 608.485C697.919 607.882 699.477 607.281 701.036 606.681L700.856 606.215C702.416 605.615 703.978 605.016 705.541 604.419L705.72 604.886C707.283 604.289 708.848 603.694 710.415 603.1L710.237 602.633C711.795 602.042 713.355 601.454 714.916 600.866L715.092 601.334C716.64 600.752 718.19 600.171 719.742 599.592L719.567 599.123C721.119 598.544 722.673 597.966 724.229 597.389L724.403 597.858C725.958 597.282 727.515 596.707 729.074 596.134L728.902 595.664C730.461 595.091 732.022 594.519 733.585 593.948L733.756 594.418C735.319 593.848 736.883 593.279 738.449 592.712L738.279 592.241C739.845 591.674 741.413 591.108 742.983 590.544L743.152 591.014C744.722 590.45 746.293 589.887 747.866 589.326L747.698 588.855C749.271 588.294 750.847 587.734 752.423 587.176L752.59 587.647C754.167 587.089 755.745 586.533 757.325 585.978L757.159 585.506C758.734 584.953 760.311 584.401 761.889 583.851L762.054 584.323C763.616 583.779 765.18 583.236 766.745 582.694L766.582 582.222C768.148 581.68 769.715 581.14 771.285 580.601L771.447 581.074C773.016 580.536 774.586 579.999 776.158 579.464L775.997 578.991C777.57 578.455 779.144 577.921 780.72 577.389L780.88 577.863C782.455 577.33 784.032 576.8 785.611 576.271L785.452 575.796C787.031 575.267 788.612 574.74 790.194 574.213L790.352 574.688C791.934 574.162 793.518 573.638 795.103 573.115L794.946 572.64C796.532 572.117 798.119 571.595 799.708 571.076L799.863 571.551C801.452 571.031 803.042 570.513 804.633 569.997L804.479 569.521C806.071 569.004 807.664 568.489 809.26 567.976L809.413 568.452C810.989 567.944 812.566 567.439 814.146 566.935L813.993 566.458C815.572 565.954 817.152 565.452 818.733 564.951L818.884 565.428C820.465 564.927 822.047 564.428 823.631 563.931L823.482 563.454C825.066 562.956 826.652 562.46 828.24 561.965L828.388 562.443C829.975 561.948 831.564 561.456 833.154 560.964L833.006 560.487C834.597 559.995 836.189 559.506 837.783 559.018L837.929 559.496C839.522 559.008 841.117 558.521 842.713 558.036L842.568 557.558C844.164 557.073 845.762 556.59 847.362 556.108L847.506 556.587C849.105 556.105 850.706 555.625 852.308 555.147L852.165 554.668C853.767 554.189 855.371 553.712 856.977 553.237L857.119 553.717C857.921 553.479 858.724 553.242 859.527 553.005C860.331 552.768 861.135 552.532 861.938 552.296L861.797 551.816C863.404 551.345 865.01 550.876 866.616 550.408L866.756 550.889C868.361 550.422 869.966 549.957 871.571 549.494L871.432 549.014C873.037 548.551 874.642 548.09 876.247 547.632L876.384 548.112C877.988 547.654 879.591 547.198 881.195 546.744L881.058 546.263C882.662 545.809 884.265 545.357 885.868 544.907L886.003 545.388C887.605 544.938 889.207 544.491 890.809 544.045L890.675 543.564C892.277 543.118 893.878 542.675 895.479 542.234L895.612 542.716C897.213 542.275 898.813 541.836 900.413 541.399L900.281 540.916C901.881 540.479 903.481 540.045 905.08 539.612L905.211 540.095C906.811 539.662 908.411 539.231 910.01 538.803L909.88 538.32C911.499 537.886 913.117 537.454 914.735 537.025L914.863 537.508C916.481 537.079 918.097 536.652 919.714 536.227L919.587 535.744C921.203 535.319 922.82 534.896 924.435 534.475L924.561 534.959C926.177 534.539 927.792 534.12 929.406 533.704L929.281 533.22C930.896 532.804 932.51 532.39 934.124 531.978L934.247 532.463C935.861 532.051 937.474 531.641 939.086 531.234L938.963 530.749C940.576 530.342 942.188 529.937 943.8 529.534L943.921 530.019C945.532 529.616 947.143 529.215 948.753 528.817L948.633 528.331C950.243 527.933 951.853 527.536 953.462 527.142L953.581 527.628C955.19 527.233 956.799 526.841 958.407 526.452L958.289 525.966C959.913 525.572 961.537 525.18 963.16 524.791L963.277 525.277C964.905 524.886 966.533 524.498 968.16 524.112L968.045 523.625C969.672 523.239 971.299 522.855 972.925 522.474L973.04 522.96C974.665 522.579 976.291 522.199 977.915 521.822L977.802 521.335C979.427 520.958 981.052 520.583 982.675 520.21L982.787 520.697C984.411 520.325 986.033 519.954 987.655 519.586L987.545 519.098C989.167 518.73 990.789 518.364 992.41 518L992.519 518.488C994.14 518.124 995.76 517.763 997.379 517.403L997.271 516.915C998.891 516.556 1000.51 516.198 1002.13 515.844L1002.24 516.332C1003.85 515.977 1005.47 515.624 1007.09 515.274L1006.98 514.785C1008.61 514.432 1010.24 514.081 1011.87 513.732L1011.97 514.221C1013.61 513.87 1015.25 513.521 1016.89 513.175L1016.78 512.686C1018.42 512.339 1020.06 511.995 1021.69 511.653L1021.8 512.143C1023.43 511.801 1025.07 511.462 1026.7 511.124L1026.6 510.635C1028.23 510.297 1029.87 509.962 1031.5 509.63L1031.6 510.12C1033.23 509.787 1034.86 509.457 1036.49 509.129L1036.4 508.638C1038.03 508.31 1039.66 507.984 1041.29 507.661L1041.38 508.151C1043.01 507.828 1044.64 507.506 1046.27 507.187L1046.17 506.697C1047.8 506.378 1049.43 506.061 1051.05 505.746L1051.15 506.237C1052.78 505.923 1054.4 505.611 1056.02 505.301L1055.93 504.81C1057.57 504.497 1059.21 504.187 1060.84 503.879L1060.94 504.37C1062.58 504.06 1064.23 503.752 1065.87 503.447L1065.78 502.956C1067.43 502.65 1069.07 502.347 1070.72 502.046L1070.81 502.538C1072.45 502.238 1074.1 501.939 1075.74 501.643L1075.65 501.151C1077.29 500.855 1078.93 500.561 1080.57 500.27L1080.66 500.762C1082.3 500.471 1083.94 500.182 1085.58 499.895L1085.49 499.403C1087.13 499.116 1088.77 498.832 1090.41 498.55L1090.49 499.042C1092.13 498.76 1093.76 498.481 1095.4 498.203L1095.31 497.71C1096.95 497.433 1098.58 497.158 1100.21 496.885L1100.3 497.378C1101.93 497.105 1103.56 496.835 1105.19 496.567L1105.11 496.073C1106.76 495.802 1108.41 495.534 1110.05 495.267L1110.13 495.761C1111.79 495.493 1113.44 495.228 1115.1 494.965L1115.02 494.471C1116.67 494.208 1118.32 493.948 1119.98 493.69L1120.05 494.184C1121.7 493.925 1123.35 493.67 1125 493.416L1124.93 492.922C1126.58 492.669 1128.22 492.418 1129.87 492.169L1129.95 492.663C1131.59 492.415 1133.24 492.169 1134.88 491.925L1134.81 491.43C1136.45 491.186 1138.1 490.945 1139.74 490.706L1139.81 491.201C1141.45 490.962 1143.1 490.725 1144.74 490.491L1144.66 489.996C1146.31 489.761 1147.94 489.529 1149.58 489.3L1149.65 489.795C1151.29 489.565 1152.93 489.338 1154.56 489.113L1154.49 488.618C1156.16 488.39 1157.82 488.164 1159.48 487.94L1159.55 488.435C1161.21 488.212 1162.87 487.99 1164.53 487.772L1164.46 487.276C1166.12 487.057 1167.78 486.84 1169.44 486.626L1169.5 487.122C1171.16 486.908 1172.81 486.697 1174.47 486.488L1174.4 485.992C1176.06 485.783 1177.71 485.576 1179.36 485.372L1179.43 485.868C1181.08 485.664 1182.73 485.462 1184.38 485.263L1184.32 484.767C1185.97 484.567 1187.61 484.37 1189.26 484.176L1189.32 484.672C1190.97 484.478 1192.61 484.286 1194.26 484.097L1194.2 483.6C1195.84 483.41 1197.49 483.223 1199.13 483.039L1199.18 483.535C1200.84 483.349 1202.49 483.166 1204.14 482.985L1204.09 482.488C1205.76 482.305 1207.42 482.124 1209.09 481.946L1209.14 482.443C1210.81 482.266 1212.47 482.09 1214.14 481.917L1214.09 481.42C1215.75 481.247 1217.41 481.076 1219.07 480.908L1219.12 481.406C1220.78 481.238 1222.44 481.073 1224.1 480.91L1224.05 480.412C1225.71 480.249 1227.37 480.089 1229.02 479.931L1229.07 480.429C1230.72 480.271 1232.38 480.116 1234.03 479.963L1233.98 479.465C1235.64 479.312 1237.29 479.162 1238.94 479.014L1238.98 479.512C1240.63 479.364 1242.28 479.219 1243.92 479.076L1243.88 478.578C1245.53 478.435 1247.17 478.295 1248.82 478.157L1248.86 478.655C1250.54 478.515 1252.21 478.377 1253.88 478.242L1253.84 477.743C1255.51 477.608 1257.18 477.475 1258.85 477.345L1258.89 477.844C1260.56 477.714 1262.23 477.586 1263.89 477.461L1263.86 476.963C1265.52 476.838 1267.19 476.716 1268.85 476.596L1268.89 477.095C1270.55 476.975 1272.21 476.858 1273.87 476.743L1273.84 476.245C1275.49 476.13 1277.15 476.018 1278.81 475.909L1278.84 476.408C1280.5 476.298 1282.15 476.192 1283.81 476.088L1283.77 475.589C1285.43 475.484 1287.08 475.383 1288.73 475.284L1288.76 475.783C1290.41 475.684 1292.06 475.588 1293.7 475.494L1293.67 474.995C1295.35 474.899 1297.02 474.807 1298.69 474.716L1298.72 475.216C1300.39 475.125 1302.07 475.038 1303.74 474.953L1303.72 474.453C1305.39 474.368 1307.06 474.286 1308.73 474.206L1308.76 474.706C1310.43 474.626 1312.09 474.549 1313.76 474.475L1313.74 473.975C1315.4 473.901 1317.07 473.829 1318.73 473.76L1318.75 474.26C1320.41 474.191 1322.07 474.124 1323.73 474.061L1323.71 473.561C1325.37 473.498 1327.03 473.437 1328.68 473.378L1328.7 473.878C1330.36 473.82 1332.01 473.764 1333.66 473.711L1333.64 473.212C1335.29 473.159 1336.94 473.108 1338.59 473.061L1338.61 473.561C1340.28 473.512 1341.96 473.466 1343.63 473.423L1343.61 472.924C1345.29 472.881 1346.97 472.84 1348.65 472.803L1348.66 473.302C1350.33 473.265 1352.01 473.23 1353.68 473.198L1353.67 472.698C1355.34 472.666 1357.01 472.637 1358.68 472.61L1358.69 473.11C1360.35 473.084 1362.02 473.06 1363.68 473.039L1363.67 472.539C1365.34 472.518 1367 472.5 1368.66 472.485L1368.66 472.985C1370.32 472.97 1371.98 472.957 1373.63 472.947L1373.63 472.447C1375.29 472.437 1376.94 472.43 1378.59 472.426L1378.59 472.926C1380.24 472.921 1381.89 472.92 1383.54 472.921L1383.54 472.421C1385.22 472.422 1386.9 472.426 1388.58 472.433L1388.58 472.933C1390.26 472.94 1391.94 472.95 1393.61 472.963L1393.61 472.463C1395.29 472.475 1396.96 472.491 1398.64 472.509L1398.63 473.009C1400.3 473.028 1401.97 473.049 1403.63 473.073L1403.64 472.574C1405.31 472.598 1406.97 472.625 1408.63 472.655L1408.63 473.155C1410.29 473.185 1411.95 473.218 1413.6 473.253L1413.61 472.753C1415.27 472.789 1416.93 472.828 1418.58 472.869L1418.57 473.369C1420.22 473.41 1421.87 473.455 1423.51 473.502L1423.53 473.002C1425.19 473.05 1426.85 473.1 1428.51 473.153L1428.49 473.653C1430.17 473.707 1431.85 473.765 1433.53 473.825L1433.55 473.325C1435.23 473.385 1436.9 473.449 1438.58 473.515L1438.56 474.014C1440.23 474.081 1441.9 474.15 1443.57 474.222L1443.59 473.722C1445.26 473.795 1446.92 473.87 1448.58 473.948L1448.56 474.448C1450.22 474.526 1451.88 474.607 1453.54 474.691L1453.56 474.192C1455.22 474.276 1456.88 474.363 1458.53 474.453L1458.5 474.952C1460.15 475.042 1461.8 475.135 1463.45 475.231L1463.48 474.732C1465.12 474.828 1466.77 474.927 1468.41 475.029L1468.38 475.528C1470.06 475.633 1471.74 475.74 1473.41 475.851L1473.44 475.352C1475.12 475.463 1476.8 475.577 1478.47 475.694L1478.44 476.193C1480.11 476.31 1481.78 476.43 1483.44 476.554L1483.48 476.055C1485.15 476.178 1486.81 476.305 1488.47 476.435L1488.43 476.933C1490.09 477.063 1491.75 477.195 1493.41 477.331L1493.45 476.833C1495.1 476.969 1496.75 477.108 1498.4 477.25L1498.36 477.748C1500.01 477.89 1501.66 478.035 1503.3 478.183L1503.34 477.685C1504.99 477.833 1506.63 477.985 1508.26 478.139L1508.22 478.637C1509.89 478.794 1511.55 478.955 1513.22 479.119L1513.27 478.621C1514.94 478.787 1516.61 478.955 1518.28 479.127L1518.23 479.624C1519.9 479.796 1521.57 479.971 1523.23 480.149L1523.28 479.652C1524.94 479.83 1526.6 480.011 1528.26 480.196L1528.21 480.693C1529.86 480.878 1531.51 481.066 1533.16 481.257L1533.22 480.76C1534.87 480.951 1536.52 481.146 1538.16 481.344L1538.1 481.84C1539.74 482.038 1541.38 482.239 1543.02 482.443L1543.08 481.947C1544.72 482.151 1546.35 482.358 1547.98 482.569L1547.92 483.065C1549.58 483.28 1551.24 483.498 1552.9 483.72L1552.96 483.225C1554.63 483.448 1556.3 483.675 1557.96 483.905L1557.89 484.401C1559.56 484.631 1561.21 484.865 1562.87 485.102L1562.94 484.607C1564.6 484.844 1566.25 485.085 1567.9 485.329L1567.82 485.823C1569.47 486.067 1571.11 486.315 1572.75 486.565L1572.83 486.071C1574.47 486.322 1576.11 486.576 1577.74 486.834L1577.66 487.328C1579.3 487.585 1580.92 487.846 1582.55 488.111L1582.63 487.617C1584.26 487.882 1585.88 488.149 1587.5 488.421L1587.42 488.914C1589.08 489.193 1590.74 489.475 1592.4 489.762L1592.48 489.269C1594.14 489.556 1595.8 489.846 1597.45 490.139L1597.36 490.632C1599.01 490.925 1600.66 491.222 1602.3 491.523L1602.39 491.031C1604.03 491.332 1605.67 491.637 1607.31 491.945L1607.22 492.436C1608.85 492.744 1610.48 493.056 1612.11 493.371L1612.2 492.88C1613.83 493.195 1615.45 493.514 1617.07 493.837L1616.97 494.327C1618.59 494.649 1620.2 494.975 1621.81 495.304L1621.91 494.814C1623.55 495.148 1625.17 495.486 1626.8 495.827L1626.7 496.317C1628.35 496.664 1629.99 497.015 1631.64 497.369L1631.74 496.881C1633.38 497.236 1635.02 497.594 1636.66 497.957L1636.55 498.445C1638.18 498.807 1639.81 499.173 1641.44 499.543L1641.55 499.055C1643.17 499.425 1644.79 499.799 1646.41 500.176L1646.3 500.663C1647.91 501.041 1649.52 501.422 1651.13 501.807L1651.24 501.32C1652.85 501.705 1654.45 502.094 1656.05 502.487L1655.93 502.972C1657.54 503.366 1659.13 503.764 1660.73 504.165L1660.85 503.68C1662.49 504.094 1664.13 504.511 1665.76 504.932L1665.63 505.416C1667.26 505.837 1668.88 506.262 1670.5 506.69L1670.63 506.207C1672.25 506.636 1673.87 507.069 1675.48 507.506L1675.35 507.989C1676.96 508.426 1678.56 508.867 1680.16 509.311L1680.29 508.83C1681.89 509.275 1683.49 509.724 1685.08 510.177L1684.94 510.658C1686.53 511.11 1688.11 511.567 1689.69 512.028L1689.83 511.548C1691.41 512.009 1692.99 512.475 1694.56 512.944L1694.42 513.423C1696.04 513.907 1697.65 514.396 1699.26 514.889L1699.41 514.411C1701.02 514.904 1702.63 515.401 1704.23 515.903L1704.08 516.38C1705.68 516.881 1707.27 517.387 1708.86 517.896L1709.01 517.42C1710.6 517.93 1712.18 518.444 1713.76 518.963L1713.6 519.438C1715.18 519.956 1716.75 520.478 1718.31 521.005L1718.47 520.531C1720.04 521.058 1721.6 521.589 1723.15 522.124L1722.99 522.597C1724.55 523.135 1726.11 523.677 1727.66 524.224L1727.83 523.752C1729.43 524.315 1731.02 524.882 1732.6 525.453L1732.43 525.924C1734.01 526.495 1735.59 527.07 1737.16 527.65L1737.33 527.181C1738.9 527.761 1740.47 528.346 1742.03 528.936L1741.85 529.403C1743.41 529.992 1744.96 530.586 1746.5 531.183L1746.68 530.717C1748.23 531.315 1749.77 531.918 1751.3 532.525L1751.12 532.99C1752.65 533.597 1754.18 534.208 1755.7 534.824L1755.88 534.36C1757.43 534.988 1758.98 535.621 1760.51 536.259L1760.32 536.72C1761.88 537.367 1763.43 538.018 1764.98 538.675L1765.18 538.214C1766.72 538.871 1768.26 539.532 1769.79 540.199L1769.59 540.657C1771.13 541.323 1772.65 541.993 1774.17 542.668L1774.37 542.211C1775.89 542.887 1777.4 543.567 1778.91 544.253L1778.7 544.708C1780.2 545.392 1781.7 546.081 1783.19 546.775L1783.4 546.322C1784.9 547.021 1786.39 547.724 1787.87 548.432L1787.65 548.883C1789.18 549.611 1790.7 550.345 1792.21 551.083L1792.43 550.634C1793.94 551.373 1795.45 552.118 1796.95 552.867L1796.72 553.314C1798.22 554.063 1799.71 554.816 1801.19 555.575L1801.41 555.13C1802.89 555.889 1804.37 556.654 1805.83 557.423L1805.6 557.866C1807.07 558.634 1808.52 559.408 1809.97 560.187L1810.21 559.746C1811.66 560.526 1813.1 561.31 1814.53 562.1L1814.29 562.538C1815.77 563.353 1817.25 564.175 1818.71 565.001L1818.96 564.566C1820.42 565.394 1821.88 566.227 1823.33 567.066L1823.08 567.499C1824.53 568.337 1825.97 569.18 1827.4 570.029L1827.66 569.599C1829.09 570.448 1830.51 571.303 1831.93 572.163L1831.67 572.59C1833.08 573.449 1834.48 574.314 1835.88 575.184L1836.14 574.759C1837.54 575.63 1838.93 576.507 1840.31 577.388L1840.04 577.81C1841.47 578.72 1842.88 579.637 1844.29 580.559L1844.56 580.141C1845.97 581.064 1847.37 581.993 1848.76 582.928L1848.48 583.342C1849.86 584.276 1851.24 585.215 1852.61 586.159L1852.89 585.748C1854.26 586.694 1855.62 587.645 1856.97 588.603L1856.68 589.01C1858.03 589.966 1859.37 590.928 1860.7 591.895L1860.99 591.491C1862.33 592.467 1863.66 593.449 1864.98 594.436L1864.68 594.836C1866.03 595.847 1867.37 596.863 1868.71 597.886L1869.01 597.49C1870.34 598.514 1871.66 599.543 1872.97 600.579L1872.66 600.971C1873.97 602.006 1875.27 603.046 1876.56 604.093L1876.87 603.705C1878.16 604.752 1879.44 605.806 1880.71 606.866L1880.39 607.249C1881.65 608.308 1882.91 609.372 1884.15 610.442L1884.48 610.063C1885.75 611.155 1887.01 612.254 1888.25 613.359L1887.92 613.733C1889.18 614.848 1890.43 615.969 1891.66 617.096L1892 616.726C1893.24 617.855 1894.46 618.99 1895.67 620.132L1895.33 620.496C1896.54 621.635 1897.74 622.781 1898.93 623.933L1899.28 623.575C1900.47 624.728 1901.65 625.889 1902.81 627.055L1902.46 627.408C1903.63 628.58 1904.79 629.758 1905.94 630.942L1906.29 630.594C1907.47 631.804 1908.62 633.02 1909.77 634.243L1909.41 634.585C1910.55 635.805 1911.68 637.033 1912.8 638.266L1913.17 637.931C1914.29 639.167 1915.4 640.409 1916.5 641.658L1916.12 641.987C1917.21 643.234 1918.29 644.488 1919.36 645.747L1919.74 645.424C1920.81 646.686 1921.87 647.955 1922.91 649.23L1922.52 649.546C1923.59 650.844 1924.63 652.148 1925.67 653.459L1926.06 653.15C1927.1 654.465 1928.12 655.786 1929.13 657.115L1928.73 657.418C1929.74 658.744 1930.74 660.076 1931.72 661.416L1932.12 661.121C1933.11 662.462 1934.07 663.811 1935.03 665.166L1934.62 665.454C1935.57 666.807 1936.51 668.167 1937.44 669.533L1937.85 669.253C1938.79 670.636 1939.71 672.027 1940.62 673.424L1940.2 673.697C1941.11 675.096 1942.01 676.502 1942.89 677.915L1943.31 677.65C1944.19 679.066 1945.06 680.488 1945.91 681.918L1945.48 682.174C1946.34 683.601 1947.17 685.034 1947.99 686.474L1948.43 686.226C1949.25 687.669 1950.06 689.119 1950.86 690.576L1950.42 690.815C1951.21 692.275 1951.99 693.741 1952.76 695.215L1953.2 694.984C1953.97 696.464 1954.73 697.95 1955.46 699.444L1955.02 699.665C1955.75 701.156 1956.48 702.653 1957.18 704.157L1957.63 703.944C1958.34 705.451 1959.04 706.965 1959.71 708.486L1959.26 708.689C1959.93 710.207 1960.59 711.732 1961.24 713.263L1961.7 713.069C1962.35 714.601 1962.98 716.14 1963.59 717.686L1963.13 717.87C1963.74 719.411 1964.34 720.959 1964.92 722.514L1965.39 722.339C1965.97 723.896 1966.54 725.461 1967.09 727.032L1966.62 727.198C1967.17 728.766 1967.7 730.34 1968.22 731.922L1968.7 731.766Z",stroke:"black",strokeOpacity:"0.5",strokeDasharray:"5 5"}),M.jsx("g",{clipPath:"url(#clip1_759_511)",children:M.jsx("path",{d:"M1211.07 1257.52C1211.07 1257.52 1197.31 1263.37 1192.52 1265.3C1177.92 1271.65 1158.84 1257.75 1158.84 1257.75C1158.84 1257.75 1162.19 1234.49 1176.93 1228.48C1188.03 1223.63 1195.59 1220.62 1195.59 1220.62C1195.59 1220.62 1198.21 1206.32 1209.33 1201.63L1234.36 1260.88C1223.14 1265.52 1211.07 1257.52 1211.07 1257.52ZM1182.26 1239.78C1181.36 1240.16 1180.54 1240.71 1179.86 1241.4C1179.17 1242.09 1178.63 1242.92 1178.26 1243.82C1177.9 1244.72 1177.71 1245.69 1177.72 1246.66C1177.72 1247.64 1177.92 1248.6 1178.3 1249.5C1178.87 1250.85 1179.83 1252 1181.05 1252.81C1182.27 1253.62 1183.71 1254.04 1185.18 1254.03C1186.64 1254.02 1188.07 1253.58 1189.29 1252.76C1190.5 1251.94 1191.45 1250.77 1192 1249.41C1192.55 1248.06 1192.69 1246.56 1192.4 1245.13C1192.1 1243.69 1191.39 1242.37 1190.35 1241.34C1189.3 1240.31 1187.98 1239.61 1186.54 1239.33C1185.1 1239.06 1183.61 1239.21 1182.26 1239.78ZM1246.67 1220.85C1243.9 1227.13 1238.98 1232.23 1232.8 1235.22L1226.7 1220.72C1232.93 1215.25 1246.67 1220.85 1246.67 1220.85Z",fill:"black"})})]}),M.jsxs("defs",{children:[M.jsx("clipPath",{id:"clip0_759_511",children:M.jsx("rect",{width:"1991",height:"1991",fill:"white"})}),M.jsx("clipPath",{id:"clip1_759_511",children:M.jsx("rect",{width:"89",height:"89",fill:"white",transform:"matrix(-0.377237 0.926117 0.926117 0.377237 1178.74 1181.17)"})})]})]});function o2(e){return Dl({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"}}]})(e)}function Al(e){return Dl({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"}}]})(e)}const o0={initial:{opacity:0,x:-80},animate:e=>({opacity:1,x:0,transition:{delay:e*.1,duration:.5}})},Kme=()=>M.jsxs("div",{className:"flex flex-col w-full bg-white overflow-clip",children:[M.jsx(Mv,{children:M.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:M.jsxs("div",{className:"relative z-10 flex flex-col w-full h-full",children:[M.jsx(Bv,{}),M.jsx("div",{className:"absolute top-0 left-0 z-40 w-3/4 h-full opacity-50 bg-gradient-to-r from-black via-black to-transparent"}),M.jsxs("div",{className:`z-50 relative flex flex-col items-center overflow-auto h-full w-full gap-2 py-[calc(4rem+2rem)] text-white px-10 
            laptop:px-28
            `,children:[M.jsx("div",{className:`absolute z-50 hidden scale-110 -rotate-90 bottom-28 right-28 
              laptop:block 
              `,children:M.jsxs("div",{className:"flex items-center gap-5 animate-ltr",children:[M.jsx(o2,{className:"scale-x-[150%]"}),M.jsx("p",{className:"whitespace-nowrap",children:"Scroll Down"})]})}),M.jsxs("div",{className:`flex flex-col w-full gap-5
              laptop:gap-20 laptop:flex-row
              `,children:[M.jsx(We.div,{initial:{x:"-100%"},animate:{x:0},transition:{duration:1,ease:"easeOut"},className:"flex flex-col col-span-3",children:M.jsx("img",{src:"./images/DMRS.webp",alt:"",className:"w-full invert"})}),M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:`text-sm self-start mb-10
                  laptop:hidden
                  `,children:"Dan Murdoch Risk Services"}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`hidden flex-col min-w-[15rem] rounded-lg overflow-hidden w-full
                  laptop:flex
                  `,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]}),M.jsxs("div",{className:`flex flex-col w-full h-full gap-10 
              tablet:flex-row tablet:mt-10 
              laptop:flex-col laptop:self-start
              `,children:[M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:`hidden text-base
                  laptop:block
                  `,children:"Dan Murdoch Risk Services"}),M.jsxs(We.div,{initial:{x:-450},animate:{x:0},transition:{delay:.4,duration:1,ease:"easeOut"},className:`flex flex-col justify-center gap-1 
                  tablet:w-1/2
                  laptop:mt-auto laptop:items-start
                  `,children:[M.jsx("p",{className:`z-10 text-xs
                    mobile:text-sm
                    laptop:text-base 
                    hd:text-lg
                    `,children:"Providing Global Corporations with"}),M.jsx(uF,{})]}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`flex flex-col min-w-[15rem] rounded-lg overflow-hidden w-full mt-auto
                  tablet:w-1/2
                  laptop:hidden `,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]})]})]})})}),M.jsxs("section",{className:`flex flex-col gap-16 overflow-hidden navTrigger py-10 px-12 
      tablet:px-12
      laptop:p-20 laptop:pb-0 laptop:overflow-visible laptop:flex-row
      desktop:px-24
      `,children:[M.jsxs("div",{className:`flex flex-col items-center justify-center gap-1 z-10
        laptop:sticky laptop:flex-1 laptop:top-16 laptop:max-h-[calc(100vh-4rem)]
        `,children:[M.jsx("h2",{className:`text-lg font-bold text-center 
            desktop:text-xl hd:text-3xl
            `,children:"WHO ARE WE?"}),M.jsxs("p",{className:`text-sm text-center 
          desktop:text-base hd:text-md
          `,children:["Discover who we are and be part of our ",M.jsx("span",{className:"font-bold text-accent-500",children:"JOURNEY"})]})]}),M.jsxs("div",{className:"flex flex-col flex-1 gap-16",children:[M.jsx(U2,{children:M.jsxs(ey,{imageUrl:"./images/australia-map.png",children:[M.jsxs("h2",{className:`text-xl font-bold 
              desktop:text-2xl hd:text-3xl
              `,children:["DMRS ",M.jsx("span",{className:"text-primary-300",children:"Australia"})]}),M.jsx("p",{className:`text-xs text-justify 
              desktop:text-sm hd:text-md
              `,children:"Dan Murdoch Risk Services (Australia) Pty Ltd is the parent company of our operational division Dan Murdoch Risk Services (Thailand) Limited."}),M.jsx(wc,{size:"xs",variant:"default",className:" w-fit !bg-accent-400 !ring-accent-400 text-white",children:M.jsx(wr,{to:"/dmrs/australia",children:"Go to DMRS Australia"})})]})}),M.jsx(U2,{children:M.jsxs(ey,{imageUrl:"./images/thailand-map.png",children:[M.jsxs("h2",{className:`text-xl font-bold 
              desktop:text-2xl 
              hd:text-3xl
              `,children:["DMRS ",M.jsx("span",{className:"text-primary-300",children:"Thailand"})]}),M.jsx("p",{className:`text-xs text-justify 
              desktop:text-sm 
              hd:text-md`,children:"Dan Murdoch Risk Services (Thailand) Co. Ltd. staff are trained detectives and intelligence analysts who use both objective and subjective thinking to gather manual online data leading to intelligence for many Fortune 500 companies worldwide."}),M.jsx(wc,{size:"xs",variant:"default",className:" w-fit !bg-accent-400 !ring-accent-400 text-white",children:M.jsx(wr,{to:"/dmrs/thailand",children:"Go to DMRS Thailand"})})]})}),M.jsx(U2,{children:M.jsxs(ey,{children:[M.jsx("h2",{className:`font-bold text-md 
              desktop:text-2xl 
              hd:text-3xl
              `,children:"Specialization"}),M.jsx("p",{className:`text-xs text-justify 
              desktop:text-sm 
              hd:text-md
              `,children:"We specialize in pharmaceuticals and the protection of and identifying risks associated with medicines worldwide."}),M.jsx(wc,{size:"xs",variant:"default",className:"w-fit",children:M.jsx(wr,{to:"/dmrs/contact",children:"Get Started"})})]})})]})]}),M.jsxs("section",{className:`relative flex  z-[1] gap-5 px-6 py-8
        mobile:py-10 mobile:px-12 
        tablet:px-12
        laptop:p-20
        desktop:px-24`,children:[M.jsx("div",{className:`hidden absolute top-0 right-0 translate-y-[-70vh] translate-x-[40vh]
        laptop:block
        `,children:M.jsx(Qme,{})}),M.jsxs("div",{className:`flex flex-col  gap-10
        laptop:max-w-[55%]
        `,children:[M.jsxs("div",{className:"flex flex-col gap-3",children:[M.jsxs(We.div,{variants:o0,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"flex items-center gap-3",children:[M.jsx("div",{className:"flex items-center justify-center p-2 rounded-md bg-black/5 aspect-square",children:M.jsx(Gme,{className:`text-sm 
                laptop:text-md 
                hd:text-lg
                `})}),M.jsxs("h2",{className:`text-lg font-bold 
              laptop:text-xl 
              hd:text-2xl
              `,children:["Our ",M.jsx("span",{className:"text-primary-300",children:"Vision"})]})]}),M.jsx(We.p,{variants:o0,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:2,className:`text-xs text-justify 
              laptop:text-sm 
              hd:text-base`,children:"Dan Murdoch Risk Services will be the preferred company of choice for online intelligence, investigative consultancy, brand protection and business intelligence advice worldwide offering beneficial solutions for all corporate and personal problems."})]}),M.jsxs("div",{className:"flex flex-col gap-3",children:[M.jsxs(We.div,{variants:o0,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"flex items-center gap-3",children:[M.jsx("div",{className:"flex items-center justify-center p-2 rounded-md bg-black/5 aspect-square",children:M.jsx(Wme,{className:`text-sm 
                laptop:text-md 
                hd:text-lg`})}),M.jsxs("h2",{className:`text-lg font-bold 
              laptop:text-xl 
              hd:text-2xl`,children:["Our ",M.jsx("span",{className:"text-primary-300",children:"Mission Statement"})]})]}),M.jsx(We.p,{variants:o0,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:2,className:`text-xs text-justify 
              laptop:text-sm 
              hd:text-base
              `,children:"Dan Murdoch Risk Services will offer and deliver to the corporate world and the general public a complete range of business services from intelligence strategies and a true investigative consultancy to proactive solutions and risk management strategies for internal and external problems facing companies and individuals worldwide."})]})]})]}),M.jsxs("section",{className:`relative flex flex-col gap-10 mt-16 px-6 py-8 
      mobile:py-10 mobile:px-12 
      tablet:px-12
      laptop:p-20 laptop:flex-row
      desktop:px-24
      
      `,children:[M.jsx("div",{className:"absolute top-0 left-0 flex w-full h-full",children:M.jsxs("div",{className:"relative w-full h-full",children:[M.jsx("div",{className:"absolute right-0 grid w-3/4 h-full grid-cols-7",children:M.jsx(zP,{cellCount:35,cellClass:"border border-background-dark/5"})}),M.jsx("div",{className:"absolute right-0 w-3/4 h-full bg-gradient-radial from-transparent to-white"})]})}),M.jsxs("div",{className:`z-10 flex flex-col items-center gap-8 
        laptop:w-[45%]
        `,children:[M.jsxs(We.div,{initial:{opacity:0,x:-75},whileInView:{opacity:1,x:0},transition:{duration:.5},viewport:{once:!0,margin:"-50px"},className:`flex items-center 
            hd:flex-row hd:gap-5
            `,children:[M.jsx("img",{src:"./images/sheild-dynamic-color.png",className:"w-1/4",alt:""}),M.jsxs("h2",{className:`text-lg font-bold text-center 
            hd:text-2xl hd:text-left
            `,children:[" What are ",M.jsx("span",{className:"text-primary-300",children:"we"})," offering?"]})]}),M.jsxs("div",{className:`flex flex-col gap-3 text-xs 
          tablet:text-sm tablet:w-3/4 
          laptop:w-full laptop:px-5 laptop:gap-5 
          hd:text-base hd:gap-10
          `,children:[M.jsxs("p",{className:"text-justify",children:["The services DMRS offers fall into three broad areas, labeled as ",M.jsx("strong",{children:"Intelligence"}),", ",M.jsx("strong",{children:"Investigations"}),", and ",M.jsx("strong",{children:"Research"}),"."]}),M.jsx("p",{className:"text-justify",children:"While our geographical areas of operation are Asia-wide and Australia we conduct intelligence monitoring and investigations worldwide using our own staff and trusted associates."})]})]}),M.jsx(EH,{})]})]}),Zme="data:image/webp;base64,UklGRioKAABXRUJQVlA4TB0KAAAvLUPJECcw7/M+7wTZNkMYwhBufNUAD4cYKNa2G7eBVMNMBVsDWwUz6L8pH0oEAXz8b/JEEf2nBNt23Db63r0FAaInnAJIRoN7cVH085v9ekny87/9qUmZ2Vap/+xfTeov++XaoD/vZ2b6zX6N6+/HS9SaJ66/3HrJzAL7a2ayFLXmievvx0vUmieuv4eCl+LcMtrluR80einOLaNdnvvBvZfMbJwkP/ejxoFkKWq8M9rluR80einOLaNdnvtxQHlptNG9j3x98u0vo9JLo43ufeTrk29/WayX+GnCzHx98m1kij2QLEWNlUa7+Prk219GpZdGG937yNcn3/6yvF46TCzlWwuKdZrfTPRYyrcWlMNpdG1wGnPfokMOEMhV9FjKtxYU6zS/meixlG8tKIfTDhIbxebx50iNjWLz+HOkZhIem8efoyxFjY1i8/hzpMZGsXn8OR44Vpr3TryZ6LPSvHfizURJEzkOFN+CLEWflea9E28m+qw0753Dx0w5rES/l+adI4mX8pzrt7RyWEkSL+U518PHSnm8RKeV8niJzibyHEiWotNKebxEp5UOCi/FugTTGk8bXop1CaY1nv69ZGYgFxPM7JtUsS7BtMbThpdiXYJpjWezeymXR+ashMlLEO2UyyNzVsLkJYh2yjXxnWsC1IHM7FtTuTwyZyVMXoJop1wembMSJi8dAHby+wbP3rQ213z8vsGzN63NNZ+1E+k6TcSA4FtWft/g2ZvW5pqP3zcY9qb5z+kQ8FKdvMb4tHJPsjp5jfFp5eZXdfIa4/Ntqrm1mzp5jfFp5Z5kdfIa47PprVQvz++lNqxUL+fIS2ZWL89/IFmqDSvVy/N7qQ0r1cvze2nDW6luTo+V6ub0WKluntdK9BU9Vqqb02OluvlhssZTP885Ri14qX6ec4xaOFD9POcYyVIteKl+nnOMWvBS/TznGG10J2HJ83kJupOw5Dx4ycyw5PkOJEtBdxKWPJ+XoDsJS57PSxvcSaOXMOV5vATZSaOXMOV9e8nMxgNhyvMcSJaC7KTRS5jyPF6C7KTRS5jyw8FLo5Fw5jnGDOraDs48x5hBXUTAmecYs29OjUbCmecYM6hrOzjzHGO2qa3Ur5dgWkkTL5lZvweSpWBaqV8vwbTSIeYlzHn8mEH0EuY8fswgHghzHj9mshREL2HO48cMopcw5/djdnCZKYeVKDVTDitBbKHXXJ6i1Ew5rESpmQ4EK/WcQ7RSzznEJnrOZSmIVuo5h2ilnvPNbKW+vQTPSn17SZMmzEyWgmelvr0Ez0qHmJd6NxM0L2liJjPrvQVZCpqXejcTNC/1bqZNbCUecjhW4iGH0wQPuSwFx0o85HCsxEO+aZ3ESQ7FSVqYycw4yWUpCE7iJIfgJE7yDesjbsxUxk5zFuLGTHXsZGY85eNfJ+VrzkLcmKmMneYsxI2ZPnbagDa6dxJveUob3TuJtzzlH0blfkLOWy5LpbTRvZN4y1Pa6N5JvOWbcC2HfivN20gHK5kZj7myNW8j+q00b6NDy0p85mmsxGeepgk+c1kqjZX4zNNYic98w1mJ1zzcSrzm4U3wmstS4VbiNQ+3Eq/5BjMSx3mIkTjOQybjHOeyVIiROM5DjMRxvrmu9481E633NBvn8XGe4fWeZmYW2wJnN89SrsZ5fJxnaL2n2TiPj/PMAXRPs9FJnOdL1ng4z5csJnCeK1ajkzjPl6zxcJ6//nvpDcZLvOduL/Geuw/Eey5Lub3Ee+72Eu/5RrIS//m0lfjPp5vgP5elpq3Efz5tJf7zTeQlDfIpL2mQTx1Ig1yWmvKSBvmUlzTIN5CXdMgfvaRD/nggHXJZ6tFLOuSPXnqHNNPm8ZIW+a2XtMhvD6RFLkvdekmL/NZLWuSb5xn9OuSPz+jXIX98GLwOuTL1aVQPMz0+o1+HfNOs8WiSf3wiSW5mlyS5LPXxiST5xyeS5AeYl4b1HT3yYSFBj1yZ+thEj/x2fUePdZ73Fi+9t5jpteUezC8u92B+/ffSD11e+jn52pp3SC/9vPzn6X9/9NJ7y+uufP330g9cXjrBzHRdlyZmuq5LkhakKUnMNP2+wrw7emmHm+m6Lkney7H+TAf7TQPrDw+KFT5PaPJejl3XdVB5yb8eRft7Z9nze9cP8U2a7PlN0let8LnhY6aW3ztLjG44nN47y5g9dRR7KeazgqHYS71/KC2qFR4z+O3UppfwmuHw8RIf1wTB8Ee+z+mVRi/x8YGwqlYYbNSzm9z+wO2Dw8ZLnNzPAII7OPmMkSFMcDn5MIuVq1pO4sFMENzBx2eMvFk/ixde7sNW3hy8fIb75Se3vHxY+OpVfifx4aVl5sBugg1qJfzewDB+eEwFwRsYvoMKeEwFYWKL4cuOgGfyrl7VcEFxN13XBdlKfbjAd+6Hg5V8TsEwhpjWgkpYye+U+l7CtBZUogn/hLj+gTAtOqhWORzhd0p9L2FaC0plJZ9FcLhg/twPBS9hG0f4Vop1BLbvsRVGK6U9ELYvTBW+JlSrWEdg+x5bwbfS6Ih+5vtYrbTx3IRz/HBdd5P22hSc3xk4XNfdpL0IAueX0w3XBR4q1lorYfQSrutull+b0sd8/358NrqX7l2xxknYvZTXTumtucZJ2L2U107prblmQo79QPUn6WrWGidh91JeO6W35pp5PnYv1bfTxvvuJ/QxhvdrPpDNtN5JfO1VC2th/YScr01RatZ6J2HeqwbZTL3M8efGj8t1ng3+HSJpw5393Ke5DXf2d0Pgb2phsBI1v0duh5aT5t1Cv5fm3UK/l+YmyHXb/YbWvFvo99K8Ww4rL40+mvMK9V4afTTnFfq9NDZQf3HhG1qjj+a8Qr2XRh/NeQWHlw6n/WrU/f5R1vaSDBujvsFV20vU7Fc7LL1E1+/NcS0rSXKgb3HVspImXrqu6/XfSz9weenwMhNtVcdKcrQgT8lhJtqqjpUOIjOt6SOVtdY+MT6it4U1fZSq6DXTmj5SWWvtE+ejw8ZNcWs/1JbPROudRGe7cYsM3/jymcjvJGrLZ6J8Tjp01n/8z9GkuuY9FOMlWhca/A9s3AE156F5T1Fd8x6a99LhZKZ1faLbTOv6RHcLvj7thvJZ6NlJdJvJ2afXk5/3m/+vjBxQ19es6x/d19es6x/dF3Ks658sRff1Nev6R/f1Nev6d4Ct8VDtpbUGottLaxcevv211kB0e2ntetC7yz62Q+p+zP79abTfj9m/P432G//6NkJJU7Tfj9m/P432+zHn2592ED3Pn3Yv5Xr2JeUPjt8FlevZl7Q/z/8AMxPl+8/WeUmSFnZCrfMS3WZ6v/HSAWYm2q/5X+MlSVrYDbXGS5KY6d3FSoeXmai/x7LfS5K0sCPK7yXazfRe46WDy0wyPOtyzkmjl6RoYXyoojQlhZlkeNblnJNGLx1aZvI7SYbnX0rRwg6p+fUdKcwUXhcA",Jme="/dmrs/assets/dmrs-australia-0f8a7146.webp",$me="/dmrs/assets/intelligent-intelligence-icon-dbbcc961.webp";function e0e(e){return Dl({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"9",x2:"15",y1:"18",y2:"18"}},{tag:"line",attr:{x1:"10",x2:"14",y1:"22",y2:"22"}},{tag:"path",attr:{d:"M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"}}]})(e)}function t0e(e){return Dl({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M34,64a6,6,0,0,1,6-6H216a6,6,0,0,1,0,12H40A6,6,0,0,1,34,64Zm6,70h72a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12Zm88,52H40a6,6,0,0,0,0,12h88a6,6,0,0,0,0-12Zm108.24,10.24a6,6,0,0,1-8.48,0l-21.49-21.48a38.06,38.06,0,1,1,8.49-8.49l21.48,21.49A6,6,0,0,1,236.24,196.24ZM184,170a26,26,0,1,0-26-26A26,26,0,0,0,184,170Z"}}]})(e)}function r0e(e){return Dl({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M.95 14.184L12 20.403l9.919-5.55v2.21L12 22.662l-10.484-5.96-.565.308v.77L12 24l11.05-6.218v-4.317l-.515-.309L12 19.118l-9.867-5.653v-2.21L12 16.805l11.05-6.218V6.32l-.515-.308L12 11.974 2.647 6.681 12 1.388l7.76 4.368.668-.411v-.566L12 0 .95 6.27v.72L12 13.207l9.919-5.55v2.26L12 15.52 1.516 9.56l-.565.308Z"}}]})(e)}const i0e={initial:{opacity:0,x:-80},animate:e=>({opacity:1,x:0,transition:{delay:e*.1,duration:.7}})},n0e=()=>{new Array(28);const e=oe.useRef([]);function t(r){r.classList.contains("active")||!r||(r.classList.add("fill"),setTimeout(()=>{r.classList.remove("fill")},Math.random()*2*5e3))}return oe.useEffect(()=>{const r=setInterval(()=>{const i=e.current[Math.floor(Math.random()*25)];t(i)},5e3);return()=>clearInterval(r)},[]),M.jsxs("div",{className:"flex flex-col w-full bg-white",children:[M.jsx(Mv,{children:M.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:M.jsxs("div",{className:"relative z-10 flex flex-col w-full h-full",children:[M.jsx(Bv,{}),M.jsx("div",{className:"absolute top-0 left-0 z-40 w-3/4 h-full opacity-50 bg-gradient-to-r from-black via-black to-transparent"}),M.jsxs("div",{className:`z-50 relative flex flex-col overflow-auto items-center h-full w-full gap-2 py-[calc(4rem+2rem)] text-white px-10 
              laptop:px-28`,children:[M.jsx("div",{className:`absolute z-50 hidden scale-110 -rotate-90 bottom-28 right-28 
                laptop:block`,children:M.jsxs("div",{className:"flex items-center gap-5 animate-ltr",children:[M.jsx(o2,{className:"scale-x-[150%]"}),M.jsx("p",{className:"whitespace-nowrap",children:"Scroll Down"})]})}),M.jsxs("div",{className:`flex flex-col items-center w-full gap-10 
                laptop:gap-20 laptop:flex-row`,children:[M.jsx(We.div,{initial:{x:"-100%"},animate:{x:0},transition:{duration:1,ease:"easeOut"},className:"flex flex-col col-span-3",children:M.jsx("img",{src:"./images/DMRS.webp",alt:"",className:"w-full invert"})}),M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:`text-base text-center items 
                    mobile:text-left 
                    laptop:hidden`,children:"Dan Murdoch Risk Services"}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`hidden flex-col min-w-[15rem] rounded-lg overflow-hidden w-full 
                    laptop:flex`,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]}),M.jsxs("div",{className:`flex flex-col w-full h-full gap-10 
                tablet:flex-row tablet:mt-10 
                laptop:flex-col laptop:self-start`,children:[M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:`hidden text-base 
                    mobile:text-left 
                    laptop:block`,children:"Dan Murdoch Risk Services"}),M.jsx(We.div,{initial:{x:-450},animate:{x:0},transition:{delay:.4,duration:1,ease:"easeOut"},className:`flex flex-col items-center justify-center gap-1 
                    tablet:w-1/2
                    laptop:mt-auto laptop:items-start `,children:M.jsx("p",{className:`z-10 text-md
                    laptop:text-xl`,children:"AUSTRALIA"})}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`flex flex-col min-w-[15rem] rounded-lg overflow-hidden w-full mt-auto
                    tablet:w-1/2
                    laptop:hidden`,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]})]})]})})}),M.jsx("section",{className:`relative gap-16 navTrigger 
        tablet:z-12`,children:M.jsxs("div",{className:`flex flex-col w-full gap-6 px-6 py-8 h-fit 
          mobile:py-10 mobile:px-12 mobile:h-fit mobile:flex-col 
          tablet:items-center tablet:px-12 tablet:flex-row 
          laptop:p-20 laptop:gap-24 
          desktop:min-h-screen desktop:gap-20 desktop:px-24`,children:[M.jsx(We.div,{initial:{opacity:0,x:105},whileInView:{opacity:1,x:0},transition:{duration:1},viewport:{once:!0},className:`flex w-full h-[300px] bg-gray-200 rounded-tl-[2rem] rounded-br-[2rem] z-10  overflow-hidden
              tablet:h-[calc((3/5)*100vh)] tablet:w-1/2 tablet:rounded-tl-[4rem] tablet:rounded-br-[4rem] 
              laptop:w-1/2`,children:M.jsx("img",{src:Jme,alt:"",className:"object-cover w-full h-full"})}),M.jsx("img",{src:Zme,alt:"",className:`hidden top-0 z-0 
            tablet:absolute tablet:right-0 tablet:w-auto tablet:m-auto tablet:min-h-[600px] tablet:max-h-[850px] tablet:block`}),M.jsxs(We.div,{variants:i0e,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"z-10 flex flex-col justify-center w-full gap-4 mobile:w-full mobile:gap-4 tablet:w-1/2 tablet:gap-10",children:[M.jsxs("h2",{className:`flex flex-col text-lg font-bold 
              mobile:text-xl 
              tablet:text-xl
            `,children:["Dan Murdoch Risk Services",M.jsx("strong",{className:`text-lg font-bold text-primary-300 
                mobile:text-2xl 
                tablet:text-2xl
              `,children:"Australia."})]}),M.jsx("div",{className:`flex flex-col gap-4 text-xs 
              mobile:text-sm 
              laptop:text-sm 
              desktop:text-base`,children:M.jsxs("p",{children:[M.jsx("strong",{className:"text-accent-500",children:"DMRS"})," ",M.jsx("strong",{className:"text-primary-300",children:"Australia"})," Pty Ltd is the parent company for the operational division Dan Murdoch Risk Services (Thailand) Co. Limited."]})})]})]})}),M.jsxs("section",{className:`z-10 flex flex-col gap-10 p-8 overflow-hidden navTrigger
        mobile:p-18 
        laptop:p-28 laptop:overflow-visible`,children:[M.jsxs("div",{className:"flex flex-col justify-center w-full col-span-3 gap-5",children:[M.jsx("p",{className:`font-bold text-center uppercase text-md text-bg-dark 
            laptop:text-xl`,children:"Who are Dan Murdoch Risk Services?"}),M.jsxs("p",{className:`self-center max-w-5xl text-center text-xs text-bg-dark 
            tablet:min-w-[565px] tablet:text-sm`,children:[M.jsx("strong",{className:"text-accent-800",children:"DMRS "}),M.jsx("strong",{className:"text-primary-400",children:"Australia "}),"Pty Ltd Pty Ltd operates all services offered under the banners of DMRS, Dan Murdoch Risk Services, Your Intelligence Program, and DMRS VPN."]})]}),M.jsxs("div",{className:`grid grid-rows-3 gap-10 
          mobile:grid-cols-3 mobile:grid-rows-1`,children:[M.jsxs(We.div,{initial:{opacity:0,y:80},whileInView:{opacity:1,y:0},transition:{duration:1},viewport:{once:!0},className:"flex flex-col items-center justify-start gap-2 px-5 py-10 border rounded-lg border-background-dark/05",children:[M.jsx("div",{className:"flex items-center justify-center h-20 aspect-square",children:M.jsx(We.div,{whileInView:{scale:[1,.5,1.3,1]},viewport:{once:!0},transition:{duration:1,ease:"easeIn",times:[0,1.5,1]},children:M.jsx(e0e,{size:60})})}),M.jsx("p",{className:"text-center",children:"Intelligence"})]}),M.jsxs(We.div,{initial:{opacity:0,y:80},whileInView:{opacity:1,y:0},transition:{duration:1},viewport:{once:!0},className:"flex flex-col items-center justify-start gap-2 px-5 py-10 border rounded-lg border-background-dark/05",children:[M.jsx("div",{className:"flex items-center justify-center h-20 aspect-square",children:M.jsx(We.div,{whileInView:{scale:[1,.5,1.3,1]},viewport:{once:!0},transition:{duration:1,ease:"easeIn",times:[0,1.5,1]},children:M.jsx(t0e,{size:60})})}),M.jsx("p",{className:"text-center",children:"Brand Identity"})]}),M.jsxs(We.div,{initial:{opacity:0,y:80},whileInView:{opacity:1,y:0},transition:{duration:1},viewport:{once:!0},className:"flex flex-col items-center justify-start gap-2 px-5 py-10 border rounded-lg border-background-dark/05",children:[M.jsx("div",{className:"flex items-center justify-center h-20 aspect-square",children:M.jsx(We.div,{whileInView:{scale:[1,.5,1.3,1]},viewport:{once:!0},transition:{duration:1,ease:"easeIn",times:[0,1.5,1]},children:M.jsx(r0e,{size:60})})}),M.jsx("p",{className:"text-center",children:"Data Collection"})]})]})]}),M.jsx("section",{className:`relative p-8 bg-background-dark 
        mobile:p-28 
        tablet:p-28`,children:M.jsxs("div",{className:`flex flex-col gap-10 
          mobile:flex-row`,children:[M.jsx(We.div,{initial:{opacity:0,scale:.5},whileInView:{opacity:1,scale:1},transition:{duration:1,ease:"easeOut"},viewport:{once:!0},className:"flex justify-center",children:M.jsx("img",{src:$me,alt:"",className:`object-contain w-1/2 h-full 
              mobile:w-auto`})}),M.jsxs("div",{className:`flex flex-col justify-center gap-3 text-center 
            mobile:text-left`,children:[M.jsx("p",{className:`text-sm 
              tablet:text-md 
              laptop:text-lg `,children:M.jsx(We.div,{initial:{opacity:0,y:-80},whileInView:{opacity:1,y:0},transition:{duration:.5,ease:"easeIn"},viewport:{once:!0},children:M.jsx("strong",{className:"text-primary-300",children:"Intelligent Intelligence"})})}),M.jsx("p",{className:`text-sm text-justify text-white 
                          tablet:text-base 
                          laptop:text-md`,children:M.jsx(We.div,{initial:{opacity:0,y:80},whileInView:{opacity:1,y:0},transition:{duration:.5,ease:"easeIn"},viewport:{once:!0},children:"Leads to thoughtful investigations and evidence-filled undercover operations resulting in a safer pharmaceutical environment globally."})})]})]})}),M.jsx("section",{className:`z-40 flex flex-col-reverse items-center w-full p-8 
      tablet:flex-row
      mobile:p-18 
      laptop:p-28`,children:M.jsxs("div",{className:"flex flex-col items-center flex-1 gap-5",children:[M.jsxs("h2",{className:`font-bold text-center text-md 
          laptop:text-xl 
          hd:text-xl`,children:["See our ",M.jsx("span",{className:"text-primary-300",children:"services"})," in full."]}),M.jsx(wr,{to:"/dmrs-fe/thailand#services_th",children:M.jsx(wc,{variant:"outline",children:"Our Services"})})]})})]})},s0e=({title:e,description:t,className:r})=>M.jsxs(We.div,{initial:{opacity:0},whileInView:{opacity:1},className:`flex flex-col gap-2 ${r}`,children:[M.jsx("h2",{className:"text-base mobile:text-md laptop:text-md desktop:text-md font-bold",children:e}),M.jsx("p",{className:"text-sm",children:t})]}),a0e=({name:e,icon:t,content:r,subContents:i})=>{const[n,s]=oe.useState(!1);return M.jsxs("div",{className:`relative overflow-hidden ease-in-out duration-300 flex flex-col text-base gap-2 bg-white ring-1 ring-gray-400 fill-accent-400/20 justify-center items-start aspect-video 
        ${n?"min-h-[320px] max-w-[100%] laptop:min-h-[400px] h-fit scale-[1.03] fill-accent-200/20 text-white ":"min-h-[300px] max-w-[100%] tablet:min-h-[320px] desktop:min-h-[360px] hover:scale-[1.03] hover:text-white"}
        tablet:min-w-full
        laptop:text-md 
        desktop:text-md
        before:content-[' '] before:min-h-0 before:absolute before:bottom-0 before:left-0 before:w-full before:bg-accent-500 before:duration-200 before:ease-in-out 
        ${n?"before:min-h-full":"before:delay-100 before:hover:min-h-full"}
      `,children:[M.jsx("div",{className:`card-scroll flex flex-col w-full h-full items-start justify-start px-6 mobile:px-6 tablet:px-6 laptop:px-8 desktop:px-8 pt-6 pb-12 gap-6 z-10 ${n?"items-start flex-col overflow-y-auto tablet:overflow-y-auto laptop:overflow-y-auto desktop:overflow-y-auto delay-200":"items-center"}`,children:n?i.map((a,o)=>M.jsx(s0e,{className:"text-white",title:a.title,description:a.description},o)):M.jsxs("div",{className:"flex flex-col gap-2",children:[e,r]})}),M.jsx("span",{className:`absolute top-16 -right-[10%] z-0 duration-500 ${n?"scale-125 rotate-12":" rotate-0"} `,children:t}),M.jsx("span",{className:`absolute z-20 ${n?"text-white bg-gradient-to-t from-accent-500 via-accent-500/90 to-accent-500/10":""} w-full pb-3 pt-6 bottom-0 px-6 mobile:px-6 tablet:px-6 laptop:px-8 text-xs cursor-pointer mobile:text-sm laptop:text-sm`,children:M.jsx("button",{onClick:()=>{s(a=>!a)},children:n?"Click to Hide <":"Click to Show >"})})]})},o0e={initial:{opacity:0,x:-20},animate:e=>({opacity:1,x:0,transition:{delay:e*.1,duration:.1}})},l0e=({children:e,content:t,parentHover:r,active:i,handleSelectActive:n,className:s=null,index:a})=>M.jsxs(We.div,{variants:o0e,initial:"initial",whileInView:"animate",viewport:{once:!0,margin:"100px"},custom:a,onClick:()=>n(t),className:`hover:pl-7 hover:grayscale-0 hover:opacity-100 hover:text-primary-300 hover:bg-black/5 text-background-dark gap-2 flex flex-col px-4 py-4 cursor-pointer transition-all duration-500 ${i?"pl-7 border-accent-400 text-accent-400":r?"grayscale text-background-dark opacity-50":"grayscale-0 text-background-dark opacity-100 border-black/20 "}`,children:[M.jsxs("div",{className:"flex items-center justify-between w-full",children:[M.jsx("h2",{className:`transition-[font-size] ${i?"text-sm desktop:text-base text-accent-400 font-medium pr-4 hd:text-md":"desktop:text-base hd:text-md"}`,children:t.name}),M.jsx(yL,{size:32,className:`transition-[transform] duration-700 ease-in-out min-w-[32px] ${i?"rotate-[90deg] text-accent-400":"rotate-0"}`})]}),M.jsx("div",{className:`overflow-hidden text-xs desktop:text-sm hd:text-base duration-1000 text-background-dark transition-[max-height] ease-in-out ${i?"max-h-[50rem]":"max-h-0"}`,children:t.content})]}),c0e=()=>{const e=[{name:"Office 365 SharePoint Development",content:"Experts in the setup and management of cloud computer services for law enforcement and private companies such as Office 365 together with SharePoint administration and management."},{name:"Anonymous Domain Name Registration",content:"Registration of anonymous domain names for our clients, law enforcement, security and investigation consultants worldwide."},{name:"Anonymous Website Hosting",content:"Hosting of pretext and websites anonymously only for our clients and industry personnel."},{name:"Covert Pretext Setups for Police and Investigative services worldwide.",content:"Setup of a complete pretext facility such as pretext website construction, hosting, business address and location services."},{name:"Covert Website Design",content:"Design and building a website to your required specifications."},{name:"Anonymous VPN and high end Proxy facility",content:"Login to our servers from any country by any device including iPhone, ipad other mobile devices and laptops. Traveling to such countries as China, Middle Eastern countries using the VPN service gives you secure access to all your data and online internet content without restriction."}],[t,r]=oe.useState(!1),[i,n]=oe.useState(e[0]),s=a=>{if(a.name===i.name)return;const o=e.findIndex(l=>l.name==a.name);n(e[o])};return M.jsx("div",{className:"z-10 flex-[1]",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:M.jsx("div",{className:"flex flex-col",children:e.map((a,o)=>M.jsx(l0e,{index:o,content:a,parentHover:t,active:a.name==(i==null?void 0:i.name),handleSelectActive:s},o))})})},h0e=()=>M.jsx(We.div,{viewport:{once:!0},whileInView:{scale:40,transition:{duration:.5,ease:n7,repeat:!1}},className:"absolute flex items-center justify-center bg-background-dark w-[100px] h-[100px] left-[50%] rounded-full z-0"}),u0e=[{title:"Trained Detectives",paragraph:M.jsxs(M.Fragment,{children:["DMRS staff are ",M.jsx("strong",{children:"trained detectives"})," and ",M.jsx("strong",{children:"intelligence analysts"})," who use both objective and subjective thinking to ",M.jsx("strong",{children:"gather online data and intelligence"})," for many Fortune 500 companies worldwide."]})},{title:"Premier and Innovative",paragraph:M.jsxs(M.Fragment,{children:["Our facilities also offer ",M.jsx("strong",{children:"premier and innovative investigative consultancy"})," in all areas of corporate and personal requirements."]})},{title:"Global Protection",paragraph:M.jsxs(M.Fragment,{children:["DMRS is proud to be focused on the ",M.jsx("strong",{children:"protection of patients globally"})," through our identification of risks concerned with the illicit trade in counterfeit, sub-standard and suspect medicines together with all associated risks to corporations tasked with the protection of consumers worldwide."]})}],d0e={animate:e=>({opacity:[0,1],x:[-80,0],transition:{delay:.3*e+1,duration:.4}})},p0e={animate:e=>({width:["110%","0%"],transition:{delay:.4*e+1,duration:.7}})},f0e=()=>M.jsx("div",{className:"w-full h-full flex items-center px-6",children:M.jsx(We.div,{whileInView:{opacity:[0,1],x:[-80,0],transition:{delay:1,duration:1,staggerChildren:.1}},viewport:{once:!0},className:`flex flex-col h-full gap-y-10 gap-x-5 items-center text-white
        tablet:gap-y-20
        laptop:gap-y-[9rem]
        desktop:gap-y-32
        `,children:u0e.map((e,t)=>M.jsxs("div",{className:`grid h-full gap-2 items-center text-white
              tablet:gap-3
              laptop:grid-cols-2 laptop:gap-10
              desktop:gap-20
          `,children:[M.jsx(We.div,{variants:d0e,viewport:{once:!0},whileInView:"animate",custom:t,className:"flex items-center w-full",children:M.jsx("h1",{className:`relative text-md
                  tablet:text-lg 
                  laptop:text-xl 
                  desktop:text-2xl 
                `,children:e.title})}),M.jsxs(We.p,{className:"relative desktop:text-base",children:[M.jsx(We.span,{variants:p0e,viewport:{once:!0},whileInView:"animate",custom:t,className:"absolute right-0 bg-background-dark min-h-full"}),e.paragraph]})]},t))})}),Yl={initial:{opacity:0,x:-80},animate:e=>({opacity:1,x:0,transition:{delay:e*.3,duration:.7}})},m0e=()=>{let e="300";new Array(28);const t=oe.useRef([]),r=Pl();oe.useEffect(()=>{if(r.hash==="#services_th"){const s=document.getElementById("services_th");s&&s.scrollIntoView({behavior:"smooth"})}},[r]);function i(s){s.classList.contains("active")||!s||(s.classList.add("fill"),setTimeout(()=>{s.classList.remove("fill")},Math.random()*2*5e3))}oe.useEffect(()=>{const s=setInterval(()=>{const a=t.current[Math.floor(Math.random()*25)];i(a)},5e3);return()=>clearInterval(s)},[]);const n=[{name:M.jsx("p",{className:"self-start font-bold",children:"Intelligence"}),icon:M.jsx(qme,{width:e,height:e}),content:M.jsx("p",{className:"text-sm",children:"We are the industry leaders in manual intelligence collection, product monitoring and global investigative work protecting Fortune 500 companies with a worldwide footprint."}),subContent:[{title:"Online Intelligence Data Collection and Analysis",description:"Unique manual online intelligence monitoring service. Intelligent intelligence protecting your products and company online. All data collected is secured and displayed within a SharePoint environment for access 24/7 with corporate visual presentations linked to the raw data collected."},{title:"Intellectual Property Protection",description:"Many global Fortune 500 companies leave their trademark, copyright and intellectual property protection in our hands. Many companies in the worldwide pharmaceutical marketplace trust us to protect them with our hands-on manual intelligence and investigative consultancy."}]},{name:M.jsx("p",{className:"self-start font-bold",children:"Research"}),icon:M.jsx(Xme,{width:e,height:e}),content:M.jsx("p",{className:"text-sm",children:"If you have a problem whether it is offline or online we proactively research using our research methodology and tools to give you an appropriate and considered answer."}),subContent:[{title:"Business Intelligence and Research",description:"Background checks within the geographical area of your concern involving in-depth overt and covert research being conducted resulting in fact driven reporting you can rely on."}]},{name:M.jsx("p",{className:"self-start font-bold",children:"Investigations"}),icon:M.jsx(Yme,{width:e,height:e}),content:M.jsx("p",{className:"text-sm",children:"We investigate your specific problem are experienced in correct evidence gathering procedures and are aware of the complex skills required to ensure that the integrity of a company is never placed in doubt."}),subContent:[{title:"Online Investigations",description:'Dan Murdoch Risk Services has set the "industry standard" in online investigations conducting research and pretext engagement leading to undercover investigations and evidence collection on a global footing.'}]}];return M.jsxs("div",{className:"flex flex-col items-center justify-center w-full bg-white overflow-clip",children:[M.jsx(Mv,{children:M.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:M.jsxs("div",{className:"relative z-10 flex flex-col w-full h-full",children:[M.jsx(Bv,{}),M.jsx("div",{className:"absolute top-0 left-0 z-40 w-3/4 h-full opacity-50 bg-gradient-to-r from-black via-black to-transparent"}),M.jsxs("div",{className:"z-50 relative flex flex-col items-center overflow-auto h-full w-full gap-2 py-[calc(4rem+2rem)] text-white px-10 laptop:px-28",children:[M.jsx("div",{className:"absolute z-50 hidden scale-110 -rotate-90 laptop:block bottom-28 right-28",children:M.jsxs("div",{className:"flex items-center gap-5 animate-ltr",children:[M.jsx(o2,{className:"scale-x-[150%]"}),M.jsx("p",{className:"whitespace-nowrap",children:"Scroll Down"})]})}),M.jsxs("div",{className:"flex flex-col items-center w-full gap-10 laptop:gap-20 laptop:flex-row",children:[M.jsx(We.div,{initial:{x:"-100%"},animate:{x:0},transition:{duration:1,ease:"easeOut"},className:"flex flex-col col-span-3",children:M.jsx("img",{src:"./images/DMRS.webp",alt:"",className:"w-full invert"})}),M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:"text-base text-center items mobile:text-left laptop:hidden",children:"Dan Murdoch Risk Services"}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:"hidden laptop:flex flex-col min-w-[15rem] rounded-lg overflow-hidden w-full",children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]}),M.jsxs("div",{className:"flex flex-col w-full h-full gap-10 tablet:flex-row tablet:mt-10 laptop:flex-col laptop:self-start",children:[M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:"hidden text-base mobile:text-left laptop:block",children:"Dan Murdoch Risk Services"}),M.jsx(We.div,{initial:{x:-450},animate:{x:0},transition:{delay:.4,duration:1,ease:"easeOut"},className:`flex flex-col items-center justify-center gap-1 
                  tablet:w-1/2
                  laptop:mt-auto laptop:items-start `,children:M.jsx("p",{className:"z-10 text-md laptop:text-xl",children:"THAILAND"})}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`flex 
                  tablet:w-1/2
                  laptop:hidden flex-col min-w-[15rem] rounded-lg overflow-hidden w-full mt-auto`,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]})]})]})})}),M.jsx("section",{className:"navTrigger",children:M.jsxs("div",{className:"relative flex flex-col w-full gap-6 px-6 py-8 h-fit mobile:py-10 mobile:px-12 tablet:items-center tablet:px-12 tablet:flex-row laptop:p-20 laptop:gap-24 desktop:min-h-screen desktop:gap-20 desktop:px-24 z-20",children:[M.jsx("div",{className:"flex w-full h-[300px] bg-gray-200 rounded-tl-[2rem] rounded-br-[2rem] tablet:h-[calc((3/5)*100vh)] tablet:w-1/2 laptop:w-1/2 tablet:rounded-tl-[4rem] tablet:rounded-br-[4rem] overflow-hidden",children:M.jsx("img",{src:"./images/dmrs-thailand.webp",alt:"",className:"object-cover w-full h-full"})}),M.jsx("img",{src:"/images/thailand-map.png",alt:"",className:"absolute opacity-50 h-full brightness-90 -z-10 top-0 right-0 hidden mobile:block laptop:right-[20%]"}),M.jsxs(We.div,{variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:1,className:"z-10 flex flex-col justify-center w-full gap-4 tablet:w-1/2 tablet:gap-10",children:[M.jsxs("h2",{className:"flex flex-col text-lg font-bold mobile:text-xl",children:["Dan Murdoch Risk Services ",M.jsx("strong",{className:"text-lg font-bold text-primary-300 mobile:text-2xl ",children:"Thailand."})]}),M.jsx("div",{className:"flex flex-col gap-4 text-xs mobile:text-sm desktop:text-base",children:M.jsxs("p",{children:[M.jsx("strong",{className:"text-accent-500",children:"DMRS"})," ",M.jsx("strong",{className:"text-primary-300",children:"Thailand"})," Co. Limited is based in Thailand with staff also in the Philippines, Australia, Hong Kong and China with trusted and verified agents in many global locations."]})})]})]})}),M.jsx("section",{className:"flex items-center justify-center relative overflow-hidden",children:M.jsxs(We.div,{whileInView:{opacity:[0,1],transition:{duration:1,delay:.5}},viewport:{once:!0},className:`flex w-full gap-6 py-14 min-h-fit justify-center items-center
          mobile:px-12 mobile:h-fit mobile:flex-col 
          tablet:items-center tablet:px-24 tablet:flex-col 
          laptop:p-20 laptop:gap-24 laptop:w-full 
          desktop:w-[90%] desktop:min-h-screen desktop:gap-20 desktop:px-24
          before:absolute before:content-[''] before:top-0 before:bg-gradient-to-t before:from-background-dark before:to-background-light before:min-h-[5px] before:min-w-full after:z-10 
          after:absolute after:content-[''] after:bottom-0 after:bg-gradient-to-b after:from-background-dark after:to-background-light after:min-h-[5px] after:min-w-full before:z-10 
        `,children:[M.jsx(h0e,{}),M.jsx(f0e,{}),M.jsx("div",{className:"absolute top-0 bg-gradient-to-t from-background-dark to-white min-h-[5px] min-w-full z-10"})]})}),M.jsx("div",{id:"services_th",className:"pt-10",children:M.jsxs(We.section,{className:`relative flex items-start min-w-full min-h-full pb-20 overflow-hidden align-middle px-6
          mobile:max-w-full 
          tablet:px-12
          tablet:mt-10 
          laptop:gap-10`,variants:Yl,initial:"initial",id:"services_th",whileInView:"animate",viewport:{once:!0},custom:1,children:[M.jsx("div",{className:`absolute left-0 grid w-full h-full grid-cols-3 -top-10 
            laptop:grid-cols-8`,children:M.jsx(zP,{cellCount:40,cellClass:"border border-background-dark/5"})}),M.jsxs("div",{className:`flex flex-col h-full gap-6 px-6
              laptop:px-12 
              desktop:px-[4.5rem]`,children:[M.jsxs("div",{className:"flex flex-col items-start gap-2",children:[M.jsx("h2",{className:"z-10 text-lg font-bold mobile:text-xl laptop:text-xl",children:"Services"}),M.jsxs("p",{className:"z-10 gap-1 text-sm mobile:text-xs desktop:text-xs",children:["The services DMRS offers fall into three categories",M.jsx(We.span,{className:"font-bold",variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:2,children:" INTELLIGENCE,"}),M.jsx(We.span,{className:"font-bold",variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:4,children:" INVESTIGATIONS,"}),M.jsx(We.span,{className:"font-bold",variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:6,children:" RESEARCH."})]})]}),M.jsx("div",{className:"flex flex-row items-center justify-start",children:M.jsx(We.div,{variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:6,className:`z-10 grid grid-rows-1 gap-4 fill-black justify-center w-full
                tablet:grid-cols-2 tablet:gap-6
                desktop:grid-cols-3`,children:n.map((s,a)=>M.jsx(a0e,{name:s.name,icon:s.icon,content:s.content,subContents:s.subContent},a))})})]})]})}),M.jsx("section",{className:`flex flex-col items-center justify-center w-full h-full gap-10 mb-10 px-6
          mobile:max-w-full 
          tablet:px-12 tablet:max-w-full
          tablet:mt-10 
          laptop:gap-10`,children:M.jsxs(We.div,{className:`flex flex-col items-start gap-2 px-6
          laptop:px-12 
          desktop:px-[4.5rem]`,variants:Yl,initial:"initial",whileInView:"animate",viewport:{once:!0},custom:4,children:[M.jsx("h2",{className:"z-10 font-bold text-md mobile:text-xl laptop:text-xl",children:"Other Services"}),M.jsx("p",{className:"z-10 text-sm mobile:text-xs desktop:text-base",children:"However, as an additional service to our partners, we offer further unique capabilities such as -"}),M.jsx(c0e,{})]})})]})},g0e=()=>{const e=i=>{const n=i.target.name;r(s=>({...s,[n]:i.target.value}))},[t,r]=oe.useState({name:"",email:"",services:"",message:""});return M.jsx("div",{className:`flex gap-10 w-full bg-background-light navTrigger laptop:gap-0 justify-center py-24
          mobile:py-24
          tablet:py-32
          laptop:py-40
        `,children:M.jsx("div",{className:`flex flex-col w-[90%] min-h-full 
              mobile:w-[90%]
              laptop:w-[80%] laptop:flex-row
              desktop:w-[70%]
            `,children:M.jsxs("div",{className:`grid grid-cols-4 gap-10
                mobile:gap-10 
                tablet:gap-20
                laptop:gap-40
              `,children:[M.jsx("div",{className:"col-span-4 mobile:col-span-4 laptop:col-span-3",children:M.jsxs("h1",{className:`text-lg text-background-dark font-bold
                    mobile:text-xl
                    tablet:text-3xl
                  `,children:["Start a Project with",M.jsx("span",{className:`font-bold text-primary-300 text-lg pl-2
                      mobile:text-2xl
                      tablet:text-5xl
                    `,children:"DMRS"})]})}),M.jsxs("div",{className:`grid grid-cols-1 gap-10 col-span-4
                mobile:grid-cols-1 mobile:gap-10
                laptop:grid-cols-4 laptop:gap-20
                `,children:[M.jsxs("form",{className:`flex flex-col col-span-3 self-center flex-1 w-full gap-3 relative
                    mobile:col-span-1 
                    laptop:col-span-3
                  `,children:[M.jsxs("div",{className:"border-b border-secondary-800/20 pb-3",children:[M.jsx(qo,{className:"text-background-dark",label:"What's your name?",name:"name",placeholder:"Enter your name",onInput:e,value:t.name,number:"01"}),M.jsx(qo,{className:"text-background-dark",label:"What's your email address?",name:"email",placeholder:"Enter your email address",onInput:e,value:t.email,number:"02"}),M.jsx(qo,{className:"text-background-dark",label:"What services are you looking for?",name:"services",placeholder:"Data Collection, Online Investigations, Business Intelligence",onInput:e,value:t.services,number:"03"}),M.jsx(qo,{className:"text-background-dark",label:"Message",name:"message",placeholder:"Leave us a message!",onInput:e,value:t.message,number:"04"})]}),M.jsx("button",{className:"rounded-lg bg-primary-300 left-10 px-12 py-3 hover:bg-primary-200",children:M.jsx("a",{href:"mailto:test@gmail.com",children:"Send it!"})})]}),M.jsxs("div",{className:`grid col-span-1 gap-5
                    mobile:grid mobile:gap-10
                  `,children:[M.jsxs("div",{className:"flex flex-col gap-1 ",children:[M.jsx("p",{className:"text-secondary-800/60 text-xs",children:"Contact Details"}),M.jsx("p",{className:"text-background-dark",children:"dmrs.thailand@dmrs.com"}),M.jsx("p",{className:"text-background-dark",children:"+8(02) 345 678"})]}),M.jsxs("div",{className:"flex flex-col gap-1",children:[M.jsx("p",{className:"text-secondary-800/60 text-xs",children:"Business Details"}),M.jsx("p",{className:"text-background-dark",children:"P.O. Box 37"}),M.jsx("p",{className:"text-background-dark whitespace-nowrap",children:"Yannawa, Bangkok - 10120"}),M.jsx("p",{className:"text-background-dark",children:"Thailand"})]}),M.jsxs("div",{className:"flex flex-col gap-1",children:[M.jsx("p",{className:"text-secondary-800/60 text-xs",children:"Locations"}),M.jsx("p",{className:"text-background-dark",children:"Thailand"}),M.jsx("p",{className:"text-background-dark",children:"Hongkong"}),M.jsx("p",{className:"text-background-dark",children:"Australia"}),M.jsx("p",{className:"text-background-dark",children:"China"}),M.jsx("p",{className:"text-background-dark",children:"Philippines"})]})]})]})]})})})},v0e=({content:e,listType:t})=>M.jsx("li",{children:M.jsx("p",{children:e})}),y0e=({content:e,subParagraph:t})=>M.jsxs("div",{className:"flex flex-col gap-6",children:[M.jsx("li",{children:M.jsx("p",{children:e})}),t?M.jsxs("ol",{className:"pl-10 list-decimal",children:[" ",t.map((r,i)=>M.jsx(v0e,{content:r.content},i))," "]}):""]}),x0e=()=>{const e=[{content:"When accessing our Website, Dan Murdoch Risk Services will learn certain information about you during your visit. How we will handle information we learn about you depends upon what you do when visiting our site.If you visit our site to read or download information on our pages, we collect and store only the following information about you:",subParagraph:[{content:"The name of the domain from which you access the Internet"},{content:"The date and time you access our site"},{content:"The Internet address of the website you used to link directly to our site"},{content:"No information is stored about visitors to this site"}]},{content:"If you identify yourself by sending us an e-mail containing personal information, then the information collected will be solely used to respond to your message.The information collected is for statistical purposes. Dan Murdoch Risk Services may use software programs to create summary statistics, which are used for such purposes as assessing the number of visitors to the different sections of our site, what information is of most and least interest, determining technical design specifications, and identifying system performance or problem areas."},{content:"For site security purposes and to ensure that this service remains available to all users, Dan Murdoch Risk Services uses software programs to monitor network traffic to identify unauthorized attempts to upload or change information, or otherwise cause damage."},{content:"Dan Murdoch Risk Services will not obtain personally-identifying information about you when you visit our site, unless you choose to provide such information to us, nor will such information be sold or otherwise transferred to unaffiliated third parties without the approval of the user at the time of collection."}];return M.jsx("section",{className:"navTrigger",children:M.jsxs("div",{className:"flex bg-white flex-col w-full gap-6 px-6 py-24 h-fit mobile:py-24 mobile:p-12 mobile:h-fit mobile:flex-col tablet:p-24 tablet:flex-col laptop:px-20 laptop:py-20 laptop:gap-12 desktop:gap-10 desktop:p-36",children:[M.jsxs("div",{children:[M.jsx("h1",{className:"z-10 text-xl font-bold mobile:text-left mobile:text-2xl tablet:text-2xl",children:"PRIVACY POLICY"}),M.jsx("h2",{className:"z-10 text-sm text-accent-800 font-bold mobile:text-left mobile:text-base tablet:text-base",children:"Dan Murdoch Risk Services"})]}),M.jsx("ul",{className:"flex flex-col gap-6",children:e.map((t,r)=>M.jsx(y0e,{content:t.content,subParagraph:t.subParagraph??""},r))})]})})},b0e=({content:e})=>M.jsx("li",{children:M.jsx("p",{children:e})}),w0e=({title:e,content:t,subParagraph:r})=>M.jsxs("div",{className:"flex flex-col gap-6",children:[M.jsxs("li",{className:"font-bold",children:[M.jsx("p",{children:e}),M.jsx("div",{className:"font-normal flex flex-col gap-6",children:t})]}),r?M.jsxs("ol",{className:"pl-10 list-decimal flex flex-col gap-3",children:[r.map((i,n)=>M.jsx(b0e,{content:i.content},n))," "]}):""]}),C0e=()=>{const e=[{title:"User's Acknowledgment and Acceptance of Terms",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:'Dan Murdoch Risk Services ("Us" or "We") provides the yourintell.com site and various related services (collectively, the "site") to you, the user, subject to your compliance with all the terms, conditions, and notices contained or referenced herein (the "Terms of Use"), as well as any other written agreement between us and you. In addition, when using particular services or materials on this site, users shall be subject to any posted rules applicable to such services or materials that may contain terms and conditions in addition to those in these Terms of Use. All such guidelines or rules are hereby incorporated by reference into these Terms of Use.'}),M.jsx("p",{children:"BY USING THIS SITE, YOU AGREE TO BE BOUND BY THESE TERMS OF USE. IF YOU DO NOT WISH TO BE BOUND BY THE THESE TERMS OF USE, PLEASE EXIT THE SITE NOW. YOUR REMEDY FOR DISSATISFACTION WITH THIS SITE, OR ANY PRODUCTS, SERVICES, CONTENT, OR OTHER INFORMATION AVAILABLE ON OR THROUGH THIS SITE, IS TO STOP USING THE SITE AND/OR THOSE PARTICULAR PRODUCTS OR SERVICES. YOUR AGREEMENT WITH US REGARDING COMPLIANCE WITH THESE TERMS OF USE BECOMES EFFECTIVE IMMEDIATELY UPON COMMENCEMENT OF YOUR USE OF THIS SITE."}),M.jsx("p",{children:"These Terms of Use are effective as of 1st. July 2011. We expressly reserve the right to change these Terms of Use from time to time without notice to you. You acknowledge and agree that it is your responsibility to review this site and these Terms of Use from time to time and to familiarize yourself with any modifications. Your continued use of this site after such modifications will constitute acknowledgment of the modified Terms of Use and agreement to abide and be bound by the modified Terms of Use."}),M.jsx("p",{children:'As used in these Terms of Use, references to our "Affiliates" include our owners, subsidiaries, affiliated companies, officers, directors, suppliers, partners, sponsors, and advertisers, and includes (without limitation) all parties involved in creating, producing, and/or delivering this site and/or its contents.'})]})},{title:"Description of Services",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"We make various services available on this site including, but not limited to, Intelligence gathering, data collection, investigation services, internet research, research, online services, and other like services. You are responsible for providing, at your own expense, all equipment necessary to use the services, including a computer, modem, and Internet access (including payment of all fees associated with such access)."}),M.jsx("p",{children:"We reserve the sole right to either modify or discontinue the site, including any of the site's features, at any time with or without notice to you. We will not be liable to you or any third party should we exercise such right. Any new features that augment or enhance the then-current services on this site shall also be subject to these Terms of Use."})]})},{title:"Registration Data and Privacy",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:'In order to access some of the services on this site, you will be required to use an account and password that can be obtained by completing our online registration form, which requests certain information and data ("Registration Data"), and maintaining and updating your Registration Data as required. By registering, you agree that all information provided in the Registration Data is true and accurate and that you will maintain and update this information as required in order to keep it current, complete, and accurate.'}),M.jsx("p",{children:"You also grant us the right to disclose to third parties certain Registration Data about you. The information we obtain through your use of this site, including your Registration Data, is subject to our Privacy Policy, which is specifically incorporated by reference into these Terms of Use."})]})},{title:"Conduct on Site",content:"Your use of the site is subject to all applicable laws and regulations, and you are solely responsible for the substance of your communications through the site. By posting information in or otherwise using any communications service, chat room, message board, newsgroup, software library, or other interactive service that may be available to you on or through this site, you agree that you will not upload, share, post, or otherwise distribute or facilitate distribution of any content -- including text, communications, software, images, sounds, data, or other information -- that:",subParagraph:[{content:"is unlawful, threatening, abusive, harassing, defamatory, libelous, deceptive, fraudulent, invasive of another's privacy, tortious, contains explicit or graphic descriptions or accounts of sexual acts (including but not limited to sexual language of a violent or threatening nature directed at another individual or group of individuals), or otherwise violates our rules or policies;"},{content:"victimizes, harasses, degrades, or intimidates an individual or group of individuals on the basis of religion, gender, sexual orientation, race, ethnicity, age, or disability;"},{content:"infringes on any patent, trademark, trade secret, copyright, right of publicity, or other proprietary right of any party;"},{content:'constitutes unauthorized or unsolicited advertising, junk or bulk email (also known as "spamming"), chain letters, any other form of unauthorized solicitation, or any form of lottery or gambling;'},{content:"contains software viruses or any other computer code, files, or programs that are designed or intended to disrupt, damage, or limit the functioning of any software, hardware, or telecommunications equipment or to damage or obtain unauthorized access to any data or other information of any third party; or"},{content:" impersonates any person or entity, including any of our employees or representatives."}]},{title:"Third Party Sites and Information",content:"This site may link you to other sites on the Internet or otherwise include references to information, documents, software, materials and/or services provided by other parties. These sites may contain information or material that some people may find inappropriate or offensive. These other sites and parties are not under our control, and you acknowledge that we are not responsible for the accuracy, copyright compliance, legality, decency, or any other aspect of the content of such sites, nor are we responsible for errors or omissions in any references to other parties or their products and services. The inclusion of such a link or reference is provided merely as a convenience and does not imply endorsement of, or association with, the site or party by us, or any warranty of any kind, either express or implied."},{title:" Intellectual Property Information",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"Copyright (c) 1st. July 2011 Dan Murdoch Risk Services All Rights Reserved."}),M.jsx("p",{children:'For purposes of these Terms of Use, "content" is defined as any information, data, communications, software, photos, video, graphics, music, sounds, and other material and services that can be viewed by users on our site. This includes message boards, chat, and other original content.'}),M.jsx("p",{children:"By accepting these Terms of Use, you acknowledge and agree that all content presented to you on this site is protected by copyrights, trademarks, service marks, patents or other proprietary rights and laws, and is the sole property of Dan Murdoch Risk Services and/or its Affiliates. You are only permitted to use the content as expressly authorized by us or the specific content provider. Except for a single copy made for personal use only, you may not copy, reproduce, modify, republish, upload, post, transmit, or distribute any documents or information from this site in any form or by any means without prior written permission from us or the specific content provider, and you are solely responsible for obtaining permission before reusing any copyrighted material that is available on this site. Any unauthorized use of the materials appearing on this site may violate copyright, trademark and other applicable laws and could result in criminal or civil penalties."}),M.jsx("p",{children:`Neither we or our Affiliates warrant or represent that your use of materials displayed on, or obtained through, this site will not infringe the rights of third parties. See "User's Materials" below for a description of the procedures to be followed in the event that any party believes that content posted on this site infringes on any patent, trademark, trade secret, copyright, right of publicity, or other proprietary right of any party.`}),M.jsx("p",{children:"All custom graphics, icons, logos and service names are registered trademarks, trademarks or service marks of Dan Murdoch Risk Services or its Affiliates. All other trademarks or service marks are property of their respective owners. Nothing in these Terms of Use grants you any right to use any trademark, service mark, logo, and/or the name of Dan Murdoch Risk Services or its Affiliates."})]})},{title:" Unauthorized Use of Materials",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"Subject to our Privacy Policy, any communication or material that you transmit to this site or to us, whether by electronic mail, post, or other means, for any reason, will be treated as non-confidential and non-proprietary. While you retain all rights in such communications or material, you grant us and our agents and affiliates a non-exclusive, paid-up, perpetual, and worldwide right to copy, distribute, display, perform, publish, translate, adapt, modify, and otherwise use such material for any purpose regardless of the form or medium (now known or not currently known) in which it is used."}),M.jsx("p",{children:"Please do not submit confidential or proprietary information to us unless we have mutually agreed in writing otherwise. We are also unable to accept your unsolicited ideas or proposals, so please do not submit them to us in any circumstance."}),M.jsx("p",{children:"We respect the intellectual property of others, and we ask you to do the same. If you or any user of this site believes its copyright, trademark or other property rights have been infringed by a posting on this site, you or the user should send notification to our Designated Agent (as identified below) immediately. To be effective, the notification must include:"})]}),subParagraph:[{content:"Identify in sufficient detail the copyrighted work that you believe has been infringed upon or other information sufficient to specify the copyrighted work being infringed)."},{content:"Identify the material that you claim is infringing the copyrighted work listed in item #1 above."},{content:"Provide information reasonably sufficient to permit us to contact you (email address is preferred)."},{content:"Provide information, if possible, sufficient to permit us to notify the owner/administrator of the allegedly infringing webpage or other content (email address is preferred)."},{content:'Include the following statement: "I have a good faith belief that use of the copyrighted materials described above as allegedly infringing is not authorized by the copyright owner, its agent, or the law."'},{content:' Include the following statement: "I swear, under penalty of perjury, that the information in the notification is accurate and that I am the copyright owner or am authorized to act on behalf of the owner of an exclusive right that is allegedly infringed."'},{content:"Sign the paper."},{content:"Send the written communication to the following address:Designated Agent for Claimed Infringement:You acknowledge and agree that upon receipt of a notice of a claim of copyright infringement, we may immediately remove the identified materials from our site without liability to you or any other party and that the claims of the complaining party and the party that originally posted the materials will be referred to the United States Copyright Office for adjudication as provided in the Digital Millennium Copyright Act."}]},{title:"Disclaimer of Warranties",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:'ALL MATERIALS AND SERVICES ON THIS SITE ARE PROVIDED ON AN "AS IS" AND "AS AVAILABLE" BASIS WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR THE WARRANTY OF NON-INFRINGEMENT. WITHOUT LIMITING THE FOREGOING, WE MAKE NO WARRANTY THAT (A) THE SERVICES AND MATERIALS WILL MEET YOUR REQUIREMENTS, (B) THE SERVICES AND MATERIALS WILL BE UNINTERRUPTED, TIMELY, SECURE, OR ERROR-FREE, (C) THE RESULTS THAT MAY BE OBTAINED FROM THE USE OF THE SERVICES OR MATERIALS WILL BE EFFECTIVE, ACCURATE OR RELIABLE, OR (D) THE QUALITY OF ANY PRODUCTS, SERVICES, OR INFORMATION PURCHASED OR OBTAINED BY YOU FROM THE SITE FROM US OR OUR AFFILIATES WILL MEET YOUR EXPECTATIONS OR BE FREE FROM MISTAKES, ERRORS OR DEFECTS.'}),M.jsx("p",{children:"THIS SITE COULD INCLUDE TECHNICAL OR OTHER MISTAKES, INACCURACIES OR TYPOGRAPHICAL ERRORS. WE MAY MAKE CHANGES TO THE MATERIALS AND SERVICES AT THIS SITE, INCLUDING THE PRICES AND DESCRIPTIONS OF ANY PRODUCTS LISTED HEREIN, AT ANY TIME WITHOUT NOTICE. THE MATERIALS OR SERVICES AT THIS SITE MAY BE OUT OF DATE, AND WE MAKE NO COMMITMENT TO UPDATE SUCH MATERIALS OR SERVICES."}),M.jsx("p",{children:"THIS SITE COULD INCLUDE TECHNICAL OR OTHER MISTAKES, INACCURACIES OR TYPOGRAPHICAL ERRORS. WE MAY MAKE CHANGES TO THE MATERIALS AND SERVICES AT THIS SITE, INCLUDING THE PRICES AND DESCRIPTIONS OF ANY PRODUCTS LISTED HEREIN, AT ANY TIME WITHOUT NOTICE. THE MATERIALS OR SERVICES AT THIS SITE MAY BE OUT OF DATE, AND WE MAKE NO COMMITMENT TO UPDATE SUCH MATERIALS OR SERVICES."}),M.jsx("p",{children:"THE USE OF THE SERVICES OR THE DOWNLOADING OR OTHER ACQUISITION OF ANY MATERIALS THROUGH THIS SITE IS DONE AT YOUR OWN DISCRETION AND RISK AND WITH YOUR AGREEMENT THAT YOU WILL BE SOLELY RESPONSIBLE FOR ANY DAMAGE TO YOUR COMPUTER SYSTEM OR LOSS OF DATA THAT RESULTS FROM SUCH ACTIVITIES."}),M.jsx("p",{children:"Through your use of the site, you may have the opportunities to engage in commercial transactions with other users and vendors. You acknowledge that all transactions relating to any merchandise or services offered by any party, including, but not limited to the purchase terms, payment terms, warranties, guarantees, maintenance and delivery terms relating to such transactions, are agreed to solely between the seller or purchaser of such merchandize and services and you. WE MAKE NO WARRANTY REGARDING ANY TRANSACTIONS EXECUTED THROUGH, OR IN CONNECTION WITH THIS SITE, AND YOU UNDERSTAND AND AGREE THAT SUCH TRANSACTIONS ARE CONDUCTED ENTIRELY AT YOUR OWN RISK. ANY WARRANTY THAT IS PROVIDED IN CONNECTION WITH ANY PRODUCTS, SERVICES, MATERIALS, OR INFORMATION AVAILABLE ON OR THROUGH THIS SITE FROM A THIRD PARTY IS PROVIDED SOLELY BY SUCH THIRD PARTY, AND NOT BY US OR ANY OTHER OF OUR AFFILIATES."}),M.jsx("p",{children:"Content available through this site often represents the opinions and judgments of an information provider, site user, or other person or entity not connected with us. We do not endorse, nor are we responsible for the accuracy or reliability of, any opinion, advice, or statement made by anyone other than an authorized Dan Murdoch Risk Services spokesperson speaking in his/her official capacity. Please refer to the specific editorial policies posted on various sections of this site for further information, which policies are incorporated by reference into these Terms of Use."}),M.jsx("p",{children:"You understand and agree that temporary interruptions of the services available through this site may occur as normal events. You further understand and agree that we have no control over third party networks you may access in the course of the use of this site, and therefore, delays and disruption of other network transmissions are completely beyond our control."}),M.jsx("p",{children:'You understand and agree that the services available on this site are provided "AS IS" and that we assume no responsibility for the timeliness, deletion, mis-delivery or failure to store any user communications or personalization settings.'}),M.jsx("p",{children:"SOME STATES OR JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF CERTAIN WARRANTIES, SO SOME OF THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU."})]})},{title:"Limitation of Liability",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"IN NO EVENT SHALL WE OR OUR AFFILIATES BE LIABLE TO YOU OR ANY THIRD PARTY FOR ANY SPECIAL, PUNITIVE, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER, INCLUDING, WITHOUT LIMITATION, THOSE RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, AND ON ANY THEORY OF LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OF THIS SITE OR OF ANY WEB SITE REFERENCED OR LINKED TO FROM THIS SITE."}),M.jsx("p",{children:"FURTHER, WE SHALL NOT BE LIABLE IN ANY WAY FOR THIRD PARTY GOODS AND SERVICES OFFERED THROUGH THIS SITE OR FOR ASSISTANCE IN CONDUCTING COMMERCIAL TRANSACTIONS THROUGH THIS SITE, INCLUDING WITHOUT LIMITATION THE PROCESSING OF ORDERS."}),M.jsx("p",{children:"SOME JURISDICTIONS PROHIBIT THE EXCLUSION OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES, SO THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU."})]})},{title:"Indemnification",content:"Upon a request by us, you agree to defend, indemnify, and hold us and our Affiliates harmless from all liabilities, claims, and expenses, including attorney's fees, that arise from your use or misuse of this site. We reserve the right, at our own expense, to assume the exclusive defense and control of any matter otherwise subject to indemnification by you, in which event you will cooperate with us in asserting any available defenses."},{title:"Security and Password",content:"You are solely responsible for maintaining the confidentiality of your password and account and for any and all statements made and acts or omissions that occur through the use of your password and account. Therefore, you must take steps to ensure that others do not gain access to your password and account. Our personnel will never ask you for your password. You may not transfer or share your account with anyone, and we reserve the right to immediately terminate your account if you do transfer or share your account."},{title:"Participation in Promotions",content:"From time to time, this site may include advertisements offered by third parties. You may enter into correspondence with or participate in promotions of the advertisers showing their products on this site. Any such correspondence or promotions, including the delivery of and the payment for goods and services, and any other terms, conditions, warranties or representations associated with such correspondence or promotions, are solely between you and the advertiser. We assume no liability, obligation or responsibility for any part of any such correspondence or promotion."},{title:"E-mail, Messaging, Blogging, and Chat Services",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:'We may make email, messaging, blogging, or chat services (collectively, "Communications") available to users of our site, either directly or through a third-party provider. We make available separate supplemental agreements characterizing the relationship between you and us that, except where expressly noted or contradictory, includes these Terms.'}),M.jsx("p",{children:"We will not inspect or disclose the contents of private Communications except with the consent of the sender or the recipient, or in the narrowly-defined situations provided under the Electronic Communications Privacy Act, or as other required by law or by court or governmental order. Further information is available in our Privacy Policy."}),M.jsx("p",{children:'We may employ automated monitoring devices or techniques to protect our users from mass unsolicited communications (also known as "spam") and/or other types of electronic communications that we deem inconsistent with our business purposes. However, such devices or techniques are not perfect, and we will not be responsible for any legitimate communication that is blocked, or for any unsolicited communication that is not blocked.'}),M.jsx("p",{children:"Mailboxes may have a limited storage capacity. If you exceed the maximum permitted storage space, we may employ automated devices that delete or block email messages that exceed the limit. We will not be responsible for such deleted or blocked messages."})]})},{title:"International Use",content:"Although this site may be accessible worldwide, we make no representation that materials on this site are appropriate or available for use in locations outside the United States, and accessing them from territories where their contents are illegal is prohibited. Those who choose to access this site from other locations do so on their own initiative and are responsible for compliance with local laws. Any offer for any product, service, and/or information made in connection with this site is void where prohibited."},{title:" Termination of Use",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"You agree that we may, in our sole discretion, terminate or suspend your access to all or part of the site with or without notice and for any reason, including, without limitation, breach of these Terms of Use. Any suspected fraudulent, abusive or illegal activity may be grounds for terminating your relationship and may be referred to appropriate law enforcement authorities."}),M.jsx("p",{children:"Upon termination or suspension, regardless of the reasons therefore, your right to use the services available on this site immediately ceases, and you acknowledge and agree that we may immediately deactivate or delete your account and all related information and files in your account and/or bar any further access to such files or this site. We shall not be liable to you or any third party for any claims or damages arising out of any termination or suspension or any other actions taken by us in connection with such termination or suspension."})]})},{title:"Governing Law",content:"This site (excluding any linked sites) is controlled by us from our offices within the United States of America, United States of America. It can be accessed from all 50 states, as well as from other countries around the world. As each of these places has laws that may differ from those of United States of America, by accessing this site both of us agree that the statutes and laws of the State of United States of America, without regard to the conflicts of laws principles thereof and the United Nations Convention on the International Sales of Goods, will apply to all matters relating to the use of this site and the purchase of products and services available through this site. Each of us agrees and hereby submits to the exclusive personal jurisdiction and venue any court of competent jurisdiction within the State of United States of America with respect to such matters."},{title:"Notices",content:"All notices to a party shall be in writing and shall be made either via email or conventional mail. Notices to us must be sent to the attention of Customer Service at info@yourintell.com, if by email, or at Dan Murdoch Risk Services Hong Kong if by conventional mail. Notices to you may be sent to the address supplied by you as part of your Registration Data. In addition, we may broadcast notices or messages through the site to inform you of changes to the site or other matters of importance, and such broadcasts shall constitute notice to you at the time of sending."},{title:"Entire Agreement",content:"These terms and conditions constitute the entire agreement and understanding between us concerning the subject matter of this agreement and supersedes all prior agreements and understandings of the parties with respect to that subject matter. These Terms of Use may not be altered, supplemented, or amended by the use of any other document(s). Any attempt to alter, supplement or amend this document or to enter an order for products or services which are subject to additional or altered terms and conditions shall be null and void, unless otherwise agreed to in a written agreement signed by you and us. To the extent that anything in or associated with this site is in conflict or inconsistent with these Terms of Use, these Terms of Use shall take precedence."},{title:"Miscellaneous",content:M.jsxs(M.Fragment,{children:[M.jsx("p",{children:"In any action to enforce these Terms of Use, the prevailing party will be entitled to costs and attorneys' fees. Any cause of action brought by you against us or our Affiliates must be instituted with one year after the cause of action arises or be deemed forever waived and barred."}),M.jsx("p",{children:"You may not assign your rights and obligations under these Terms of Use to any party, and any purported attempt to do so will be null and void. We may free assign our rights and obligations under these Terms of Use."}),M.jsx("p",{children:"You agree not to sell, resell, reproduce, duplicate, copy or use for any commercial purposes any portion of this site, or use of or access to this site.In addition to any excuse provided by applicable law, we shall be excused from liability for non-delivery or delay in delivery of products and services available through our site arising from any event beyond our reasonable control, whether or not foreseeable by either party, including but not limited to, labor disturbance, war, fire, accident, adverse weather, inability to secure transportation, governmental act or regulation, and other causes or events beyond our reasonable control, whether or not similar to those which are enumerated above."}),M.jsx("p",{children:"If any part of these Terms of Use is held invalid or unenforceable, that portion shall be construed in a manner consistent with applicable law to reflect, as nearly as possible, the original intentions of the parties, and the remaining portions shall remain in full force and effect.Any failure by us to enforce or exercise any provision of these Terms of Use or related rights shall not constitute a waiver of that right or provision."})]})},{title:"Contact Information",content:"Except as explicitly noted on this site, the services available through this site are offered by Dan Murdoch Risk Services,located in Australia. If you notice that any user is violating these Terms of Use, please contact us at info@yourintell.com."}];return M.jsx("section",{className:"navTrigger",children:M.jsx("section",{className:"navTrigger",children:M.jsxs("div",{className:"flex flex-col w-full gap-6 px-6 py-24 bg-white h-fit mobile:py-24 mobile:p-12 mobile:h-fit mobile:flex-col tablet:p-24 tablet:flex-col laptop:px-20 laptop:py-20 laptop:gap-12 desktop:gap-10 desktop:p-36",children:[M.jsxs("div",{children:[M.jsx("h1",{className:"z-10 text-xl font-bold mobile:text-left mobile:text-2xl tablet:text-2xl",children:"TERMS OF USE"}),M.jsx("h2",{className:"z-10 text-sm font-bold text-accent-800 mobile:text-left mobile:text-base tablet:text-base",children:"Dan Murdoch Risk Services"})]}),M.jsx("h2",{className:"z-10 text-sm font-bold mobile:text-left mobile:text-base tablet:text-base",children:"SITE TERMS AND CONDITIONS USE"}),M.jsx("ol",{className:"flex flex-col gap-6 pl-5 list-decimal",children:e.map((t,r)=>M.jsx(w0e,{title:t.title,content:t.content,subParagraph:t.subParagraph??""},r))})]})})})},S0e=({...e})=>{const{imageUrl:t,title:r,content:i,index:n}=e;return M.jsxs("div",{className:"relative flex flex-col gap-5 laptop:flex-row",children:[M.jsxs("div",{className:"relative overflow-hidden rounded-lg laptop:hidden",children:[M.jsx("div",{className:"z-20",children:M.jsx("img",{className:"object-cover w-full h-full aspect-square mobile:aspect-video",src:t,alt:"",loading:"lazy"})}),M.jsx("div",{className:"absolute inset-0 bg-black/70"}),M.jsx("h3",{className:"absolute top-0 left-0 z-30 m-10 text-base mobile:text-lg text-white",children:r})]}),M.jsxs("div",{className:"flex flex-col laptop:w-[60%] laptop:gap-5",children:[M.jsx(We.h3,{initial:{x:-50},whileInView:{x:0},viewport:{once:!0},className:"hidden text-lg text-background-dark laptop:block",children:r}),M.jsx(We.p,{initial:{x:-50},whileInView:{x:0},viewport:{once:!0},className:"w-full text-justify",children:i})]}),M.jsx(_0e,{imageUrl:t})]})},_0e=({imageUrl:e})=>{const t=oe.useRef(null),r=oe.useRef(null);return oe.useEffect(()=>{let i;const n=r.current,s=()=>{n.classList.remove("opacity-0"),n.classList.add("opacity-1")};return n!=null&&n.complete?s():i=n==null?void 0:n.addEventListener("load",s),()=>{i&&removeEventListener("load",i)}},[]),M.jsx(We.div,{ref:t,initial:{x:100},whileInView:{x:0},viewport:{once:!0},className:"z-20 hidden w-1/2 h-full overflow-hidden rounded-lg laptop:block laptop:absolute right-[-15%] top-0 shadow-md bg-cover bg-center",style:{backgroundImage:"url(./images/browse-small.webp)"},children:M.jsx("img",{ref:r,className:"object-cover w-full h-full aspect-video opacity-0",src:e,alt:""})})},A0e=[{imageUrl:"./images/server.webp",title:"Why do we use our own virtual private network system?",content:"There are many reasons someone would want to surf the internet anonymously. Many people think that internet privacy is only for those trying to hide something but that simply is not the case. Internet privacy is essential for normal people like you and professionals like us who value their identity and rights. As governments, search engines, and marketers use increasingly more aggressive methods for tracking what you do online; the need for internet privacy has increased. Government agencies continue to push the boundaries of what they collect and demand from internet service providers, search engines, and individual website owners."},{imageUrl:"./images/browse.webp",title:"How They're Tracking You",content:"Every time you go online you run the risk of identify theft. Even seemingly harmless tasks like checking email and the news open you up to vulnerabilities. Website owners and statistics tracking systems can pinpoint the sites you've visited last, your geographic location and details about your browser and operating system. Worse, spyware and malevolent data tracking systems called cookies can track even more information about your surfing habits. For example, most web browsers today can save passwords for the sites that you visit. While this feature is convenient for us, criminals can often find and use this information to access your email accounts, online banking, and credit card accounts"},{imageUrl:"./images/hacker.webp",title:"Why They're Tracking You",content:"A large number of people are interested in your surfing habits; from marketing agencies to government agencies. Marketers want to know your buying habits in order to serve you more targeted offers. Governments may be interested in censoring the information you access. While not everyone tracking you may have evil intent, it is dangerous to leave your safety in the hands of others."},{imageUrl:"./images/security.webp",title:"How to Stop Them From Tracking You",content:"The best and perhaps only way for you to prevent this data collection is to surf the web anonymously. Anonymous surfing can be accomplished by using proxy servers that randomize your IP address as you surf the internet Proxy servers act as a middleman between you and the web sites you visit, preventing anyone from personally identifying you and your surfing habits. Protecting your internet privacy is essential for protecting you from those who wish to harm you. Using proxy servers is an effective way to do this."}],E0e=()=>M.jsxs("div",{className:"flex flex-col w-full bg-white",children:[M.jsx(Mv,{children:M.jsx("div",{className:"absolute top-0 left-0 w-full h-full",children:M.jsxs("div",{className:"relative z-10 flex flex-col w-full h-full",children:[M.jsx(Bv,{}),M.jsx("div",{className:"absolute top-0 left-0 z-40 w-3/4 h-full opacity-50 bg-gradient-to-r from-black via-black to-transparent"}),M.jsxs("div",{className:"z-50 relative flex flex-col items-center overflow-auto h-full w-full gap-2 py-[calc(4rem+2rem)] text-white px-10 laptop:px-28",children:[M.jsx("div",{className:"absolute z-50 hidden scale-110 -rotate-90 laptop:block bottom-28 right-28",children:M.jsxs("div",{className:"flex items-center gap-5 animate-ltr",children:[M.jsx(o2,{className:"scale-x-[150%]"}),M.jsx("p",{className:"whitespace-nowrap",children:"Scroll Down"})]})}),M.jsxs("div",{className:"flex flex-col items-center w-full gap-10 laptop:gap-20 laptop:flex-row",children:[M.jsx(We.div,{initial:{x:"-100%"},animate:{x:0},transition:{duration:1,ease:"easeOut"},className:"flex flex-col col-span-3",children:M.jsx("img",{src:"./images/DMRS.webp",alt:"",className:"w-full invert"})}),M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:"text-base text-center items mobile:text-left laptop:hidden",children:"Dan Murdoch Risk Services"}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:"hidden laptop:flex flex-col min-w-[15rem] rounded-lg overflow-hidden w-full",children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]}),M.jsxs("div",{className:"flex flex-col w-full h-full gap-10 tablet:flex-row tablet:mt-10 laptop:flex-col laptop:self-start",children:[M.jsx(We.p,{initial:{x:-400},animate:{x:0},transition:{delay:.2,duration:1,ease:"easeOut"},className:"hidden text-base mobile:text-left laptop:block",children:"Dan Murdoch Risk Services"}),M.jsx(We.div,{initial:{x:-450},animate:{x:0},transition:{delay:.4,duration:1,ease:"easeOut"},className:`flex flex-col items-center justify-center gap-1 
                  tablet:w-1/2
                  laptop:mt-auto laptop:items-start `,children:M.jsx("p",{className:"z-10 text-xl laptop:text-xl",children:"VPN"})}),M.jsxs(We.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:1,ease:"easeOut"},className:`flex 
                  tablet:w-1/2
                  laptop:hidden flex-col min-w-[15rem] rounded-lg overflow-hidden w-full mt-auto`,children:[M.jsx(wr,{to:"thailand",className:"flex items-center justify-center p-2 py-5 font-medium text-center transition-all bg-white hover:h-full h-1/2 text-background-dark",children:"Our Services"}),M.jsxs(wr,{to:"contact",className:"flex items-center justify-center gap-4 p-2 py-5 font-medium text-center transition-all hover:h-full h-1/2 hover:brightness-110 bg-primary-300 text-background-dark",children:["Get Started  ",M.jsx(Al,{className:"scale-150"})," "]})]})]})]})]})})}),M.jsx("section",{className:"relative flex gap-10 p-10 overflow-hidden laptop:pl-28 navTrigger",children:M.jsx("div",{className:"flex flex-col gap-16",children:A0e.map((e,t)=>M.jsx(S0e,{imageUrl:e.imageUrl,title:e.title,content:e.content,index:t},t))})})]}),M0e=()=>(oe.useEffect(()=>{var e=0,t=window.location;t.replace(t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")+t.pathname.split("/").slice(0,1+e).join("/")+"/?/"+t.pathname.slice(1).split("/").slice(e).join("/").replace(/&/g,"~and~")+(t.search?"&"+t.search.slice(1).replace(/&/g,"~and~"):"")+t.hash),function(r){if(r.search[1]==="/"){var i=r.search.slice(1).split("&").map(function(n){return n.replace(/~and~/g,"&")}).join("?");window.history.replaceState(null,null,r.pathname.slice(0,-1)+i+r.hash)}}(window.location)},[]),M.jsx("div",{})),T0e=$z(W4(M.jsxs(Xs,{path:"/dmrs",element:M.jsx(hF,{}),children:[M.jsx(Xs,{index:!0,element:M.jsx(Kme,{})}),M.jsx(Xs,{path:"thailand",element:M.jsx(m0e,{})}),M.jsx(Xs,{path:"australia",element:M.jsx(n0e,{})}),M.jsx(Xs,{path:"vpn",element:M.jsx(E0e,{})}),M.jsx(Xs,{path:"contact",element:M.jsx(g0e,{})}),M.jsx(Xs,{path:"terms",element:M.jsx(C0e,{})}),M.jsx(Xs,{path:"policy",element:M.jsx(x0e,{})}),M.jsx(Xs,{path:"*",element:M.jsx(M0e,{})})]}))),L0e=()=>M.jsx(Gz,{router:T0e});Y3.createRoot(document.getElementById("root")).render(M.jsx(Kn.StrictMode,{children:M.jsx(L0e,{})}))});export default P0e();
